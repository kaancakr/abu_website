(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[596],{2671:function(e,t,r){"use strict";let n,i,a,o,s,l,c,u,h,d,f,p,m,A,g,v,y,x,E,_,C,b,w,B,I,M,S,T,P,D,R,F,z,O,Q,L,k,U,N,G,H,V,j,Y,J,W,q,K,X,Z,$;function ee(){return(ee=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(null,arguments)}r.r(t),r.d(t,{AccumulativeShadows:function(){return gp},AdaptiveDpr:function(){return vJ},AdaptiveEvents:function(){return vW},ArcballControls:function(){return cX},AsciiRenderer:function(){return l8},BBAnchor:function(){return me},Backdrop:function(){return gE},BakeShadows:function(){return vN},Billboard:function(){return oe},Bounds:function(){return AR},Box:function(){return Aa},Bvh:function(){return p$},CameraControls:function(){return uF},CameraShake:function(){return Ak},Capsule:function(){return A_},CatmullRomLine:function(){return oF},Caustics:function(){return gM},Center:function(){return ma},Circle:function(){return Ao},Clone:function(){return sX},Cloud:function(){return ve},CloudInstance:function(){return g7},Clouds:function(){return g9},ComputedAttribute:function(){return sq},Cone:function(){return As},ContactShadows:function(){return gh},CubeCamera:function(){return cd},CubeTexture:function(){return hc},CubicBezierLine:function(){return oR},CurveModifier:function(){return mQ},CycleRaycast:function(){return eq},Cylinder:function(){return Al},Decal:function(){return s9},Detailed:function(){return vk},DetectGPU:function(){return fs},DeviceOrientationControls:function(){return cg},Dodecahedron:function(){return Ay},DragControls:function(){return re},Edges:function(){return sM},Effects:function(){return sm},Environment:function(){return gl},EnvironmentCube:function(){return ga},EnvironmentMap:function(){return gi},EnvironmentPortal:function(){return go},Example:function(){return mo},Extrude:function(){return Ax},FaceControls:function(){return xE},FaceLandmarker:function(){return xA},FaceLandmarkerDefaults:function(){return xm},Facemesh:function(){return xu},FacemeshDatas:function(){return xf},FacemeshEye:function(){return xd},FacemeshEyeDefaults:function(){return xh},Fbo:function(){return co},Fbx:function(){return du},FirstPersonControls:function(){return uh},Fisheye:function(){return v4},Float:function(){return AU},FlyControls:function(){return cC},GizmoHelper:function(){return uZ},GizmoViewcube:function(){return hr},GizmoViewport:function(){return ha},Gltf:function(){return l5},GradientTexture:function(){return sg},GradientType:function(){return sA},Grid:function(){return hs},Helper:function(){return dq},Html:function(){return eW},Hud:function(){return uN},Icosahedron:function(){return Ag},Image:function(){return sI},Instance:function(){return mC},Instances:function(){return mb},IsObject:function(){return sy},KeyboardControls:function(){return aH},Ktx2:function(){return dL},Lathe:function(){return AE},Lightformer:function(){return gL},Line:function(){return oT},Loader:function(){return e2},MapControls:function(){return cR},MarchingCube:function(){return s3},MarchingCubes:function(){return s2},MarchingPlane:function(){return s4},Mask:function(){return v2},MatcapTexture:function(){return vc},Merged:function(){return mw},MeshDiscardMaterial:function(){return m8},MeshDistortMaterial:function(){return mk},MeshPortalMaterial:function(){return v8},MeshReflectorMaterial:function(){return mj},MeshRefractionMaterial:function(){return m3},MeshTransmissionMaterial:function(){return m6},MeshWobbleMaterial:function(){return mN},MotionPathControls:function(){return uk},NormalTexture:function(){return vh},Octahedron:function(){return Av},OrbitControls:function(){return cF},OrthographicCamera:function(){return cl},Outlines:function(){return sT},PerformanceMonitor:function(){return vK},PerspectiveCamera:function(){return cu},PivotControls:function(){return xs},Plane:function(){return Au},Point:function(){return vP},PointMaterial:function(){return Ae},PointMaterialImpl:function(){return m7},PointerLockControls:function(){return ua},Points:function(){return vR},PointsBuffer:function(){return vD},Polyhedron:function(){return AA},PositionPoint:function(){return vB},PositionalAudio:function(){return oz},Preload:function(){return vU},PresentationControls:function(){return aU},Progress:function(){return e0},QuadraticBezierLine:function(){return oD},RandomizedLight:function(){return gm},Reflector:function(){return gS},RenderCubeTexture:function(){return v0},RenderTexture:function(){return vZ},Resize:function(){return AI},Ring:function(){return Am},RoundedBox:function(){return Ab},Sampler:function(){return sW},ScreenQuad:function(){return AB},ScreenSizer:function(){return oc},ScreenSpace:function(){return ot},Scroll:function(){return r2},ScrollControls:function(){return r$},Segment:function(){return vL},SegmentObject:function(){return vO},Segments:function(){return vz},Select:function(){return a9},Shadow:function(){return g_},ShadowAlpha:function(){return vE},Shape:function(){return AC},Sky:function(){return gY},SoftShadows:function(){return An},Sparkles:function(){return vs},Sphere:function(){return Ac},Splat:function(){return ci},SpotLight:function(){return gQ},SpotLightShadow:function(){return gO},SpriteAnimator:function(){return mM},Stage:function(){return gy},Stars:function(){return gq},Stats:function(){return d$},StatsGl:function(){return d2},Svg:function(){return le},Tetrahedron:function(){return Ap},Text:function(){return oL},Text3D:function(){return o$},Texture:function(){return sE},Torus:function(){return Ad},TorusKnot:function(){return Af},TrackballControls:function(){return ck},Trail:function(){return sH},TrailTexture:function(){return mi},TransformControls:function(){return c4},Tube:function(){return Ah},VideoTexture:function(){return dH},View:function(){return yx},Wireframe:function(){return vx},accumulativeContext:function(){return gd},calcPosFromAngles:function(){return gj},calculateAspectRatio:function(){return dY},calculateScaleFactor:function(){return os},checkIfFrameIsEmpty:function(){return dj},getFirstItem:function(){return dV},isWebGL2Available:function(){return sp},meshBounds:function(){return vY},shaderMaterial:function(){return sv},useAnimations:function(){return p1},useAspect:function(){return d4},useBVH:function(){return pZ},useBounds:function(){return AF},useBoxProjectedEnv:function(){return p8},useCamera:function(){return d5},useContextBridge:function(){return p0},useCubeCamera:function(){return ch},useCubeTexture:function(){return hl},useCursor:function(){return eK},useDepthBuffer:function(){return d3},useDetectGPU:function(){return fo},useEnvironment:function(){return ge},useFBO:function(){return ca},useFBX:function(){return dc},useFaceControls:function(){return x_},useFaceLandmarker:function(){return xg},useFont:function(){return oK},useGLTF:function(){return l4},useGizmoContext:function(){return uH},useHelper:function(){return dW},useIntersect:function(){return p2},useKTX2:function(){return dQ},useKeyboardControls:function(){return aV},useMask:function(){return v3},useMatcapTexture:function(){return vl},useMotion:function(){return uQ},useNormalTexture:function(){return vu},usePerformanceMonitor:function(){return vX},useProgress:function(){return e$},useScroll:function(){return rZ},useSelect:function(){return a7},useSpriteAnimator:function(){return mI},useSpriteLoader:function(){return dJ},useSurfaceSampler:function(){return sJ},useTexture:function(){return sx},useTrail:function(){return sG},useTrailTexture:function(){return mn},useVideoTexture:function(){return dG}});var et,er,en,ei,ea,eo,es,el,ec,eu,eh,ed,ef,ep,em,eA,eg,ev,ey,ex,eE,e_,eC,eb,ew,eB,eI,eM,eS,eT,eP,eD,eR,eF,ez=r(2265),eO=r(4040),eQ=r(7776),eL=r(5238);let ek=new eQ.Vector3,eU=new eQ.Vector3,eN=new eQ.Vector3,eG=new eQ.Vector2;function eH(e,t,r){let n=ek.setFromMatrixPosition(e.matrixWorld);n.project(t);let i=r.width/2,a=r.height/2;return[n.x*i+i,-(n.y*a)+a]}let eV=e=>1e-10>Math.abs(e)?0:e;function ej(e,t,r=""){let n="matrix3d(";for(let r=0;16!==r;r++)n+=eV(t[r]*e.elements[r])+(15!==r?",":")");return r+n}let eY=(Z=[1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1],e=>ej(e,Z)),eJ=($=e=>[1/e,1/e,1/e,1,-1/e,-1/e,-1/e,-1,1/e,1/e,1/e,1,1,1,1,1],(e,t)=>ej(e,$(t),"translate(-50%,-50%)")),eW=ez.forwardRef(({children:e,eps:t=.001,style:r,className:n,prepend:i,center:a,fullscreen:o,portal:s,distanceFactor:l,sprite:c=!1,transform:u=!1,occlude:h,onOcclude:d,castShadow:f,receiveShadow:p,material:m,geometry:A,zIndexRange:g=[16777271,0],calculatePosition:v=eH,as:y="div",wrapperClass:x,pointerEvents:E="auto",..._},C)=>{let{gl:b,camera:w,scene:B,size:I,raycaster:M,events:S,viewport:T}=(0,eL.A)(),[P]=ez.useState(()=>document.createElement(y)),D=ez.useRef(),R=ez.useRef(null),F=ez.useRef(0),z=ez.useRef([0,0]),O=ez.useRef(null),Q=ez.useRef(null),L=(null==s?void 0:s.current)||S.connected||b.domElement.parentNode,k=ez.useRef(null),U=ez.useRef(!1),N=ez.useMemo(()=>{var e;return h&&"blending"!==h||Array.isArray(h)&&h.length&&(e=h[0])&&"object"==typeof e&&"current"in e},[h]);ez.useLayoutEffect(()=>{let e=b.domElement;h&&"blending"===h?(e.style.zIndex=`${Math.floor(g[0]/2)}`,e.style.position="absolute",e.style.pointerEvents="none"):(e.style.zIndex=null,e.style.position=null,e.style.pointerEvents=null)},[h]),ez.useLayoutEffect(()=>{if(R.current){let e=D.current=eO.createRoot(P);if(B.updateMatrixWorld(),u)P.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{let e=v(R.current,w,I);P.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${e[0]}px,${e[1]}px,0);transform-origin:0 0;`}return L&&(i?L.prepend(P):L.appendChild(P)),()=>{L&&L.removeChild(P),e.unmount()}}},[L,u]),ez.useLayoutEffect(()=>{x&&(P.className=x)},[x]);let G=ez.useMemo(()=>u?{position:"absolute",top:0,left:0,width:I.width,height:I.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:a?"translate3d(-50%,-50%,0)":"none",...o&&{top:-I.height/2,left:-I.width/2,width:I.width,height:I.height},...r},[r,a,o,I,u]),H=ez.useMemo(()=>({position:"absolute",pointerEvents:E}),[E]);ez.useLayoutEffect(()=>{var t,i;U.current=!1,u?null==(t=D.current)||t.render(ez.createElement("div",{ref:O,style:G},ez.createElement("div",{ref:Q,style:H},ez.createElement("div",{ref:C,className:n,style:r,children:e})))):null==(i=D.current)||i.render(ez.createElement("div",{ref:C,style:G,className:n,children:e}))});let V=ez.useRef(!0);(0,eL.C)(e=>{if(R.current){w.updateMatrixWorld(),R.current.updateWorldMatrix(!0,!1);let e=u?z.current:v(R.current,w,I);if(u||Math.abs(F.current-w.zoom)>t||Math.abs(z.current[0]-e[0])>t||Math.abs(z.current[1]-e[1])>t){let t=function(e,t){let r=ek.setFromMatrixPosition(e.matrixWorld),n=eU.setFromMatrixPosition(t.matrixWorld),i=r.sub(n),a=t.getWorldDirection(eN);return i.angleTo(a)>Math.PI/2}(R.current,w),r=!1;N&&(Array.isArray(h)?r=h.map(e=>e.current):"blending"!==h&&(r=[B]));let n=V.current;if(r){let e=function(e,t,r,n){let i=ek.setFromMatrixPosition(e.matrixWorld),a=i.clone();a.project(t),eG.set(a.x,a.y),r.setFromCamera(eG,t);let o=r.intersectObjects(n,!0);if(o.length){let e=o[0].distance;return i.distanceTo(r.ray.origin)<e}return!0}(R.current,w,M,r);V.current=e&&!t}else V.current=!t;n!==V.current&&(d?d(!V.current):P.style.display=V.current?"block":"none");let i=Math.floor(g[0]/2),a=h?N?[g[0],i]:[i-1,0]:g;if(P.style.zIndex=`${function(e,t,r){if(t instanceof eQ.PerspectiveCamera||t instanceof eQ.OrthographicCamera){let n=ek.setFromMatrixPosition(e.matrixWorld),i=eU.setFromMatrixPosition(t.matrixWorld),a=n.distanceTo(i),o=(r[1]-r[0])/(t.far-t.near),s=r[1]-o*t.far;return Math.round(o*a+s)}}(R.current,w,a)}`,u){let[e,t]=[I.width/2,I.height/2],r=w.projectionMatrix.elements[5]*t,{isOrthographicCamera:n,top:i,left:a,bottom:o,right:s}=w,u=eY(w.matrixWorldInverse),h=n?`scale(${r})translate(${eV(-(s+a)/2)}px,${eV((i+o)/2)}px)`:`translateZ(${r}px)`,d=R.current.matrixWorld;c&&((d=w.matrixWorldInverse.clone().transpose().copyPosition(d).scale(R.current.scale)).elements[3]=d.elements[7]=d.elements[11]=0,d.elements[15]=1),P.style.width=I.width+"px",P.style.height=I.height+"px",P.style.perspective=n?"":`${r}px`,O.current&&Q.current&&(O.current.style.transform=`${h}${u}translate(${e}px,${t}px)`,Q.current.style.transform=eJ(d,1/((l||10)/400)))}else{let t=void 0===l?1:function(e,t){if(t instanceof eQ.OrthographicCamera)return t.zoom;if(!(t instanceof eQ.PerspectiveCamera))return 1;{let r=ek.setFromMatrixPosition(e.matrixWorld),n=eU.setFromMatrixPosition(t.matrixWorld);return 1/(2*Math.tan(t.fov*Math.PI/180/2)*r.distanceTo(n))}}(R.current,w)*l;P.style.transform=`translate3d(${e[0]}px,${e[1]}px,0) scale(${t})`}z.current=e,F.current=w.zoom}}if(!N&&k.current&&!U.current){if(u){if(O.current){let e=O.current.children[0];if(null!=e&&e.clientWidth&&null!=e&&e.clientHeight){let{isOrthographicCamera:t}=w;if(t||A)_.scale&&(Array.isArray(_.scale)?_.scale instanceof eQ.Vector3?k.current.scale.copy(_.scale.clone().divideScalar(1)):k.current.scale.set(1/_.scale[0],1/_.scale[1],1/_.scale[2]):k.current.scale.setScalar(1/_.scale));else{let t=(l||10)/400,r=e.clientWidth*t,n=e.clientHeight*t;k.current.scale.set(r,n,1)}U.current=!0}}}else{let t=P.children[0];if(null!=t&&t.clientWidth&&null!=t&&t.clientHeight){let e=1/T.factor,r=t.clientWidth*e,n=t.clientHeight*e;k.current.scale.set(r,n,1),U.current=!0}k.current.lookAt(e.camera.position)}}});let j=ez.useMemo(()=>({vertexShader:u?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom"
            is false.
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;

            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[u]);return ez.createElement("group",ee({},_,{ref:R}),h&&!N&&ez.createElement("mesh",{castShadow:f,receiveShadow:p,ref:k},A||ez.createElement("planeGeometry",null),m||ez.createElement("shaderMaterial",{side:eQ.DoubleSide,vertexShader:j.vertexShader,fragmentShader:j.fragmentShader})))});function eq({onChanged:e,portal:t,preventDefault:r=!0,scroll:n=!0,keyCode:i=9}){let a=ez.useRef(0),o=(0,eL.A)(e=>e.setEvents),s=(0,eL.A)(e=>e.get),l=(0,eL.A)(e=>e.gl);return ez.useEffect(()=>{var c;let u;let h=[],d=s().events.filter,f=null!==(c=null==t?void 0:t.current)&&void 0!==c?c:l.domElement.parentNode,p=()=>f&&e&&e(h,Math.round(a.current)%h.length);o({filter:(e,t)=>{let r=[...e];r.length===h.length&&h.every(e=>r.map(e=>e.object.uuid).includes(e.object.uuid))||(a.current=0,h=r,p()),d&&(r=d(r,t));for(let e=0;e<Math.round(a.current)%r.length;e++){let e=r.shift();r=[...r,e]}return r}});let m=e=>{var t,r;a.current=e(a.current),null==(t=s().events.handlers)||t.onPointerCancel(void 0),null==(r=s().events.handlers)||r.onPointerMove(u),p()},A=e=>{(e.keyCode||e.which)===i&&(r&&e.preventDefault(),h.length>1&&m(e=>e+1))},g=e=>{r&&e.preventDefault();let t=0;e||(e=window.event),e.wheelDelta?t=e.wheelDelta/120:e.detail&&(t=-e.detail/3),h.length>1&&m(e=>Math.abs(e-t))},v=e=>u=e;return document.addEventListener("pointermove",v,{passive:!0}),n&&document.addEventListener("wheel",g),void 0!==i&&document.addEventListener("keydown",A),()=>{o({filter:d}),void 0!==i&&document.removeEventListener("keydown",A),n&&document.removeEventListener("wheel",g),document.removeEventListener("pointermove",v)}},[l,s,o,r,n,i]),null}function eK(e,t="pointer",r="auto",n=document.body){ez.useEffect(()=>{if(e)return n.style.cursor=t,()=>void(n.style.cursor=r)},[e])}var eX=r(5901);let eZ=0,e$=(0,eX.Z)(e=>(eQ.DefaultLoadingManager.onStart=(t,r,n)=>{e({active:!0,item:t,loaded:r,total:n,progress:(r-eZ)/(n-eZ)*100})},eQ.DefaultLoadingManager.onLoad=()=>{e({active:!1})},eQ.DefaultLoadingManager.onError=t=>e(e=>({errors:[...e.errors,t]})),eQ.DefaultLoadingManager.onProgress=(t,r,n)=>{r===n&&(eZ=n),e({active:!0,item:t,loaded:r,total:n,progress:(r-eZ)/(n-eZ)*100||100})},{errors:[],active:!1,progress:0,item:"",loaded:0,total:0}));function e0({children:e}){let t=e$();return ez.createElement(ez.Fragment,null,null==e?void 0:e(t))}let e1=e=>`Loading ${e.toFixed(2)}%`;function e2({containerStyles:e,innerStyles:t,barStyles:r,dataStyles:n,dataInterpolation:i=e1,initialState:a=e=>e}){let{active:o,progress:s}=e$(),l=ez.useRef(0),c=ez.useRef(0),u=ez.useRef(null),[h,d]=ez.useState(a(o));ez.useEffect(()=>{let e;return o!==h&&(e=setTimeout(()=>d(o),300)),()=>clearTimeout(e)},[h,o]);let f=ez.useCallback(()=>{u.current&&(l.current+=(s-l.current)/2,(l.current>.95*s||100===s)&&(l.current=s),u.current.innerText=i(l.current),l.current<s&&(c.current=requestAnimationFrame(f)))},[i,s]);return ez.useEffect(()=>(f(),()=>cancelAnimationFrame(c.current)),[f]),h?ez.createElement("div",{style:{...e3.container,opacity:o?1:0,...e}},ez.createElement("div",null,ez.createElement("div",{style:{...e3.inner,...t}},ez.createElement("div",{style:{...e3.bar,transform:`scaleX(${s/100})`,...r}}),ez.createElement("span",{ref:u,style:{...e3.data,...n}})))):null}let e3={container:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"#171717",display:"flex",alignItems:"center",justifyContent:"center",transition:"opacity 300ms ease",zIndex:1e3},inner:{width:100,height:3,background:"#272727",textAlign:"center"},bar:{height:3,width:"100%",background:"white",transition:"transform 200ms",transformOrigin:"left center"},data:{display:"inline-block",position:"relative",fontVariantNumeric:"tabular-nums",marginTop:"0.8em",color:"#f0f0f0",fontSize:"0.6em",fontFamily:'-apple-system, BlinkMacSystemFont, "Inter", "Segoe UI", "Helvetica Neue", Helvetica, Arial, Roboto, Ubuntu, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',whiteSpace:"nowrap"}},e4={toVector:(e,t)=>(void 0===e&&(e=t),Array.isArray(e)?e:[e,e]),add:(e,t)=>[e[0]+t[0],e[1]+t[1]],sub:(e,t)=>[e[0]-t[0],e[1]-t[1]],addTo(e,t){e[0]+=t[0],e[1]+=t[1]},subTo(e,t){e[0]-=t[0],e[1]-=t[1]}};function e5(e,t,r){return 0===t||Math.abs(t)===1/0?Math.pow(e,5*r):e*t*r/(t+r*e)}function e6(e,t,r,n=.15){return 0===n?Math.max(t,Math.min(e,r)):e<t?-e5(t-e,r-t,n)+t:e>r?+e5(e-r,r-t,n)+r:e}function e8(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function e9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function e7(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?e9(Object(r),!0).forEach(function(t){e8(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):e9(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let te={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function tt(e){return e?e[0].toUpperCase()+e.slice(1):""}let tr=["enter","leave"],tn=["gotpointercapture","lostpointercapture"];function ti(e){return"touches"in e}function ta(e){return ti(e)?"touch":"pointerType"in e?e.pointerType:"mouse"}function to(e){return ti(e)?("touchend"===e.type||"touchcancel"===e.type?e.changedTouches:e.targetTouches)[0]:e}function ts(e,t){try{let r=t.clientX-e.clientX,n=t.clientY-e.clientY,i=(t.clientX+e.clientX)/2,a=(t.clientY+e.clientY)/2,o=Math.hypot(r,n);return{angle:-(180*Math.atan2(r,n))/Math.PI,distance:o,origin:[i,a]}}catch(e){}return null}function tl(e,t){let[r,n]=Array.from(e.touches).filter(e=>t.includes(e.identifier));return ts(r,n)}function tc(e){let t=to(e);return ti(e)?t.identifier:t.pointerId}function tu(e){let t=to(e);return[t.clientX,t.clientY]}function th(e){let{deltaX:t,deltaY:r,deltaMode:n}=e;return 1===n?(t*=40,r*=40):2===n&&(t*=800,r*=800),[t,r]}function td(e,...t){return"function"==typeof e?e(...t):e}function tf(){}function tp(e,t){return Object.assign({},t,e||{})}class tm{constructor(e,t,r){this.ctrl=e,this.args=t,this.key=r,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(e){this.ctrl.state[this.key]=e}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){let{state:e,shared:t,ingKey:r,args:n}=this;t[r]=e._active=e.active=e._blocked=e._force=!1,e._step=[!1,!1],e.intentional=!1,e._movement=[0,0],e._distance=[0,0],e._direction=[0,0],e._delta=[0,0],e._bounds=[[-1/0,1/0],[-1/0,1/0]],e.args=n,e.axis=void 0,e.memo=void 0,e.elapsedTime=e.timeDelta=0,e.direction=[0,0],e.distance=[0,0],e.overflow=[0,0],e._movementBound=[!1,!1],e.velocity=[0,0],e.movement=[0,0],e.delta=[0,0],e.timeStamp=0}start(e){let t=this.state,r=this.config;t._active||(this.reset(),this.computeInitial(),t._active=!0,t.target=e.target,t.currentTarget=e.currentTarget,t.lastOffset=r.from?td(r.from,t):t.offset,t.offset=t.lastOffset,t.startTime=t.timeStamp=e.timeStamp)}computeValues(e){let t=this.state;t._values=e,t.values=this.config.transform(e)}computeInitial(){let e=this.state;e._initial=e._values,e.initial=e.values}compute(e){let{state:t,config:r,shared:n}=this;t.args=this.args;let i=0;if(e&&(t.event=e,r.preventDefault&&e.cancelable&&t.event.preventDefault(),t.type=e.type,n.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,n.locked=!!document.pointerLockElement,Object.assign(n,function(e){let t={};if("buttons"in e&&(t.buttons=e.buttons),"shiftKey"in e){let{shiftKey:r,altKey:n,metaKey:i,ctrlKey:a}=e;Object.assign(t,{shiftKey:r,altKey:n,metaKey:i,ctrlKey:a})}return t}(e)),n.down=n.pressed=n.buttons%2==1||n.touches>0,i=e.timeStamp-t.timeStamp,t.timeStamp=e.timeStamp,t.elapsedTime=t.timeStamp-t.startTime),t._active){let e=t._delta.map(Math.abs);e4.addTo(t._distance,e)}this.axisIntent&&this.axisIntent(e);let[a,o]=t._movement,[s,l]=r.threshold,{_step:c,values:u}=t;if(r.hasCustomTransform?(!1===c[0]&&(c[0]=Math.abs(a)>=s&&u[0]),!1===c[1]&&(c[1]=Math.abs(o)>=l&&u[1])):(!1===c[0]&&(c[0]=Math.abs(a)>=s&&Math.sign(a)*s),!1===c[1]&&(c[1]=Math.abs(o)>=l&&Math.sign(o)*l)),t.intentional=!1!==c[0]||!1!==c[1],!t.intentional)return;let h=[0,0];if(r.hasCustomTransform){let[e,t]=u;h[0]=!1!==c[0]?e-c[0]:0,h[1]=!1!==c[1]?t-c[1]:0}else h[0]=!1!==c[0]?a-c[0]:0,h[1]=!1!==c[1]?o-c[1]:0;this.restrictToAxis&&!t._blocked&&this.restrictToAxis(h);let d=t.offset,f=t._active&&!t._blocked||t.active;f&&(t.first=t._active&&!t.active,t.last=!t._active&&t.active,t.active=n[this.ingKey]=t._active,e&&(t.first&&("bounds"in r&&(t._bounds=td(r.bounds,t)),this.setup&&this.setup()),t.movement=h,this.computeOffset()));let[p,m]=t.offset,[[A,g],[v,y]]=t._bounds;t.overflow=[p<A?-1:p>g?1:0,m<v?-1:m>y?1:0],t._movementBound[0]=!!t.overflow[0]&&(!1===t._movementBound[0]?t._movement[0]:t._movementBound[0]),t._movementBound[1]=!!t.overflow[1]&&(!1===t._movementBound[1]?t._movement[1]:t._movementBound[1]);let x=t._active&&r.rubberband||[0,0];if(t.offset=function(e,[t,r],[n,i]){let[[a,o],[s,l]]=e;return[e6(t,a,o,n),e6(r,s,l,i)]}(t._bounds,t.offset,x),t.delta=e4.sub(t.offset,d),this.computeMovement(),f&&(!t.last||i>32)){t.delta=e4.sub(t.offset,d);let e=t.delta.map(Math.abs);e4.addTo(t.distance,e),t.direction=t.delta.map(Math.sign),t._direction=t._delta.map(Math.sign),!t.first&&i>0&&(t.velocity=[e[0]/i,e[1]/i],t.timeDelta=i)}}emit(){let e=this.state,t=this.shared,r=this.config;if(e._active||this.clean(),(e._blocked||!e.intentional)&&!e._force&&!r.triggerAllEvents)return;let n=this.handler(e7(e7(e7({},t),e),{},{[this.aliasKey]:e.values}));void 0!==n&&(e.memo=n)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}}class tA extends tm{constructor(...e){super(...e),e8(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=e4.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=e4.sub(this.state.offset,this.state.lastOffset)}axisIntent(e){let t=this.state,r=this.config;if(!t.axis&&e){let n="object"==typeof r.axisThreshold?r.axisThreshold[ta(e)]:r.axisThreshold;t.axis=function([e,t],r){let n=Math.abs(e),i=Math.abs(t);return n>i&&n>r?"x":i>n&&i>r?"y":void 0}(t._movement,n)}t._blocked=(r.lockDirection||!!r.axis)&&!t.axis||!!r.axis&&r.axis!==t.axis}restrictToAxis(e){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":e[1]=0;break;case"y":e[0]=0}}}let tg=e=>e,tv={enabled:(e=!0)=>e,eventOptions:(e,t,r)=>e7(e7({},r.shared.eventOptions),e),preventDefault:(e=!1)=>e,triggerAllEvents:(e=!1)=>e,rubberband(e=0){switch(e){case!0:return[.15,.15];case!1:return[0,0];default:return e4.toVector(e)}},from:e=>"function"==typeof e?e:null!=e?e4.toVector(e):void 0,transform(e,t,r){let n=e||r.shared.transform;return this.hasCustomTransform=!!n,n||tg},threshold:e=>e4.toVector(e,0)},ty=0,tx=e7(e7({},tv),{},{axis(e,t,{axis:r}){if(this.lockDirection="lock"===r,!this.lockDirection)return r},axisThreshold:(e=ty)=>e,bounds(e={}){if("function"==typeof e)return t=>tx.bounds(e(t));if("current"in e)return()=>e.current;if("function"==typeof HTMLElement&&e instanceof HTMLElement)return e;let{left:t=-1/0,right:r=1/0,top:n=-1/0,bottom:i=1/0}=e;return[[t,r],[n,i]]}}),tE={ArrowRight:(e,t=1)=>[e*t,0],ArrowLeft:(e,t=1)=>[-1*e*t,0],ArrowUp:(e,t=1)=>[0,-1*e*t],ArrowDown:(e,t=1)=>[0,e*t]};class t_ extends tA{constructor(...e){super(...e),e8(this,"ingKey","dragging")}reset(){super.reset();let e=this.state;e._pointerId=void 0,e._pointerActive=!1,e._keyboardActive=!1,e._preventScroll=!1,e._delayed=!1,e.swipe=[0,0],e.tap=!1,e.canceled=!1,e.cancel=this.cancel.bind(this)}setup(){let e=this.state;if(e._bounds instanceof HTMLElement){let t=e._bounds.getBoundingClientRect(),r=e.currentTarget.getBoundingClientRect(),n={left:t.left-r.left+e.offset[0],right:t.right-r.right+e.offset[0],top:t.top-r.top+e.offset[1],bottom:t.bottom-r.bottom+e.offset[1]};e._bounds=tx.bounds(n)}}cancel(){let e=this.state;e.canceled||(e.canceled=!0,e._active=!1,setTimeout(()=>{this.compute(),this.emit()},0))}setActive(){this.state._active=this.state._pointerActive||this.state._keyboardActive}clean(){this.pointerClean(),this.state._pointerActive=!1,this.state._keyboardActive=!1,super.clean()}pointerDown(e){let t=this.config,r=this.state;if(null!=e.buttons&&(Array.isArray(t.pointerButtons)?!t.pointerButtons.includes(e.buttons):-1!==t.pointerButtons&&t.pointerButtons!==e.buttons))return;let n=this.ctrl.setEventIds(e);t.pointerCapture&&e.target.setPointerCapture(e.pointerId),n&&n.size>1&&r._pointerActive||(this.start(e),this.setupPointer(e),r._pointerId=tc(e),r._pointerActive=!0,this.computeValues(tu(e)),this.computeInitial(),t.preventScrollAxis&&"mouse"!==ta(e)?(r._active=!1,this.setupScrollPrevention(e)):t.delay>0?(this.setupDelayTrigger(e),t.triggerAllEvents&&(this.compute(e),this.emit())):this.startPointerDrag(e))}startPointerDrag(e){let t=this.state;t._active=!0,t._preventScroll=!0,t._delayed=!1,this.compute(e),this.emit()}pointerMove(e){let t=this.state,r=this.config;if(!t._pointerActive)return;let n=tc(e);if(void 0!==t._pointerId&&n!==t._pointerId)return;let i=tu(e);if(document.pointerLockElement===e.target?t._delta=[e.movementX,e.movementY]:(t._delta=e4.sub(i,t._values),this.computeValues(i)),e4.addTo(t._movement,t._delta),this.compute(e),t._delayed&&t.intentional){this.timeoutStore.remove("dragDelay"),t.active=!1,this.startPointerDrag(e);return}if(r.preventScrollAxis&&!t._preventScroll){if(!t.axis)return;if(t.axis===r.preventScrollAxis||"xy"===r.preventScrollAxis){t._active=!1,this.clean();return}this.timeoutStore.remove("startPointerDrag"),this.startPointerDrag(e);return}this.emit()}pointerUp(e){this.ctrl.setEventIds(e);try{this.config.pointerCapture&&e.target.hasPointerCapture(e.pointerId)&&e.target.releasePointerCapture(e.pointerId)}catch(e){}let t=this.state,r=this.config;if(!t._active||!t._pointerActive)return;let n=tc(e);if(void 0!==t._pointerId&&n!==t._pointerId)return;this.state._pointerActive=!1,this.setActive(),this.compute(e);let[i,a]=t._distance;if(t.tap=i<=r.tapsThreshold&&a<=r.tapsThreshold,t.tap&&r.filterTaps)t._force=!0;else{let[e,n]=t._delta,[i,a]=t._movement,[o,s]=r.swipe.velocity,[l,c]=r.swipe.distance,u=r.swipe.duration;if(t.elapsedTime<u){let r=Math.abs(e/t.timeDelta),u=Math.abs(n/t.timeDelta);r>o&&Math.abs(i)>l&&(t.swipe[0]=Math.sign(e)),u>s&&Math.abs(a)>c&&(t.swipe[1]=Math.sign(n))}}this.emit()}pointerClick(e){!this.state.tap&&e.detail>0&&(e.preventDefault(),e.stopPropagation())}setupPointer(e){let t=this.config,r=t.device;t.pointerLock&&e.currentTarget.requestPointerLock(),t.pointerCapture||(this.eventStore.add(this.sharedConfig.window,r,"change",this.pointerMove.bind(this)),this.eventStore.add(this.sharedConfig.window,r,"end",this.pointerUp.bind(this)),this.eventStore.add(this.sharedConfig.window,r,"cancel",this.pointerUp.bind(this)))}pointerClean(){this.config.pointerLock&&document.pointerLockElement===this.state.currentTarget&&document.exitPointerLock()}preventScroll(e){this.state._preventScroll&&e.cancelable&&e.preventDefault()}setupScrollPrevention(e){this.state._preventScroll=!1,"persist"in e&&"function"==typeof e.persist&&e.persist();let t=this.eventStore.add(this.sharedConfig.window,"touch","change",this.preventScroll.bind(this),{passive:!1});this.eventStore.add(this.sharedConfig.window,"touch","end",t),this.eventStore.add(this.sharedConfig.window,"touch","cancel",t),this.timeoutStore.add("startPointerDrag",this.startPointerDrag.bind(this),this.config.preventScrollDelay,e)}setupDelayTrigger(e){this.state._delayed=!0,this.timeoutStore.add("dragDelay",()=>{this.state._step=[0,0],this.startPointerDrag(e)},this.config.delay)}keyDown(e){let t=tE[e.key];if(t){let r=this.state,n=e.shiftKey?10:e.altKey?.1:1;this.start(e),r._delta=t(this.config.keyboardDisplacement,n),r._keyboardActive=!0,e4.addTo(r._movement,r._delta),this.compute(e),this.emit()}}keyUp(e){e.key in tE&&(this.state._keyboardActive=!1,this.setActive(),this.compute(e),this.emit())}bind(e){let t=this.config.device;e(t,"start",this.pointerDown.bind(this)),this.config.pointerCapture&&(e(t,"change",this.pointerMove.bind(this)),e(t,"end",this.pointerUp.bind(this)),e(t,"cancel",this.pointerUp.bind(this)),e("lostPointerCapture","",this.pointerUp.bind(this))),this.config.keys&&(e("key","down",this.keyDown.bind(this)),e("key","up",this.keyUp.bind(this))),this.config.filterTaps&&e("click","",this.pointerClick.bind(this),{capture:!0,passive:!1})}}let tC="undefined"!=typeof window&&window.document&&window.document.createElement;function tb(){return tC&&"ontouchstart"in window}let tw={isBrowser:tC,gesture:function(){try{return"constructor"in GestureEvent}catch(e){return!1}}(),touch:tb(),touchscreen:tb()||tC&&window.navigator.maxTouchPoints>1,pointer:tC&&"onpointerdown"in window,pointerLock:tC&&"exitPointerLock"in window.document},tB=10,tI={mouse:0,touch:0,pen:8},tM=e7(e7({},tx),{},{device(e,t,{pointer:{touch:r=!1,lock:n=!1,mouse:i=!1}={}}){return(this.pointerLock=n&&tw.pointerLock,tw.touch&&r)?"touch":this.pointerLock?"mouse":tw.pointer&&!i?"pointer":tw.touch?"touch":"mouse"},preventScrollAxis(e,t,{preventScroll:r}){if(this.preventScrollDelay="number"==typeof r?r:r||void 0===r&&e?250:void 0,tw.touchscreen&&!1!==r)return e||(void 0!==r?"y":void 0)},pointerCapture(e,t,{pointer:{capture:r=!0,buttons:n=1,keys:i=!0}={}}){return this.pointerButtons=n,this.keys=i,!this.pointerLock&&"pointer"===this.device&&r},threshold(e,t,{filterTaps:r=!1,tapsThreshold:n=3,axis:i}){let a=e4.toVector(e,r?n:i?1:0);return this.filterTaps=r,this.tapsThreshold=n,a},swipe({velocity:e=.5,distance:t=50,duration:r=250}={}){return{velocity:this.transform(e4.toVector(e)),distance:this.transform(e4.toVector(t)),duration:r}},delay(e=0){switch(e){case!0:return 180;case!1:return 0;default:return e}},axisThreshold:e=>e?e7(e7({},tI),e):tI,keyboardDisplacement:(e=tB)=>e});function tS(e){let[t,r]=e.overflow,[n,i]=e._delta,[a,o]=e._direction;(t<0&&n>0&&a<0||t>0&&n<0&&a>0)&&(e._movement[0]=e._movementBound[0]),(r<0&&i>0&&o<0||r>0&&i<0&&o>0)&&(e._movement[1]=e._movementBound[1])}class tT extends tm{constructor(...e){super(...e),e8(this,"ingKey","pinching"),e8(this,"aliasKey","da")}init(){this.state.offset=[1,0],this.state.lastOffset=[1,0],this.state._pointerEvents=new Map}reset(){super.reset();let e=this.state;e._touchIds=[],e.canceled=!1,e.cancel=this.cancel.bind(this),e.turns=0}computeOffset(){let{type:e,movement:t,lastOffset:r}=this.state;"wheel"===e?this.state.offset=e4.add(t,r):this.state.offset=[(1+t[0])*r[0],t[1]+r[1]]}computeMovement(){let{offset:e,lastOffset:t}=this.state;this.state.movement=[e[0]/t[0],e[1]-t[1]]}axisIntent(){let e=this.state,[t,r]=e._movement;if(!e.axis){let n=30*Math.abs(t)-Math.abs(r);n<0?e.axis="angle":n>0&&(e.axis="scale")}}restrictToAxis(e){this.config.lockDirection&&("scale"===this.state.axis?e[1]=0:"angle"===this.state.axis&&(e[0]=0))}cancel(){let e=this.state;e.canceled||setTimeout(()=>{e.canceled=!0,e._active=!1,this.compute(),this.emit()},0)}touchStart(e){this.ctrl.setEventIds(e);let t=this.state,r=this.ctrl.touchIds;if(t._active&&t._touchIds.every(e=>r.has(e))||r.size<2)return;this.start(e),t._touchIds=Array.from(r).slice(0,2);let n=tl(e,t._touchIds);n&&this.pinchStart(e,n)}pointerStart(e){if(null!=e.buttons&&e.buttons%2!=1)return;this.ctrl.setEventIds(e),e.target.setPointerCapture(e.pointerId);let t=this.state,r=t._pointerEvents,n=this.ctrl.pointerIds;if(t._active&&Array.from(r.keys()).every(e=>n.has(e))||(r.size<2&&r.set(e.pointerId,e),t._pointerEvents.size<2))return;this.start(e);let i=ts(...Array.from(r.values()));i&&this.pinchStart(e,i)}pinchStart(e,t){this.state.origin=t.origin,this.computeValues([t.distance,t.angle]),this.computeInitial(),this.compute(e),this.emit()}touchMove(e){if(!this.state._active)return;let t=tl(e,this.state._touchIds);t&&this.pinchMove(e,t)}pointerMove(e){let t=this.state._pointerEvents;if(t.has(e.pointerId)&&t.set(e.pointerId,e),!this.state._active)return;let r=ts(...Array.from(t.values()));r&&this.pinchMove(e,r)}pinchMove(e,t){let r=this.state,n=r._values[1],i=t.angle-n,a=0;Math.abs(i)>270&&(a+=Math.sign(i)),this.computeValues([t.distance,t.angle-360*a]),r.origin=t.origin,r.turns=a,r._movement=[r._values[0]/r._initial[0]-1,r._values[1]-r._initial[1]],this.compute(e),this.emit()}touchEnd(e){this.ctrl.setEventIds(e),this.state._active&&this.state._touchIds.some(e=>!this.ctrl.touchIds.has(e))&&(this.state._active=!1,this.compute(e),this.emit())}pointerEnd(e){let t=this.state;this.ctrl.setEventIds(e);try{e.target.releasePointerCapture(e.pointerId)}catch(e){}t._pointerEvents.has(e.pointerId)&&t._pointerEvents.delete(e.pointerId),t._active&&t._pointerEvents.size<2&&(t._active=!1,this.compute(e),this.emit())}gestureStart(e){e.cancelable&&e.preventDefault();let t=this.state;t._active||(this.start(e),this.computeValues([e.scale,e.rotation]),t.origin=[e.clientX,e.clientY],this.compute(e),this.emit())}gestureMove(e){if(e.cancelable&&e.preventDefault(),!this.state._active)return;let t=this.state;this.computeValues([e.scale,e.rotation]),t.origin=[e.clientX,e.clientY];let r=t._movement;t._movement=[e.scale-1,e.rotation],t._delta=e4.sub(t._movement,r),this.compute(e),this.emit()}gestureEnd(e){this.state._active&&(this.state._active=!1,this.compute(e),this.emit())}wheel(e){let t=this.config.modifierKey;(!t||(Array.isArray(t)?t.find(t=>e[t]):e[t]))&&(this.state._active?this.wheelChange(e):this.wheelStart(e),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this)))}wheelStart(e){this.start(e),this.wheelChange(e)}wheelChange(e){"uv"in e||!e.cancelable||e.preventDefault();let t=this.state;t._delta=[-th(e)[1]/100*t.offset[0],0],e4.addTo(t._movement,t._delta),tS(t),this.state.origin=[e.clientX,e.clientY],this.compute(e),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(e){let t=this.config.device;t&&(e(t,"start",this[t+"Start"].bind(this)),e(t,"change",this[t+"Move"].bind(this)),e(t,"end",this[t+"End"].bind(this)),e(t,"cancel",this[t+"End"].bind(this)),e("lostPointerCapture","",this[t+"End"].bind(this))),this.config.pinchOnWheel&&e("wheel","",this.wheel.bind(this),{passive:!1})}}let tP=e7(e7({},tv),{},{device(e,t,{shared:r,pointer:{touch:n=!1}={}}){if(r.target&&!tw.touch&&tw.gesture)return"gesture";if(tw.touch&&n)return"touch";if(tw.touchscreen){if(tw.pointer)return"pointer";if(tw.touch)return"touch"}},bounds(e,t,{scaleBounds:r={},angleBounds:n={}}){let i=e=>{let t=tp(td(r,e),{min:-1/0,max:1/0});return[t.min,t.max]},a=e=>{let t=tp(td(n,e),{min:-1/0,max:1/0});return[t.min,t.max]};return"function"!=typeof r&&"function"!=typeof n?[i(),a()]:e=>[i(e),a(e)]},threshold(e,t,r){return this.lockDirection="lock"===r.axis,e4.toVector(e,this.lockDirection?[.1,3]:0)},modifierKey:e=>void 0===e?"ctrlKey":e,pinchOnWheel:(e=!0)=>e});class tD extends tA{constructor(...e){super(...e),e8(this,"ingKey","moving")}move(e){this.config.mouseOnly&&"mouse"!==e.pointerType||(this.state._active?this.moveChange(e):this.moveStart(e),this.timeoutStore.add("moveEnd",this.moveEnd.bind(this)))}moveStart(e){this.start(e),this.computeValues(tu(e)),this.compute(e),this.computeInitial(),this.emit()}moveChange(e){if(!this.state._active)return;let t=tu(e),r=this.state;r._delta=e4.sub(t,r._values),e4.addTo(r._movement,r._delta),this.computeValues(t),this.compute(e),this.emit()}moveEnd(e){this.state._active&&(this.state._active=!1,this.compute(e),this.emit())}bind(e){e("pointer","change",this.move.bind(this)),e("pointer","leave",this.moveEnd.bind(this))}}let tR=e7(e7({},tx),{},{mouseOnly:(e=!0)=>e});class tF extends tA{constructor(...e){super(...e),e8(this,"ingKey","scrolling")}scroll(e){this.state._active||this.start(e),this.scrollChange(e),this.timeoutStore.add("scrollEnd",this.scrollEnd.bind(this))}scrollChange(e){e.cancelable&&e.preventDefault();let t=this.state,r=function(e){var t,r;let{scrollX:n,scrollY:i,scrollLeft:a,scrollTop:o}=e.currentTarget;return[null!==(t=null!=n?n:a)&&void 0!==t?t:0,null!==(r=null!=i?i:o)&&void 0!==r?r:0]}(e);t._delta=e4.sub(r,t._values),e4.addTo(t._movement,t._delta),this.computeValues(r),this.compute(e),this.emit()}scrollEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(e){e("scroll","",this.scroll.bind(this))}}class tz extends tA{constructor(...e){super(...e),e8(this,"ingKey","wheeling")}wheel(e){this.state._active||this.start(e),this.wheelChange(e),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this))}wheelChange(e){let t=this.state;t._delta=th(e),e4.addTo(t._movement,t._delta),tS(t),this.compute(e),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(e){e("wheel","",this.wheel.bind(this))}}class tO extends tA{constructor(...e){super(...e),e8(this,"ingKey","hovering")}enter(e){this.config.mouseOnly&&"mouse"!==e.pointerType||(this.start(e),this.computeValues(tu(e)),this.compute(e),this.emit())}leave(e){if(this.config.mouseOnly&&"mouse"!==e.pointerType)return;let t=this.state;if(!t._active)return;t._active=!1;let r=tu(e);t._movement=t._delta=e4.sub(r,t._values),this.computeValues(r),this.compute(e),t.delta=t.movement,this.emit()}bind(e){e("pointer","enter",this.enter.bind(this)),e("pointer","leave",this.leave.bind(this))}}let tQ=e7(e7({},tx),{},{mouseOnly:(e=!0)=>e}),tL=new Map,tk=new Map;function tU(e){tL.set(e.key,e.engine),tk.set(e.key,e.resolver)}let tN={key:"drag",engine:t_,resolver:tM},tG={key:"hover",engine:tO,resolver:tQ},tH={key:"move",engine:tD,resolver:tR},tV={key:"pinch",engine:tT,resolver:tP},tj={key:"scroll",engine:tF,resolver:tx},tY={key:"wheel",engine:tz,resolver:tx},tJ={target(e){if(e)return()=>"current"in e?e.current:e},enabled:(e=!0)=>e,window:(e=tw.isBrowser?window:void 0)=>e,eventOptions:({passive:e=!0,capture:t=!1}={})=>({passive:e,capture:t}),transform:e=>e},tW=["target","eventOptions","window","enabled","transform"];function tq(e={},t){let r={};for(let[n,i]of Object.entries(t))switch(typeof i){case"function":r[n]=i.call(r,e[n],n,e);break;case"object":r[n]=tq(e[n],i);break;case"boolean":i&&(r[n]=e[n])}return r}class tK{constructor(e,t){e8(this,"_listeners",new Set),this._ctrl=e,this._gestureKey=t}add(e,t,r,n,i){let a=this._listeners,o=function(e,t=""){let r=te[e];return e+(r&&r[t]||t)}(t,r),s=e7(e7({},this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{}),i);e.addEventListener(o,n,s);let l=()=>{e.removeEventListener(o,n,s),a.delete(l)};return a.add(l),l}clean(){this._listeners.forEach(e=>e()),this._listeners.clear()}}class tX{constructor(){e8(this,"_timeouts",new Map)}add(e,t,r=140,...n){this.remove(e),this._timeouts.set(e,window.setTimeout(t,r,...n))}remove(e){let t=this._timeouts.get(e);t&&window.clearTimeout(t)}clean(){this._timeouts.forEach(e=>void window.clearTimeout(e)),this._timeouts.clear()}}class tZ{constructor(e){e8(this,"gestures",new Set),e8(this,"_targetEventStore",new tK(this)),e8(this,"gestureEventStores",{}),e8(this,"gestureTimeoutStores",{}),e8(this,"handlers",{}),e8(this,"config",{}),e8(this,"pointerIds",new Set),e8(this,"touchIds",new Set),e8(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),e.drag&&t$(this,"drag"),e.wheel&&t$(this,"wheel"),e.scroll&&t$(this,"scroll"),e.move&&t$(this,"move"),e.pinch&&t$(this,"pinch"),e.hover&&t$(this,"hover")}setEventIds(e){return ti(e)?(this.touchIds=new Set(Array.from(e.touches).filter(t=>{var r,n;return t.target===e.currentTarget||(null===(r=e.currentTarget)||void 0===r||null===(n=r.contains)||void 0===n?void 0:n.call(r,t.target))}).map(e=>e.identifier)),this.touchIds):"pointerId"in e?("pointerup"===e.type||"pointercancel"===e.type?this.pointerIds.delete(e.pointerId):"pointerdown"===e.type&&this.pointerIds.add(e.pointerId),this.pointerIds):void 0}applyHandlers(e,t){this.handlers=e,this.nativeHandlers=t}applyConfig(e,t){this.config=function(e,t,r={}){let{target:n,eventOptions:i,window:a,enabled:o,transform:s}=e,l=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,tW);if(r.shared=tq({target:n,eventOptions:i,window:a,enabled:o,transform:s},tJ),t){let e=tk.get(t);r[t]=tq(e7({shared:r.shared},l),e)}else for(let e in l){let t=tk.get(e);t&&(r[e]=tq(e7({shared:r.shared},l[e]),t))}return r}(e,t,this.config)}clean(){for(let e of(this._targetEventStore.clean(),this.gestures))this.gestureEventStores[e].clean(),this.gestureTimeoutStores[e].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(...e){let t;let r=this.config.shared,n={};if(!r.target||(t=r.target())){if(r.enabled){for(let r of this.gestures){let i=this.config[r],a=t0(n,i.eventOptions,!!t);i.enabled&&new(tL.get(r))(this,e,r).bind(a)}let i=t0(n,r.eventOptions,!!t);for(let t in this.nativeHandlers)i(t,"",r=>this.nativeHandlers[t](e7(e7({},this.state.shared),{},{event:r,args:e})),void 0,!0)}for(let e in n)n[e]=function(...e){return 0===e.length?tf:1===e.length?e[0]:function(){let t;for(let r of e)t=r.apply(this,arguments)||t;return t}}(...n[e]);if(!t)return n;for(let e in n){let{device:r,capture:i,passive:a}=function(e){let t=e.substring(2).toLowerCase(),r=!!~t.indexOf("passive");r&&(t=t.replace("passive",""));let n=tn.includes(t)?"capturecapture":"capture",i=!!~t.indexOf(n);return i&&(t=t.replace("capture","")),{device:t,capture:i,passive:r}}(e);this._targetEventStore.add(t,r,"",n[e],{capture:i,passive:a})}}}}function t$(e,t){e.gestures.add(t),e.gestureEventStores[t]=new tK(e,t),e.gestureTimeoutStores[t]=new tX}let t0=(e,t,r)=>(n,i,a,o={},s=!1)=>{var l,c;let u=null!==(l=o.capture)&&void 0!==l?l:t.capture,h=null!==(c=o.passive)&&void 0!==c?c:t.passive,d=s?n:function(e,t="",r=!1){let n=te[e],i=n&&n[t]||t;return"on"+tt(e)+tt(i)+(!function(e=!1,t){return e&&!tr.includes(t)}(r,i)?"":"Capture")}(n,i,u);r&&h&&(d+="Passive"),e[d]=e[d]||[],e[d].push(a)},t1=/^on(Drag|Wheel|Scroll|Move|Pinch|Hover)/;function t2(e,t,r,n,i,a){if(!e.has(r)||!tL.has(n))return;let o=r+"Start",s=r+"End";i[n]=e=>{let n;return e.first&&o in t&&t[o](e),r in t&&(n=t[r](e)),e.last&&s in t&&t[s](e),n},a[n]=a[n]||{}}function t3(e,t){return([tN,tV,tj,tY,tH,tG].forEach(tU),function(e,t){let{handlers:r,nativeHandlers:n,config:i}=function(e,t){let[r,n,i]=function(e){let t={},r={},n=new Set;for(let i in e)t1.test(i)?(n.add(RegExp.lastMatch),r[i]=e[i]):t[i]=e[i];return[r,t,n]}(e),a={};return t2(i,r,"onDrag","drag",a,t),t2(i,r,"onWheel","wheel",a,t),t2(i,r,"onScroll","scroll",a,t),t2(i,r,"onPinch","pinch",a,t),t2(i,r,"onMove","move",a,t),t2(i,r,"onHover","hover",a,t),{handlers:a,config:t,nativeHandlers:n}}(e,t||{});return function(e,t={},r,n){let i=ez.useMemo(()=>new tZ(e),[]);if(i.applyHandlers(e,n),i.applyConfig(t,r),ez.useEffect(i.effect.bind(i)),ez.useEffect(()=>i.clean.bind(i),[]),void 0===t.target)return i.bind.bind(i)}(r,i,void 0,n)})(e,t||{})}let t4=new eQ.Vector3,t5=new eQ.Vector2,t6=new eQ.Vector3,t8=new eQ.Vector3,t9=new eQ.Vector3,t7=new eQ.Plane,re=ez.forwardRef(({autoTransform:e=!0,matrix:t,axisLock:r,dragLimits:n,onHover:i,onDragStart:a,onDrag:o,onDragEnd:s,children:l,dragConfig:c,...u},h)=>{let d=(0,eL.A)(e=>e.controls),{camera:f,size:p,raycaster:m,invalidate:A}=(0,eL.A)(),g=ez.useRef(null),v=t3({onHover:({hovering:e})=>i&&i(null!=e&&e),onDragStart:({event:e})=>{d&&(d.enabled=!1);let{point:t}=e;g.current.matrix.decompose(t4,new eQ.Quaternion,new eQ.Vector3),t6.copy(t),t8.copy(t6).sub(t4),a&&a(t4),A()},onDrag:({xy:[t,i],intentional:a})=>{if(!a)return;let s=(t-p.left)/p.width*2-1,l=-((i-p.top)/p.height*2)+1;if(t5.set(s,l),m.setFromCamera(t5,f),r)switch(r){case"x":t9.set(1,0,0);break;case"y":t9.set(0,1,0);break;case"z":t9.set(0,0,1)}else f.getWorldDirection(t9).negate();t7.setFromNormalAndCoplanarPoint(t9,t6),m.ray.intersectPlane(t7,t6);let c=g.current.matrix.clone(),u=g.current.matrixWorld.clone(),h=new eQ.Vector3(t6.x-t8.x,t6.y-t8.y,t6.z-t8.z);if(n&&(h.x=n[0]?Math.max(Math.min(h.x,n[0][1]),n[0][0]):h.x,h.y=n[1]?Math.max(Math.min(h.y,n[1][1]),n[1][0]):h.y,h.z=n[2]?Math.max(Math.min(h.z,n[2][1]),n[2][0]):h.z),e){g.current.matrix.setPosition(h);let e=g.current.matrix.clone().multiply(c.invert()),t=g.current.matrix.clone().multiply(u.invert());o&&o(g.current.matrix,e,g.current.matrixWorld,t)}else{let e=new eQ.Matrix4().copy(g.current.matrix);e.setPosition(h);let t=e.clone().multiply(c.invert()),r=e.clone().multiply(u.invert());o&&o(e,t,g.current.matrixWorld,r)}A()},onDragEnd:()=>{d&&(d.enabled=!0),s&&s(),A()}},{drag:{filterTaps:!0,threshold:1,..."object"==typeof c?c:{}}});return ez.useImperativeHandle(h,()=>g.current,[]),ez.useLayoutEffect(()=>{t&&(g.current.matrix=t)},[t]),ez.createElement("group",ee({ref:g},v(),{matrix:t,matrixAutoUpdate:!1},u),l)});function rt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rr(e,t){return(rr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function rn(e,t){for(var r=[],n=e.toArray(),i=t.toArray(),a=0;a<n.length;a++)r[a]=n[a]+i[a];return new eQ.Matrix3().fromArray(r)}function ri(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function ra(e,t){if(e){if("string"==typeof e)return ri(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ri(e,t)}}function ro(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r,n,i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var a=[],o=!0,s=!1;try{for(i=i.call(e);!(o=(r=i.next()).done)&&(a.push(r.value),!t||a.length!==t);o=!0);}catch(e){s=!0,n=e}finally{try{o||null==i.return||i.return()}finally{if(s)throw n}}return a}}(e,t)||ra(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rs(e){return function(e){if(Array.isArray(e))return ri(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ra(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rl(e,t,r){return(rl=!function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}()?function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&rr(i,r.prototype),i}:Reflect.construct).apply(null,arguments)}var rc=new eQ.Vector2,ru=new eQ.Vector2;function rh(e){var t,r,n,i,a,o,s,l,c=ro(e.map(function(e){return Array.isArray(e)?rl(eQ.Vector2,rs(e)):e}),3),u=c[0],h=c[1],d=c[2];if(0===(n=(r=ro((t=e)[0],2))[0],i=r[1],o=(a=ro(t[1],2))[0],s=a[1],function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],l=t[5],c=t[6],u=t[7],h=t[8];return n*s*h+i*l*c+a*o*u-a*s*c-i*o*h-n*l*u}(n,i,1,o,s,1,(l=ro(t[2],2))[0],l[1],1)))return!1;var f=rc.subVectors(h,u);return ru.subVectors(d,u).cross(f)>0}function rd(e,t,r){return Math.max(t,Math.min(r,e))}function rf(e,t){return rd(e-Math.floor(e/t)*t,0,t)}function rp(e,t){var r=rf(t-e,2*Math.PI);return r>Math.PI&&(r-=2*Math.PI),r}function rm(e,t){return e.x===t.x?void 0!==e.z&&e.y===t.y?e.z-t.z:e.y-t.y:e.x-t.x}function rA(e,t,r){return(r-e)/(t-e)}function rg(e,t){var r=new eQ.Vector3().crossVectors(e,t),n=e.dot(t),i=new eQ.Matrix3().identity(),a=new eQ.Matrix3().set(0,-r.z,r.y,r.z,0,-r.x,-r.y,r.x,0),o=new eQ.Matrix3().multiplyMatrices(a,a).multiplyScalar(1/(1+n));return rn(rn(i,a),o)}var rv=Object.freeze({__proto__:null,clamp:rd,repeat:rf,deltaAngle:rp,degToRad:function(e){return e/180*Math.PI},radToDeg:function(e){return 180*e/Math.PI},fibonacciOnSphere:function(e,t){for(var r=t.radius,n=void 0===r?1:r,i=e.length/3,a=2/i,o=Math.PI*(3-2.2360679775),s=0;s<e.length;s+=3){var l=s*a-1+a/2,c=Math.sqrt(1-Math.pow(l,2)),u=s%i*o,h=Math.cos(u)*c,d=Math.sin(u)*c;e[s]=h*n,e[s+1]=l*n,e[s+2]=d*n}},vectorEquals:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.EPSILON;return Math.abs(e.x-t.x)<r&&Math.abs(e.y-t.y)<r&&Math.abs(e.z-t.z)<r},lexicographic:rm,convexHull:function(e){for(var t=e.sort(rm),r=[t[0],t[1]],n=2;n<t.length;n++)for(r.push(t[n]);r.length>2&&rh(rs(r.slice(-3)));)r.splice(r.length-2,1);for(var i=[t[t.length-1],t[t.length-2]],a=t.length-3;a>=0;a--)for(i.push(t[a]);i.length>2&&rh(rs(i.slice(-3)));)i.splice(i.length-2,1);return i.splice(0,1),i.splice(i.length-1,1),[].concat(r,i)},remap:function(e,t,r){var n=ro(t,2),i=n[0],a=n[1],o=ro(r,2),s=o[0];return s+(e-i)*(o[1]-s)/(a-i)},fade:function(e){return e*e*e*(e*(6*e-15)+10)},lerp:function(e,t,r){return e*(1-r)+t*r},inverseLerp:rA,normalize:function(e,t,r){var n=Math.sqrt(e*e+t*t+r*r);return[e/n,t/n,r/n]},pointOnCubeToPointOnSphere:function(e,t,r){var n=e*e,i=t*t,a=r*r;return[e*Math.sqrt(1-(i+a)/2+i*a/3),t*Math.sqrt(1-(a+n)/2+a*n/3),r*Math.sqrt(1-(n+i)/2+n*i/3)]},rotateVectorOnVector:rg,pointToCoordinate:function(e,t,r){return[Math.asin(t),Math.atan2(e,-r)]},coordinateToPoint:function(e,t){var r=Math.sin(e),n=Math.cos(e);return[Math.sin(t)*n,r,-Math.cos(t)*n]},planeSegmentIntersection:function(e,t){var r=ro(t,2),n=r[0],i=r[1],a=rg(e.normal,new eQ.Vector3(0,1,0)),o=rA(n.clone().applyMatrix3(a).y,i.clone().applyMatrix3(a).y,0);return new eQ.Vector3().lerpVectors(n,i,o)},pointToPlaneDistance:function(e,t){return t.normal.dot(e)},getIndexFrom3D:function(e,t){var r=ro(e,3),n=r[0],i=r[1],a=r[2],o=ro(t,2),s=o[0];return a*s*o[1]+i*s+n},get3DFromIndex:function(e,t){var r=ro(t,2),n=r[0],i=n*r[1],a=e/i,o=e-i*a;return[o%n,o/n,a]},getIndexFrom2D:function(e,t){return e[0]+t[0]*e[1]},get2DFromIndex:function(e,t){var r=Math.floor(e/t);return[e%t,r]}});function ry(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}var rx=function e(t,r,n){var i=this;ry(this,e),rt(this,"dot2",function(e,t){return i.x*e+i.y*t}),rt(this,"dot3",function(e,t,r){return i.x*e+i.y*t+i.z*r}),this.x=t,this.y=r,this.z=n},rE=[new rx(1,1,0),new rx(-1,1,0),new rx(1,-1,0),new rx(-1,-1,0),new rx(1,0,1),new rx(-1,0,1),new rx(1,0,-1),new rx(-1,0,-1),new rx(0,1,1),new rx(0,-1,1),new rx(0,1,-1),new rx(0,-1,-1)],r_=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],rC=Array(512),rb=Array(512);function rw(e){var t=function(e){if("number"==typeof e)e=Math.abs(e);else if("string"==typeof e){var t=e;e=0;for(var r=0;r<t.length;r++)e=(e+t.charCodeAt(r)%96*(r+1))%2147483647}return 0===e&&(e=311),e}(e);return function(){var e=48271*t%2147483647;return t=e,e/2147483647}}!function(e){e>0&&e<1&&(e*=65536),(e=Math.floor(e))<256&&(e|=e<<8);for(var t,r=0;r<256;r++)t=1&r?r_[r]^255&e:r_[r]^e>>8&255,rC[r]=rC[r+256]=t,rb[r]=rb[r+256]=rE[t%12]}(0),new function e(t){var r=this;ry(this,e),rt(this,"seed",0),rt(this,"init",function(e){r.seed=e,r.value=rw(e)}),rt(this,"value",rw(this.seed)),this.init(t)}(Math.random());var rB=function(e){return 1/(1+e+.48*e*e+.235*e*e*e)};function rI(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.25,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.01,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1/0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:rB,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:.001,l="velocity_"+t;if(void 0===e.__damp&&(e.__damp={}),void 0===e.__damp[l]&&(e.__damp[l]=0),Math.abs(e[t]-r)<=s)return e[t]=r,!1;var c=2/(n=Math.max(1e-4,n)),u=o(c*i),h=e[t]-r,d=r,f=a*n;h=Math.min(Math.max(h,-f),f),r=e[t]-h;var p=(e.__damp[l]+c*h)*i;e.__damp[l]=(e.__damp[l]-c*p)*u;var m=r+(h+p)*u;return d-e[t]>0==m>d&&(m=d,e.__damp[l]=(m-d)/i),e[t]=m,!0}var rM=new eQ.Vector3,rS=new eQ.Quaternion,rT=new eQ.Quaternion,rP=new eQ.Matrix4,rD=new eQ.Vector3;function rR(e,t,r,n,i,a,o,s){return rI(e,t,e[t]+rp(e[t],r),n,i,a,o,s)}var rF=new eQ.Vector2,rz=new eQ.Vector3;function rO(e,t,r,n,i,a,o){return"number"==typeof t?rz.setScalar(t):Array.isArray(t)?rz.set(t[0],t[1],t[2]):rz.copy(t),es=rI(e,"x",rz.x,r,n,i,a,o),el=rI(e,"y",rz.y,r,n,i,a,o),ec=rI(e,"z",rz.z,r,n,i,a,o),es||el||ec}var rQ=new eQ.Vector4,rL=new eQ.Euler,rk=new eQ.Color,rU=new eQ.Quaternion,rN=new eQ.Vector4,rG=new eQ.Vector4,rH=new eQ.Vector4;function rV(e,t,r,n,i,a,o){Array.isArray(t)?rU.set(t[0],t[1],t[2],t[3]):rU.copy(t);var s=e.dot(rU)>0?1:-1;return rU.x*=s,rU.y*=s,rU.z*=s,rU.w*=s,ex=rI(e,"x",rU.x,r,n,i,a,o),eE=rI(e,"y",rU.y,r,n,i,a,o),e_=rI(e,"z",rU.z,r,n,i,a,o),eC=rI(e,"w",rU.w,r,n,i,a,o),rN.set(e.x,e.y,e.z,e.w).normalize(),rG.set(e.__damp.velocity_x,e.__damp.velocity_y,e.__damp.velocity_z,e.__damp.velocity_w),rH.copy(rN).multiplyScalar(rG.dot(rN)/rN.dot(rN)),e.__damp.velocity_x-=rH.x,e.__damp.velocity_y-=rH.y,e.__damp.velocity_z-=rH.z,e.__damp.velocity_w-=rH.w,e.set(rN.x,rN.y,rN.z,rN.w),ex||eE||e_||eC}var rj=new eQ.Spherical,rY=new eQ.Matrix4,rJ=new eQ.Vector3,rW=new eQ.Quaternion,rq=new eQ.Vector3,rK=Object.freeze({__proto__:null,rsqw:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.01,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/(2*Math.PI);return r/Math.atan(1/t)*Math.atan(Math.sin(2*Math.PI*e*n)/t)},exp:rB,linear:function(e){return e},sine:{in:function(e){return 1-Math.cos(e*Math.PI/2)},out:function(e){return Math.sin(e*Math.PI/2)},inOut:function(e){return-(Math.cos(Math.PI*e)-1)/2}},cubic:{in:function(e){return e*e*e},out:function(e){return 1-Math.pow(1-e,3)},inOut:function(e){return e<.5?4*e*e*e:1-Math.pow(-2*e+2,3)/2}},quint:{in:function(e){return e*e*e*e*e},out:function(e){return 1-Math.pow(1-e,5)},inOut:function(e){return e<.5?16*e*e*e*e*e:1-Math.pow(-2*e+2,5)/2}},circ:{in:function(e){return 1-Math.sqrt(1-Math.pow(e,2))},out:function(e){return Math.sqrt(1-Math.pow(e-1,2))},inOut:function(e){return e<.5?(1-Math.sqrt(1-Math.pow(2*e,2)))/2:(Math.sqrt(1-Math.pow(-2*e+2,2))+1)/2}},quart:{in:function(e){return e*e*e*e},out:function(e){return 1- --e*e*e*e},inOut:function(e){return e<.5?8*e*e*e*e:1-8*--e*e*e*e}},expo:{in:function(e){return 0===e?0:Math.pow(2,10*e-10)},out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},inOut:function(e){return 0===e?0:1===e?1:e<.5?Math.pow(2,20*e-10)/2:(2-Math.pow(2,-20*e+10))/2}},damp:rI,dampLookAt:function(e,t,r,n,i,a,o){"number"==typeof t?rM.setScalar(t):Array.isArray(t)?rM.set(t[0],t[1],t[2]):rM.copy(t);var s=e.parent;(e.updateWorldMatrix(!0,!1),rD.setFromMatrixPosition(e.matrixWorld),e&&e.isCamera||e&&e.isLight)?rP.lookAt(rD,rM,e.up):rP.lookAt(rM,rD,e.up),rV(e.quaternion,rT.setFromRotationMatrix(rP),r,n,i,a,o),s&&(rP.extractRotation(s.matrixWorld),rS.setFromRotationMatrix(rP),rV(e.quaternion,rT.copy(e.quaternion).premultiply(rS.invert()),r,n,i,a,o))},dampAngle:rR,damp2:function(e,t,r,n,i,a,o){return"number"==typeof t?rF.setScalar(t):Array.isArray(t)?rF.set(t[0],t[1]):rF.copy(t),ea=rI(e,"x",rF.x,r,n,i,a,o),eo=rI(e,"y",rF.y,r,n,i,a,o),ea||eo},damp3:rO,damp4:function(e,t,r,n,i,a,o){return"number"==typeof t?rQ.setScalar(t):Array.isArray(t)?rQ.set(t[0],t[1],t[2],t[3]):rQ.copy(t),eu=rI(e,"x",rQ.x,r,n,i,a,o),eh=rI(e,"y",rQ.y,r,n,i,a,o),ed=rI(e,"z",rQ.z,r,n,i,a,o),ef=rI(e,"w",rQ.w,r,n,i,a,o),eu||eh||ed||ef},dampE:function(e,t,r,n,i,a,o){return Array.isArray(t)?rL.set(t[0],t[1],t[2],t[3]):rL.copy(t),ep=rR(e,"x",rL.x,r,n,i,a,o),em=rR(e,"y",rL.y,r,n,i,a,o),eA=rR(e,"z",rL.z,r,n,i,a,o),ep||em||eA},dampC:function(e,t,r,n,i,a,o){return t instanceof eQ.Color?rk.copy(t):Array.isArray(t)?rk.setRGB(t[0],t[1],t[2]):rk.set(t),eg=rI(e,"r",rk.r,r,n,i,a,o),ev=rI(e,"g",rk.g,r,n,i,a,o),ey=rI(e,"b",rk.b,r,n,i,a,o),eg||ev||ey},dampQ:rV,dampS:function(e,t,r,n,i,a,o){return Array.isArray(t)?rj.set(t[0],t[1],t[2]):rj.copy(t),eb=rI(e,"radius",rj.radius,r,n,i,a,o),ew=rR(e,"phi",rj.phi,r,n,i,a,o),eB=rR(e,"theta",rj.theta,r,n,i,a,o),eb||ew||eB},dampM:function(e,t,r,n,i,a,o){return void 0===e.__damp&&(e.__damp={position:new eQ.Vector3,rotation:new eQ.Quaternion,scale:new eQ.Vector3},e.decompose(e.__damp.position,e.__damp.rotation,e.__damp.scale)),Array.isArray(t)?rY.set.apply(rY,rs(t)):rY.copy(t),rY.decompose(rJ,rW,rq),eI=rO(e.__damp.position,rJ,r,n,i,a,o),eM=rV(e.__damp.rotation,rW,r,n,i,a,o),eS=rO(e.__damp.scale,rq,r,n,i,a,o),e.compose(e.__damp.position,e.__damp.rotation,e.__damp.scale),eI||eM||eS}});eQ.BufferGeometry;let rX=ez.createContext(null);function rZ(){return ez.useContext(rX)}function r$({eps:e=1e-5,enabled:t=!0,infinite:r,horizontal:n,pages:i=1,distance:a=1,damping:o=.25,maxSpeed:s=1/0,prepend:l=!1,style:c={},children:u}){let{get:h,setEvents:d,gl:f,size:p,invalidate:m,events:A}=(0,eL.A)(),[g]=ez.useState(()=>document.createElement("div")),[v]=ez.useState(()=>document.createElement("div")),[y]=ez.useState(()=>document.createElement("div")),x=f.domElement.parentNode,E=ez.useRef(0),_=ez.useMemo(()=>({el:g,eps:e,fill:v,fixed:y,horizontal:n,damping:o,offset:0,delta:0,scroll:E,pages:i,range(e,t,r=0){let n=e-r,i=n+t+2*r;return this.offset<n?0:this.offset>i?1:(this.offset-n)/(i-n)},curve(e,t,r=0){return Math.sin(this.range(e,t,r)*Math.PI)},visible(e,t,r=0){let n=e-r;return this.offset>=n&&this.offset<=n+t+2*r}}),[e,o,n,i]);ez.useEffect(()=>{for(let e in g.style.position="absolute",g.style.width="100%",g.style.height="100%",g.style[n?"overflowX":"overflowY"]="auto",g.style[n?"overflowY":"overflowX"]="hidden",g.style.top="0px",g.style.left="0px",c)g.style[e]=c[e];y.style.position="sticky",y.style.top="0px",y.style.left="0px",y.style.width="100%",y.style.height="100%",y.style.overflow="hidden",g.appendChild(y),v.style.height=n?"100%":`${i*a*100}%`,v.style.width=n?`${i*a*100}%`:"100%",v.style.pointerEvents="none",g.appendChild(v),l?x.prepend(g):x.appendChild(g),g[n?"scrollLeft":"scrollTop"]=1;let e=A.connected||f.domElement;requestAnimationFrame(()=>null==A.connect?void 0:A.connect(g));let t=h().events.compute;return d({compute(e,t){let{left:r,top:n}=x.getBoundingClientRect(),i=e.clientX-r,a=e.clientY-n;t.pointer.set(i/t.size.width*2-1,-(a/t.size.height*2)+1),t.raycaster.setFromCamera(t.pointer,t.camera)}}),()=>{x.removeChild(g),d({compute:t}),null==A.connect||A.connect(e)}},[i,a,n,g,v,y,x]),ez.useEffect(()=>{if(A.connected===g){let e=p[n?"width":"height"],i=g[n?"scrollWidth":"scrollHeight"],a=i-e,o=0,s=!0,l=!0,c=()=>{if(t&&!l&&(m(),o=g[n?"scrollLeft":"scrollTop"],E.current=o/a,r)){if(!s){if(o>=a){let e=1-_.offset;g[n?"scrollLeft":"scrollTop"]=1,E.current=_.offset=-e,s=!0}else if(o<=0){let e=1+_.offset;g[n?"scrollLeft":"scrollTop"]=i,E.current=_.offset=e,s=!0}}s&&setTimeout(()=>s=!1,40)}};g.addEventListener("scroll",c,{passive:!0}),requestAnimationFrame(()=>l=!1);let u=e=>g.scrollLeft+=e.deltaY/2;return n&&g.addEventListener("wheel",u,{passive:!0}),()=>{g.removeEventListener("scroll",c),n&&g.removeEventListener("wheel",u)}}},[g,A,p,r,_,m,n,t]);let C=0;return(0,eL.C)((t,r)=>{C=_.offset,rK.damp(_,"offset",E.current,o,r,s,void 0,e),rK.damp(_,"delta",Math.abs(C-_.offset),o,r,s,void 0,e),_.delta>e&&m()}),ez.createElement(rX.Provider,{value:_},u)}let r0=ez.forwardRef(({children:e},t)=>{let r=ez.useRef(null);ez.useImperativeHandle(t,()=>r.current,[]);let n=rZ(),{width:i,height:a}=(0,eL.A)(e=>e.viewport);return(0,eL.C)(()=>{r.current.position.x=n.horizontal?-i*(n.pages-1)*n.offset:0,r.current.position.y=n.horizontal?0:a*(n.pages-1)*n.offset}),ez.createElement("group",{ref:r},e)}),r1=ez.forwardRef(({children:e,style:t,...r},n)=>{let i=rZ(),a=ez.useRef(null);ez.useImperativeHandle(n,()=>a.current,[]);let{width:o,height:s}=(0,eL.A)(e=>e.size),l=ez.useContext(eL.f),c=ez.useMemo(()=>eO.createRoot(i.fixed),[i.fixed]);return(0,eL.C)(()=>{i.delta>i.eps&&(a.current.style.transform=`translate3d(${i.horizontal?-o*(i.pages-1)*i.offset:0}px,${i.horizontal?0:-(s*(i.pages-1)*i.offset)}px,0)`)}),c.render(ez.createElement("div",ee({ref:a,style:{...t,position:"absolute",top:0,left:0,willChange:"transform"}},r),ez.createElement(rX.Provider,{value:i},ez.createElement(eL.f.Provider,{value:l},e)))),null}),r2=ez.forwardRef(({html:e,...t},r)=>ez.createElement(e?r1:r0,ee({ref:r},t))),r3=nc(),r4=e=>na(e,r3),r5=nc();r4.write=e=>na(e,r5);let r6=nc();r4.onStart=e=>na(e,r6);let r8=nc();r4.onFrame=e=>na(e,r8);let r9=nc();r4.onFinish=e=>na(e,r9);let r7=[];r4.setTimeout=(e,t)=>{let r=r4.now()+t,n=()=>{let e=r7.findIndex(e=>e.cancel==n);~e&&r7.splice(e,1),nn-=~e?1:0},i={time:r,handler:e,cancel:n};return r7.splice(ne(r),0,i),nn+=1,no(),i};let ne=e=>~(~r7.findIndex(t=>t.time>e)||~r7.length);r4.cancel=e=>{r6.delete(e),r8.delete(e),r9.delete(e),r3.delete(e),r5.delete(e)},r4.sync=e=>{ni=!0,r4.batchedUpdates(e),ni=!1},r4.throttle=e=>{let t;function r(){try{e(...t)}finally{t=null}}function n(...e){t=e,r4.onStart(r)}return n.handler=e,n.cancel=()=>{r6.delete(r),t=null},n};let nt="undefined"!=typeof window?window.requestAnimationFrame:()=>{};r4.use=e=>nt=e,r4.now="undefined"!=typeof performance?()=>performance.now():Date.now,r4.batchedUpdates=e=>e(),r4.catch=console.error,r4.frameLoop="always",r4.advance=()=>{"demand"!==r4.frameLoop?console.warn("Cannot call the manual advancement of rafz whilst frameLoop is not set as demand"):nl()};let nr=-1,nn=0,ni=!1;function na(e,t){ni?(t.delete(e),e(0)):(t.add(e),no())}function no(){nr<0&&(nr=0,"demand"!==r4.frameLoop&&nt(ns))}function ns(){~nr&&(nt(ns),r4.batchedUpdates(nl))}function nl(){let e=nr,t=ne(nr=r4.now());if(t&&(nu(r7.splice(0,t),e=>e.handler()),nn-=t),!nn){nr=-1;return}r6.flush(),r3.flush(e?Math.min(64,nr-e):16.667),r8.flush(),r5.flush(),r9.flush()}function nc(){let e=new Set,t=e;return{add(r){nn+=t!=e||e.has(r)?0:1,e.add(r)},delete:r=>(nn-=t==e&&e.has(r)?1:0,e.delete(r)),flush(r){t.size&&(e=new Set,nn-=t.size,nu(t,t=>t(r)&&e.add(t)),nn+=e.size,t=e)}}}function nu(e,t){e.forEach(e=>{try{t(e)}catch(e){r4.catch(e)}})}function nh(){}let nd=(e,t,r)=>Object.defineProperty(e,t,{value:r,writable:!0,configurable:!0}),nf={arr:Array.isArray,obj:e=>!!e&&"Object"===e.constructor.name,fun:e=>"function"==typeof e,str:e=>"string"==typeof e,num:e=>"number"==typeof e,und:e=>void 0===e};function np(e,t){if(nf.arr(e)){if(!nf.arr(t)||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}return e===t}let nm=(e,t)=>e.forEach(t);function nA(e,t,r){if(nf.arr(e)){for(let n=0;n<e.length;n++)t.call(r,e[n],`${n}`);return}for(let n in e)e.hasOwnProperty(n)&&t.call(r,e[n],n)}let ng=e=>nf.und(e)?[]:nf.arr(e)?e:[e];function nv(e,t){if(e.size){let r=Array.from(e);e.clear(),nm(r,t)}}let ny=(e,...t)=>nv(e,e=>e(...t)),nx=()=>"undefined"==typeof window||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),nE=null,n_=!1,nC=nh;var nb=Object.freeze({__proto__:null,get createStringInterpolator(){return n},get to(){return i},get colors(){return nE},get skipAnimation(){return n_},get willAdvance(){return nC},assign:e=>{e.to&&(i=e.to),e.now&&(r4.now=e.now),void 0!==e.colors&&(nE=e.colors),null!=e.skipAnimation&&(n_=e.skipAnimation),e.createStringInterpolator&&(n=e.createStringInterpolator),e.requestAnimationFrame&&r4.use(e.requestAnimationFrame),e.batchedUpdates&&(r4.batchedUpdates=e.batchedUpdates),e.willAdvance&&(nC=e.willAdvance),e.frameLoop&&(r4.frameLoop=e.frameLoop)}});let nw=new Set,nB=[],nI=[],nM=0,nS={get idle(){return!nw.size&&!nB.length},start(e){nM>e.priority?(nw.add(e),r4.onStart(nT)):(nP(e),r4(nR))},advance:nR,sort(e){if(nM)r4.onFrame(()=>nS.sort(e));else{let t=nB.indexOf(e);~t&&(nB.splice(t,1),nD(e))}},clear(){nB=[],nw.clear()}};function nT(){nw.forEach(nP),nw.clear(),r4(nR)}function nP(e){nB.includes(e)||nD(e)}function nD(e){nB.splice(function(e,t){let r=e.findIndex(t);return r<0?e.length:r}(nB,t=>t.priority>e.priority),0,e)}function nR(e){let t=nI;for(let r=0;r<nB.length;r++){let n=nB[r];nM=n.priority,n.idle||(nC(n),n.advance(e),n.idle||t.push(n))}return nM=0,(nI=nB).length=0,(nB=t).length>0}let nF="[-+]?\\d*\\.?\\d+",nz=nF+"%";function nO(...e){return"\\(\\s*("+e.join(")\\s*,\\s*(")+")\\s*\\)"}let nQ=RegExp("rgb"+nO(nF,nF,nF)),nL=RegExp("rgba"+nO(nF,nF,nF,nF)),nk=RegExp("hsl"+nO(nF,nz,nz)),nU=RegExp("hsla"+nO(nF,nz,nz,nF)),nN=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,nG=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,nH=/^#([0-9a-fA-F]{6})$/,nV=/^#([0-9a-fA-F]{8})$/;function nj(e,t,r){return(r<0&&(r+=1),r>1&&(r-=1),r<1/6)?e+(t-e)*6*r:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function nY(e,t,r){let n=r<.5?r*(1+t):r+t-r*t,i=2*r-n;return Math.round(255*nj(i,n,e+1/3))<<24|Math.round(255*nj(i,n,e))<<16|Math.round(255*nj(i,n,e-1/3))<<8}function nJ(e){let t=parseInt(e,10);return t<0?0:t>255?255:t}function nW(e){return(parseFloat(e)%360+360)%360/360}function nq(e){let t=parseFloat(e);return t<0?0:t>1?255:Math.round(255*t)}function nK(e){let t=parseFloat(e);return t<0?0:t>100?1:t/100}function nX(e){let t;let r="number"==typeof e?e>>>0===e&&e>=0&&e<=4294967295?e:null:(t=nH.exec(e))?parseInt(t[1]+"ff",16)>>>0:nE&&void 0!==nE[e]?nE[e]:(t=nQ.exec(e))?(nJ(t[1])<<24|nJ(t[2])<<16|nJ(t[3])<<8|255)>>>0:(t=nL.exec(e))?(nJ(t[1])<<24|nJ(t[2])<<16|nJ(t[3])<<8|nq(t[4]))>>>0:(t=nN.exec(e))?parseInt(t[1]+t[1]+t[2]+t[2]+t[3]+t[3]+"ff",16)>>>0:(t=nV.exec(e))?parseInt(t[1],16)>>>0:(t=nG.exec(e))?parseInt(t[1]+t[1]+t[2]+t[2]+t[3]+t[3]+t[4]+t[4],16)>>>0:(t=nk.exec(e))?(255|nY(nW(t[1]),nK(t[2]),nK(t[3])))>>>0:(t=nU.exec(e))?(nY(nW(t[1]),nK(t[2]),nK(t[3]))|nq(t[4]))>>>0:null;if(null===r)return e;let n=(4278190080&(r=r||0))>>>24,i=(16711680&r)>>>16,a=(65280&r)>>>8,o=(255&r)/255;return`rgba(${n}, ${i}, ${a}, ${o})`}let nZ=(e,t,r)=>{if(nf.fun(e))return e;if(nf.arr(e))return nZ({range:e,output:t,extrapolate:r});if(nf.str(e.output[0]))return n(e);let i=e.output,a=e.range||[0,1],o=e.extrapolateLeft||e.extrapolate||"extend",s=e.extrapolateRight||e.extrapolate||"extend",l=e.easing||(e=>e);return t=>{let r=function(e,t){for(var r=1;r<t.length-1&&!(t[r]>=e);++r);return r-1}(t,a);return function(e,t,r,n,i,a,o,s,l){let c=l?l(e):e;if(c<t){if("identity"===o)return c;"clamp"===o&&(c=t)}if(c>r){if("identity"===s)return c;"clamp"===s&&(c=r)}return n===i?n:t===r?e<=t?n:i:(t===-1/0?c=-c:r===1/0?c-=t:c=(c-t)/(r-t),c=a(c),n===-1/0?c=-c:i===1/0?c+=n:c=c*(i-n)+n,c)}(t,a[r],a[r+1],i[r],i[r+1],l,o,s,e.map)}};function n$(){return(n$=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}let n0=Symbol.for("FluidValue.get"),n1=Symbol.for("FluidValue.observers"),n2=e=>!!(e&&e[n0]),n3=e=>e&&e[n0]?e[n0]():e,n4=e=>e[n1]||null;function n5(e,t){let r=e[n1];r&&r.forEach(e=>{e.eventObserved?e.eventObserved(t):e(t)})}class n6{constructor(e){if(this[n0]=void 0,this[n1]=void 0,!e&&!(e=this.get))throw Error("Unknown getter");n8(this,e)}}let n8=(e,t)=>ie(e,n0,t);function n9(e,t){if(e[n0]){let r=e[n1];r||ie(e,n1,r=new Set),!r.has(t)&&(r.add(t),e.observerAdded&&e.observerAdded(r.size,t))}return t}function n7(e,t){let r=e[n1];if(r&&r.has(t)){let n=r.size-1;n?r.delete(t):e[n1]=null,e.observerRemoved&&e.observerRemoved(n,t)}}let ie=(e,t,r)=>Object.defineProperty(e,t,{value:r,writable:!0,configurable:!0}),it=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,ir=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,ii=RegExp(`(${it.source})(%|[a-z]+)`,"i"),ia=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,io=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,is=e=>{let[t,r]=il(e);if(!t||nx())return e;let n=window.getComputedStyle(document.documentElement).getPropertyValue(t);if(n)return n.trim();if(r&&r.startsWith("--")){let e=window.getComputedStyle(document.documentElement).getPropertyValue(r);if(e)return e}else if(r&&io.test(r))return is(r);else if(r)return r;return e},il=e=>{let t=io.exec(e);if(!t)return[,];let[,r,n]=t;return[r,n]},ic=(e,t,r,n,i)=>`rgba(${Math.round(t)}, ${Math.round(r)}, ${Math.round(n)}, ${i})`,iu=e=>{a||(a=nE?RegExp(`(${Object.keys(nE).join("|")})(?!\\w)`,"g"):/^\b$/);let t=e.output.map(e=>n3(e).replace(io,is).replace(ir,nX).replace(a,nX)),r=t.map(e=>e.match(it).map(Number)),n=r[0].map((e,t)=>r.map(e=>{if(!(t in e))throw Error('The arity of each "output" value must be equal');return e[t]})).map(t=>nZ(n$({},e,{output:t})));return e=>{var r;let i=!ii.test(t[0])&&(null==(r=t.find(e=>ii.test(e)))?void 0:r.replace(it,"")),a=0;return t[0].replace(it,()=>`${n[a++](e)}${i||""}`).replace(ia,ic)}},ih="react-spring: ",id=e=>{let t=!1;if("function"!=typeof e)throw TypeError(`${ih}once requires a function parameter`);return(...r)=>{t||(e(...r),t=!0)}},ip=id(console.warn),im=id(console.warn);function iA(e){return nf.str(e)&&("#"==e[0]||/\d/.test(e)||!nx()&&io.test(e)||e in(nE||{}))}new WeakMap,new WeakMap,new WeakMap,new WeakMap;let ig=nx()?ez.useEffect:ez.useLayoutEffect,iv=()=>{let e=(0,ez.useRef)(!1);return ig(()=>(e.current=!0,()=>{e.current=!1}),[]),e};function iy(){let e=(0,ez.useState)()[1],t=iv();return()=>{t.current&&e(Math.random())}}let ix=e=>(0,ez.useEffect)(e,iE),iE=[];function i_(e){let t=(0,ez.useRef)();return(0,ez.useEffect)(()=>{t.current=e}),t.current}let iC=Symbol.for("Animated:node"),ib=e=>!!e&&e[iC]===e,iw=e=>e&&e[iC],iB=(e,t)=>nd(e,iC,t),iI=e=>e&&e[iC]&&e[iC].getPayload();class iM{constructor(){this.payload=void 0,iB(this,this)}getPayload(){return this.payload||[]}}class iS extends iM{constructor(e){super(),this.done=!0,this.elapsedTime=void 0,this.lastPosition=void 0,this.lastVelocity=void 0,this.v0=void 0,this.durationProgress=0,this._value=e,nf.num(this._value)&&(this.lastPosition=this._value)}static create(e){return new iS(e)}getPayload(){return[this]}getValue(){return this._value}setValue(e,t){return nf.num(e)&&(this.lastPosition=e,t&&(e=Math.round(e/t)*t,this.done&&(this.lastPosition=e))),this._value!==e&&(this._value=e,!0)}reset(){let{done:e}=this;this.done=!1,nf.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,e&&(this.lastVelocity=null),this.v0=null)}}class iT extends iS{constructor(e){super(0),this._string=null,this._toString=void 0,this._toString=nZ({output:[e,e]})}static create(e){return new iT(e)}getValue(){let e=this._string;return null==e?this._string=this._toString(this._value):e}setValue(e){if(nf.str(e)){if(e==this._string)return!1;this._string=e,this._value=1}else{if(!super.setValue(e))return!1;this._string=null}return!0}reset(e){e&&(this._toString=nZ({output:[this.getValue(),e]})),this._value=0,super.reset()}}let iP={dependencies:null};class iD extends iM{constructor(e){super(),this.source=e,this.setValue(e)}getValue(e){let t={};return nA(this.source,(r,n)=>{ib(r)?t[n]=r.getValue(e):n2(r)?t[n]=n3(r):e||(t[n]=r)}),t}setValue(e){this.source=e,this.payload=this._makePayload(e)}reset(){this.payload&&nm(this.payload,e=>e.reset())}_makePayload(e){if(e){let t=new Set;return nA(e,this._addToPayload,t),Array.from(t)}}_addToPayload(e){iP.dependencies&&n2(e)&&iP.dependencies.add(e);let t=iI(e);t&&nm(t,e=>this.add(e))}}class iR extends iD{constructor(e){super(e)}static create(e){return new iR(e)}getValue(){return this.source.map(e=>e.getValue())}setValue(e){let t=this.getPayload();return e.length==t.length?t.map((t,r)=>t.setValue(e[r])).some(Boolean):(super.setValue(e.map(iF)),!0)}}function iF(e){return(iA(e)?iT:iS).create(e)}function iz(e){let t=iw(e);return t?t.constructor:nf.arr(e)?iR:iA(e)?iT:iS}function iO(){return(iO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}let iQ=(e,t)=>{let r=!nf.fun(e)||e.prototype&&e.prototype.isReactComponent;return(0,ez.forwardRef)((n,i)=>{let a=(0,ez.useRef)(null),o=r&&(0,ez.useCallback)(e=>{a.current=(i&&(nf.fun(i)?i(e):i.current=e),e)},[i]),[s,l]=function(e,t){let r=new Set;return iP.dependencies=r,e.style&&(e=iO({},e,{style:t.createAnimatedStyle(e.style)})),e=new iD(e),iP.dependencies=null,[e,r]}(n,t),c=iy(),u=()=>{let e=a.current;(!r||e)&&!1===(!!e&&t.applyAnimatedValues(e,s.getValue(!0)))&&c()},h=new iL(u,l),d=(0,ez.useRef)();ig(()=>(d.current=h,nm(l,e=>n9(e,h)),()=>{d.current&&(nm(d.current.deps,e=>n7(e,d.current)),r4.cancel(d.current.update))})),(0,ez.useEffect)(u,[]),ix(()=>()=>{let e=d.current;nm(e.deps,t=>n7(t,e))});let f=t.getComponentProps(s.getValue());return ez.createElement(e,iO({},f,{ref:o}))})};class iL{constructor(e,t){this.update=e,this.deps=t}eventObserved(e){"change"==e.type&&r4.write(this.update)}}let ik=Symbol.for("AnimatedComponent"),iU=e=>nf.str(e)?e:e&&nf.str(e.displayName)?e.displayName:nf.fun(e)&&e.name||null;function iN(){return(iN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function iG(e,...t){return nf.fun(e)?e(...t):e}let iH=(e,t)=>!0===e||!!(t&&e&&(nf.fun(e)?e(t):ng(e).includes(t))),iV=(e,t)=>nf.obj(e)?t&&e[t]:e,ij=(e,t)=>!0===e.default?e[t]:e.default?e.default[t]:void 0,iY=e=>e,iJ=(e,t=iY)=>{let r=iW;e.default&&!0!==e.default&&(r=Object.keys(e=e.default));let n={};for(let i of r){let r=t(e[i],i);nf.und(r)||(n[i]=r)}return n},iW=["config","onProps","onStart","onChange","onPause","onResume","onRest"],iq={config:1,from:1,to:1,ref:1,loop:1,reset:1,pause:1,cancel:1,reverse:1,immediate:1,default:1,delay:1,onProps:1,onStart:1,onChange:1,onPause:1,onResume:1,onRest:1,onResolve:1,items:1,trail:1,sort:1,expires:1,initial:1,enter:1,update:1,leave:1,children:1,onDestroyed:1,keys:1,callId:1,parentId:1};function iK(e){let t=function(e){let t={},r=0;if(nA(e,(e,n)=>{!iq[n]&&(t[n]=e,r++)}),r)return t}(e);if(t){let r={to:t};return nA(e,(e,n)=>n in t||(r[n]=e)),r}return iN({},e)}function iX(e){return e=n3(e),nf.arr(e)?e.map(iX):iA(e)?nb.createStringInterpolator({range:[0,1],output:[e,e]})(1):e}function iZ(e){return nf.fun(e)||nf.arr(e)&&nf.obj(e[0])}let i$=iN({},{tension:170,friction:26},{mass:1,damping:1,easing:e=>e,clamp:!1});class i0{constructor(){this.tension=void 0,this.friction=void 0,this.frequency=void 0,this.damping=void 0,this.mass=void 0,this.velocity=0,this.restVelocity=void 0,this.precision=void 0,this.progress=void 0,this.duration=void 0,this.easing=void 0,this.clamp=void 0,this.bounce=void 0,this.decay=void 0,this.round=void 0,Object.assign(this,i$)}}function i1(e,t){if(nf.und(t.decay)){let r=!nf.und(t.tension)||!nf.und(t.friction);!r&&nf.und(t.frequency)&&nf.und(t.damping)&&nf.und(t.mass)||(e.duration=void 0,e.decay=void 0),r&&(e.frequency=void 0)}else e.duration=void 0}let i2=[];class i3{constructor(){this.changed=!1,this.values=i2,this.toValues=null,this.fromValues=i2,this.to=void 0,this.from=void 0,this.config=new i0,this.immediate=!1}}function i4(e,{key:t,props:r,defaultProps:n,state:i,actions:a}){return new Promise((o,s)=>{var l;let c,u;let h=iH(null!=(l=r.cancel)?l:null==n?void 0:n.cancel,t);if(h)p();else{nf.und(r.pause)||(i.paused=iH(r.pause,t));let e=null==n?void 0:n.pause;!0!==e&&(e=i.paused||iH(e,t)),c=iG(r.delay||0,t),e?(i.resumeQueue.add(f),a.pause()):(a.resume(),f())}function d(){i.resumeQueue.add(f),i.timeouts.delete(u),u.cancel(),c=u.time-r4.now()}function f(){c>0&&!nb.skipAnimation?(i.delayed=!0,u=r4.setTimeout(p,c),i.pauseQueue.add(d),i.timeouts.add(u)):p()}function p(){i.delayed&&(i.delayed=!1),i.pauseQueue.delete(d),i.timeouts.delete(u),e<=(i.cancelId||0)&&(h=!0);try{a.start(iN({},r,{callId:e,cancel:h}),o)}catch(e){s(e)}}})}let i5=(e,t)=>1==t.length?t[0]:t.some(e=>e.cancelled)?i9(e.get()):t.every(e=>e.noop)?i6(e.get()):i8(e.get(),t.every(e=>e.finished)),i6=e=>({value:e,noop:!0,finished:!0,cancelled:!1}),i8=(e,t,r=!1)=>({value:e,finished:t,cancelled:r}),i9=e=>({value:e,cancelled:!0,finished:!1});function i7(e,t,r,n){let{callId:i,parentId:a,onRest:o}=t,{asyncTo:s,promise:l}=r;return a||e!==s||t.reset?r.promise=(async()=>{let c,u,h;r.asyncId=i,r.asyncTo=e;let d=iJ(t,(e,t)=>"onRest"===t?void 0:e),f=new Promise((e,t)=>(c=e,u=t)),p=e=>{let t=i<=(r.cancelId||0)&&i9(n)||i!==r.asyncId&&i8(n,!1);if(t)throw e.result=t,u(e),e},m=(e,t)=>{let a=new at,o=new ar;return(async()=>{if(nb.skipAnimation)throw ae(r),o.result=i8(n,!1),u(o),o;p(a);let s=nf.obj(e)?iN({},e):iN({},t,{to:e});s.parentId=i,nA(d,(e,t)=>{nf.und(s[t])&&(s[t]=e)});let l=await n.start(s);return p(a),r.paused&&await new Promise(e=>{r.resumeQueue.add(e)}),l})()};if(nb.skipAnimation)return ae(r),i8(n,!1);try{let t;t=nf.arr(e)?(async e=>{for(let t of e)await m(t)})(e):Promise.resolve(e(m,n.stop.bind(n))),await Promise.all([t.then(c),f]),h=i8(n.get(),!0,!1)}catch(e){if(e instanceof at)h=e.result;else if(e instanceof ar)h=e.result;else throw e}finally{i==r.asyncId&&(r.asyncId=a,r.asyncTo=a?s:void 0,r.promise=a?l:void 0)}return nf.fun(o)&&r4.batchedUpdates(()=>{o(h,n,n.item)}),h})():l}function ae(e,t){nv(e.timeouts,e=>e.cancel()),e.pauseQueue.clear(),e.resumeQueue.clear(),e.asyncId=e.asyncTo=e.promise=void 0,t&&(e.cancelId=t)}class at extends Error{constructor(){super("An async animation has been interrupted. You see this error because you forgot to use `await` or `.catch(...)` on its returned promise."),this.result=void 0}}class ar extends Error{constructor(){super("SkipAnimationSignal"),this.result=void 0}}let an=e=>e instanceof aa,ai=1;class aa extends n6{constructor(...e){super(...e),this.id=ai++,this.key=void 0,this._priority=0}get priority(){return this._priority}set priority(e){this._priority!=e&&(this._priority=e,this._onPriorityChange(e))}get(){let e=iw(this);return e&&e.getValue()}to(...e){return nb.to(this,e)}interpolate(...e){return ip(`${ih}The "interpolate" function is deprecated in v9 (use "to" instead)`),nb.to(this,e)}toJSON(){return this.get()}observerAdded(e){1==e&&this._attach()}observerRemoved(e){0==e&&this._detach()}_attach(){}_detach(){}_onChange(e,t=!1){n5(this,{type:"change",parent:this,value:e,idle:t})}_onPriorityChange(e){this.idle||nS.sort(this),n5(this,{type:"priority",parent:this,priority:e})}}let ao=Symbol.for("SpringPhase"),as=e=>(1&e[ao])>0,al=e=>(2&e[ao])>0,ac=e=>(4&e[ao])>0,au=(e,t)=>t?e[ao]|=3:e[ao]&=-3,ah=(e,t)=>t?e[ao]|=4:e[ao]&=-5;class ad extends aa{constructor(e,t){if(super(),this.key=void 0,this.animation=new i3,this.queue=void 0,this.defaultProps={},this._state={paused:!1,delayed:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._pendingCalls=new Set,this._lastCallId=0,this._lastToId=0,this._memoizedDuration=0,!nf.und(e)||!nf.und(t)){let r=nf.obj(e)?iN({},e):iN({},t,{from:e});nf.und(r.default)&&(r.default=!0),this.start(r)}}get idle(){return!(al(this)||this._state.asyncTo)||ac(this)}get goal(){return n3(this.animation.to)}get velocity(){let e=iw(this);return e instanceof iS?e.lastVelocity||0:e.getPayload().map(e=>e.lastVelocity||0)}get hasAnimated(){return as(this)}get isAnimating(){return al(this)}get isPaused(){return ac(this)}get isDelayed(){return this._state.delayed}advance(e){let t=!0,r=!1,n=this.animation,{config:i,toValues:a}=n,o=iI(n.to);!o&&n2(n.to)&&(a=ng(n3(n.to))),n.values.forEach((s,l)=>{if(s.done)return;let c=s.constructor==iT?1:o?o[l].lastPosition:a[l],u=n.immediate,h=c;if(!u){let t;if(h=s.lastPosition,i.tension<=0){s.done=!0;return}let r=s.elapsedTime+=e,a=n.fromValues[l],o=null!=s.v0?s.v0:s.v0=nf.arr(i.velocity)?i.velocity[l]:i.velocity,d=i.precision||(a==c?.005:Math.min(1,.001*Math.abs(c-a)));if(nf.und(i.duration)){if(i.decay){let e=!0===i.decay?.998:i.decay,n=Math.exp(-(1-e)*r);h=a+o/(1-e)*(1-n),u=Math.abs(s.lastPosition-h)<=d,t=o*n}else{t=null==s.lastVelocity?o:s.lastVelocity;let r=i.restVelocity||d/10,n=i.clamp?0:i.bounce,l=!nf.und(n),f=a==c?s.v0>0:a<c,p=Math.ceil(e/1);for(let e=0;e<p&&!(!(Math.abs(t)>r)&&(u=Math.abs(c-h)<=d));++e){l&&(h==c||h>c==f)&&(t=-t*n,h=c);let e=(-(1e-6*i.tension)*(h-c)+-(.001*i.friction)*t)/i.mass;t+=1*e,h+=1*t}}}else{let n=1;i.duration>0&&(this._memoizedDuration!==i.duration&&(this._memoizedDuration=i.duration,s.durationProgress>0&&(s.elapsedTime=i.duration*s.durationProgress,r=s.elapsedTime+=e)),n=(n=(i.progress||0)+r/this._memoizedDuration)>1?1:n<0?0:n,s.durationProgress=n),t=((h=a+i.easing(n)*(c-a))-s.lastPosition)/e,u=1==n}s.lastVelocity=t,Number.isNaN(h)&&(console.warn("Got NaN while animating:",this),u=!0)}o&&!o[l].done&&(u=!1),u?s.done=!0:t=!1,s.setValue(h,i.round)&&(r=!0)});let s=iw(this),l=s.getValue();if(t){let e=n3(n.to);(l!==e||r)&&!i.decay?(s.setValue(e),this._onChange(e)):r&&i.decay&&this._onChange(l),this._stop()}else r&&this._onChange(l)}set(e){return r4.batchedUpdates(()=>{this._stop(),this._focus(e),this._set(e)}),this}pause(){this._update({pause:!0})}resume(){this._update({pause:!1})}finish(){if(al(this)){let{to:e,config:t}=this.animation;r4.batchedUpdates(()=>{this._onStart(),t.decay||this._set(e,!1),this._stop()})}return this}update(e){return(this.queue||(this.queue=[])).push(e),this}start(e,t){let r;return nf.und(e)?(r=this.queue||[],this.queue=[]):r=[nf.obj(e)?e:iN({},t,{to:e})],Promise.all(r.map(e=>this._update(e))).then(e=>i5(this,e))}stop(e){let{to:t}=this.animation;return this._focus(this.get()),ae(this._state,e&&this._lastCallId),r4.batchedUpdates(()=>this._stop(t,e)),this}reset(){this._update({reset:!0})}eventObserved(e){"change"==e.type?this._start():"priority"==e.type&&(this.priority=e.priority+1)}_prepareNode(e){let t=this.key||"",{to:r,from:n}=e;(null==(r=nf.obj(r)?r[t]:r)||iZ(r))&&(r=void 0),null==(n=nf.obj(n)?n[t]:n)&&(n=void 0);let i={to:r,from:n};return as(this)||(e.reverse&&([r,n]=[n,r]),n=n3(n),nf.und(n)?iw(this)||this._set(r):this._set(n)),i}_update(e,t){let r=iN({},e),{key:n,defaultProps:i}=this;r.default&&Object.assign(i,iJ(r,(e,t)=>/^on/.test(t)?iV(e,n):e)),av(this,r,"onProps"),ay(this,"onProps",r,this);let a=this._prepareNode(r);if(Object.isFrozen(this))throw Error("Cannot animate a `SpringValue` object that is frozen. Did you forget to pass your component to `animated(...)` before animating its props?");let o=this._state;return i4(++this._lastCallId,{key:n,props:r,defaultProps:i,state:o,actions:{pause:()=>{ac(this)||(ah(this,!0),ny(o.pauseQueue),ay(this,"onPause",i8(this,af(this,this.animation.to)),this))},resume:()=>{ac(this)&&(ah(this,!1),al(this)&&this._resume(),ny(o.resumeQueue),ay(this,"onResume",i8(this,af(this,this.animation.to)),this))},start:this._merge.bind(this,a)}}).then(e=>{if(r.loop&&e.finished&&!(t&&e.noop)){let e=ap(r);if(e)return this._update(e,!0)}return e})}_merge(e,t,r){if(t.cancel)return this.stop(!0),r(i9(this));let n=!nf.und(e.to),i=!nf.und(e.from);if(n||i){if(!(t.callId>this._lastToId))return r(i9(this));this._lastToId=t.callId}let{key:a,defaultProps:o,animation:s}=this,{to:l,from:c}=s,{to:u=l,from:h=c}=e;i&&!n&&(!t.default||nf.und(u))&&(u=h),t.reverse&&([u,h]=[h,u]);let d=!np(h,c);d&&(s.from=h),h=n3(h);let f=!np(u,l);f&&this._focus(u);let p=iZ(t.to),{config:m}=s,{decay:A,velocity:g}=m;(n||i)&&(m.velocity=0),t.config&&!p&&function(e,t,r){for(let n in r&&(i1(r=iN({},r),t),t=iN({},r,t)),i1(e,t),Object.assign(e,t),i$)null==e[n]&&(e[n]=i$[n]);let{mass:n,frequency:i,damping:a}=e;nf.und(i)||(i<.01&&(i=.01),a<0&&(a=0),e.tension=Math.pow(2*Math.PI/i,2)*n,e.friction=4*Math.PI*a*n/i)}(m,iG(t.config,a),t.config!==o.config?iG(o.config,a):void 0);let v=iw(this);if(!v||nf.und(u))return r(i8(this,!0));let y=nf.und(t.reset)?i&&!t.default:!nf.und(h)&&iH(t.reset,a),x=y?h:this.get(),E=iX(u),_=nf.num(E)||nf.arr(E)||iA(E),C=!p&&(!_||iH(o.immediate||t.immediate,a));if(f){let e=iz(u);if(e!==v.constructor){if(C)v=this._set(E);else throw Error(`Cannot animate between ${v.constructor.name} and ${e.name}, as the "to" prop suggests`)}}let b=v.constructor,w=n2(u),B=!1;if(!w){let e=y||!as(this)&&d;(f||e)&&(w=!(B=np(iX(x),E))),(np(s.immediate,C)||C)&&np(m.decay,A)&&np(m.velocity,g)||(w=!0)}if(B&&al(this)&&(s.changed&&!y?w=!0:w||this._stop(l)),!p&&((w||n2(l))&&(s.values=v.getPayload(),s.toValues=n2(u)?null:b==iT?[1]:ng(E)),s.immediate==C||(s.immediate=C,C||y||this._set(l)),w)){let{onRest:e}=s;nm(ag,e=>av(this,t,e));let n=i8(this,af(this,l));ny(this._pendingCalls,n),this._pendingCalls.add(r),s.changed&&r4.batchedUpdates(()=>{s.changed=!y,null==e||e(n,this),y?iG(o.onRest,n):null==s.onStart||s.onStart(n,this)})}y&&this._set(x),p?r(i7(t.to,t,this._state,this)):w?this._start():al(this)&&!f?this._pendingCalls.add(r):r(i6(x))}_focus(e){let t=this.animation;e!==t.to&&(n4(this)&&this._detach(),t.to=e,n4(this)&&this._attach())}_attach(){let e=0,{to:t}=this.animation;n2(t)&&(n9(t,this),an(t)&&(e=t.priority+1)),this.priority=e}_detach(){let{to:e}=this.animation;n2(e)&&n7(e,this)}_set(e,t=!0){let r=n3(e);if(!nf.und(r)){let e=iw(this);if(!e||!np(r,e.getValue())){let n=iz(r);e&&e.constructor==n?e.setValue(r):iB(this,n.create(r)),e&&r4.batchedUpdates(()=>{this._onChange(r,t)})}}return iw(this)}_onStart(){let e=this.animation;e.changed||(e.changed=!0,ay(this,"onStart",i8(this,af(this,e.to)),this))}_onChange(e,t){t||(this._onStart(),iG(this.animation.onChange,e,this)),iG(this.defaultProps.onChange,e,this),super._onChange(e,t)}_start(){let e=this.animation;iw(this).reset(n3(e.to)),e.immediate||(e.fromValues=e.values.map(e=>e.lastPosition)),al(this)||(au(this,!0),ac(this)||this._resume())}_resume(){nb.skipAnimation?this.finish():nS.start(this)}_stop(e,t){if(al(this)){au(this,!1);let r=this.animation;nm(r.values,e=>{e.done=!0}),r.toValues&&(r.onChange=r.onPause=r.onResume=void 0),n5(this,{type:"idle",parent:this});let n=t?i9(this.get()):i8(this.get(),af(this,null!=e?e:r.to));ny(this._pendingCalls,n),r.changed&&(r.changed=!1,ay(this,"onRest",n,this))}}}function af(e,t){let r=iX(t);return np(iX(e.get()),r)}function ap(e,t=e.loop,r=e.to){let n=iG(t);if(n){let i=!0!==n&&iK(n),a=(i||e).reverse,o=!i||i.reset;return am(iN({},e,{loop:t,default:!1,pause:void 0,to:!a||iZ(r)?r:void 0,from:o?e.from:void 0,reset:o},i))}}function am(e){let{to:t,from:r}=e=iK(e),n=new Set;return nf.obj(t)&&aA(t,n),nf.obj(r)&&aA(r,n),e.keys=n.size?Array.from(n):null,e}function aA(e,t){nA(e,(e,r)=>null!=e&&t.add(r))}let ag=["onStart","onRest","onChange","onPause","onResume"];function av(e,t,r){e.animation[r]=t[r]!==ij(t,r)?iV(t[r],e.key):void 0}function ay(e,t,...r){var n,i,a,o;null==(n=(i=e.animation)[t])||n.call(i,...r),null==(a=(o=e.defaultProps)[t])||a.call(o,...r)}let ax=["onStart","onChange","onRest"],aE=1;class a_{constructor(e,t){this.id=aE++,this.springs={},this.queue=[],this.ref=void 0,this._flush=void 0,this._initialProps=void 0,this._lastAsyncId=0,this._active=new Set,this._changed=new Set,this._started=!1,this._item=void 0,this._state={paused:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._events={onStart:new Map,onChange:new Map,onRest:new Map},this._onFrame=this._onFrame.bind(this),t&&(this._flush=t),e&&this.start(iN({default:!0},e))}get idle(){return!this._state.asyncTo&&Object.values(this.springs).every(e=>e.idle&&!e.isDelayed&&!e.isPaused)}get item(){return this._item}set item(e){this._item=e}get(){let e={};return this.each((t,r)=>e[r]=t.get()),e}set(e){for(let t in e){let r=e[t];nf.und(r)||this.springs[t].set(r)}}update(e){return e&&this.queue.push(am(e)),this}start(e){let{queue:t}=this;return(e?t=ng(e).map(am):this.queue=[],this._flush)?this._flush(this,t):(aS(this,t),aC(this,t))}stop(e,t){if(!!e!==e&&(t=e),t){let r=this.springs;nm(ng(t),t=>r[t].stop(!!e))}else ae(this._state,this._lastAsyncId),this.each(t=>t.stop(!!e));return this}pause(e){if(nf.und(e))this.start({pause:!0});else{let t=this.springs;nm(ng(e),e=>t[e].pause())}return this}resume(e){if(nf.und(e))this.start({pause:!1});else{let t=this.springs;nm(ng(e),e=>t[e].resume())}return this}each(e){nA(this.springs,e)}_onFrame(){let{onStart:e,onChange:t,onRest:r}=this._events,n=this._active.size>0,i=this._changed.size>0;(n&&!this._started||i&&!this._started)&&(this._started=!0,nv(e,([e,t])=>{t.value=this.get(),e(t,this,this._item)}));let a=!n&&this._started,o=i||a&&r.size?this.get():null;i&&t.size&&nv(t,([e,t])=>{t.value=o,e(t,this,this._item)}),a&&(this._started=!1,nv(r,([e,t])=>{t.value=o,e(t,this,this._item)}))}eventObserved(e){if("change"==e.type)this._changed.add(e.parent),e.idle||this._active.add(e.parent);else{if("idle"!=e.type)return;this._active.delete(e.parent)}r4.onFrame(this._onFrame)}}function aC(e,t){return Promise.all(t.map(t=>ab(e,t))).then(t=>i5(e,t))}async function ab(e,t,r){let{keys:n,to:i,from:a,loop:o,onRest:s,onResolve:l}=t,c=nf.obj(t.default)&&t.default;o&&(t.loop=!1),!1===i&&(t.to=null),!1===a&&(t.from=null);let u=nf.arr(i)||nf.fun(i)?i:void 0;u?(t.to=void 0,t.onRest=void 0,c&&(c.onRest=void 0)):nm(ax,r=>{let n=t[r];if(nf.fun(n)){let i=e._events[r];t[r]=({finished:e,cancelled:t})=>{let r=i.get(n);r?(e||(r.finished=!1),t&&(r.cancelled=!0)):i.set(n,{value:null,finished:e||!1,cancelled:t||!1})},c&&(c[r]=t[r])}});let h=e._state;!h.paused===t.pause?(h.paused=t.pause,ny(t.pause?h.pauseQueue:h.resumeQueue)):h.paused&&(t.pause=!0);let d=(n||Object.keys(e.springs)).map(r=>e.springs[r].start(t)),f=!0===t.cancel||!0===ij(t,"cancel");(u||f&&h.asyncId)&&d.push(i4(++e._lastAsyncId,{props:t,state:h,actions:{pause:nh,resume:nh,start(t,r){f?(ae(h,e._lastAsyncId),r(i9(e))):(t.onRest=s,r(i7(u,t,h,e)))}}})),h.paused&&await new Promise(e=>{h.resumeQueue.add(e)});let p=i5(e,await Promise.all(d));if(o&&p.finished&&!(r&&p.noop)){let r=ap(t,o,i);if(r)return aS(e,[r]),ab(e,r,!0)}return l&&r4.batchedUpdates(()=>l(p,e,e.item)),p}function aw(e,t){let r=iN({},e.springs);return t&&nm(ng(t),e=>{nf.und(e.keys)&&(e=am(e)),nf.obj(e.to)||(e=iN({},e,{to:void 0})),aM(r,e,e=>aI(e))}),aB(e,r),r}function aB(e,t){nA(t,(t,r)=>{e.springs[r]||(e.springs[r]=t,n9(t,e))})}function aI(e,t){let r=new ad;return r.key=e,t&&n9(r,t),r}function aM(e,t,r){t.keys&&nm(t.keys,n=>{(e[n]||(e[n]=r(n)))._prepareNode(t)})}function aS(e,t){nm(t,t=>{aM(e.springs,t,t=>aI(t,e))})}let aT=["children"],aP=e=>{let{children:t}=e,r=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,aT),n=(0,ez.useContext)(aD),i=r.pause||!!n.pause,a=r.immediate||!!n.immediate;r=function(e,t){let[r]=(0,ez.useState)(()=>({inputs:t,result:e()})),n=(0,ez.useRef)(),i=n.current,a=i;return a?t&&a.inputs&&function(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}(t,a.inputs)||(a={inputs:t,result:e()}):a=r,(0,ez.useEffect)(()=>{n.current=a,i==r&&(r.inputs=r.result=void 0)},[a]),a.result}(()=>({pause:i,immediate:a}),[i,a]);let{Provider:o}=aD;return ez.createElement(o,{value:r},t)},aD=(et={},Object.assign(aP,ez.createContext(et)),aP.Provider._context=aP,aP.Consumer._context=aP,aP);aP.Provider=aD.Provider,aP.Consumer=aD.Consumer;let aR=()=>{let e=[],t=function(t){im(`${ih}Directly calling start instead of using the api object is deprecated in v9 (use ".start" instead), this will be removed in later 0.X.0 versions`);let n=[];return nm(e,(e,i)=>{if(nf.und(t))n.push(e.start());else{let a=r(t,e,i);a&&n.push(e.start(a))}}),n};t.current=e,t.add=function(t){e.includes(t)||e.push(t)},t.delete=function(t){let r=e.indexOf(t);~r&&e.splice(r,1)},t.pause=function(){return nm(e,e=>e.pause(...arguments)),this},t.resume=function(){return nm(e,e=>e.resume(...arguments)),this},t.set=function(t){nm(e,e=>e.set(t))},t.start=function(t){let r=[];return nm(e,(e,n)=>{if(nf.und(t))r.push(e.start());else{let i=this._getProps(t,e,n);i&&r.push(e.start(i))}}),r},t.stop=function(){return nm(e,e=>e.stop(...arguments)),this},t.update=function(t){return nm(e,(e,r)=>e.update(this._getProps(t,e,r))),this};let r=function(e,t,r){return nf.fun(e)?e(r,t):e};return t._getProps=r,t};(er=o||(o={})).MOUNT="mount",er.ENTER="enter",er.UPDATE="update",er.LEAVE="leave";class aF extends aa{constructor(e,t){super(),this.key=void 0,this.idle=!0,this.calc=void 0,this._active=new Set,this.source=e,this.calc=nZ(...t);let r=this._get();iB(this,iz(r).create(r))}advance(e){let t=this._get();np(t,this.get())||(iw(this).setValue(t),this._onChange(t,this.idle)),!this.idle&&aO(this._active)&&aQ(this)}_get(){let e=nf.arr(this.source)?this.source.map(n3):ng(n3(this.source));return this.calc(...e)}_start(){this.idle&&!aO(this._active)&&(this.idle=!1,nm(iI(this),e=>{e.done=!1}),nb.skipAnimation?(r4.batchedUpdates(()=>this.advance()),aQ(this)):nS.start(this))}_attach(){let e=1;nm(ng(this.source),t=>{n2(t)&&n9(t,this),an(t)&&(t.idle||this._active.add(t),e=Math.max(e,t.priority+1))}),this.priority=e,this._start()}_detach(){nm(ng(this.source),e=>{n2(e)&&n7(e,this)}),this._active.clear(),aQ(this)}eventObserved(e){"change"==e.type?e.idle?this.advance():(this._active.add(e.parent),this._start()):"idle"==e.type?this._active.delete(e.parent):"priority"==e.type&&(this.priority=ng(this.source).reduce((e,t)=>Math.max(e,(an(t)?t.priority:0)+1),0))}}function az(e){return!1!==e.idle}function aO(e){return!e.size||Array.from(e).every(az)}function aQ(e){e.idle||(e.idle=!0,nm(iI(e),e=>{e.done=!0}),n5(e,{type:"idle",parent:e}))}nb.assign({createStringInterpolator:iu,to:(e,t)=>new aF(e,t)}),nS.advance;let aL=["primitive"].concat(Object.keys(eQ).filter(e=>/^[A-Z]/.test(e)).map(e=>e[0].toLowerCase()+e.slice(1)));nb.assign({createStringInterpolator:iu,colors:{transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},frameLoop:"demand"}),(0,eL.n)(()=>{r4.advance()});let ak=((e,{applyAnimatedValues:t=()=>!1,createAnimatedStyle:r=e=>new iD(e),getComponentProps:n=e=>e}={})=>{let i={applyAnimatedValues:t,createAnimatedStyle:r,getComponentProps:n},a=e=>{let t=iU(e)||"Anonymous";return(e=nf.str(e)?a[e]||(a[e]=iQ(e,i)):e[ik]||(e[ik]=iQ(e,i))).displayName=`Animated(${t})`,e};return nA(e,(t,r)=>{nf.arr(e)&&(r=iU(t)),a[r]=a(t)}),{animated:a}})(aL,{applyAnimatedValues:eL.j}).animated;function aU({enabled:e=!0,snap:t,global:r,domElement:n,cursor:i=!0,children:a,speed:o=1,rotation:s=[0,0,0],zoom:l=1,polar:c=[0,Math.PI/2],azimuth:u=[-1/0,1/0],config:h={mass:1,tension:170,friction:26}}){let d=(0,eL.A)(e=>e.events),f=(0,eL.A)(e=>e.gl),p=n||d.connected||f.domElement,{size:m}=(0,eL.A)(),A=ez.useMemo(()=>[s[0]+c[0],s[0]+c[1]],[s[0],c[0],c[1]]),g=ez.useMemo(()=>[s[1]+u[0],s[1]+u[1]],[s[1],u[0],u[1]]),v=ez.useMemo(()=>[eQ.MathUtils.clamp(s[0],...A),eQ.MathUtils.clamp(s[1],...g),s[2]],[s[0],s[1],s[2],A,g]),[y,x]=function(e,t){let r=nf.fun(e),[[n],i]=function(e,t,r){let n=nf.fun(t)&&t;n&&!r&&(r=[]);let i=(0,ez.useMemo)(()=>n||3==arguments.length?aR():void 0,[]),a=(0,ez.useRef)(0),o=iy(),s=(0,ez.useMemo)(()=>({ctrls:[],queue:[],flush(e,t){let r=aw(e,t);return!(a.current>0)||s.queue.length||Object.keys(r).some(t=>!e.springs[t])?new Promise(n=>{aB(e,r),s.queue.push(()=>{n(aC(e,t))}),o()}):aC(e,t)}}),[]),l=(0,ez.useRef)([...s.ctrls]),c=[],u=i_(e)||0;function h(e,r){for(let i=e;i<r;i++){let e=l.current[i]||(l.current[i]=new a_(null,s.flush)),r=n?n(i,e):t[i];r&&(c[i]=function(e){let t=am(e);return nf.und(t.default)&&(t.default=iJ(t)),t}(r))}}(0,ez.useMemo)(()=>{nm(l.current.slice(e,u),e=>{var t;null==(t=e.ref)||t.delete(e),null==i||i.delete(e),e.stop(!0)}),l.current.length=e,h(u,e)},[e]),(0,ez.useMemo)(()=>{h(0,Math.min(u,e))},r);let d=l.current.map((e,t)=>aw(e,c[t])),f=(0,ez.useContext)(aP),p=i_(f),m=f!==p&&function(e){for(let t in e)return!0;return!1}(f);ig(()=>{a.current++,s.ctrls=l.current;let{queue:e}=s;e.length&&(s.queue=[],nm(e,e=>e())),nm(l.current,(e,t)=>{null==i||i.add(e),m&&e.start({default:f});let r=c[t];r&&(function(e,t){if(t&&e.ref!==t){var r;null==(r=e.ref)||r.delete(e),t.add(e),e.ref=t}}(e,r.ref),e.ref?e.queue.push(r):e.start(r))})}),ix(()=>()=>{nm(s.ctrls,e=>e.stop(!0))});let A=d.map(e=>iN({},e));return i?[A,i]:A}(1,r?e:[e],r?t||[]:t);return r||2==arguments.length?[n,i]:n}(()=>({scale:1,rotation:v,config:h}));ez.useEffect(()=>void x.start({scale:1,rotation:v,config:h}),[v]),ez.useEffect(()=>{if(r&&i&&e)return p.style.cursor="grab",f.domElement.style.cursor="",()=>{p.style.cursor="default",f.domElement.style.cursor="default"}},[r,i,p,e]);let E=t3({onHover:({last:t})=>{i&&!r&&e&&(p.style.cursor=t?"auto":"grab")},onDrag:({down:r,delta:[n,a],memo:[s,c]=y.rotation.animation.to||v})=>{if(!e)return[a,n];i&&(p.style.cursor=r?"grabbing":"grab"),n=eQ.MathUtils.clamp(c+n/m.width*Math.PI*o,...g),a=eQ.MathUtils.clamp(s+a/m.height*Math.PI*o,...A);let u=t&&!r&&"boolean"!=typeof t?t:h;return x.start({scale:r&&a>A[1]/2?l:1,rotation:t&&!r?v:[a,n,0],config:e=>"scale"===e?{...u,friction:3*u.friction}:u}),[a,n]}},{target:r?p:void 0});return ez.createElement(ak.group,ee({},null==E?void 0:E(),y),a)}Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;let aN=e=>(t,r,n)=>{let i=n.subscribe;return n.subscribe=(e,t,r)=>{let a=e;if(t){let i=(null==r?void 0:r.equalityFn)||Object.is,o=e(n.getState());a=r=>{let n=e(r);if(!i(o,n)){let e=o;t(o=n,e)}},(null==r?void 0:r.fireImmediately)&&t(o,o)}return i(a)},e(t,r,n)};Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;let aG=ez.createContext(null);function aH({map:e,children:t,onChange:r,domElement:n}){let i=e.map(e=>e.name+e.keys).join("-"),a=ez.useMemo(()=>(0,eX.Z)(aN(()=>e.reduce((e,t)=>({...e,[t.name]:!1}),{}))),[i]),o=ez.useMemo(()=>[a.subscribe,a.getState,a],[i]),s=a.setState;return ez.useEffect(()=>{let t=e.map(({name:e,keys:t,up:n})=>({keys:t,up:n,fn:t=>{s({[e]:t}),r&&r(e,t,o[1]())}})).reduce((e,{keys:t,fn:r,up:n=!0})=>(t.forEach(t=>e[t]={fn:r,pressed:!1,up:n}),e),{}),i=({key:e,code:r})=>{let n=t[e]||t[r];if(!n)return;let{fn:i,pressed:a,up:o}=n;n.pressed=!0,(o||!a)&&i(!0)},a=({key:e,code:r})=>{let n=t[e]||t[r];if(!n)return;let{fn:i,up:a}=n;n.pressed=!1,a&&i(!1)},l=n||window;return l.addEventListener("keydown",i,{passive:!0}),l.addEventListener("keyup",a,{passive:!0}),()=>{l.removeEventListener("keydown",i),l.removeEventListener("keyup",a)}},[n,i]),ez.createElement(aG.Provider,{value:o,children:t})}function aV(e){let[t,r,n]=ez.useContext(aG);return e?n(e):[t,r]}let aj=new eQ.Frustum,aY=new eQ.Vector3,aJ=new eQ.Vector3,aW=new eQ.Vector3,aq=new eQ.Vector3,aK=new eQ.Vector3,aX=new eQ.Vector3,aZ=new eQ.Vector3,a$=new eQ.Vector3,a0=new eQ.Vector3,a1=new eQ.Vector3,a2=new eQ.Vector3,a3=new eQ.Vector3,a4=new eQ.Vector3,a5=new eQ.Vector3;class a6{constructor(e,t,r){this.camera=e,this.scene=t,this.startPoint=new eQ.Vector3,this.endPoint=new eQ.Vector3,this.collection=[],this.deep=r||Number.MAX_VALUE}select(e,t){return this.startPoint=e||this.startPoint,this.endPoint=t||this.endPoint,this.collection=[],this.updateFrustum(this.startPoint,this.endPoint),this.searchChildInFrustum(aj,this.scene),this.collection}updateFrustum(e,t){if(e=e||this.startPoint,t=t||this.endPoint,e.x===t.x&&(t.x+=Number.EPSILON),e.y===t.y&&(t.y+=Number.EPSILON),this.camera.updateProjectionMatrix(),this.camera.updateMatrixWorld(),this.camera.isPerspectiveCamera){aJ.copy(e),aJ.x=Math.min(e.x,t.x),aJ.y=Math.max(e.y,t.y),t.x=Math.max(e.x,t.x),t.y=Math.min(e.y,t.y),aW.setFromMatrixPosition(this.camera.matrixWorld),aq.copy(aJ),aK.set(t.x,aJ.y,0),aX.copy(t),aZ.set(aJ.x,t.y,0),aq.unproject(this.camera),aK.unproject(this.camera),aX.unproject(this.camera),aZ.unproject(this.camera),a3.copy(aq).sub(aW),a4.copy(aK).sub(aW),a5.copy(aX).sub(aW),a3.normalize(),a4.normalize(),a5.normalize(),a3.multiplyScalar(this.deep),a4.multiplyScalar(this.deep),a5.multiplyScalar(this.deep),a3.add(aW),a4.add(aW),a5.add(aW);var r=aj.planes;r[0].setFromCoplanarPoints(aW,aq,aK),r[1].setFromCoplanarPoints(aW,aK,aX),r[2].setFromCoplanarPoints(aX,aZ,aW),r[3].setFromCoplanarPoints(aZ,aq,aW),r[4].setFromCoplanarPoints(aK,aX,aZ),r[5].setFromCoplanarPoints(a5,a4,a3),r[5].normal.multiplyScalar(-1)}else if(this.camera.isOrthographicCamera){let n=Math.min(e.x,t.x),i=Math.max(e.y,t.y),a=Math.max(e.x,t.x),o=Math.min(e.y,t.y);aq.set(n,i,-1),aK.set(a,i,-1),aX.set(a,o,-1),aZ.set(n,o,-1),a$.set(n,i,1),a0.set(a,i,1),a1.set(a,o,1),a2.set(n,o,1),aq.unproject(this.camera),aK.unproject(this.camera),aX.unproject(this.camera),aZ.unproject(this.camera),a$.unproject(this.camera),a0.unproject(this.camera),a1.unproject(this.camera),a2.unproject(this.camera);var r=aj.planes;r[0].setFromCoplanarPoints(aq,a$,a0),r[1].setFromCoplanarPoints(aK,a0,a1),r[2].setFromCoplanarPoints(a1,a2,aZ),r[3].setFromCoplanarPoints(a2,a$,aq),r[4].setFromCoplanarPoints(aK,aX,aZ),r[5].setFromCoplanarPoints(a1,a0,a$),r[5].normal.multiplyScalar(-1)}else console.error("THREE.SelectionBox: Unsupported camera type.")}searchChildInFrustum(e,t){if((t.isMesh||t.isLine||t.isPoints)&&void 0!==t.material&&(null===t.geometry.boundingSphere&&t.geometry.computeBoundingSphere(),aY.copy(t.geometry.boundingSphere.center),aY.applyMatrix4(t.matrixWorld),e.containsPoint(aY)&&this.collection.push(t)),t.children.length>0)for(let r=0;r<t.children.length;r++)this.searchChildInFrustum(e,t.children[r])}}let a8=ez.createContext([]);function a9({box:e,multiple:t,children:r,onChange:n,onChangePointerUp:i,border:a="1px solid #55aaff",backgroundColor:o="rgba(75, 160, 255, 0.1)",filter:s=e=>e,...l}){let[c,u]=ez.useState(!1),{setEvents:h,camera:d,raycaster:f,gl:p,controls:m,size:A,get:g}=(0,eL.A)(),[v,y]=ez.useState(!1),[x,E]=ez.useReducer((e,{object:t,shift:r})=>void 0===t?[]:Array.isArray(t)?t:r?e.includes(t)?e.filter(e=>e!==t):[t,...e]:e[0]===t?[]:[t],[]);ez.useEffect(()=>{c?null==n||n(x):null==i||i(x)},[x,c]);let _=ez.useCallback(e=>{e.stopPropagation(),E({object:s([e.object])[0],shift:t&&e.shiftKey})},[]),C=ez.useCallback(e=>!v&&E({}),[v]),b=ez.useRef(null);return ez.useEffect(()=>{if(!e||!t)return;let r=new a6(d,b.current),n=document.createElement("div");n.style.pointerEvents="none",n.style.border=a,n.style.backgroundColor=o,n.style.position="fixed";let i=new eQ.Vector2,l=new eQ.Vector2,c=new eQ.Vector2,f=g().events.enabled,v=null==m?void 0:m.enabled,y=!1;function x(e,t){let{offsetX:r,offsetY:n}=e,{width:i,height:a}=A;t.set(r/i*2-1,-(n/a*2)+1)}function _(e){if(e.shiftKey){var t;m&&(m.enabled=!1),h({enabled:!1}),u(y=!0),null==(t=p.domElement.parentElement)||t.appendChild(n),n.style.left=`${e.clientX}px`,n.style.top=`${e.clientY}px`,n.style.width="0px",n.style.height="0px",i.x=e.clientX,i.y=e.clientY,x(e,r.startPoint)}}let C=[];function w(e){if(y){c.x=Math.max(i.x,e.clientX),c.y=Math.max(i.y,e.clientY),l.x=Math.min(i.x,e.clientX),l.y=Math.min(i.y,e.clientY),n.style.left=`${l.x}px`,n.style.top=`${l.y}px`,n.style.width=`${c.x-l.x}px`,n.style.height=`${c.y-l.y}px`,x(e,r.endPoint);let t=r.select().sort(e=>e.uuid).filter(e=>e.isMesh);!function(e,t){if(Object.is(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;let r=Object.keys(e);if(r.length!==Object.keys(t).length)return!1;for(let n=0;n<r.length;n++)if(!Object.prototype.hasOwnProperty.call(t,r[n])||!Object.is(e[r[n]],t[r[n]]))return!1;return!0}(t,C)&&(C=t,E({object:s(t)}))}}function B(e){y&&function(){if(y){var e;m&&(m.enabled=v),h({enabled:f}),u(y=!1),null==(e=n.parentElement)||e.removeChild(n)}}()}return document.addEventListener("pointerdown",_,{passive:!0}),document.addEventListener("pointermove",w,{passive:!0,capture:!0}),document.addEventListener("pointerup",B,{passive:!0}),()=>{document.removeEventListener("pointerdown",_),document.removeEventListener("pointermove",w,!0),document.removeEventListener("pointerup",B)}},[A.width,A.height,f,d,m,p]),ez.createElement("group",ee({ref:b,onClick:_,onPointerOver:()=>y(!0),onPointerOut:()=>y(!1),onPointerMissed:C},l),ez.createElement(a8.Provider,{value:x},r))}function a7(){return ez.useContext(a8)}let oe=ez.forwardRef(function({children:e,follow:t=!0,lockX:r=!1,lockY:n=!1,lockZ:i=!1,...a},o){let s=ez.useRef(null),l=ez.useRef(null),c=new eQ.Quaternion;return(0,eL.C)(({camera:e})=>{if(!t||!l.current)return;let a=l.current.rotation.clone();l.current.updateMatrix(),l.current.updateWorldMatrix(!1,!1),l.current.getWorldQuaternion(c),e.getWorldQuaternion(s.current.quaternion).premultiply(c.invert()),r&&(l.current.rotation.x=a.x),n&&(l.current.rotation.y=a.y),i&&(l.current.rotation.z=a.z)}),ez.useImperativeHandle(o,()=>l.current,[]),ez.createElement("group",ee({ref:l,matrixAutoUpdate:!1,matrixWorldAutoUpdate:!1},a),ez.createElement("group",{ref:s},e))}),ot=ez.forwardRef(({children:e,depth:t=-1,...r},n)=>{let i=ez.useRef(null);return ez.useImperativeHandle(n,()=>i.current,[]),(0,eL.C)(({camera:e})=>{i.current.quaternion.copy(e.quaternion),i.current.position.copy(e.position)}),ez.createElement("group",ee({ref:i},r),ez.createElement("group",{"position-z":-t},e))}),or=new eQ.Vector3,on=new eQ.Vector3,oi=new eQ.Vector3,oa=(e,t,r)=>{let n=r.width/2,i=r.height/2;t.updateMatrixWorld(!1);let a=e.project(t);return a.x=a.x*n+n,a.y=-(a.y*i)+i,a},oo=(e,t,r,n=1)=>{let i=or.set(e.x/r.width*2-1,-(e.y/r.height*2)+1,n);return i.unproject(t),i},os=(e,t,r,n)=>{let i=oa(oi.copy(e),r,n),a=0;for(let o=0;o<2;++o){let s=on.copy(i).setComponent(o,i.getComponent(o)+t),l=oo(s,r,n,s.z);a=Math.max(a,e.distanceTo(l))}return a},ol=new eQ.Vector3,oc=(0,ez.forwardRef)(({scale:e=1,...t},r)=>{let n=(0,ez.useRef)(null);return ez.useImperativeHandle(r,()=>n.current,[]),(0,eL.C)(t=>{let r=n.current;if(!r)return;let i=os(r.getWorldPosition(ol),e,t.camera,t.size);r.scale.setScalar(i*e)}),ez.createElement("object3D",ee({ref:n},t))}),ou=new eQ.Box3,oh=new eQ.Vector3;class od extends eQ.InstancedBufferGeometry{constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry",this.setIndex([0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5]),this.setAttribute("position",new eQ.Float32BufferAttribute([-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],3)),this.setAttribute("uv",new eQ.Float32BufferAttribute([-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],2))}applyMatrix4(e){let t=this.attributes.instanceStart,r=this.attributes.instanceEnd;return void 0!==t&&(t.applyMatrix4(e),r.applyMatrix4(e),t.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}setPositions(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));let r=new eQ.InstancedInterleavedBuffer(t,6,1);return this.setAttribute("instanceStart",new eQ.InterleavedBufferAttribute(r,3,0)),this.setAttribute("instanceEnd",new eQ.InterleavedBufferAttribute(r,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(e,t=3){let r;e instanceof Float32Array?r=e:Array.isArray(e)&&(r=new Float32Array(e));let n=new eQ.InstancedInterleavedBuffer(r,2*t,1);return this.setAttribute("instanceColorStart",new eQ.InterleavedBufferAttribute(n,t,0)),this.setAttribute("instanceColorEnd",new eQ.InterleavedBufferAttribute(n,t,t)),this}fromWireframeGeometry(e){return this.setPositions(e.attributes.position.array),this}fromEdgesGeometry(e){return this.setPositions(e.attributes.position.array),this}fromMesh(e){return this.fromWireframeGeometry(new eQ.WireframeGeometry(e.geometry)),this}fromLineSegments(e){let t=e.geometry;return this.setPositions(t.attributes.position.array),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new eQ.Box3);let e=this.attributes.instanceStart,t=this.attributes.instanceEnd;void 0!==e&&void 0!==t&&(this.boundingBox.setFromBufferAttribute(e),ou.setFromBufferAttribute(t),this.boundingBox.union(ou))}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new eQ.Sphere),null===this.boundingBox&&this.computeBoundingBox();let e=this.attributes.instanceStart,t=this.attributes.instanceEnd;if(void 0!==e&&void 0!==t){let r=this.boundingSphere.center;this.boundingBox.getCenter(r);let n=0;for(let i=0,a=e.count;i<a;i++)oh.fromBufferAttribute(e,i),n=Math.max(n,r.distanceToSquared(oh)),oh.fromBufferAttribute(t,i),n=Math.max(n,r.distanceToSquared(oh));this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}applyMatrix(e){return console.warn("THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4()."),this.applyMatrix4(e)}}class of extends eQ.ShaderMaterial{constructor(e){super({type:"LineMaterial",uniforms:eQ.UniformsUtils.clone(eQ.UniformsUtils.merge([eQ.UniformsLib.common,eQ.UniformsLib.fog,{worldUnits:{value:1},linewidth:{value:1},resolution:{value:new eQ.Vector2(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}}])),vertexShader:`
				#include <common>
				#include <fog_pars_vertex>
				#include <logdepthbuf_pars_vertex>
				#include <clipping_planes_pars_vertex>

				uniform float linewidth;
				uniform vec2 resolution;

				attribute vec3 instanceStart;
				attribute vec3 instanceEnd;

				#ifdef USE_COLOR
					#ifdef USE_LINE_COLOR_ALPHA
						varying vec4 vLineColor;
						attribute vec4 instanceColorStart;
						attribute vec4 instanceColorEnd;
					#else
						varying vec3 vLineColor;
						attribute vec3 instanceColorStart;
						attribute vec3 instanceColorEnd;
					#endif
				#endif

				#ifdef WORLD_UNITS

					varying vec4 worldPos;
					varying vec3 worldStart;
					varying vec3 worldEnd;

					#ifdef USE_DASH

						varying vec2 vUv;

					#endif

				#else

					varying vec2 vUv;

				#endif

				#ifdef USE_DASH

					uniform float dashScale;
					attribute float instanceDistanceStart;
					attribute float instanceDistanceEnd;
					varying float vLineDistance;

				#endif

				void trimSegment( const in vec4 start, inout vec4 end ) {

					// trim end segment so it terminates between the camera plane and the near plane

					// conservative estimate of the near plane
					float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
					float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
					float nearEstimate = - 0.5 * b / a;

					float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

					end.xyz = mix( start.xyz, end.xyz, alpha );

				}

				void main() {

					#ifdef USE_COLOR

						vLineColor = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

					#endif

					#ifdef USE_DASH

						vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;
						vUv = uv;

					#endif

					float aspect = resolution.x / resolution.y;

					// camera space
					vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
					vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

					#ifdef WORLD_UNITS

						worldStart = start.xyz;
						worldEnd = end.xyz;

					#else

						vUv = uv;

					#endif

					// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
					// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
					// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
					// perhaps there is a more elegant solution -- WestLangley

					bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

					if ( perspective ) {

						if ( start.z < 0.0 && end.z >= 0.0 ) {

							trimSegment( start, end );

						} else if ( end.z < 0.0 && start.z >= 0.0 ) {

							trimSegment( end, start );

						}

					}

					// clip space
					vec4 clipStart = projectionMatrix * start;
					vec4 clipEnd = projectionMatrix * end;

					// ndc space
					vec3 ndcStart = clipStart.xyz / clipStart.w;
					vec3 ndcEnd = clipEnd.xyz / clipEnd.w;

					// direction
					vec2 dir = ndcEnd.xy - ndcStart.xy;

					// account for clip-space aspect ratio
					dir.x *= aspect;
					dir = normalize( dir );

					#ifdef WORLD_UNITS

						// get the offset direction as perpendicular to the view vector
						vec3 worldDir = normalize( end.xyz - start.xyz );
						vec3 offset;
						if ( position.y < 0.5 ) {

							offset = normalize( cross( start.xyz, worldDir ) );

						} else {

							offset = normalize( cross( end.xyz, worldDir ) );

						}

						// sign flip
						if ( position.x < 0.0 ) offset *= - 1.0;

						float forwardOffset = dot( worldDir, vec3( 0.0, 0.0, 1.0 ) );

						// don't extend the line if we're rendering dashes because we
						// won't be rendering the endcaps
						#ifndef USE_DASH

							// extend the line bounds to encompass  endcaps
							start.xyz += - worldDir * linewidth * 0.5;
							end.xyz += worldDir * linewidth * 0.5;

							// shift the position of the quad so it hugs the forward edge of the line
							offset.xy -= dir * forwardOffset;
							offset.z += 0.5;

						#endif

						// endcaps
						if ( position.y > 1.0 || position.y < 0.0 ) {

							offset.xy += dir * 2.0 * forwardOffset;

						}

						// adjust for linewidth
						offset *= linewidth * 0.5;

						// set the world position
						worldPos = ( position.y < 0.5 ) ? start : end;
						worldPos.xyz += offset;

						// project the worldpos
						vec4 clip = projectionMatrix * worldPos;

						// shift the depth of the projected points so the line
						// segments overlap neatly
						vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;
						clip.z = clipPose.z * clip.w;

					#else

						vec2 offset = vec2( dir.y, - dir.x );
						// undo aspect ratio adjustment
						dir.x /= aspect;
						offset.x /= aspect;

						// sign flip
						if ( position.x < 0.0 ) offset *= - 1.0;

						// endcaps
						if ( position.y < 0.0 ) {

							offset += - dir;

						} else if ( position.y > 1.0 ) {

							offset += dir;

						}

						// adjust for linewidth
						offset *= linewidth;

						// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
						offset /= resolution.y;

						// select end
						vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

						// back to clip space
						offset *= clip.w;

						clip.xy += offset;

					#endif

					gl_Position = clip;

					vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

					#include <logdepthbuf_vertex>
					#include <clipping_planes_vertex>
					#include <fog_vertex>

				}
			`,fragmentShader:`
				uniform vec3 diffuse;
				uniform float opacity;
				uniform float linewidth;

				#ifdef USE_DASH

					uniform float dashOffset;
					uniform float dashSize;
					uniform float gapSize;

				#endif

				varying float vLineDistance;

				#ifdef WORLD_UNITS

					varying vec4 worldPos;
					varying vec3 worldStart;
					varying vec3 worldEnd;

					#ifdef USE_DASH

						varying vec2 vUv;

					#endif

				#else

					varying vec2 vUv;

				#endif

				#include <common>
				#include <fog_pars_fragment>
				#include <logdepthbuf_pars_fragment>
				#include <clipping_planes_pars_fragment>

				#ifdef USE_COLOR
					#ifdef USE_LINE_COLOR_ALPHA
						varying vec4 vLineColor;
					#else
						varying vec3 vLineColor;
					#endif
				#endif

				vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {

					float mua;
					float mub;

					vec3 p13 = p1 - p3;
					vec3 p43 = p4 - p3;

					vec3 p21 = p2 - p1;

					float d1343 = dot( p13, p43 );
					float d4321 = dot( p43, p21 );
					float d1321 = dot( p13, p21 );
					float d4343 = dot( p43, p43 );
					float d2121 = dot( p21, p21 );

					float denom = d2121 * d4343 - d4321 * d4321;

					float numer = d1343 * d4321 - d1321 * d4343;

					mua = numer / denom;
					mua = clamp( mua, 0.0, 1.0 );
					mub = ( d1343 + d4321 * ( mua ) ) / d4343;
					mub = clamp( mub, 0.0, 1.0 );

					return vec2( mua, mub );

				}

				void main() {

					#include <clipping_planes_fragment>

					#ifdef USE_DASH

						if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

						if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

					#endif

					float alpha = opacity;

					#ifdef WORLD_UNITS

						// Find the closest points on the view ray and the line segment
						vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;
						vec3 lineDir = worldEnd - worldStart;
						vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );

						vec3 p1 = worldStart + lineDir * params.x;
						vec3 p2 = rayEnd * params.y;
						vec3 delta = p1 - p2;
						float len = length( delta );
						float norm = len / linewidth;

						#ifndef USE_DASH

							#ifdef USE_ALPHA_TO_COVERAGE

								float dnorm = fwidth( norm );
								alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );

							#else

								if ( norm > 0.5 ) {

									discard;

								}

							#endif

						#endif

					#else

						#ifdef USE_ALPHA_TO_COVERAGE

							// artifacts appear on some hardware if a derivative is taken within a conditional
							float a = vUv.x;
							float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
							float len2 = a * a + b * b;
							float dlen = fwidth( len2 );

							if ( abs( vUv.y ) > 1.0 ) {

								alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );

							}

						#else

							if ( abs( vUv.y ) > 1.0 ) {

								float a = vUv.x;
								float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
								float len2 = a * a + b * b;

								if ( len2 > 1.0 ) discard;

							}

						#endif

					#endif

					vec4 diffuseColor = vec4( diffuse, alpha );
					#ifdef USE_COLOR
						#ifdef USE_LINE_COLOR_ALPHA
							diffuseColor *= vLineColor;
						#else
							diffuseColor.rgb *= vLineColor;
						#endif
					#endif

					#include <logdepthbuf_fragment>

					gl_FragColor = diffuseColor;

					#include <tonemapping_fragment>
					#include <${parseInt(eQ.REVISION.replace(/\D+/g,""))>=154?"colorspace_fragment":"encodings_fragment"}>
					#include <fog_fragment>
					#include <premultiplied_alpha_fragment>

				}
			`,clipping:!0}),this.isLineMaterial=!0,this.onBeforeCompile=function(){this.transparent?this.defines.USE_LINE_COLOR_ALPHA="1":delete this.defines.USE_LINE_COLOR_ALPHA},Object.defineProperties(this,{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(e){this.uniforms.diffuse.value=e}},worldUnits:{enumerable:!0,get:function(){return"WORLD_UNITS"in this.defines},set:function(e){!0===e?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}},linewidth:{enumerable:!0,get:function(){return this.uniforms.linewidth.value},set:function(e){this.uniforms.linewidth.value=e}},dashed:{enumerable:!0,get:function(){return"USE_DASH"in this.defines},set(e){!!e!="USE_DASH"in this.defines&&(this.needsUpdate=!0),!0===e?this.defines.USE_DASH="":delete this.defines.USE_DASH}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(e){this.uniforms.dashScale.value=e}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(e){this.uniforms.dashSize.value=e}},dashOffset:{enumerable:!0,get:function(){return this.uniforms.dashOffset.value},set:function(e){this.uniforms.dashOffset.value=e}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(e){this.uniforms.gapSize.value=e}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(e){this.uniforms.opacity.value=e}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(e){this.uniforms.resolution.value.copy(e)}},alphaToCoverage:{enumerable:!0,get:function(){return"USE_ALPHA_TO_COVERAGE"in this.defines},set:function(e){!!e!="USE_ALPHA_TO_COVERAGE"in this.defines&&(this.needsUpdate=!0),!0===e?(this.defines.USE_ALPHA_TO_COVERAGE="",this.extensions.derivatives=!0):(delete this.defines.USE_ALPHA_TO_COVERAGE,this.extensions.derivatives=!1)}}}),this.setValues(e)}}let op=new eQ.Vector3,om=new eQ.Vector3,oA=new eQ.Vector4,og=new eQ.Vector4,ov=new eQ.Vector4,oy=new eQ.Vector3,ox=new eQ.Matrix4,oE=new eQ.Line3,o_=new eQ.Vector3,oC=new eQ.Box3,ob=new eQ.Sphere,ow=new eQ.Vector4;function oB(e,t,r){return ow.set(0,0,-t,1).applyMatrix4(e.projectionMatrix),ow.multiplyScalar(1/ow.w),ow.x=u/r.width,ow.y=u/r.height,ow.applyMatrix4(e.projectionMatrixInverse),ow.multiplyScalar(1/ow.w),Math.abs(Math.max(ow.x,ow.y))}class oI extends eQ.Mesh{constructor(e=new od,t=new of({color:16777215*Math.random()})){super(e,t),this.isLineSegments2=!0,this.type="LineSegments2"}computeLineDistances(){let e=this.geometry,t=e.attributes.instanceStart,r=e.attributes.instanceEnd,n=new Float32Array(2*t.count);for(let e=0,i=0,a=t.count;e<a;e++,i+=2)op.fromBufferAttribute(t,e),om.fromBufferAttribute(r,e),n[i]=0===i?0:n[i-1],n[i+1]=n[i]+op.distanceTo(om);let i=new eQ.InstancedInterleavedBuffer(n,2,1);return e.setAttribute("instanceDistanceStart",new eQ.InterleavedBufferAttribute(i,1,0)),e.setAttribute("instanceDistanceEnd",new eQ.InterleavedBufferAttribute(i,1,1)),this}raycast(e,t){let r,n;let i=this.material.worldUnits,a=e.camera;null!==a||i||console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2 while worldUnits is set to false.');let o=void 0!==e.params.Line2&&e.params.Line2.threshold||0;s=e.ray;let h=this.matrixWorld,d=this.geometry,f=this.material;if(u=f.linewidth+o,l=d.attributes.instanceStart,c=d.attributes.instanceEnd,null===d.boundingSphere&&d.computeBoundingSphere(),ob.copy(d.boundingSphere).applyMatrix4(h),i)r=.5*u;else{let e=Math.max(a.near,ob.distanceToPoint(s.origin));r=oB(a,e,f.resolution)}if(ob.radius+=r,!1!==s.intersectsSphere(ob)){if(null===d.boundingBox&&d.computeBoundingBox(),oC.copy(d.boundingBox).applyMatrix4(h),i)n=.5*u;else{let e=Math.max(a.near,oC.distanceToPoint(s.origin));n=oB(a,e,f.resolution)}oC.expandByScalar(n),!1!==s.intersectsBox(oC)&&(i?function(e,t){for(let r=0,n=l.count;r<n;r++){oE.start.fromBufferAttribute(l,r),oE.end.fromBufferAttribute(c,r);let n=new eQ.Vector3,i=new eQ.Vector3;s.distanceSqToSegment(oE.start,oE.end,i,n),i.distanceTo(n)<.5*u&&t.push({point:i,pointOnLine:n,distance:s.origin.distanceTo(i),object:e,face:null,faceIndex:r,uv:null,uv2:null})}}(this,t):function(e,t,r){let n=t.projectionMatrix,i=e.material.resolution,a=e.matrixWorld,o=e.geometry,l=o.attributes.instanceStart,c=o.attributes.instanceEnd,h=-t.near;s.at(1,ov),ov.w=1,ov.applyMatrix4(t.matrixWorldInverse),ov.applyMatrix4(n),ov.multiplyScalar(1/ov.w),ov.x*=i.x/2,ov.y*=i.y/2,ov.z=0,oy.copy(ov),ox.multiplyMatrices(t.matrixWorldInverse,a);for(let t=0,o=l.count;t<o;t++){if(oA.fromBufferAttribute(l,t),og.fromBufferAttribute(c,t),oA.w=1,og.w=1,oA.applyMatrix4(ox),og.applyMatrix4(ox),oA.z>h&&og.z>h)continue;if(oA.z>h){let e=oA.z-og.z,t=(oA.z-h)/e;oA.lerp(og,t)}else if(og.z>h){let e=og.z-oA.z,t=(og.z-h)/e;og.lerp(oA,t)}oA.applyMatrix4(n),og.applyMatrix4(n),oA.multiplyScalar(1/oA.w),og.multiplyScalar(1/og.w),oA.x*=i.x/2,oA.y*=i.y/2,og.x*=i.x/2,og.y*=i.y/2,oE.start.copy(oA),oE.start.z=0,oE.end.copy(og),oE.end.z=0;let o=oE.closestPointToPointParameter(oy,!0);oE.at(o,o_);let d=eQ.MathUtils.lerp(oA.z,og.z,o),f=d>=-1&&d<=1,p=oy.distanceTo(o_)<.5*u;if(f&&p){oE.start.fromBufferAttribute(l,t),oE.end.fromBufferAttribute(c,t),oE.start.applyMatrix4(a),oE.end.applyMatrix4(a);let n=new eQ.Vector3,i=new eQ.Vector3;s.distanceSqToSegment(oE.start,oE.end,i,n),r.push({point:i,pointOnLine:n,distance:s.origin.distanceTo(i),object:e,face:null,faceIndex:t,uv:null,uv2:null})}}}(this,a,t))}}}class oM extends od{constructor(){super(),this.isLineGeometry=!0,this.type="LineGeometry"}setPositions(e){let t=e.length-3,r=new Float32Array(2*t);for(let n=0;n<t;n+=3)r[2*n]=e[n],r[2*n+1]=e[n+1],r[2*n+2]=e[n+2],r[2*n+3]=e[n+3],r[2*n+4]=e[n+4],r[2*n+5]=e[n+5];return super.setPositions(r),this}setColors(e,t=3){let r=e.length-t,n=new Float32Array(2*r);if(3===t)for(let i=0;i<r;i+=t)n[2*i]=e[i],n[2*i+1]=e[i+1],n[2*i+2]=e[i+2],n[2*i+3]=e[i+3],n[2*i+4]=e[i+4],n[2*i+5]=e[i+5];else for(let i=0;i<r;i+=t)n[2*i]=e[i],n[2*i+1]=e[i+1],n[2*i+2]=e[i+2],n[2*i+3]=e[i+3],n[2*i+4]=e[i+4],n[2*i+5]=e[i+5],n[2*i+6]=e[i+6],n[2*i+7]=e[i+7];return super.setColors(n,t),this}fromLine(e){let t=e.geometry;return this.setPositions(t.attributes.position.array),this}}class oS extends oI{constructor(e=new oM,t=new of({color:16777215*Math.random()})){super(e,t),this.isLine2=!0,this.type="Line2"}}let oT=ez.forwardRef(function({points:e,color:t=16777215,vertexColors:r,linewidth:n,lineWidth:i,segments:a,dashed:o,...s},l){var c,u;let h=(0,eL.A)(e=>e.size),d=ez.useMemo(()=>a?new oI:new oS,[a]),[f]=ez.useState(()=>new of),p=(null==r||null==(c=r[0])?void 0:c.length)===4?4:3,m=ez.useMemo(()=>{let n=a?new od:new oM,i=e.map(e=>{let t=Array.isArray(e);return e instanceof eQ.Vector3||e instanceof eQ.Vector4?[e.x,e.y,e.z]:e instanceof eQ.Vector2?[e.x,e.y,0]:t&&3===e.length?[e[0],e[1],e[2]]:t&&2===e.length?[e[0],e[1],0]:e});if(n.setPositions(i.flat()),r){t=16777215;let e=r.map(e=>e instanceof eQ.Color?e.toArray():e);n.setColors(e.flat(),p)}return n},[e,a,r,p]);return ez.useLayoutEffect(()=>{d.computeLineDistances()},[e,d]),ez.useLayoutEffect(()=>{o?f.defines.USE_DASH="":delete f.defines.USE_DASH,f.needsUpdate=!0},[o,f]),ez.useEffect(()=>()=>m.dispose(),[m]),ez.createElement("primitive",ee({object:d,ref:l},s),ez.createElement("primitive",{object:m,attach:"geometry"}),ez.createElement("primitive",ee({object:f,attach:"material",color:t,vertexColors:!!r,resolution:[h.width,h.height],linewidth:null!==(u=null!=n?n:i)&&void 0!==u?u:1,dashed:o,transparent:4===p},s)))}),oP=new eQ.Vector3,oD=ez.forwardRef(function({start:e=[0,0,0],end:t=[0,0,0],mid:r,segments:n=20,...i},a){let o=ez.useRef(null);ez.useImperativeHandle(a,()=>o.current);let[s]=ez.useState(()=>new eQ.QuadraticBezierCurve3(void 0,void 0,void 0)),l=ez.useCallback((e,t,r,n=20)=>(e instanceof eQ.Vector3?s.v0.copy(e):s.v0.set(...e),t instanceof eQ.Vector3?s.v2.copy(t):s.v2.set(...t),r instanceof eQ.Vector3?s.v1.copy(r):Array.isArray(r)?s.v1.set(...r):s.v1.copy(s.v0.clone().add(s.v2.clone().sub(s.v0)).add(oP.set(0,s.v0.y-s.v2.y,0))),s.getPoints(n)),[]);ez.useLayoutEffect(()=>{o.current.setPoints=(e,t,r)=>{let n=l(e,t,r);o.current.geometry&&o.current.geometry.setPositions(n.map(e=>e.toArray()).flat())}},[]);let c=ez.useMemo(()=>l(e,t,r,n),[e,t,r,n]);return ez.createElement(oT,ee({ref:o,points:c},i))}),oR=ez.forwardRef(function({start:e,end:t,midA:r,midB:n,segments:i=20,...a},o){let s=ez.useMemo(()=>{let a=e instanceof eQ.Vector3?e:new eQ.Vector3(...e),o=t instanceof eQ.Vector3?t:new eQ.Vector3(...t),s=r instanceof eQ.Vector3?r:new eQ.Vector3(...r),l=n instanceof eQ.Vector3?n:new eQ.Vector3(...n);return new eQ.CubicBezierCurve3(a,s,l,o).getPoints(i)},[e,t,r,n,i]);return ez.createElement(oT,ee({ref:o,points:s},a))}),oF=ez.forwardRef(function({points:e,closed:t=!1,curveType:r="centripetal",tension:n=.5,segments:i=20,vertexColors:a,...o},s){let l=ez.useMemo(()=>{let i=e.map(e=>e instanceof eQ.Vector3?e:new eQ.Vector3(...e));return new eQ.CatmullRomCurve3(i,t,r,n)},[e,t,r,n]),c=ez.useMemo(()=>l.getPoints(i),[l,i]),u=ez.useMemo(()=>{if(!a||a.length<2)return;if(a.length===i+1)return a;let e=a.map(e=>e instanceof eQ.Color?e:new eQ.Color(...e));t&&e.push(e[0].clone());let r=[e[0]],n=i/(e.length-1);for(let t=1;t<i;t++){let i=t%n/n,a=Math.floor(t/n);r.push(e[a].clone().lerp(e[a+1],i))}return r.push(e[e.length-1]),r},[a,i]);return ez.createElement(oT,ee({ref:s,points:c,vertexColors:u},o))}),oz=ez.forwardRef(({url:e,distance:t=1,loop:r=!0,autoplay:n,...i},a)=>{let o=ez.useRef(null);ez.useImperativeHandle(a,()=>o.current,[]);let s=(0,eL.A)(({camera:e})=>e),[l]=ez.useState(()=>new eQ.AudioListener),c=(0,eL.F)(eQ.AudioLoader,e);return ez.useEffect(()=>{let e=o.current;e&&(e.setBuffer(c),e.setRefDistance(t),e.setLoop(r),n&&!e.isPlaying&&e.play())},[c,s,t,r]),ez.useEffect(()=>{let e=o.current;return s.add(l),()=>{s.remove(l),e&&(e.isPlaying&&e.stop(),e.source&&e.source._connected&&e.disconnect())}},[]),ez.createElement("positionalAudio",ee({ref:o,args:[l]},i))});var oO=r(5212),oQ=r(9429);let oL=ez.forwardRef(({sdfGlyphSize:e=64,anchorX:t="center",anchorY:r="middle",font:n,fontSize:i=1,children:a,characters:o,onSync:s,...l},c)=>{let u=(0,eL.A)(({invalidate:e})=>e),[h]=ez.useState(()=>new oO.xv),[d,f]=ez.useMemo(()=>{let e=[],t="";return ez.Children.forEach(a,r=>{"string"==typeof r||"number"==typeof r?t+=r:e.push(r)}),[e,t]},[a]);return(0,oQ.Rq)(()=>new Promise(e=>(0,oO.C5)({font:n,characters:o},e)),["troika-text",n,o]),ez.useLayoutEffect(()=>void h.sync(()=>{u(),s&&s(h)})),ez.useEffect(()=>()=>h.dispose(),[h]),ez.createElement("primitive",ee({object:h,ref:c,font:n,text:f,anchorX:t,anchorY:r,fontSize:i,sdfGlyphSize:e},l),d)});class ok extends eQ.ExtrudeGeometry{constructor(e,t={}){let{bevelEnabled:r=!1,bevelSize:n=8,bevelThickness:i=10,font:a,height:o=50,size:s=100,lineHeight:l=1,letterSpacing:c=0,...u}=t;void 0===a?super():super(a.generateShapes(e,s,{lineHeight:l,letterSpacing:c}),{...u,bevelEnabled:r,bevelSize:n,bevelThickness:i,depth:o}),this.type="TextGeometry"}}function oU(e,t){if(t===eQ.TrianglesDrawMode)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),e;if(t!==eQ.TriangleFanDrawMode&&t!==eQ.TriangleStripDrawMode)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",t),e;{let r=e.getIndex();if(null===r){let t=[],n=e.getAttribute("position");if(void 0===n)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(let e=0;e<n.count;e++)t.push(e);e.setIndex(t),r=e.getIndex()}let n=r.count-2,i=[];if(r){if(t===eQ.TriangleFanDrawMode)for(let e=1;e<=n;e++)i.push(r.getX(0)),i.push(r.getX(e)),i.push(r.getX(e+1));else for(let e=0;e<n;e++)e%2==0?(i.push(r.getX(e)),i.push(r.getX(e+1)),i.push(r.getX(e+2))):(i.push(r.getX(e+2)),i.push(r.getX(e+1)),i.push(r.getX(e)))}i.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");let a=e.clone();return a.setIndex(i),a.clearGroups(),a}}function oN(e,t=Math.PI/3){let r=Math.cos(t),n=(1+1e-10)*100,i=[new eQ.Vector3,new eQ.Vector3,new eQ.Vector3],a=new eQ.Vector3,o=new eQ.Vector3,s=new eQ.Vector3,l=new eQ.Vector3;function c(e){let t=~~(e.x*n),r=~~(e.y*n),i=~~(e.z*n);return`${t},${r},${i}`}let u=e.index?e.toNonIndexed():e,h=u.attributes.position,d={};for(let e=0,t=h.count/3;e<t;e++){let t=3*e,r=i[0].fromBufferAttribute(h,t+0),n=i[1].fromBufferAttribute(h,t+1),s=i[2].fromBufferAttribute(h,t+2);a.subVectors(s,n),o.subVectors(r,n);let l=new eQ.Vector3().crossVectors(a,o).normalize();for(let e=0;e<3;e++){let t=c(i[e]);t in d||(d[t]=[]),d[t].push(l)}}let f=new Float32Array(3*h.count),p=new eQ.BufferAttribute(f,3,!1);for(let e=0,t=h.count/3;e<t;e++){let t=3*e,n=i[0].fromBufferAttribute(h,t+0),u=i[1].fromBufferAttribute(h,t+1),f=i[2].fromBufferAttribute(h,t+2);a.subVectors(f,u),o.subVectors(n,u),s.crossVectors(a,o).normalize();for(let e=0;e<3;e++){let n=d[c(i[e])];l.set(0,0,0);for(let e=0,t=n.length;e<t;e++){let t=n[e];s.dot(t)>r&&l.add(t)}l.normalize(),p.setXYZ(t+e,l.x,l.y,l.z)}}return u.setAttribute("normal",p),u}var oG=Object.defineProperty,oH=(e,t,r)=>t in e?oG(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,oV=(e,t,r)=>(oH(e,"symbol"!=typeof t?t+"":t,r),r);class oj extends eQ.Loader{constructor(e){super(e)}load(e,t,r,n){let i=new eQ.FileLoader(this.manager);i.setPath(this.path),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials),i.load(e,e=>{if("string"!=typeof e)throw Error("unsupported data type");let r=JSON.parse(e),n=this.parse(r);t&&t(n)},r,n)}loadAsync(e,t){return super.loadAsync(e,t)}parse(e){return new oY(e)}}class oY{constructor(e){oV(this,"data"),this.data=e}generateShapes(e,t=100,r){let n=[],i={letterSpacing:0,lineHeight:1,...r},a=function(e,t,r,n){let i=Array.from(e),a=t/r.resolution,o=(r.boundingBox.yMax-r.boundingBox.yMin+r.underlineThickness)*a,s=[],l=0,c=0;for(let e=0;e<i.length;e++){let t=i[e];if("\n"===t)l=0,c-=o*n.lineHeight;else{let e=function(e,t,r,n,i){let a,o,s,l,c,u,h,d;let f=i.glyphs[e]||i.glyphs["?"];if(!f){console.error('THREE.Font: character "'+e+'" does not exists in font family '+i.familyName+".");return}let p=new eQ.ShapePath;if(f.o){let e=f._cachedOutline||(f._cachedOutline=f.o.split(" "));for(let i=0,f=e.length;i<f;)switch(e[i++]){case"m":a=parseInt(e[i++])*t+r,o=parseInt(e[i++])*t+n,p.moveTo(a,o);break;case"l":a=parseInt(e[i++])*t+r,o=parseInt(e[i++])*t+n,p.lineTo(a,o);break;case"q":s=parseInt(e[i++])*t+r,l=parseInt(e[i++])*t+n,c=parseInt(e[i++])*t+r,u=parseInt(e[i++])*t+n,p.quadraticCurveTo(c,u,s,l);break;case"b":s=parseInt(e[i++])*t+r,l=parseInt(e[i++])*t+n,c=parseInt(e[i++])*t+r,u=parseInt(e[i++])*t+n,h=parseInt(e[i++])*t+r,d=parseInt(e[i++])*t+n,p.bezierCurveTo(c,u,h,d,s,l)}}return{offsetX:f.ha*t,path:p}}(t,a,l,c,r);e&&(l+=e.offsetX+n.letterSpacing,s.push(e.path))}}return s}(e,t,this.data,i);for(let e=0,t=a.length;e<t;e++)Array.prototype.push.apply(n,a[e].toShapes(!1));return n}}oV(oY,"isFont"),oV(oY,"type");let oJ=null;async function oW(e){return"string"==typeof e?await (await fetch(e)).json():e}async function oq(e){var t;return t=await oW(e),oJ||(oJ=new oj),oJ.parse(t)}function oK(e){return(0,oQ.Rq)(oq,[e])}oK.preload=e=>(0,oQ.MA)(oq,[e]),oK.clear=e=>(0,oQ.ZH)([e]);let oX=["string","number"],oZ=e=>{let t="",r=[];return ez.Children.forEach(e,e=>{oX.includes(typeof e)?t+=e+"":r.push(e)}),[t,...r]},o$=ez.forwardRef(({font:e,letterSpacing:t=0,lineHeight:r=1,size:n=1,height:i=.2,bevelThickness:a=.1,bevelSize:o=.01,bevelEnabled:s=!1,bevelOffset:l=0,bevelSegments:c=4,curveSegments:u=8,smooth:h,children:d,...f},p)=>{ez.useMemo(()=>(0,eL.e)({RenamedTextGeometry:ok}),[]);let m=ez.useRef(null),A=oK(e),g=(0,ez.useMemo)(()=>({font:A,size:n,height:i,bevelThickness:a,bevelSize:o,bevelEnabled:s,bevelSegments:c,bevelOffset:l,curveSegments:u,letterSpacing:t,lineHeight:r}),[A,n,i,a,o,s,c,l,u,t,r]),[v,...y]=(0,ez.useMemo)(()=>oZ(d),[d]),x=ez.useMemo(()=>[v,g],[v,g]);return ez.useLayoutEffect(()=>{h&&(m.current.geometry=function(e,t=1e-4){t=Math.max(t,Number.EPSILON);let r={},n=e.getIndex(),i=e.getAttribute("position"),a=n?n.count:i.count,o=0,s=Object.keys(e.attributes),l={},c={},u=[],h=["getX","getY","getZ","getW"];for(let t=0,r=s.length;t<r;t++){let r=s[t];l[r]=[];let n=e.morphAttributes[r];n&&(c[r]=Array(n.length).fill(0).map(()=>[]))}let d=Math.pow(10,Math.log10(1/t));for(let t=0;t<a;t++){let i=n?n.getX(t):t,a="";for(let t=0,r=s.length;t<r;t++){let r=s[t],n=e.getAttribute(r),o=n.itemSize;for(let e=0;e<o;e++)a+=`${~~(n[h[e]](i)*d)},`}if(a in r)u.push(r[a]);else{for(let t=0,r=s.length;t<r;t++){let r=s[t],n=e.getAttribute(r),a=e.morphAttributes[r],o=n.itemSize,u=l[r],d=c[r];for(let e=0;e<o;e++){let t=h[e];if(u.push(n[t](i)),a)for(let e=0,r=a.length;e<r;e++)d[e].push(a[e][t](i))}}r[a]=o,u.push(o),o++}}let f=e.clone();for(let t=0,r=s.length;t<r;t++){let r=s[t],n=e.getAttribute(r),i=new n.array.constructor(l[r]),a=new eQ.BufferAttribute(i,n.itemSize,n.normalized);if(f.setAttribute(r,a),r in c)for(let t=0;t<c[r].length;t++){let n=e.morphAttributes[r][t],i=new n.array.constructor(c[r][t]),a=new eQ.BufferAttribute(i,n.itemSize,n.normalized);f.morphAttributes[r][t]=a}}return f.setIndex(u),f}(m.current.geometry,h),m.current.geometry.computeVertexNormals())},[x,h]),ez.useImperativeHandle(p,()=>m.current,[]),ez.createElement("mesh",ee({},f,{ref:m}),ez.createElement("renamedTextGeometry",{args:x}),y)}),o0={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"varying vec2 vUv;\nvoid main() {\n	vUv = uv;\n	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform float opacity;\nuniform sampler2D tDiffuse;\nvarying vec2 vUv;\nvoid main() {\n	vec4 texel = texture2D( tDiffuse, vUv );\n	gl_FragColor = opacity * texel;\n}"};var o1=Object.defineProperty,o2=(e,t,r)=>t in e?o1(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,o3=(e,t,r)=>(o2(e,"symbol"!=typeof t?t+"":t,r),r);class o4{constructor(){o3(this,"enabled",!0),o3(this,"needsSwap",!0),o3(this,"clear",!1),o3(this,"renderToScreen",!1)}setSize(e,t){}render(e,t,r,n,i){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}class o5{constructor(e){o3(this,"camera",new eQ.OrthographicCamera(-1,1,1,-1,0,1)),o3(this,"geometry",new eQ.PlaneGeometry(2,2)),o3(this,"mesh"),this.mesh=new eQ.Mesh(this.geometry,e)}get material(){return this.mesh.material}set material(e){this.mesh.material=e}dispose(){this.mesh.geometry.dispose()}render(e){e.render(this.mesh,this.camera)}}var o6=Object.defineProperty,o8=(e,t,r)=>t in e?o6(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,o9=(e,t,r)=>(o8(e,"symbol"!=typeof t?t+"":t,r),r);class o7 extends o4{constructor(e,t="tDiffuse"){super(),o9(this,"textureID"),o9(this,"uniforms"),o9(this,"material"),o9(this,"fsQuad"),this.textureID=t,e instanceof eQ.ShaderMaterial?(this.uniforms=e.uniforms,this.material=e):(this.uniforms=eQ.UniformsUtils.clone(e.uniforms),this.material=new eQ.ShaderMaterial({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new o5(this.material)}render(e,t,r){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=r.texture),this.fsQuad.material=this.material,this.renderToScreen?e.setRenderTarget(null):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil)),this.fsQuad.render(e)}}var se=Object.defineProperty,st=(e,t,r)=>t in e?se(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,sr=(e,t,r)=>(st(e,"symbol"!=typeof t?t+"":t,r),r);class sn extends o4{constructor(e,t){super(),sr(this,"scene"),sr(this,"camera"),sr(this,"inverse"),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,r){let n,i;let a=e.getContext(),o=e.state;o.buffers.color.setMask(!1),o.buffers.depth.setMask(!1),o.buffers.color.setLocked(!0),o.buffers.depth.setLocked(!0),this.inverse?(n=0,i=1):(n=1,i=0),o.buffers.stencil.setTest(!0),o.buffers.stencil.setOp(a.REPLACE,a.REPLACE,a.REPLACE),o.buffers.stencil.setFunc(a.ALWAYS,n,4294967295),o.buffers.stencil.setClear(i),o.buffers.stencil.setLocked(!0),e.setRenderTarget(r),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),o.buffers.color.setLocked(!1),o.buffers.depth.setLocked(!1),o.buffers.stencil.setLocked(!1),o.buffers.stencil.setFunc(a.EQUAL,1,4294967295),o.buffers.stencil.setOp(a.KEEP,a.KEEP,a.KEEP),o.buffers.stencil.setLocked(!0)}}class si extends o4{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}var sa=Object.defineProperty,so=(e,t,r)=>t in e?sa(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ss=(e,t,r)=>(so(e,"symbol"!=typeof t?t+"":t,r),r);class sl{constructor(e,t){if(ss(this,"renderer"),ss(this,"_pixelRatio"),ss(this,"_width"),ss(this,"_height"),ss(this,"renderTarget1"),ss(this,"renderTarget2"),ss(this,"writeBuffer"),ss(this,"readBuffer"),ss(this,"renderToScreen"),ss(this,"passes",[]),ss(this,"copyPass"),ss(this,"clock"),this.renderer=e,void 0===t){let r={minFilter:eQ.LinearFilter,magFilter:eQ.LinearFilter,format:eQ.RGBAFormat},n=e.getSize(new eQ.Vector2);this._pixelRatio=e.getPixelRatio(),this._width=n.width,this._height=n.height,(t=new eQ.WebGLRenderTarget(this._width*this._pixelRatio,this._height*this._pixelRatio,r)).texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,void 0===o0&&console.error("THREE.EffectComposer relies on CopyShader"),void 0===o7&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new o7(o0),this.copyPass.material.blending=eQ.NoBlending,this.clock=new eQ.Clock}swapBuffers(){let e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){let t=this.passes.indexOf(e);-1!==t&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){void 0===e&&(e=this.clock.getDelta());let t=this.renderer.getRenderTarget(),r=!1,n=this.passes.length;for(let t=0;t<n;t++){let n=this.passes[t];if(!1!==n.enabled){if(n.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(t),n.render(this.renderer,this.writeBuffer,this.readBuffer,e,r),n.needsSwap){if(r){let t=this.renderer.getContext(),r=this.renderer.state.buffers.stencil;r.setFunc(t.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),r.setFunc(t.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==sn&&(n instanceof sn?r=!0:n instanceof si&&(r=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(void 0===e){let t=this.renderer.getSize(new eQ.Vector2);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,(e=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;let r=this._width*this._pixelRatio,n=this._height*this._pixelRatio;this.renderTarget1.setSize(r,n),this.renderTarget2.setSize(r,n);for(let e=0;e<this.passes.length;e++)this.passes[e].setSize(r,n)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}}var sc=Object.defineProperty,su=(e,t,r)=>t in e?sc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,sh=(e,t,r)=>(su(e,"symbol"!=typeof t?t+"":t,r),r);class sd extends o4{constructor(e,t,r,n,i=0){super(),sh(this,"scene"),sh(this,"camera"),sh(this,"overrideMaterial"),sh(this,"clearColor"),sh(this,"clearAlpha"),sh(this,"clearDepth",!1),sh(this,"_oldClearColor",new eQ.Color),this.scene=e,this.camera=t,this.overrideMaterial=r,this.clearColor=n,this.clearAlpha=i,this.clear=!0,this.needsSwap=!1}render(e,t,r){let n,i=e.autoClear;e.autoClear=!1;let a=null;void 0!==this.overrideMaterial&&(a=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(e.getClearColor(this._oldClearColor),n=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:r),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(this._oldClearColor,n),void 0!==this.overrideMaterial&&(this.scene.overrideMaterial=a),e.autoClear=i}}let sf={uniforms:{tDiffuse:{value:null}},vertexShader:"varying vec2 vUv;\nvoid main() {\n	vUv = uv;\n	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D tDiffuse;\nvarying vec2 vUv;\nvoid main() {\n	vec4 tex = texture2D( tDiffuse, vUv );\n	gl_FragColor = LinearTosRGB( tex );\n}"},sp=()=>{try{var e=document.createElement("canvas");return!!(window.WebGL2RenderingContext&&e.getContext("webgl2"))}catch(e){return!1}},sm=ez.forwardRef(({children:e,multisamping:t=8,renderIndex:r=1,disableRender:n,disableGamma:i,disableRenderPass:a,depthBuffer:o=!0,stencilBuffer:s=!1,anisotropy:l=1,encoding:c,type:u,...h},d)=>{ez.useMemo(()=>(0,eL.e)({EffectComposer:sl,RenderPass:sd,ShaderPass:o7}),[]);let f=ez.useRef(null);ez.useImperativeHandle(d,()=>f.current,[]);let{scene:p,camera:m,gl:A,size:g,viewport:v}=(0,eL.A)(),[y]=ez.useState(()=>{let e=new eQ.WebGLRenderTarget(g.width,g.height,{type:u||eQ.HalfFloatType,format:eQ.RGBAFormat,depthBuffer:o,stencilBuffer:s,anisotropy:l});return u===eQ.UnsignedByteType&&null!=c&&("colorSpace"in e?e.texture.colorSpace=c:e.texture.encoding=c),e.samples=t,e});ez.useEffect(()=>{var e,t;null==(e=f.current)||e.setSize(g.width,g.height),null==(t=f.current)||t.setPixelRatio(v.dpr)},[A,g,v.dpr]),(0,eL.C)(()=>{var e;n||null==(e=f.current)||e.render()},r);let x=[];return a||x.push(ez.createElement("renderPass",{key:"renderpass",attach:`passes-${x.length}`,args:[p,m]})),i||x.push(ez.createElement("shaderPass",{attach:`passes-${x.length}`,key:"gammapass",args:[sf]})),ez.Children.forEach(e,e=>{e&&x.push(ez.cloneElement(e,{key:x.length,attach:`passes-${x.length}`}))}),ez.createElement("effectComposer",ee({ref:f,args:[A,y]},h),x)}),sA=((en={}).Linear="linear",en.Radial="radial",en);function sg({stops:e,colors:t,size:r=1024,width:n=16,type:i=sA.Linear,innerCircleRadius:a=0,outerCircleRadius:o="auto",...s}){let l=(0,eL.A)(e=>e.gl),c=ez.useMemo(()=>{let s;let l=document.createElement("canvas"),c=l.getContext("2d");if(l.width=n,l.height=r,i===sA.Linear)s=c.createLinearGradient(0,0,0,r);else{let e=l.width/2,t=l.height/2,r="auto"!==o?Math.abs(Number(o)):Math.sqrt(e**2+t**2);s=c.createRadialGradient(e,t,Math.abs(a),e,t,r)}let u=new eQ.Color,h=e.length;for(;h--;)s.addColorStop(e[h],u.set(t[h]).getStyle());return c.save(),c.fillStyle=s,c.fillRect(0,0,n,r),c.restore(),l},[e]);return ez.createElement("canvasTexture",ee({colorSpace:l.outputColorSpace,args:[c],attach:"map"},s))}function sv(e,t,r,n){let i=class extends eQ.ShaderMaterial{constructor(i={}){let a=Object.entries(e);super({uniforms:a.reduce((e,[t,r])=>{let n=eQ.UniformsUtils.clone({[t]:{value:r}});return{...e,...n}},{}),vertexShader:t,fragmentShader:r}),this.key="",a.forEach(([e])=>Object.defineProperty(this,e,{get:()=>this.uniforms[e].value,set:t=>this.uniforms[e].value=t})),Object.assign(this,i),n&&n(this)}};return i.key=eQ.MathUtils.generateUUID(),i}let sy=e=>e===Object(e)&&!Array.isArray(e)&&"function"!=typeof e;function sx(e,t){let r=(0,eL.A)(e=>e.gl),n=(0,eL.F)(eQ.TextureLoader,sy(e)?Object.values(e):e);return(0,ez.useLayoutEffect)(()=>{null==t||t(n)},[t]),(0,ez.useEffect)(()=>{if("initTexture"in r){let e=[];Array.isArray(n)?e=n:n instanceof eQ.Texture?e=[n]:sy(n)&&(e=Object.values(n)),e.forEach(e=>{e instanceof eQ.Texture&&r.initTexture(e)})}},[r,n]),(0,ez.useMemo)(()=>{if(!sy(e))return n;{let t={},r=0;for(let i in e)t[i]=n[r++];return t}},[e,n])}sx.preload=e=>eL.F.preload(eQ.TextureLoader,e),sx.clear=e=>eL.F.clear(eQ.TextureLoader,e);let sE=({children:e,input:t,onLoad:r})=>{let n=sx(t,r);return ez.createElement(ez.Fragment,null,null==e?void 0:e(n))},s_=parseInt(eQ.REVISION.replace(/\D+/g,"")),sC=sv({color:new eQ.Color("white"),scale:new eQ.Vector2(1,1),imageBounds:new eQ.Vector2(1,1),resolution:1024,map:null,zoom:1,radius:0,grayscale:0,opacity:1},`
  varying vec2 vUv;
  varying vec2 vPos;
  void main() {
    gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.);
    vUv = uv;
    vPos = position.xy;
  }
`,`
  // mostly from https://gist.github.com/statico/df64c5d167362ecf7b34fca0b1459a44
  varying vec2 vUv;
  varying vec2 vPos;
  uniform vec2 scale;
  uniform vec2 imageBounds;
  uniform float resolution;
  uniform vec3 color;
  uniform sampler2D map;
  uniform float radius;
  uniform float zoom;
  uniform float grayscale;
  uniform float opacity;
  const vec3 luma = vec3(.299, 0.587, 0.114);
  vec4 toGrayscale(vec4 color, float intensity) {
    return vec4(mix(color.rgb, vec3(dot(color.rgb, luma)), intensity), color.a);
  }
  vec2 aspect(vec2 size) {
    return size / min(size.x, size.y);
  }
  
  const float PI = 3.14159265;
    
  // from https://iquilezles.org/articles/distfunctions
  float udRoundBox( vec2 p, vec2 b, float r ) {
    return length(max(abs(p)-b+r,0.0))-r;
  }

  void main() {
    vec2 s = aspect(scale);
    vec2 i = aspect(imageBounds);
    float rs = s.x / s.y;
    float ri = i.x / i.y;
    vec2 new = rs < ri ? vec2(i.x * s.y / i.y, s.y) : vec2(s.x, i.y * s.x / i.x);
    vec2 offset = (rs < ri ? vec2((new.x - s.x) / 2.0, 0.0) : vec2(0.0, (new.y - s.y) / 2.0)) / new;
    vec2 uv = vUv * s / new + offset;
    vec2 zUv = (uv - vec2(0.5, 0.5)) / zoom + vec2(0.5, 0.5);

    vec2 res = vec2(scale * resolution);
    vec2 halfRes = 0.5 * res;
    float b = udRoundBox(vUv.xy * res - halfRes, halfRes, resolution * radius);    
	  vec3 a = mix(vec3(1.0,0.0,0.0), vec3(0.0,0.0,0.0), smoothstep(0.0, 1.0, b));
    gl_FragColor = toGrayscale(texture2D(map, zUv) * vec4(color, opacity * a), grayscale);
    
    #include <tonemapping_fragment>
    #include <${s_>=154?"colorspace_fragment":"encodings_fragment"}>
  }
`),sb=ez.forwardRef(({children:e,color:t,segments:r=1,scale:n=1,zoom:i=1,grayscale:a=0,opacity:o=1,radius:s=0,texture:l,toneMapped:c,transparent:u,side:h,...d},f)=>{(0,eL.e)({ImageMaterial:sC});let p=ez.useRef(null),m=(0,eL.A)(e=>e.size),A=Array.isArray(n)?[n[0],n[1]]:[n,n],g=[l.image.width,l.image.height],v=Math.max(m.width,m.height);return ez.useImperativeHandle(f,()=>p.current,[]),ez.useLayoutEffect(()=>{p.current.geometry.parameters&&p.current.material.scale.set(A[0]*p.current.geometry.parameters.width,A[1]*p.current.geometry.parameters.height)},[]),ez.createElement("mesh",ee({ref:p,scale:Array.isArray(n)?[...n,1]:n},d),ez.createElement("planeGeometry",{args:[1,1,r,r]}),ez.createElement("imageMaterial",{color:t,map:l,zoom:i,grayscale:a,opacity:o,scale:A,imageBounds:g,resolution:v,radius:s,toneMapped:c,transparent:u,side:h,key:sC.key}),e)}),sw=ez.forwardRef(({url:e,...t},r)=>{let n=sx(e);return ez.createElement(sb,ee({},t,{texture:n,ref:r}))}),sB=ez.forwardRef(({url:e,...t},r)=>ez.createElement(sb,ee({},t,{ref:r}))),sI=ez.forwardRef((e,t)=>{if(e.url)return ez.createElement(sw,ee({},e,{ref:t}));if(e.texture)return ez.createElement(sB,ee({},e,{ref:t}));throw Error("<Image /> requires a url or texture")}),sM=ez.forwardRef(({threshold:e=15,geometry:t,...r},n)=>{let i=ez.useRef(null);ez.useImperativeHandle(n,()=>i.current,[]);let a=ez.useMemo(()=>[0,0,0,1,0,0],[]),o=ez.useRef(),s=ez.useRef();return ez.useLayoutEffect(()=>{let r=i.current.parent,n=null!=t?t:null==r?void 0:r.geometry;if(!n||o.current===n&&s.current===e)return;o.current=n,s.current=e;let a=new eQ.EdgesGeometry(n,e).attributes.position.array;i.current.geometry.setPositions(a),i.current.geometry.attributes.instanceStart.needsUpdate=!0,i.current.geometry.attributes.instanceEnd.needsUpdate=!0,i.current.computeLineDistances()}),ez.createElement(oT,ee({segments:!0,points:a,ref:i,raycast:()=>null},r))}),sS=sv({screenspace:!1,color:new eQ.Color("black"),opacity:1,thickness:.05,size:new eQ.Vector2},`#include <common>
   #include <morphtarget_pars_vertex>
   #include <skinning_pars_vertex>
   uniform float thickness;
   uniform float screenspace;
   uniform vec2 size;
   void main() {
     #if defined (USE_SKINNING)
	     #include <beginnormal_vertex>
       #include <morphnormal_vertex>
       #include <skinbase_vertex>
       #include <skinnormal_vertex>
       #include <defaultnormal_vertex>
     #endif
     #include <begin_vertex>
	   #include <morphtarget_vertex>
	   #include <skinning_vertex>
     #include <project_vertex>
     vec4 tNormal = vec4(normal, 0.0);
     vec4 tPosition = vec4(transformed, 1.0);
     #ifdef USE_INSTANCING
       tNormal = instanceMatrix * tNormal;
       tPosition = instanceMatrix * tPosition;
     #endif
     if (screenspace == 0.0) {
       vec3 newPosition = tPosition.xyz + tNormal.xyz * thickness;
       gl_Position = projectionMatrix * modelViewMatrix * vec4(newPosition, 1.0); 
     } else {
       vec4 clipPosition = projectionMatrix * modelViewMatrix * tPosition;
       vec4 clipNormal = projectionMatrix * modelViewMatrix * tNormal;
       vec2 offset = normalize(clipNormal.xy) * thickness / size * clipPosition.w * 2.0;
       clipPosition.xy += offset;
       gl_Position = clipPosition;
     }
   }`,`uniform vec3 color;
   uniform float opacity;
   void main(){
     gl_FragColor = vec4(color, opacity);
     #include <tonemapping_fragment>
     #include <${s_>=154?"colorspace_fragment":"encodings_fragment"}>
   }`);function sT({color:e="black",opacity:t=1,transparent:r=!1,screenspace:n=!1,toneMapped:i=!0,polygonOffset:a=!1,polygonOffsetFactor:o=0,renderOrder:s=0,thickness:l=.05,angle:c=Math.PI,...u}){let h=ez.useRef(),[d]=ez.useState(()=>new sS({side:eQ.BackSide})),{gl:f}=(0,eL.A)(),p=f.getDrawingBufferSize(new eQ.Vector2);ez.useMemo(()=>(0,eL.e)({OutlinesMaterial:sS}),[]);let m=ez.useRef(0),A=ez.useRef();return ez.useLayoutEffect(()=>{let e=h.current;if(!e)return;let t=e.parent;if(t&&t.geometry&&(m.current!==c||A.current!==t.geometry)){var r;m.current=c,A.current=t.geometry;let n=null==(r=e.children)?void 0:r[0];n&&(c&&n.geometry.dispose(),e.remove(n)),t.skeleton?((n=new eQ.SkinnedMesh).material=d,n.bind(t.skeleton,t.bindMatrix)):t.isInstancedMesh?(n=new eQ.InstancedMesh(t.geometry,d,t.count)).instanceMatrix=t.instanceMatrix:(n=new eQ.Mesh).material=d,e.add(n),n.geometry=c?oN(t.geometry,c):t.geometry}}),ez.useLayoutEffect(()=>{let c=h.current;if(!c)return;let u=c.children[0];u&&(u.renderOrder=s,(0,eL.j)(u.material,{transparent:r,thickness:l,color:e,opacity:t,size:p,screenspace:n,toneMapped:i,polygonOffset:a,polygonOffsetFactor:o}))}),ez.useEffect(()=>()=>{let e=h.current;if(!e)return;let t=e.children[0];t&&(c&&t.geometry.dispose(),e.remove(t))},[]),ez.createElement("group",ee({ref:h},u))}var sP=Object.defineProperty,sD=(e,t,r)=>t in e?sP(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,sR=(e,t,r)=>(sD(e,"symbol"!=typeof t?t+"":t,r),r);function sF(e,t,r,n,i){let a;if(e=e.subarray||e.slice?e:e.buffer,r=r.subarray||r.slice?r:r.buffer,e=t?e.subarray?e.subarray(t,i&&t+i):e.slice(t,i&&t+i):e,r.set)r.set(e,n);else for(a=0;a<e.length;a++)r[a+n]=e[a];return r}class sz extends eQ.BufferGeometry{constructor(){super(),sR(this,"type","MeshLine"),sR(this,"isMeshLine",!0),sR(this,"positions",[]),sR(this,"previous",[]),sR(this,"next",[]),sR(this,"side",[]),sR(this,"width",[]),sR(this,"indices_array",[]),sR(this,"uvs",[]),sR(this,"counters",[]),sR(this,"widthCallback",null),sR(this,"_attributes"),sR(this,"_points",[]),sR(this,"points"),sR(this,"matrixWorld",new eQ.Matrix4),Object.defineProperties(this,{points:{enumerable:!0,get(){return this._points},set(e){this.setPoints(e,this.widthCallback)}}})}setMatrixWorld(e){this.matrixWorld=e}setPoints(e,t){var r;if(e=(r=e)instanceof Float32Array?r:r instanceof eQ.BufferGeometry?r.getAttribute("position").array:r.map(e=>{let t=Array.isArray(e);return e instanceof eQ.Vector3?[e.x,e.y,e.z]:e instanceof eQ.Vector2?[e.x,e.y,0]:t&&3===e.length?[e[0],e[1],e[2]]:t&&2===e.length?[e[0],e[1],0]:e}).flat(),this._points=e,this.widthCallback=null!=t?t:null,this.positions=[],this.counters=[],e.length&&e[0]instanceof eQ.Vector3)for(let t=0;t<e.length;t++){let r=e[t],n=t/(e.length-1);this.positions.push(r.x,r.y,r.z),this.positions.push(r.x,r.y,r.z),this.counters.push(n),this.counters.push(n)}else for(let t=0;t<e.length;t+=3){let r=t/(e.length-1);this.positions.push(e[t],e[t+1],e[t+2]),this.positions.push(e[t],e[t+1],e[t+2]),this.counters.push(r),this.counters.push(r)}this.process()}compareV3(e,t){let r=6*e,n=6*t;return this.positions[r]===this.positions[n]&&this.positions[r+1]===this.positions[n+1]&&this.positions[r+2]===this.positions[n+2]}copyV3(e){let t=6*e;return[this.positions[t],this.positions[t+1],this.positions[t+2]]}process(){let e,t;let r=this.positions.length/6;this.previous=[],this.next=[],this.side=[],this.width=[],this.indices_array=[],this.uvs=[],t=this.compareV3(0,r-1)?this.copyV3(r-2):this.copyV3(0),this.previous.push(t[0],t[1],t[2]),this.previous.push(t[0],t[1],t[2]);for(let n=0;n<r;n++){if(this.side.push(1),this.side.push(-1),e=this.widthCallback?this.widthCallback(n/(r-1)):1,this.width.push(e),this.width.push(e),this.uvs.push(n/(r-1),0),this.uvs.push(n/(r-1),1),n<r-1){t=this.copyV3(n),this.previous.push(t[0],t[1],t[2]),this.previous.push(t[0],t[1],t[2]);let e=2*n;this.indices_array.push(e,e+1,e+2),this.indices_array.push(e+2,e+1,e+3)}n>0&&(t=this.copyV3(n),this.next.push(t[0],t[1],t[2]),this.next.push(t[0],t[1],t[2]))}t=this.compareV3(r-1,0)?this.copyV3(1):this.copyV3(r-1),this.next.push(t[0],t[1],t[2]),this.next.push(t[0],t[1],t[2]),this._attributes&&this._attributes.position.count===this.counters.length?(this._attributes.position.copyArray(new Float32Array(this.positions)),this._attributes.position.needsUpdate=!0,this._attributes.previous.copyArray(new Float32Array(this.previous)),this._attributes.previous.needsUpdate=!0,this._attributes.next.copyArray(new Float32Array(this.next)),this._attributes.next.needsUpdate=!0,this._attributes.side.copyArray(new Float32Array(this.side)),this._attributes.side.needsUpdate=!0,this._attributes.width.copyArray(new Float32Array(this.width)),this._attributes.width.needsUpdate=!0,this._attributes.uv.copyArray(new Float32Array(this.uvs)),this._attributes.uv.needsUpdate=!0,this._attributes.index.copyArray(new Uint16Array(this.indices_array)),this._attributes.index.needsUpdate=!0):this._attributes={position:new eQ.BufferAttribute(new Float32Array(this.positions),3),previous:new eQ.BufferAttribute(new Float32Array(this.previous),3),next:new eQ.BufferAttribute(new Float32Array(this.next),3),side:new eQ.BufferAttribute(new Float32Array(this.side),1),width:new eQ.BufferAttribute(new Float32Array(this.width),1),uv:new eQ.BufferAttribute(new Float32Array(this.uvs),2),index:new eQ.BufferAttribute(new Uint16Array(this.indices_array),1),counters:new eQ.BufferAttribute(new Float32Array(this.counters),1)},this.setAttribute("position",this._attributes.position),this.setAttribute("previous",this._attributes.previous),this.setAttribute("next",this._attributes.next),this.setAttribute("side",this._attributes.side),this.setAttribute("width",this._attributes.width),this.setAttribute("uv",this._attributes.uv),this.setAttribute("counters",this._attributes.counters),this.setAttribute("position",this._attributes.position),this.setAttribute("previous",this._attributes.previous),this.setAttribute("next",this._attributes.next),this.setAttribute("side",this._attributes.side),this.setAttribute("width",this._attributes.width),this.setAttribute("uv",this._attributes.uv),this.setAttribute("counters",this._attributes.counters),this.setIndex(this._attributes.index),this.computeBoundingSphere(),this.computeBoundingBox()}advance({x:e,y:t,z:r}){let n=this._attributes.position.array,i=this._attributes.previous.array,a=this._attributes.next.array,o=n.length;sF(n,0,i,0,o),sF(n,6,n,0,o-6),n[o-6]=e,n[o-5]=t,n[o-4]=r,n[o-3]=e,n[o-2]=t,n[o-1]=r,sF(n,6,a,0,o-6),a[o-6]=e,a[o-5]=t,a[o-4]=r,a[o-3]=e,a[o-2]=t,a[o-1]=r,this._attributes.position.needsUpdate=!0,this._attributes.previous.needsUpdate=!0,this._attributes.next.needsUpdate=!0}}let sO=`
  #include <common>
  #include <logdepthbuf_pars_vertex>
  #include <fog_pars_vertex>
  #include <clipping_planes_pars_vertex>

  attribute vec3 previous;
  attribute vec3 next;
  attribute float side;
  attribute float width;
  attribute float counters;
  
  uniform vec2 resolution;
  uniform float lineWidth;
  uniform vec3 color;
  uniform float opacity;
  uniform float sizeAttenuation;
  
  varying vec2 vUV;
  varying vec4 vColor;
  varying float vCounters;
  
  vec2 fix(vec4 i, float aspect) {
    vec2 res = i.xy / i.w;
    res.x *= aspect;
    return res;
  }
  
  void main() {
    float aspect = resolution.x / resolution.y;
    vColor = vec4(color, opacity);
    vUV = uv;
    vCounters = counters;
  
    mat4 m = projectionMatrix * modelViewMatrix;
    vec4 finalPosition = m * vec4(position, 1.0) * aspect;
    vec4 prevPos = m * vec4(previous, 1.0);
    vec4 nextPos = m * vec4(next, 1.0);
  
    vec2 currentP = fix(finalPosition, aspect);
    vec2 prevP = fix(prevPos, aspect);
    vec2 nextP = fix(nextPos, aspect);
  
    float w = lineWidth * width;
  
    vec2 dir;
    if (nextP == currentP) dir = normalize(currentP - prevP);
    else if (prevP == currentP) dir = normalize(nextP - currentP);
    else {
      vec2 dir1 = normalize(currentP - prevP);
      vec2 dir2 = normalize(nextP - currentP);
      dir = normalize(dir1 + dir2);
  
      vec2 perp = vec2(-dir1.y, dir1.x);
      vec2 miter = vec2(-dir.y, dir.x);
      //w = clamp(w / dot(miter, perp), 0., 4. * lineWidth * width);
    }
  
    //vec2 normal = (cross(vec3(dir, 0.), vec3(0., 0., 1.))).xy;
    vec4 normal = vec4(-dir.y, dir.x, 0., 1.);
    normal.xy *= .5 * w;
    //normal *= projectionMatrix;
    if (sizeAttenuation == 0.) {
      normal.xy *= finalPosition.w;
      normal.xy /= (vec4(resolution, 0., 1.) * projectionMatrix).xy * aspect;
    }
  
    finalPosition.xy += normal.xy * side;
    gl_Position = finalPosition;
    #include <logdepthbuf_vertex>
    #include <fog_vertex>
    vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
    #include <clipping_planes_vertex>
    #include <fog_vertex>
  }
`,sQ=parseInt(eQ.REVISION.replace(/\D+/g,"")),sL=`
  #include <fog_pars_fragment>
  #include <logdepthbuf_pars_fragment>
  #include <clipping_planes_pars_fragment>
  
  uniform sampler2D map;
  uniform sampler2D alphaMap;
  uniform float useGradient;
  uniform float useMap;
  uniform float useAlphaMap;
  uniform float useDash;
  uniform float dashArray;
  uniform float dashOffset;
  uniform float dashRatio;
  uniform float visibility;
  uniform float alphaTest;
  uniform vec2 repeat;
  uniform vec3 gradient[2];
  
  varying vec2 vUV;
  varying vec4 vColor;
  varying float vCounters;
  
  void main() {
    #include <logdepthbuf_fragment>
    vec4 diffuseColor = vColor;
    if (useGradient == 1.) diffuseColor = vec4(mix(gradient[0], gradient[1], vCounters), 1.0);
    if (useMap == 1.) diffuseColor *= texture2D(map, vUV * repeat);
    if (useAlphaMap == 1.) diffuseColor.a *= texture2D(alphaMap, vUV * repeat).a;
    if (diffuseColor.a < alphaTest) discard;
    if (useDash == 1.) diffuseColor.a *= ceil(mod(vCounters + dashOffset, dashArray) - (dashArray * dashRatio));
    diffuseColor.a *= step(vCounters, visibility);
    #include <clipping_planes_fragment>
    gl_FragColor = diffuseColor;     
    #include <fog_fragment>
    #include <tonemapping_fragment>
    #include <${sQ>=154?"colorspace_fragment":"encodings_fragment"}>
  }
`;class sk extends eQ.ShaderMaterial{constructor(e){super({uniforms:{...eQ.UniformsLib.fog,lineWidth:{value:1},map:{value:null},useMap:{value:0},alphaMap:{value:null},useAlphaMap:{value:0},color:{value:new eQ.Color(16777215)},gradient:{value:[new eQ.Color(16711680),new eQ.Color(65280)]},opacity:{value:1},resolution:{value:new eQ.Vector2(1,1)},sizeAttenuation:{value:1},dashArray:{value:0},dashOffset:{value:0},dashRatio:{value:.5},useDash:{value:0},useGradient:{value:0},visibility:{value:1},alphaTest:{value:0},repeat:{value:new eQ.Vector2(1,1)}},vertexShader:sO,fragmentShader:sL}),sR(this,"lineWidth"),sR(this,"map"),sR(this,"useMap"),sR(this,"alphaMap"),sR(this,"useAlphaMap"),sR(this,"color"),sR(this,"gradient"),sR(this,"resolution"),sR(this,"sizeAttenuation"),sR(this,"dashArray"),sR(this,"dashOffset"),sR(this,"dashRatio"),sR(this,"useDash"),sR(this,"useGradient"),sR(this,"visibility"),sR(this,"repeat"),this.type="MeshLineMaterial",Object.defineProperties(this,{lineWidth:{enumerable:!0,get(){return this.uniforms.lineWidth.value},set(e){this.uniforms.lineWidth.value=e}},map:{enumerable:!0,get(){return this.uniforms.map.value},set(e){this.uniforms.map.value=e}},useMap:{enumerable:!0,get(){return this.uniforms.useMap.value},set(e){this.uniforms.useMap.value=e}},alphaMap:{enumerable:!0,get(){return this.uniforms.alphaMap.value},set(e){this.uniforms.alphaMap.value=e}},useAlphaMap:{enumerable:!0,get(){return this.uniforms.useAlphaMap.value},set(e){this.uniforms.useAlphaMap.value=e}},color:{enumerable:!0,get(){return this.uniforms.color.value},set(e){this.uniforms.color.value=e}},gradient:{enumerable:!0,get(){return this.uniforms.gradient.value},set(e){this.uniforms.gradient.value=e}},opacity:{enumerable:!0,get(){return this.uniforms.opacity.value},set(e){this.uniforms.opacity.value=e}},resolution:{enumerable:!0,get(){return this.uniforms.resolution.value},set(e){this.uniforms.resolution.value.copy(e)}},sizeAttenuation:{enumerable:!0,get(){return this.uniforms.sizeAttenuation.value},set(e){this.uniforms.sizeAttenuation.value=e}},dashArray:{enumerable:!0,get(){return this.uniforms.dashArray.value},set(e){this.uniforms.dashArray.value=e,this.useDash=0!==e?1:0}},dashOffset:{enumerable:!0,get(){return this.uniforms.dashOffset.value},set(e){this.uniforms.dashOffset.value=e}},dashRatio:{enumerable:!0,get(){return this.uniforms.dashRatio.value},set(e){this.uniforms.dashRatio.value=e}},useDash:{enumerable:!0,get(){return this.uniforms.useDash.value},set(e){this.uniforms.useDash.value=e}},useGradient:{enumerable:!0,get(){return this.uniforms.useGradient.value},set(e){this.uniforms.useGradient.value=e}},visibility:{enumerable:!0,get(){return this.uniforms.visibility.value},set(e){this.uniforms.visibility.value=e}},alphaTest:{enumerable:!0,get(){return this.uniforms.alphaTest.value},set(e){this.uniforms.alphaTest.value=e}},repeat:{enumerable:!0,get(){return this.uniforms.repeat.value},set(e){this.uniforms.repeat.value.copy(e)}}}),this.setValues(e)}copy(e){return super.copy(e),this.lineWidth=e.lineWidth,this.map=e.map,this.useMap=e.useMap,this.alphaMap=e.alphaMap,this.useAlphaMap=e.useAlphaMap,this.color.copy(e.color),this.gradient=e.gradient,this.opacity=e.opacity,this.resolution.copy(e.resolution),this.sizeAttenuation=e.sizeAttenuation,this.dashArray=e.dashArray,this.dashOffset=e.dashOffset,this.dashRatio=e.dashRatio,this.useDash=e.useDash,this.useGradient=e.useGradient,this.visibility=e.visibility,this.alphaTest=e.alphaTest,this.repeat.copy(e.repeat),this}}let sU={width:.2,length:1,decay:1,local:!1,stride:0,interval:1},sN=(e,t=1)=>(e.set(e.subarray(t)),e.fill(-1/0,-t),e);function sG(e,t){let{length:r,local:n,decay:i,interval:a,stride:o}={...sU,...t},s=ez.useRef(),[l]=ez.useState(()=>new eQ.Vector3);ez.useLayoutEffect(()=>{e&&(s.current=Float32Array.from({length:30*r},(t,r)=>e.position.getComponent(r%3)))},[r,e]);let c=ez.useRef(new eQ.Vector3),u=ez.useRef(0);return(0,eL.C)(()=>{if(e&&s.current){if(0===u.current){let t;n?t=e.position:(e.getWorldPosition(l),t=l);let r=1*i;for(let e=0;e<r;e++)t.distanceTo(c.current)<o||(sN(s.current,3),s.current.set(t.toArray(),s.current.length-3));c.current.copy(t)}u.current++,u.current=u.current%a}}),s}let sH=ez.forwardRef((e,t)=>{let{children:r}=e,{width:n,length:i,decay:a,local:o,stride:s,interval:l}={...sU,...e},{color:c="hotpink",attenuation:u,target:h}=e,d=(0,eL.A)(e=>e.size),f=(0,eL.A)(e=>e.scene),p=ez.useRef(null),[m,A]=ez.useState(null),g=sG(m,{length:i,decay:a,local:o,stride:s,interval:l});ez.useEffect(()=>{let e=(null==h?void 0:h.current)||p.current.children.find(e=>e instanceof eQ.Object3D);e&&A(e)},[g,h]);let v=ez.useMemo(()=>new sz,[]),y=ez.useMemo(()=>{var e;let t;let i=new sk({lineWidth:.1*n,color:c,sizeAttenuation:1,resolution:new eQ.Vector2(d.width,d.height)});return r&&(Array.isArray(r)?t=r.find(e=>"string"==typeof e.type&&"meshLineMaterial"===e.type):"string"==typeof r.type&&"meshLineMaterial"===r.type&&(t=r)),"object"==typeof(null==(e=t)?void 0:e.props)&&i.setValues(t.props),i},[n,c,d,r]);return ez.useEffect(()=>{y.uniforms.resolution.value.set(d.width,d.height)},[d]),(0,eL.C)(()=>{g.current&&v.setPoints(g.current,u)}),ez.createElement("group",null,(0,eL.g)(ez.createElement("mesh",{ref:t,geometry:v,material:y}),f),ez.createElement("group",{ref:p},r))}),sV=new eQ.Triangle,sj=new eQ.Vector3;class sY{constructor(e){let t=e.geometry;t.index&&(console.warn("THREE.MeshSurfaceSampler: Converting geometry to non-indexed BufferGeometry."),t=t.toNonIndexed()),this.geometry=t,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.colorAttribute=this.geometry.getAttribute("color"),this.weightAttribute=null,this.distribution=null}setWeightAttribute(e){return this.weightAttribute=e?this.geometry.getAttribute(e):null,this}build(){let e=this.positionAttribute,t=this.weightAttribute,r=new Float32Array(e.count/3);for(let n=0;n<e.count;n+=3){let i=1;t&&(i=t.getX(n)+t.getX(n+1)+t.getX(n+2)),sV.a.fromBufferAttribute(e,n),sV.b.fromBufferAttribute(e,n+1),sV.c.fromBufferAttribute(e,n+2),i*=sV.getArea(),r[n/3]=i}this.distribution=new Float32Array(e.count/3);let n=0;for(let e=0;e<r.length;e++)n+=r[e],this.distribution[e]=n;return this}setRandomGenerator(e){return this.randomFunction=e,this}sample(e,t,r){let n=this.sampleFaceIndex();return this.sampleFace(n,e,t,r)}sampleFaceIndex(){let e=this.distribution[this.distribution.length-1];return this.binarySearch(this.randomFunction()*e)}binarySearch(e){let t=this.distribution,r=0,n=t.length-1,i=-1;for(;r<=n;){let a=Math.ceil((r+n)/2);if(0===a||t[a-1]<=e&&t[a]>e){i=a;break}e<t[a]?n=a-1:r=a+1}return i}sampleFace(e,t,r,n){let i=this.randomFunction(),a=this.randomFunction();return i+a>1&&(i=1-i,a=1-a),sV.a.fromBufferAttribute(this.positionAttribute,3*e),sV.b.fromBufferAttribute(this.positionAttribute,3*e+1),sV.c.fromBufferAttribute(this.positionAttribute,3*e+2),t.set(0,0,0).addScaledVector(sV.a,i).addScaledVector(sV.b,a).addScaledVector(sV.c,1-(i+a)),void 0!==r&&sV.getNormal(r),void 0!==n&&void 0!==this.colorAttribute&&(sV.a.fromBufferAttribute(this.colorAttribute,3*e),sV.b.fromBufferAttribute(this.colorAttribute,3*e+1),sV.c.fromBufferAttribute(this.colorAttribute,3*e+2),sj.set(0,0,0).addScaledVector(sV.a,i).addScaledVector(sV.b,a).addScaledVector(sV.c,1-(i+a)),n.r=sj.x,n.g=sj.y,n.b=sj.z),this}}function sJ(e,t=16,r,n,i){let[a,o]=ez.useState(()=>{let e=Array.from({length:t},()=>[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]).flat();return new eQ.InstancedBufferAttribute(Float32Array.from(e),16)});return ez.useLayoutEffect(()=>{if(void 0===e.current)return;let s=new sY(e.current);n&&s.setWeightAttribute(n),s.build();let l=new eQ.Vector3,c=new eQ.Vector3,u=new eQ.Color,h=new eQ.Object3D;e.current.updateMatrixWorld(!0);for(let n=0;n<t;n++)s.sample(l,c,u),"function"==typeof r?r({dummy:h,sampledMesh:e.current,position:l,normal:c,color:u},n):h.position.copy(l),h.updateMatrix(),null!=i&&i.current&&i.current.setMatrixAt(n,h.matrix),h.matrix.toArray(a.array,16*n);null!=i&&i.current&&(i.current.instanceMatrix.needsUpdate=!0),a.needsUpdate=!0,o(new eQ.InstancedBufferAttribute(a.array,a.itemSize).copy(a))},[e,i,n,t,r]),a}function sW({children:e,weight:t,transform:r,instances:n,mesh:i,count:a=16,...o}){let s=ez.useRef(null),l=ez.useRef(null),c=ez.useRef(null);return ez.useLayoutEffect(()=>{var e,t;l.current=null!==(e=null==n?void 0:n.current)&&void 0!==e?e:s.current.children.find(e=>e.hasOwnProperty("instanceMatrix")),c.current=null!==(t=null==i?void 0:i.current)&&void 0!==t?t:s.current.children.find(e=>"Mesh"===e.type)},[e,null==i?void 0:i.current,null==n?void 0:n.current]),sJ(c,a,r,t,l),ez.createElement("group",ee({ref:s},o),e)}let sq=({compute:e,name:t,...r})=>{let[n]=ez.useState(()=>new eQ.BufferAttribute(new Float32Array(0),1)),i=ez.useRef(null);return ez.useLayoutEffect(()=>{if(i.current){var t;let r=e(null!==(t=i.current.parent)&&void 0!==t?t:i.current.__r3f.parent);i.current.copy(r)}},[e]),ez.createElement("primitive",ee({ref:i,object:n,attach:`attributes-${t}`},r))},sK={clone:function(e){let t=new Map,r=new Map,n=e.clone();return function e(t,r,n){n(t,r);for(let i=0;i<t.children.length;i++)e(t.children[i],r.children[i],n)}(e,n,function(e,n){t.set(n,e),r.set(e,n)}),n.traverse(function(e){if(!e.isSkinnedMesh)return;let n=t.get(e),i=n.skeleton.bones;e.skeleton=n.skeleton.clone(),e.bindMatrix.copy(n.bindMatrix),e.skeleton.bones=i.map(function(e){return r.get(e)}),e.bind(e.skeleton,e.bindMatrix)}),n}},sX=ez.forwardRef(({isChild:e=!1,object:t,children:r,deep:n,castShadow:i,receiveShadow:a,inject:o,keys:s,...l},c)=>{let u={keys:s,deep:n,inject:o,castShadow:i,receiveShadow:a};if(Array.isArray(t=ez.useMemo(()=>{if(!1===e&&!Array.isArray(t)){let e=!1;if(t.traverse(t=>{t.isSkinnedMesh&&(e=!0)}),e)return sK.clone(t)}return t},[t,e])))return ez.createElement("group",ee({},l,{ref:c}),t.map(e=>ez.createElement(sX,ee({key:e.uuid,object:e},u))),r);let{children:h,...d}=function(e,{keys:t=["near","far","color","distance","decay","penumbra","angle","intensity","skeleton","visible","castShadow","receiveShadow","morphTargetDictionary","morphTargetInfluences","name","geometry","material","position","rotation","scale","up","userData","bindMode","bindMatrix","bindMatrixInverse","skeleton"],deep:r,inject:n,castShadow:i,receiveShadow:a}){let o={};for(let r of t)o[r]=e[r];return r&&(o.geometry&&"materialsOnly"!==r&&(o.geometry=o.geometry.clone()),o.material&&"geometriesOnly"!==r&&(o.material=o.material.clone())),n&&(o="function"==typeof n?{...o,children:n(e)}:ez.isValidElement(n)?{...o,children:n}:{...o,...n}),e instanceof eQ.Mesh&&(i&&(o.castShadow=!0),a&&(o.receiveShadow=!0)),o}(t,u),f=t.type[0].toLowerCase()+t.type.slice(1);return ez.createElement(f,ee({},d,l,{ref:c}),t.children.map(e=>"Bone"===e.type?ez.createElement("primitive",ee({key:e.uuid,object:e},u)):ez.createElement(sX,ee({key:e.uuid,object:e},u,{isChild:!0}))),r,h)});class sZ extends eQ.Mesh{constructor(e,t,r=!1,n=!1,i=1e4){let a=new eQ.BufferGeometry;super(a,t),this.isMarchingCubes=!0;let o=this,s=new Float32Array(36),l=new Float32Array(36),c=new Float32Array(36);function u(e,t,r,n,i,a,u,h,d,f){var p,m,A,g,v,y;let x=(r-u)/(h-u),E=o.normal_cache;s[t+0]=n+x*o.delta,s[t+1]=i,s[t+2]=a,l[t+0]=(p=E[e+0])+(E[e+3]-p)*x,l[t+1]=(m=E[e+1])+(E[e+4]-m)*x,l[t+2]=(A=E[e+2])+(E[e+5]-A)*x,c[t+0]=(g=o.palette[3*d+0])+(o.palette[3*f+0]-g)*x,c[t+1]=(v=o.palette[3*d+1])+(o.palette[3*f+1]-v)*x,c[t+2]=(y=o.palette[3*d+2])+(o.palette[3*f+2]-y)*x}function h(e,t,r,n,i,a,u,h,d,f){var p,m,A,g,v,y;let x=(r-u)/(h-u),E=o.normal_cache;s[t+0]=n,s[t+1]=i+x*o.delta,s[t+2]=a;let _=e+3*o.yd;l[t+0]=(p=E[e+0])+(E[_+0]-p)*x,l[t+1]=(m=E[e+1])+(E[_+1]-m)*x,l[t+2]=(A=E[e+2])+(E[_+2]-A)*x,c[t+0]=(g=o.palette[3*d+0])+(o.palette[3*f+0]-g)*x,c[t+1]=(v=o.palette[3*d+1])+(o.palette[3*f+1]-v)*x,c[t+2]=(y=o.palette[3*d+2])+(o.palette[3*f+2]-y)*x}function d(e,t,r,n,i,a,u,h,d,f){var p,m,A,g,v,y;let x=(r-u)/(h-u),E=o.normal_cache;s[t+0]=n,s[t+1]=i,s[t+2]=a+x*o.delta;let _=e+3*o.zd;l[t+0]=(p=E[e+0])+(E[_+0]-p)*x,l[t+1]=(m=E[e+1])+(E[_+1]-m)*x,l[t+2]=(A=E[e+2])+(E[_+2]-A)*x,c[t+0]=(g=o.palette[3*d+0])+(o.palette[3*f+0]-g)*x,c[t+1]=(v=o.palette[3*d+1])+(o.palette[3*f+1]-v)*x,c[t+2]=(y=o.palette[3*d+2])+(o.palette[3*f+2]-y)*x}function f(e){let t=3*e;0===o.normal_cache[t]&&(o.normal_cache[t+0]=o.field[e-1]-o.field[e+1],o.normal_cache[t+1]=o.field[e-o.yd]-o.field[e+o.yd],o.normal_cache[t+2]=o.field[e-o.zd]-o.field[e+o.zd])}this.enableUvs=r,this.enableColors=n,this.init=function(e){this.resolution=e,this.isolation=80,this.size=e,this.size2=this.size*this.size,this.size3=this.size2*this.size,this.halfsize=this.size/2,this.delta=2/this.size,this.yd=this.size,this.zd=this.size2,this.field=new Float32Array(this.size3),this.normal_cache=new Float32Array(3*this.size3),this.palette=new Float32Array(3*this.size3),this.count=0;let t=3*i;this.positionArray=new Float32Array(3*t);let r=new eQ.BufferAttribute(this.positionArray,3);r.setUsage(eQ.DynamicDrawUsage),a.setAttribute("position",r),this.normalArray=new Float32Array(3*t);let n=new eQ.BufferAttribute(this.normalArray,3);if(n.setUsage(eQ.DynamicDrawUsage),a.setAttribute("normal",n),this.enableUvs){this.uvArray=new Float32Array(2*t);let e=new eQ.BufferAttribute(this.uvArray,2);e.setUsage(eQ.DynamicDrawUsage),a.setAttribute("uv",e)}if(this.enableColors){this.colorArray=new Float32Array(3*t);let e=new eQ.BufferAttribute(this.colorArray,3);e.setUsage(eQ.DynamicDrawUsage),a.setAttribute("color",e)}a.boundingSphere=new eQ.Sphere(new eQ.Vector3,1)},this.addBall=function(e,t,r,n,i,a){let o,s,l,c,u,h,d,f,p,m,A;let g=Math.sign(n);n=Math.abs(n);let v=null!=a,y=new eQ.Color(e,t,r);if(v)try{y=a instanceof eQ.Color?a:Array.isArray(a)?new eQ.Color(Math.min(Math.abs(a[0]),1),Math.min(Math.abs(a[1]),1),Math.min(Math.abs(a[2]),1)):new eQ.Color(a)}catch(n){y=new eQ.Color(e,t,r)}let x=this.size*Math.sqrt(n/i),E=r*this.size,_=t*this.size,C=e*this.size,b=Math.floor(E-x);b<1&&(b=1);let w=Math.floor(E+x);w>this.size-1&&(w=this.size-1);let B=Math.floor(_-x);B<1&&(B=1);let I=Math.floor(_+x);I>this.size-1&&(I=this.size-1);let M=Math.floor(C-x);M<1&&(M=1);let S=Math.floor(C+x);for(S>this.size-1&&(S=this.size-1),l=b;l<w;l++)for(u=this.size2*l,p=(f=l/this.size-r)*f,s=B;s<I;s++)for(c=u+this.size*s,m=(d=s/this.size-t)*d,o=M;o<S;o++)if((A=n/(1e-6+(h=o/this.size-e)*h+m+p)-i)>0){this.field[c+o]+=A*g;let e=Math.sqrt((o-C)*(o-C)+(s-_)*(s-_)+(l-E)*(l-E))/x,t=1-e*e*e*(e*(6*e-15)+10);this.palette[(c+o)*3+0]+=y.r*t,this.palette[(c+o)*3+1]+=y.g*t,this.palette[(c+o)*3+2]+=y.b*t}},this.addPlaneX=function(e,t){let r=this.size,n=this.yd,i=this.zd,a=this.field,o,s,l,c,u,h,d=r*Math.sqrt(e/t);for(d>r&&(d=r),o=0;o<d;o++)if((c=e/(1e-4+(u=o/r)*u)-t)>0)for(s=0;s<r;s++)for(l=0,h=o+s*n;l<r;l++)a[i*l+h]+=c},this.addPlaneY=function(e,t){let r=this.size,n=this.yd,i=this.zd,a=this.field,o,s,l,c,u,h,d,f=r*Math.sqrt(e/t);for(f>r&&(f=r),s=0;s<f;s++)if((c=e/(1e-4+(u=s/r)*u)-t)>0)for(o=0,h=s*n;o<r;o++)for(l=0,d=h+o;l<r;l++)a[i*l+d]+=c},this.addPlaneZ=function(e,t){let r=this.size,n=this.yd,i=this.zd,a=this.field,o,s,l,c,u,h,d,f=r*Math.sqrt(e/t);for(f>r&&(f=r),l=0;l<f;l++)if((c=e/(1e-4+(u=l/r)*u)-t)>0)for(s=0,h=i*l;s<r;s++)for(o=0,d=h+s*n;o<r;o++)a[d+o]+=c},this.setCell=function(e,t,r,n){let i=this.size2*r+this.size*t+e;this.field[i]=n},this.getCell=function(e,t,r){let n=this.size2*r+this.size*t+e;return this.field[n]},this.blur=function(e=1){let t=this.field,r=t.slice(),n=this.size,i=this.size2;for(let a=0;a<n;a++)for(let o=0;o<n;o++)for(let s=0;s<n;s++){let l=i*s+n*o+a,c=r[l],u=1;for(let t=-1;t<=1;t+=2){let l=t+a;if(!(l<0)&&!(l>=n))for(let t=-1;t<=1;t+=2){let a=t+o;if(!(a<0)&&!(a>=n))for(let t=-1;t<=1;t+=2){let o=t+s;if(o<0||o>=n)continue;let h=r[i*o+n*a+l];u++,c+=e*(h-c)/u}}}t[l]=c}},this.reset=function(){for(let e=0;e<this.size3;e++)this.normal_cache[3*e]=0,this.field[e]=0,this.palette[3*e]=this.palette[3*e+1]=this.palette[3*e+2]=0},this.update=function(){this.count=0;let e=this.size-2;for(let t=1;t<e;t++){let r=this.size2*t,n=(t-this.halfsize)/this.halfsize;for(let t=1;t<e;t++){let i=r+this.size*t,a=(t-this.halfsize)/this.halfsize;for(let t=1;t<e;t++)!function(e,t,r,n,i){let a=n+1,p=n+o.yd,m=n+o.zd,A=a+o.yd,g=a+o.zd,v=n+o.yd+o.zd,y=a+o.yd+o.zd,x=0,E=o.field[n],_=o.field[a],C=o.field[p],b=o.field[A],w=o.field[m],B=o.field[g],I=o.field[v],M=o.field[y];E<i&&(x|=1),_<i&&(x|=2),C<i&&(x|=8),b<i&&(x|=4),w<i&&(x|=16),B<i&&(x|=32),I<i&&(x|=128),M<i&&(x|=64);let S=s$[x];if(0===S)return;let T=o.delta,P=e+T,D=t+T,R=r+T;1&S&&(f(n),f(a),u(3*n,0,i,e,t,r,E,_,n,a)),2&S&&(f(a),f(A),h(3*a,3,i,P,t,r,_,b,a,A)),4&S&&(f(p),f(A),u(3*p,6,i,e,D,r,C,b,p,A)),8&S&&(f(n),f(p),h(3*n,9,i,e,t,r,E,C,n,p)),16&S&&(f(m),f(g),u(3*m,12,i,e,t,R,w,B,m,g)),32&S&&(f(g),f(y),h(3*g,15,i,P,t,R,B,M,g,y)),64&S&&(f(v),f(y),u(3*v,18,i,e,D,R,I,M,v,y)),128&S&&(f(m),f(v),h(3*m,21,i,e,t,R,w,I,m,v)),256&S&&(f(n),f(m),d(3*n,24,i,e,t,r,E,w,n,m)),512&S&&(f(a),f(g),d(3*a,27,i,P,t,r,_,B,a,g)),1024&S&&(f(A),f(y),d(3*A,30,i,P,D,r,b,M,A,y)),2048&S&&(f(p),f(v),d(3*p,33,i,e,D,r,C,I,p,v)),x<<=4;let F,z,O,Q=0;for(;-1!=s0[x+Q];)z=(F=x+Q)+1,O=F+2,function(e,t,r,n,i,a){let s=3*o.count;if(o.positionArray[s+0]=e[n],o.positionArray[s+1]=e[n+1],o.positionArray[s+2]=e[n+2],o.positionArray[s+3]=e[i],o.positionArray[s+4]=e[i+1],o.positionArray[s+5]=e[i+2],o.positionArray[s+6]=e[a],o.positionArray[s+7]=e[a+1],o.positionArray[s+8]=e[a+2],!0===o.material.flatShading){let e=(t[n+0]+t[i+0]+t[a+0])/3,r=(t[n+1]+t[i+1]+t[a+1])/3,l=(t[n+2]+t[i+2]+t[a+2])/3;o.normalArray[s+0]=e,o.normalArray[s+1]=r,o.normalArray[s+2]=l,o.normalArray[s+3]=e,o.normalArray[s+4]=r,o.normalArray[s+5]=l,o.normalArray[s+6]=e,o.normalArray[s+7]=r,o.normalArray[s+8]=l}else o.normalArray[s+0]=t[n+0],o.normalArray[s+1]=t[n+1],o.normalArray[s+2]=t[n+2],o.normalArray[s+3]=t[i+0],o.normalArray[s+4]=t[i+1],o.normalArray[s+5]=t[i+2],o.normalArray[s+6]=t[a+0],o.normalArray[s+7]=t[a+1],o.normalArray[s+8]=t[a+2];if(o.enableUvs){let t=2*o.count;o.uvArray[t+0]=e[n+0],o.uvArray[t+1]=e[n+2],o.uvArray[t+2]=e[i+0],o.uvArray[t+3]=e[i+2],o.uvArray[t+4]=e[a+0],o.uvArray[t+5]=e[a+2]}o.enableColors&&(o.colorArray[s+0]=r[n+0],o.colorArray[s+1]=r[n+1],o.colorArray[s+2]=r[n+2],o.colorArray[s+3]=r[i+0],o.colorArray[s+4]=r[i+1],o.colorArray[s+5]=r[i+2],o.colorArray[s+6]=r[a+0],o.colorArray[s+7]=r[a+1],o.colorArray[s+8]=r[a+2]),o.count+=3}(s,l,c,3*s0[F],3*s0[z],3*s0[O]),Q+=3}((t-this.halfsize)/this.halfsize,a,n,i+t,this.isolation)}}this.geometry.setDrawRange(0,this.count),a.getAttribute("position").needsUpdate=!0,a.getAttribute("normal").needsUpdate=!0,this.enableUvs&&(a.getAttribute("uv").needsUpdate=!0),this.enableColors&&(a.getAttribute("color").needsUpdate=!0),this.count/3>i&&console.warn("THREE.MarchingCubes: Geometry buffers too small for rendering. Please create an instance with a higher poly count.")},this.init(e)}}let s$=new Int32Array([0,265,515,778,1030,1295,1541,1804,2060,2309,2575,2822,3082,3331,3593,3840,400,153,915,666,1430,1183,1941,1692,2460,2197,2975,2710,3482,3219,3993,3728,560,825,51,314,1590,1855,1077,1340,2620,2869,2111,2358,3642,3891,3129,3376,928,681,419,170,1958,1711,1445,1196,2988,2725,2479,2214,4010,3747,3497,3232,1120,1385,1635,1898,102,367,613,876,3180,3429,3695,3942,2154,2403,2665,2912,1520,1273,2035,1786,502,255,1013,764,3580,3317,4095,3830,2554,2291,3065,2800,1616,1881,1107,1370,598,863,85,348,3676,3925,3167,3414,2650,2899,2137,2384,1984,1737,1475,1226,966,719,453,204,4044,3781,3535,3270,3018,2755,2505,2240,2240,2505,2755,3018,3270,3535,3781,4044,204,453,719,966,1226,1475,1737,1984,2384,2137,2899,2650,3414,3167,3925,3676,348,85,863,598,1370,1107,1881,1616,2800,3065,2291,2554,3830,4095,3317,3580,764,1013,255,502,1786,2035,1273,1520,2912,2665,2403,2154,3942,3695,3429,3180,876,613,367,102,1898,1635,1385,1120,3232,3497,3747,4010,2214,2479,2725,2988,1196,1445,1711,1958,170,419,681,928,3376,3129,3891,3642,2358,2111,2869,2620,1340,1077,1855,1590,314,51,825,560,3728,3993,3219,3482,2710,2975,2197,2460,1692,1941,1183,1430,666,915,153,400,3840,3593,3331,3082,2822,2575,2309,2060,1804,1541,1295,1030,778,515,265,0]),s0=new Int32Array([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,8,3,9,8,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,1,2,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,2,10,0,2,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,8,3,2,10,8,10,9,8,-1,-1,-1,-1,-1,-1,-1,3,11,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,11,2,8,11,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,0,2,3,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,11,2,1,9,11,9,8,11,-1,-1,-1,-1,-1,-1,-1,3,10,1,11,10,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,10,1,0,8,10,8,11,10,-1,-1,-1,-1,-1,-1,-1,3,9,0,3,11,9,11,10,9,-1,-1,-1,-1,-1,-1,-1,9,8,10,10,8,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,7,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,3,0,7,3,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,8,4,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,1,9,4,7,1,7,3,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,8,4,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,4,7,3,0,4,1,2,10,-1,-1,-1,-1,-1,-1,-1,9,2,10,9,0,2,8,4,7,-1,-1,-1,-1,-1,-1,-1,2,10,9,2,9,7,2,7,3,7,9,4,-1,-1,-1,-1,8,4,7,3,11,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,4,7,11,2,4,2,0,4,-1,-1,-1,-1,-1,-1,-1,9,0,1,8,4,7,2,3,11,-1,-1,-1,-1,-1,-1,-1,4,7,11,9,4,11,9,11,2,9,2,1,-1,-1,-1,-1,3,10,1,3,11,10,7,8,4,-1,-1,-1,-1,-1,-1,-1,1,11,10,1,4,11,1,0,4,7,11,4,-1,-1,-1,-1,4,7,8,9,0,11,9,11,10,11,0,3,-1,-1,-1,-1,4,7,11,4,11,9,9,11,10,-1,-1,-1,-1,-1,-1,-1,9,5,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,5,4,0,8,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,5,4,1,5,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,5,4,8,3,5,3,1,5,-1,-1,-1,-1,-1,-1,-1,1,2,10,9,5,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,8,1,2,10,4,9,5,-1,-1,-1,-1,-1,-1,-1,5,2,10,5,4,2,4,0,2,-1,-1,-1,-1,-1,-1,-1,2,10,5,3,2,5,3,5,4,3,4,8,-1,-1,-1,-1,9,5,4,2,3,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,11,2,0,8,11,4,9,5,-1,-1,-1,-1,-1,-1,-1,0,5,4,0,1,5,2,3,11,-1,-1,-1,-1,-1,-1,-1,2,1,5,2,5,8,2,8,11,4,8,5,-1,-1,-1,-1,10,3,11,10,1,3,9,5,4,-1,-1,-1,-1,-1,-1,-1,4,9,5,0,8,1,8,10,1,8,11,10,-1,-1,-1,-1,5,4,0,5,0,11,5,11,10,11,0,3,-1,-1,-1,-1,5,4,8,5,8,10,10,8,11,-1,-1,-1,-1,-1,-1,-1,9,7,8,5,7,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,3,0,9,5,3,5,7,3,-1,-1,-1,-1,-1,-1,-1,0,7,8,0,1,7,1,5,7,-1,-1,-1,-1,-1,-1,-1,1,5,3,3,5,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,7,8,9,5,7,10,1,2,-1,-1,-1,-1,-1,-1,-1,10,1,2,9,5,0,5,3,0,5,7,3,-1,-1,-1,-1,8,0,2,8,2,5,8,5,7,10,5,2,-1,-1,-1,-1,2,10,5,2,5,3,3,5,7,-1,-1,-1,-1,-1,-1,-1,7,9,5,7,8,9,3,11,2,-1,-1,-1,-1,-1,-1,-1,9,5,7,9,7,2,9,2,0,2,7,11,-1,-1,-1,-1,2,3,11,0,1,8,1,7,8,1,5,7,-1,-1,-1,-1,11,2,1,11,1,7,7,1,5,-1,-1,-1,-1,-1,-1,-1,9,5,8,8,5,7,10,1,3,10,3,11,-1,-1,-1,-1,5,7,0,5,0,9,7,11,0,1,0,10,11,10,0,-1,11,10,0,11,0,3,10,5,0,8,0,7,5,7,0,-1,11,10,5,7,11,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,6,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,5,10,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,0,1,5,10,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,8,3,1,9,8,5,10,6,-1,-1,-1,-1,-1,-1,-1,1,6,5,2,6,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,6,5,1,2,6,3,0,8,-1,-1,-1,-1,-1,-1,-1,9,6,5,9,0,6,0,2,6,-1,-1,-1,-1,-1,-1,-1,5,9,8,5,8,2,5,2,6,3,2,8,-1,-1,-1,-1,2,3,11,10,6,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,0,8,11,2,0,10,6,5,-1,-1,-1,-1,-1,-1,-1,0,1,9,2,3,11,5,10,6,-1,-1,-1,-1,-1,-1,-1,5,10,6,1,9,2,9,11,2,9,8,11,-1,-1,-1,-1,6,3,11,6,5,3,5,1,3,-1,-1,-1,-1,-1,-1,-1,0,8,11,0,11,5,0,5,1,5,11,6,-1,-1,-1,-1,3,11,6,0,3,6,0,6,5,0,5,9,-1,-1,-1,-1,6,5,9,6,9,11,11,9,8,-1,-1,-1,-1,-1,-1,-1,5,10,6,4,7,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,3,0,4,7,3,6,5,10,-1,-1,-1,-1,-1,-1,-1,1,9,0,5,10,6,8,4,7,-1,-1,-1,-1,-1,-1,-1,10,6,5,1,9,7,1,7,3,7,9,4,-1,-1,-1,-1,6,1,2,6,5,1,4,7,8,-1,-1,-1,-1,-1,-1,-1,1,2,5,5,2,6,3,0,4,3,4,7,-1,-1,-1,-1,8,4,7,9,0,5,0,6,5,0,2,6,-1,-1,-1,-1,7,3,9,7,9,4,3,2,9,5,9,6,2,6,9,-1,3,11,2,7,8,4,10,6,5,-1,-1,-1,-1,-1,-1,-1,5,10,6,4,7,2,4,2,0,2,7,11,-1,-1,-1,-1,0,1,9,4,7,8,2,3,11,5,10,6,-1,-1,-1,-1,9,2,1,9,11,2,9,4,11,7,11,4,5,10,6,-1,8,4,7,3,11,5,3,5,1,5,11,6,-1,-1,-1,-1,5,1,11,5,11,6,1,0,11,7,11,4,0,4,11,-1,0,5,9,0,6,5,0,3,6,11,6,3,8,4,7,-1,6,5,9,6,9,11,4,7,9,7,11,9,-1,-1,-1,-1,10,4,9,6,4,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,10,6,4,9,10,0,8,3,-1,-1,-1,-1,-1,-1,-1,10,0,1,10,6,0,6,4,0,-1,-1,-1,-1,-1,-1,-1,8,3,1,8,1,6,8,6,4,6,1,10,-1,-1,-1,-1,1,4,9,1,2,4,2,6,4,-1,-1,-1,-1,-1,-1,-1,3,0,8,1,2,9,2,4,9,2,6,4,-1,-1,-1,-1,0,2,4,4,2,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,2,8,2,4,4,2,6,-1,-1,-1,-1,-1,-1,-1,10,4,9,10,6,4,11,2,3,-1,-1,-1,-1,-1,-1,-1,0,8,2,2,8,11,4,9,10,4,10,6,-1,-1,-1,-1,3,11,2,0,1,6,0,6,4,6,1,10,-1,-1,-1,-1,6,4,1,6,1,10,4,8,1,2,1,11,8,11,1,-1,9,6,4,9,3,6,9,1,3,11,6,3,-1,-1,-1,-1,8,11,1,8,1,0,11,6,1,9,1,4,6,4,1,-1,3,11,6,3,6,0,0,6,4,-1,-1,-1,-1,-1,-1,-1,6,4,8,11,6,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,10,6,7,8,10,8,9,10,-1,-1,-1,-1,-1,-1,-1,0,7,3,0,10,7,0,9,10,6,7,10,-1,-1,-1,-1,10,6,7,1,10,7,1,7,8,1,8,0,-1,-1,-1,-1,10,6,7,10,7,1,1,7,3,-1,-1,-1,-1,-1,-1,-1,1,2,6,1,6,8,1,8,9,8,6,7,-1,-1,-1,-1,2,6,9,2,9,1,6,7,9,0,9,3,7,3,9,-1,7,8,0,7,0,6,6,0,2,-1,-1,-1,-1,-1,-1,-1,7,3,2,6,7,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,11,10,6,8,10,8,9,8,6,7,-1,-1,-1,-1,2,0,7,2,7,11,0,9,7,6,7,10,9,10,7,-1,1,8,0,1,7,8,1,10,7,6,7,10,2,3,11,-1,11,2,1,11,1,7,10,6,1,6,7,1,-1,-1,-1,-1,8,9,6,8,6,7,9,1,6,11,6,3,1,3,6,-1,0,9,1,11,6,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,8,0,7,0,6,3,11,0,11,6,0,-1,-1,-1,-1,7,11,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,8,11,7,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,11,7,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,1,9,8,3,1,11,7,6,-1,-1,-1,-1,-1,-1,-1,10,1,2,6,11,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,10,3,0,8,6,11,7,-1,-1,-1,-1,-1,-1,-1,2,9,0,2,10,9,6,11,7,-1,-1,-1,-1,-1,-1,-1,6,11,7,2,10,3,10,8,3,10,9,8,-1,-1,-1,-1,7,2,3,6,2,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,0,8,7,6,0,6,2,0,-1,-1,-1,-1,-1,-1,-1,2,7,6,2,3,7,0,1,9,-1,-1,-1,-1,-1,-1,-1,1,6,2,1,8,6,1,9,8,8,7,6,-1,-1,-1,-1,10,7,6,10,1,7,1,3,7,-1,-1,-1,-1,-1,-1,-1,10,7,6,1,7,10,1,8,7,1,0,8,-1,-1,-1,-1,0,3,7,0,7,10,0,10,9,6,10,7,-1,-1,-1,-1,7,6,10,7,10,8,8,10,9,-1,-1,-1,-1,-1,-1,-1,6,8,4,11,8,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,6,11,3,0,6,0,4,6,-1,-1,-1,-1,-1,-1,-1,8,6,11,8,4,6,9,0,1,-1,-1,-1,-1,-1,-1,-1,9,4,6,9,6,3,9,3,1,11,3,6,-1,-1,-1,-1,6,8,4,6,11,8,2,10,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,3,0,11,0,6,11,0,4,6,-1,-1,-1,-1,4,11,8,4,6,11,0,2,9,2,10,9,-1,-1,-1,-1,10,9,3,10,3,2,9,4,3,11,3,6,4,6,3,-1,8,2,3,8,4,2,4,6,2,-1,-1,-1,-1,-1,-1,-1,0,4,2,4,6,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,0,2,3,4,2,4,6,4,3,8,-1,-1,-1,-1,1,9,4,1,4,2,2,4,6,-1,-1,-1,-1,-1,-1,-1,8,1,3,8,6,1,8,4,6,6,10,1,-1,-1,-1,-1,10,1,0,10,0,6,6,0,4,-1,-1,-1,-1,-1,-1,-1,4,6,3,4,3,8,6,10,3,0,3,9,10,9,3,-1,10,9,4,6,10,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,9,5,7,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,4,9,5,11,7,6,-1,-1,-1,-1,-1,-1,-1,5,0,1,5,4,0,7,6,11,-1,-1,-1,-1,-1,-1,-1,11,7,6,8,3,4,3,5,4,3,1,5,-1,-1,-1,-1,9,5,4,10,1,2,7,6,11,-1,-1,-1,-1,-1,-1,-1,6,11,7,1,2,10,0,8,3,4,9,5,-1,-1,-1,-1,7,6,11,5,4,10,4,2,10,4,0,2,-1,-1,-1,-1,3,4,8,3,5,4,3,2,5,10,5,2,11,7,6,-1,7,2,3,7,6,2,5,4,9,-1,-1,-1,-1,-1,-1,-1,9,5,4,0,8,6,0,6,2,6,8,7,-1,-1,-1,-1,3,6,2,3,7,6,1,5,0,5,4,0,-1,-1,-1,-1,6,2,8,6,8,7,2,1,8,4,8,5,1,5,8,-1,9,5,4,10,1,6,1,7,6,1,3,7,-1,-1,-1,-1,1,6,10,1,7,6,1,0,7,8,7,0,9,5,4,-1,4,0,10,4,10,5,0,3,10,6,10,7,3,7,10,-1,7,6,10,7,10,8,5,4,10,4,8,10,-1,-1,-1,-1,6,9,5,6,11,9,11,8,9,-1,-1,-1,-1,-1,-1,-1,3,6,11,0,6,3,0,5,6,0,9,5,-1,-1,-1,-1,0,11,8,0,5,11,0,1,5,5,6,11,-1,-1,-1,-1,6,11,3,6,3,5,5,3,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,9,5,11,9,11,8,11,5,6,-1,-1,-1,-1,0,11,3,0,6,11,0,9,6,5,6,9,1,2,10,-1,11,8,5,11,5,6,8,0,5,10,5,2,0,2,5,-1,6,11,3,6,3,5,2,10,3,10,5,3,-1,-1,-1,-1,5,8,9,5,2,8,5,6,2,3,8,2,-1,-1,-1,-1,9,5,6,9,6,0,0,6,2,-1,-1,-1,-1,-1,-1,-1,1,5,8,1,8,0,5,6,8,3,8,2,6,2,8,-1,1,5,6,2,1,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,6,1,6,10,3,8,6,5,6,9,8,9,6,-1,10,1,0,10,0,6,9,5,0,5,6,0,-1,-1,-1,-1,0,3,8,5,6,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,5,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,5,10,7,5,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,5,10,11,7,5,8,3,0,-1,-1,-1,-1,-1,-1,-1,5,11,7,5,10,11,1,9,0,-1,-1,-1,-1,-1,-1,-1,10,7,5,10,11,7,9,8,1,8,3,1,-1,-1,-1,-1,11,1,2,11,7,1,7,5,1,-1,-1,-1,-1,-1,-1,-1,0,8,3,1,2,7,1,7,5,7,2,11,-1,-1,-1,-1,9,7,5,9,2,7,9,0,2,2,11,7,-1,-1,-1,-1,7,5,2,7,2,11,5,9,2,3,2,8,9,8,2,-1,2,5,10,2,3,5,3,7,5,-1,-1,-1,-1,-1,-1,-1,8,2,0,8,5,2,8,7,5,10,2,5,-1,-1,-1,-1,9,0,1,5,10,3,5,3,7,3,10,2,-1,-1,-1,-1,9,8,2,9,2,1,8,7,2,10,2,5,7,5,2,-1,1,3,5,3,7,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,7,0,7,1,1,7,5,-1,-1,-1,-1,-1,-1,-1,9,0,3,9,3,5,5,3,7,-1,-1,-1,-1,-1,-1,-1,9,8,7,5,9,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,8,4,5,10,8,10,11,8,-1,-1,-1,-1,-1,-1,-1,5,0,4,5,11,0,5,10,11,11,3,0,-1,-1,-1,-1,0,1,9,8,4,10,8,10,11,10,4,5,-1,-1,-1,-1,10,11,4,10,4,5,11,3,4,9,4,1,3,1,4,-1,2,5,1,2,8,5,2,11,8,4,5,8,-1,-1,-1,-1,0,4,11,0,11,3,4,5,11,2,11,1,5,1,11,-1,0,2,5,0,5,9,2,11,5,4,5,8,11,8,5,-1,9,4,5,2,11,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,5,10,3,5,2,3,4,5,3,8,4,-1,-1,-1,-1,5,10,2,5,2,4,4,2,0,-1,-1,-1,-1,-1,-1,-1,3,10,2,3,5,10,3,8,5,4,5,8,0,1,9,-1,5,10,2,5,2,4,1,9,2,9,4,2,-1,-1,-1,-1,8,4,5,8,5,3,3,5,1,-1,-1,-1,-1,-1,-1,-1,0,4,5,1,0,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,4,5,8,5,3,9,0,5,0,3,5,-1,-1,-1,-1,9,4,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,11,7,4,9,11,9,10,11,-1,-1,-1,-1,-1,-1,-1,0,8,3,4,9,7,9,11,7,9,10,11,-1,-1,-1,-1,1,10,11,1,11,4,1,4,0,7,4,11,-1,-1,-1,-1,3,1,4,3,4,8,1,10,4,7,4,11,10,11,4,-1,4,11,7,9,11,4,9,2,11,9,1,2,-1,-1,-1,-1,9,7,4,9,11,7,9,1,11,2,11,1,0,8,3,-1,11,7,4,11,4,2,2,4,0,-1,-1,-1,-1,-1,-1,-1,11,7,4,11,4,2,8,3,4,3,2,4,-1,-1,-1,-1,2,9,10,2,7,9,2,3,7,7,4,9,-1,-1,-1,-1,9,10,7,9,7,4,10,2,7,8,7,0,2,0,7,-1,3,7,10,3,10,2,7,4,10,1,10,0,4,0,10,-1,1,10,2,8,7,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,9,1,4,1,7,7,1,3,-1,-1,-1,-1,-1,-1,-1,4,9,1,4,1,7,0,8,1,8,7,1,-1,-1,-1,-1,4,0,3,7,4,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,8,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,10,8,10,11,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,9,3,9,11,11,9,10,-1,-1,-1,-1,-1,-1,-1,0,1,10,0,10,8,8,10,11,-1,-1,-1,-1,-1,-1,-1,3,1,10,11,3,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,11,1,11,9,9,11,8,-1,-1,-1,-1,-1,-1,-1,3,0,9,3,9,11,1,2,9,2,11,9,-1,-1,-1,-1,0,2,11,8,0,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,2,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,8,2,8,10,10,8,9,-1,-1,-1,-1,-1,-1,-1,9,10,2,0,9,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,8,2,8,10,0,1,8,1,10,8,-1,-1,-1,-1,1,10,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,8,9,1,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,9,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,3,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]),s1=ez.createContext(null),s2=ez.forwardRef(({resolution:e=28,maxPolyCount:t=1e4,enableUvs:r=!1,enableColors:n=!1,children:i,...a},o)=>{let s=ez.useRef(null);ez.useImperativeHandle(o,()=>s.current,[]);let l=ez.useMemo(()=>new sZ(e,null,r,n,t),[e,t,r,n]),c=ez.useMemo(()=>({getParent:()=>s}),[]);return(0,eL.C)(()=>{l.update(),l.reset()},-1),ez.createElement(ez.Fragment,null,ez.createElement("primitive",ee({object:l,ref:s},a),ez.createElement(s1.Provider,{value:c},i)))}),s3=ez.forwardRef(({strength:e=.5,subtract:t=12,color:r,...n},i)=>{let{getParent:a}=ez.useContext(s1),o=ez.useMemo(()=>a(),[a]),s=ez.useRef(null);ez.useImperativeHandle(i,()=>s.current,[]);let l=new eQ.Vector3;return(0,eL.C)(n=>{o.current&&s.current&&(s.current.getWorldPosition(l),o.current.addBall(.5+.5*l.x,.5+.5*l.y,.5+.5*l.z,e,t,r))}),ez.createElement("group",ee({ref:s},n))}),s4=ez.forwardRef(({planeType:e="x",strength:t=.5,subtract:r=12,...n},i)=>{let{getParent:a}=ez.useContext(s1),o=ez.useMemo(()=>a(),[a]),s=ez.useRef(null);ez.useImperativeHandle(i,()=>s.current,[]);let l=ez.useMemo(()=>"x"===e?"addPlaneX":"y"===e?"addPlaneY":"addPlaneZ",[e]);return(0,eL.C)(()=>{o.current&&s.current&&o.current[l](t,r)}),ez.createElement("group",ee({ref:s},n))});class s5 extends eQ.BufferGeometry{constructor(e,t,r,n){super();let i=[],a=[],o=[],s=new eQ.Vector3,l=new eQ.Matrix4;l.makeRotationFromEuler(r),l.setPosition(t);let c=new eQ.Matrix4;function u(t,r,n){r.applyMatrix4(e.matrixWorld),r.applyMatrix4(c),n.transformDirection(e.matrixWorld),t.push(new s6(r.clone(),n.clone()))}function h(e,t){let r=[],i=.5*Math.abs(n.dot(t));for(let n=0;n<e.length;n+=3){let a,o,s,l,c,u,h;let f=e[n+0].position.dot(t)-i,p=e[n+1].position.dot(t)-i,m=e[n+2].position.dot(t)-i;switch(((c=f>0)?1:0)+((u=p>0)?1:0)+((h=m>0)?1:0)){case 0:r.push(e[n]),r.push(e[n+1]),r.push(e[n+2]);break;case 1:if(c&&(a=e[n+1],o=e[n+2],s=d(e[n],a,t,i),l=d(e[n],o,t,i)),u){a=e[n],o=e[n+2],s=d(e[n+1],a,t,i),l=d(e[n+1],o,t,i),r.push(s),r.push(o.clone()),r.push(a.clone()),r.push(o.clone()),r.push(s.clone()),r.push(l);break}h&&(a=e[n],o=e[n+1],s=d(e[n+2],a,t,i),l=d(e[n+2],o,t,i)),r.push(a.clone()),r.push(o.clone()),r.push(s),r.push(l),r.push(s.clone()),r.push(o.clone());break;case 2:c||(o=d(a=e[n].clone(),e[n+1],t,i),s=d(a,e[n+2],t,i),r.push(a),r.push(o),r.push(s)),u||(o=d(a=e[n+1].clone(),e[n+2],t,i),s=d(a,e[n],t,i),r.push(a),r.push(o),r.push(s)),h||(o=d(a=e[n+2].clone(),e[n],t,i),s=d(a,e[n+1],t,i),r.push(a),r.push(o),r.push(s))}}return r}function d(e,t,r,n){let i=e.position.dot(r)-n,a=i/(i-(t.position.dot(r)-n));return new s6(new eQ.Vector3(e.position.x+a*(t.position.x-e.position.x),e.position.y+a*(t.position.y-e.position.y),e.position.z+a*(t.position.z-e.position.z)),new eQ.Vector3(e.normal.x+a*(t.normal.x-e.normal.x),e.normal.y+a*(t.normal.y-e.normal.y),e.normal.z+a*(t.normal.z-e.normal.z)))}c.copy(l).invert(),function(){let t;let r=[],c=new eQ.Vector3,d=new eQ.Vector3;if(!0===e.geometry.isGeometry){console.error("THREE.DecalGeometry no longer supports THREE.Geometry. Use BufferGeometry instead.");return}let f=e.geometry,p=f.attributes.position,m=f.attributes.normal;if(null!==f.index){let e=f.index;for(t=0;t<e.count;t++)c.fromBufferAttribute(p,e.getX(t)),d.fromBufferAttribute(m,e.getX(t)),u(r,c,d)}else for(t=0;t<p.count;t++)c.fromBufferAttribute(p,t),d.fromBufferAttribute(m,t),u(r,c,d);for(t=0,r=h(r,s.set(1,0,0)),r=h(r,s.set(-1,0,0)),r=h(r,s.set(0,1,0)),r=h(r,s.set(0,-1,0)),r=h(r,s.set(0,0,1)),r=h(r,s.set(0,0,-1));t<r.length;t++){let e=r[t];o.push(.5+e.position.x/n.x,.5+e.position.y/n.y),e.position.applyMatrix4(l),i.push(e.position.x,e.position.y,e.position.z),a.push(e.normal.x,e.normal.y,e.normal.z)}}(),this.setAttribute("position",new eQ.Float32BufferAttribute(i,3)),this.setAttribute("normal",new eQ.Float32BufferAttribute(a,3)),this.setAttribute("uv",new eQ.Float32BufferAttribute(o,2))}}class s6{constructor(e,t){this.position=e,this.normal=t}clone(){return new this.constructor(this.position.clone(),this.normal.clone())}}function s8(e=[0,0,0]){return Array.isArray(e)?e:e instanceof eQ.Vector3||e instanceof eQ.Euler?[e.x,e.y,e.z]:[e,e,e]}let s9=ez.forwardRef(function({debug:e,depthTest:t=!1,polygonOffsetFactor:r=-10,map:n,mesh:i,children:a,position:o,rotation:s,scale:l,...c},u){let h=ez.useRef(null);ez.useImperativeHandle(u,()=>h.current);let d=ez.useRef(null);return ez.useLayoutEffect(()=>{let e=(null==i?void 0:i.current)||h.current.parent,t=h.current;if(!(e instanceof eQ.Mesh))throw Error('Decal must have a Mesh as parent or specify its "mesh" prop');let r={position:new eQ.Vector3,rotation:new eQ.Euler,scale:new eQ.Vector3(1,1,1)};if(e){(0,eL.j)(r,{position:o,scale:l});let n=e.matrixWorld.clone();if(e.matrixWorld.identity(),s&&"number"!=typeof s)(0,eL.j)(r,{rotation:s});else{let t=new eQ.Object3D;t.position.copy(r.position),t.lookAt(e.position),"number"==typeof s&&t.rotateZ(s),(0,eL.j)(r,{rotation:t.rotation})}return t.geometry=new s5(e,r.position,r.rotation,r.scale),d.current&&((0,eL.j)(d.current,r),d.current.traverse(e=>e.raycast=()=>null)),e.matrixWorld=n,()=>{t.geometry.dispose()}}},[i,...s8(o),...s8(l),...s8(s)]),ez.createElement("mesh",ee({ref:h,"material-transparent":!0,"material-polygonOffset":!0,"material-polygonOffsetFactor":r,"material-depthTest":t,"material-map":n},c),a,e&&ez.createElement("mesh",{ref:d},ez.createElement("boxGeometry",null),ez.createElement("meshNormalMaterial",{wireframe:!0}),ez.createElement("axesHelper",null)))});class s7 extends eQ.Loader{constructor(e){super(e),this.defaultDPI=90,this.defaultUnit="px"}load(e,t,r,n){let i=this,a=new eQ.FileLoader(i.manager);a.setPath(i.path),a.setRequestHeader(i.requestHeader),a.setWithCredentials(i.withCredentials),a.load(e,function(r){try{t(i.parse(r))}catch(t){n?n(t):console.error(t),i.manager.itemError(e)}},r,n)}parse(e){let t=this;function r(e,t,r,i,a,o,s,l){if(0==t||0==r){e.lineTo(l.x,l.y);return}i=i*Math.PI/180,t=Math.abs(t),r=Math.abs(r);let c=(s.x-l.x)/2,u=(s.y-l.y)/2,h=Math.cos(i)*c+Math.sin(i)*u,d=-Math.sin(i)*c+Math.cos(i)*u,f=t*t,p=r*r,m=h*h,A=d*d,g=m/f+A/p;if(g>1){let e=Math.sqrt(g);t*=e,r*=e,f=t*t,p=r*r}let v=f*A+p*m,y=Math.sqrt(Math.max(0,(f*p-v)/v));a===o&&(y=-y);let x=y*t*d/r,E=-y*r*h/t,_=Math.cos(i)*x-Math.sin(i)*E+(s.x+l.x)/2,C=Math.sin(i)*x+Math.cos(i)*E+(s.y+l.y)/2,b=n(1,0,(h-x)/t,(d-E)/r),w=n((h-x)/t,(d-E)/r,(-h-x)/t,(-d-E)/r)%(2*Math.PI);e.currentPath.absellipse(_,C,t,r,b,b+w,0===o,i)}function n(e,t,r,n){let i=Math.sqrt(e*e+t*t)*Math.sqrt(r*r+n*n),a=Math.acos(Math.max(-1,Math.min(1,(e*r+t*n)/i)));return e*n-t*r<0&&(a=-a),a}function i(e,t){t=Object.assign({},t);let r={};if(e.hasAttribute("class")){let t=e.getAttribute("class").split(/\s/).filter(Boolean).map(e=>e.trim());for(let e=0;e<t.length;e++)r=Object.assign(r,f["."+t[e]])}function n(n,i,a){void 0===a&&(a=function(e){return e.startsWith("url")&&console.warn("SVGLoader: url access in attributes is not implemented."),e}),e.hasAttribute(n)&&(t[i]=a(e.getAttribute(n))),r[n]&&(t[i]=a(r[n])),e.style&&""!==e.style[n]&&(t[i]=a(e.style[n]))}function i(e){return Math.max(0,Math.min(1,l(e)))}function a(e){return Math.max(0,l(e))}return e.hasAttribute("id")&&(r=Object.assign(r,f["#"+e.getAttribute("id")])),n("fill","fill"),n("fill-opacity","fillOpacity",i),n("fill-rule","fillRule"),n("opacity","opacity",i),n("stroke","stroke"),n("stroke-opacity","strokeOpacity",i),n("stroke-width","strokeWidth",a),n("stroke-linejoin","strokeLineJoin"),n("stroke-linecap","strokeLineCap"),n("stroke-miterlimit","strokeMiterLimit",a),n("visibility","visibility"),t}function a(e,t,r){let n;if("string"!=typeof e)throw TypeError("Invalid input: "+typeof e);let i={WHITESPACE:/[ \t\r\n]/,DIGIT:/[\d]/,SIGN:/[-+]/,POINT:/\./,COMMA:/,/,EXP:/e/i,FLAGS:/[01]/},a=0,o=!0,s="",l="",c=[];function u(e,t,r){let n=SyntaxError('Unexpected character "'+e+'" at index '+t+".");throw n.partial=r,n}function h(){""!==s&&(""===l?c.push(Number(s)):c.push(Number(s)*Math.pow(10,Number(l)))),s="",l=""}let d=e.length;for(let f=0;f<d;f++){if(n=e[f],Array.isArray(t)&&t.includes(c.length%r)&&i.FLAGS.test(n)){a=1,s=n,h();continue}if(0===a){if(i.WHITESPACE.test(n))continue;if(i.DIGIT.test(n)||i.SIGN.test(n)){a=1,s=n;continue}if(i.POINT.test(n)){a=2,s=n;continue}i.COMMA.test(n)&&(o&&u(n,f,c),o=!0)}if(1===a){if(i.DIGIT.test(n)){s+=n;continue}if(i.POINT.test(n)){s+=n,a=2;continue}if(i.EXP.test(n)){a=3;continue}i.SIGN.test(n)&&1===s.length&&i.SIGN.test(s[0])&&u(n,f,c)}if(2===a){if(i.DIGIT.test(n)){s+=n;continue}if(i.EXP.test(n)){a=3;continue}i.POINT.test(n)&&"."===s[s.length-1]&&u(n,f,c)}if(3===a){if(i.DIGIT.test(n)){l+=n;continue}if(i.SIGN.test(n)){if(""===l){l+=n;continue}1===l.length&&i.SIGN.test(l)&&u(n,f,c)}}i.WHITESPACE.test(n)?(h(),a=0,o=!1):i.COMMA.test(n)?(h(),a=0,o=!0):i.SIGN.test(n)?(h(),a=1,s=n):i.POINT.test(n)?(h(),a=2,s=n):u(n,f,c)}return h(),c}let o=["mm","cm","in","pt","pc","px"],s={mm:{mm:1,cm:.1,in:1/25.4,pt:72/25.4,pc:6/25.4,px:-1},cm:{mm:10,cm:1,in:1/2.54,pt:72/2.54,pc:6/2.54,px:-1},in:{mm:25.4,cm:2.54,in:1,pt:72,pc:6,px:-1},pt:{mm:25.4/72,cm:2.54/72,in:1/72,pt:1,pc:6/72,px:-1},pc:{mm:25.4/6,cm:2.54/6,in:1/6,pt:12,pc:1,px:-1},px:{px:1}};function l(e){let r,n="px";if("string"==typeof e||e instanceof String)for(let t=0,r=o.length;t<r;t++){let r=o[t];if(e.endsWith(r)){n=r,e=e.substring(0,e.length-r.length);break}}return"px"===n&&"px"!==t.defaultUnit?r=s.in[t.defaultUnit]/t.defaultDPI:(r=s[n][t.defaultUnit])<0&&(r=s[n].in*t.defaultDPI),r*parseFloat(e)}function c(e){let t=e.elements;return t[0]*t[4]-t[1]*t[3]<0}function u(e){let t=e.elements;return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function h(e){let t=e.elements;return Math.sqrt(t[3]*t[3]+t[4]*t[4])}let d=[],f={},p=[],m=new eQ.Matrix3,A=new eQ.Matrix3,g=new eQ.Matrix3,v=new eQ.Matrix3,y=new eQ.Vector2,x=new eQ.Vector3,E=new eQ.Matrix3,_=new DOMParser().parseFromString(e,"image/svg+xml");return!function e(t,n){if(1!==t.nodeType)return;let o=function(e){if(!(e.hasAttribute("transform")||"use"===e.nodeName&&(e.hasAttribute("x")||e.hasAttribute("y"))))return null;let t=function(e){let t=new eQ.Matrix3;if("use"===e.nodeName&&(e.hasAttribute("x")||e.hasAttribute("y"))){let r=l(e.getAttribute("x")),n=l(e.getAttribute("y"));t.translate(r,n)}if(e.hasAttribute("transform")){let r=e.getAttribute("transform").split(")");for(let e=r.length-1;e>=0;e--){let n=r[e].trim();if(""===n)continue;let i=n.indexOf("("),o=n.length;if(i>0&&i<o){let e=n.slice(0,i),t=a(n.slice(i+1));switch(m.identity(),e){case"translate":if(t.length>=1){let e=t[0],r=0;t.length>=2&&(r=t[1]),m.translate(e,r)}break;case"rotate":if(t.length>=1){let e=0,r=0,n=0;e=t[0]*Math.PI/180,t.length>=3&&(r=t[1],n=t[2]),A.makeTranslation(-r,-n),g.makeRotation(e),v.multiplyMatrices(g,A),A.makeTranslation(r,n),m.multiplyMatrices(A,v)}break;case"scale":if(t.length>=1){let e=t[0],r=e;t.length>=2&&(r=t[1]),m.scale(e,r)}break;case"skewX":1===t.length&&m.set(1,Math.tan(t[0]*Math.PI/180),0,0,1,0,0,0,1);break;case"skewY":1===t.length&&m.set(1,0,0,Math.tan(t[0]*Math.PI/180),1,0,0,0,1);break;case"matrix":6===t.length&&m.set(t[0],t[2],t[4],t[1],t[3],t[5],0,0,1)}}t.premultiply(m)}}return t}(e);return p.length>0&&t.premultiply(p[p.length-1]),E.copy(t),p.push(t),t}(t),s=!1,_=null;switch(t.nodeName){case"svg":case"g":n=i(t,n);break;case"style":(function(e){if(e.sheet&&e.sheet.cssRules&&e.sheet.cssRules.length)for(let t=0;t<e.sheet.cssRules.length;t++){let r=e.sheet.cssRules[t];if(1!==r.type)continue;let n=r.selectorText.split(/,/gm).filter(Boolean).map(e=>e.trim());for(let e=0;e<n.length;e++){let t=Object.fromEntries(Object.entries(r.style).filter(([,e])=>""!==e));f[n[e]]=Object.assign(f[n[e]]||{},t)}}})(t);break;case"path":n=i(t,n),t.hasAttribute("d")&&(_=function(e){let t=new eQ.ShapePath,n=new eQ.Vector2,i=new eQ.Vector2,o=new eQ.Vector2,s=!0,l=!1,c=e.getAttribute("d");if(""===c||"none"===c)return null;let u=c.match(/[a-df-z][^a-df-z]*/gi);for(let e=0,c=u.length;e<c;e++){var h,d,f,p,m,A,g,v;let c;let y=u[e],x=y.charAt(0),E=y.slice(1).trim();switch(!0===s&&(l=!0,s=!1),x){case"M":c=a(E);for(let e=0,r=c.length;e<r;e+=2)n.x=c[e+0],n.y=c[e+1],i.x=n.x,i.y=n.y,0===e?t.moveTo(n.x,n.y):t.lineTo(n.x,n.y),0===e&&o.copy(n);break;case"H":c=a(E);for(let e=0,r=c.length;e<r;e++)n.x=c[e],i.x=n.x,i.y=n.y,t.lineTo(n.x,n.y),0===e&&!0===l&&o.copy(n);break;case"V":c=a(E);for(let e=0,r=c.length;e<r;e++)n.y=c[e],i.x=n.x,i.y=n.y,t.lineTo(n.x,n.y),0===e&&!0===l&&o.copy(n);break;case"L":c=a(E);for(let e=0,r=c.length;e<r;e+=2)n.x=c[e+0],n.y=c[e+1],i.x=n.x,i.y=n.y,t.lineTo(n.x,n.y),0===e&&!0===l&&o.copy(n);break;case"C":c=a(E);for(let e=0,r=c.length;e<r;e+=6)t.bezierCurveTo(c[e+0],c[e+1],c[e+2],c[e+3],c[e+4],c[e+5]),i.x=c[e+2],i.y=c[e+3],n.x=c[e+4],n.y=c[e+5],0===e&&!0===l&&o.copy(n);break;case"S":c=a(E);for(let e=0,r=c.length;e<r;e+=4)t.bezierCurveTo((h=n.x)-(i.x-h),(d=n.y)-(i.y-d),c[e+0],c[e+1],c[e+2],c[e+3]),i.x=c[e+0],i.y=c[e+1],n.x=c[e+2],n.y=c[e+3],0===e&&!0===l&&o.copy(n);break;case"Q":c=a(E);for(let e=0,r=c.length;e<r;e+=4)t.quadraticCurveTo(c[e+0],c[e+1],c[e+2],c[e+3]),i.x=c[e+0],i.y=c[e+1],n.x=c[e+2],n.y=c[e+3],0===e&&!0===l&&o.copy(n);break;case"T":c=a(E);for(let e=0,r=c.length;e<r;e+=2){let r=(f=n.x)-(i.x-f),a=(p=n.y)-(i.y-p);t.quadraticCurveTo(r,a,c[e+0],c[e+1]),i.x=r,i.y=a,n.x=c[e+0],n.y=c[e+1],0===e&&!0===l&&o.copy(n)}break;case"A":c=a(E,[3,4],7);for(let e=0,a=c.length;e<a;e+=7){if(c[e+5]==n.x&&c[e+6]==n.y)continue;let a=n.clone();n.x=c[e+5],n.y=c[e+6],i.x=n.x,i.y=n.y,r(t,c[e],c[e+1],c[e+2],c[e+3],c[e+4],a,n),0===e&&!0===l&&o.copy(n)}break;case"m":c=a(E);for(let e=0,r=c.length;e<r;e+=2)n.x+=c[e+0],n.y+=c[e+1],i.x=n.x,i.y=n.y,0===e?t.moveTo(n.x,n.y):t.lineTo(n.x,n.y),0===e&&o.copy(n);break;case"h":c=a(E);for(let e=0,r=c.length;e<r;e++)n.x+=c[e],i.x=n.x,i.y=n.y,t.lineTo(n.x,n.y),0===e&&!0===l&&o.copy(n);break;case"v":c=a(E);for(let e=0,r=c.length;e<r;e++)n.y+=c[e],i.x=n.x,i.y=n.y,t.lineTo(n.x,n.y),0===e&&!0===l&&o.copy(n);break;case"l":c=a(E);for(let e=0,r=c.length;e<r;e+=2)n.x+=c[e+0],n.y+=c[e+1],i.x=n.x,i.y=n.y,t.lineTo(n.x,n.y),0===e&&!0===l&&o.copy(n);break;case"c":c=a(E);for(let e=0,r=c.length;e<r;e+=6)t.bezierCurveTo(n.x+c[e+0],n.y+c[e+1],n.x+c[e+2],n.y+c[e+3],n.x+c[e+4],n.y+c[e+5]),i.x=n.x+c[e+2],i.y=n.y+c[e+3],n.x+=c[e+4],n.y+=c[e+5],0===e&&!0===l&&o.copy(n);break;case"s":c=a(E);for(let e=0,r=c.length;e<r;e+=4)t.bezierCurveTo((m=n.x)-(i.x-m),(A=n.y)-(i.y-A),n.x+c[e+0],n.y+c[e+1],n.x+c[e+2],n.y+c[e+3]),i.x=n.x+c[e+0],i.y=n.y+c[e+1],n.x+=c[e+2],n.y+=c[e+3],0===e&&!0===l&&o.copy(n);break;case"q":c=a(E);for(let e=0,r=c.length;e<r;e+=4)t.quadraticCurveTo(n.x+c[e+0],n.y+c[e+1],n.x+c[e+2],n.y+c[e+3]),i.x=n.x+c[e+0],i.y=n.y+c[e+1],n.x+=c[e+2],n.y+=c[e+3],0===e&&!0===l&&o.copy(n);break;case"t":c=a(E);for(let e=0,r=c.length;e<r;e+=2){let r=(g=n.x)-(i.x-g),a=(v=n.y)-(i.y-v);t.quadraticCurveTo(r,a,n.x+c[e+0],n.y+c[e+1]),i.x=r,i.y=a,n.x=n.x+c[e+0],n.y=n.y+c[e+1],0===e&&!0===l&&o.copy(n)}break;case"a":c=a(E,[3,4],7);for(let e=0,a=c.length;e<a;e+=7){if(0==c[e+5]&&0==c[e+6])continue;let a=n.clone();n.x+=c[e+5],n.y+=c[e+6],i.x=n.x,i.y=n.y,r(t,c[e],c[e+1],c[e+2],c[e+3],c[e+4],a,n),0===e&&!0===l&&o.copy(n)}break;case"Z":case"z":t.currentPath.autoClose=!0,t.currentPath.curves.length>0&&(n.copy(o),t.currentPath.currentPoint.copy(n),s=!0);break;default:console.warn(y)}l=!1}return t}(t));break;case"rect":n=i(t,n),_=function(e){let t=l(e.getAttribute("x")||0),r=l(e.getAttribute("y")||0),n=l(e.getAttribute("rx")||e.getAttribute("ry")||0),i=l(e.getAttribute("ry")||e.getAttribute("rx")||0),a=l(e.getAttribute("width")),o=l(e.getAttribute("height")),s=new eQ.ShapePath;return s.moveTo(t+n,r),s.lineTo(t+a-n,r),(0!==n||0!==i)&&s.bezierCurveTo(t+a-.448084975506*n,r,t+a,r+.448084975506*i,t+a,r+i),s.lineTo(t+a,r+o-i),(0!==n||0!==i)&&s.bezierCurveTo(t+a,r+o-.448084975506*i,t+a-.448084975506*n,r+o,t+a-n,r+o),s.lineTo(t+n,r+o),(0!==n||0!==i)&&s.bezierCurveTo(t+.448084975506*n,r+o,t,r+o-.448084975506*i,t,r+o-i),s.lineTo(t,r+i),(0!==n||0!==i)&&s.bezierCurveTo(t,r+.448084975506*i,t+.448084975506*n,r,t+n,r),s}(t);break;case"polygon":n=i(t,n),_=function(e){let t=new eQ.ShapePath,r=0;return e.getAttribute("points").replace(/([+-]?\d*\.?\d+(?:e[+-]?\d+)?)(?:,|\s)([+-]?\d*\.?\d+(?:e[+-]?\d+)?)/g,function(e,n,i){let a=l(n),o=l(i);0===r?t.moveTo(a,o):t.lineTo(a,o),r++}),t.currentPath.autoClose=!0,t}(t);break;case"polyline":n=i(t,n),_=function(e){let t=new eQ.ShapePath,r=0;return e.getAttribute("points").replace(/([+-]?\d*\.?\d+(?:e[+-]?\d+)?)(?:,|\s)([+-]?\d*\.?\d+(?:e[+-]?\d+)?)/g,function(e,n,i){let a=l(n),o=l(i);0===r?t.moveTo(a,o):t.lineTo(a,o),r++}),t.currentPath.autoClose=!1,t}(t);break;case"circle":n=i(t,n),_=function(e){let t=l(e.getAttribute("cx")||0),r=l(e.getAttribute("cy")||0),n=l(e.getAttribute("r")||0),i=new eQ.Path;i.absarc(t,r,n,0,2*Math.PI);let a=new eQ.ShapePath;return a.subPaths.push(i),a}(t);break;case"ellipse":n=i(t,n),_=function(e){let t=l(e.getAttribute("cx")||0),r=l(e.getAttribute("cy")||0),n=l(e.getAttribute("rx")||0),i=l(e.getAttribute("ry")||0),a=new eQ.Path;a.absellipse(t,r,n,i,0,2*Math.PI);let o=new eQ.ShapePath;return o.subPaths.push(a),o}(t);break;case"line":n=i(t,n),_=function(e){let t=l(e.getAttribute("x1")||0),r=l(e.getAttribute("y1")||0),n=l(e.getAttribute("x2")||0),i=l(e.getAttribute("y2")||0),a=new eQ.ShapePath;return a.moveTo(t,r),a.lineTo(n,i),a.currentPath.autoClose=!1,a}(t);break;case"defs":s=!0;break;case"use":n=i(t,n);let C=(t.getAttributeNS("http://www.w3.org/1999/xlink","href")||"").substring(1),b=t.viewportElement.getElementById(C);b?e(b,n):console.warn("SVGLoader: 'use node' references non-existent node id: "+C)}_&&(void 0!==n.fill&&"none"!==n.fill&&_.color.setStyle(n.fill,"srgb"),function(e,t){function r(e){x.set(e.x,e.y,1).applyMatrix3(t),e.set(x.x,x.y)}let n=e.subPaths;for(let e=0,i=n.length;e<i;e++){let i=n[e].curves;for(let e=0;e<i.length;e++){let n=i[e];n.isLineCurve?(r(n.v1),r(n.v2)):n.isCubicBezierCurve?(r(n.v0),r(n.v1),r(n.v2),r(n.v3)):n.isQuadraticBezierCurve?(r(n.v0),r(n.v1),r(n.v2)):n.isEllipseCurve&&(y.set(n.aX,n.aY),r(y),n.aX=y.x,n.aY=y.y,function(e){let t=e.elements,r=t[0]*t[3]+t[1]*t[4];return 0!==r&&Math.abs(r/(u(e)*h(e)))>Number.EPSILON}(t)?function(e){let r=e.xRadius,n=e.yRadius,i=Math.cos(e.aRotation),a=Math.sin(e.aRotation),o=new eQ.Vector3(r*i,r*a,0),s=new eQ.Vector3(-n*a,n*i,0),l=o.applyMatrix3(t),u=s.applyMatrix3(t),h=m.set(l.x,u.x,0,l.y,u.y,0,0,0,1),d=A.copy(h).invert(),f=g.copy(d).transpose().multiply(d).elements,p=function(e,t,r){let n,i,a,o,s;let l=e+r,c=e-r,u=Math.sqrt(c*c+4*t*t);return l>0?i=e*(s=1/(n=.5*(l+u)))*r-t*s*t:l<0?i=.5*(l-u):(n=.5*u,i=-.5*u),Math.abs(a=c>0?c+u:c-u)>2*Math.abs(t)?(o=1/Math.sqrt(1+(s=-2*t/a)*s),a=s*o):0===Math.abs(t)?(a=1,o=0):(a=1/Math.sqrt(1+(s=-.5*a/t)*s),o=s*a),c>0&&(s=a,a=-o,o=s),{rt1:n,rt2:i,cs:a,sn:o}}(f[0],f[1],f[4]),v=Math.sqrt(p.rt1),y=Math.sqrt(p.rt2);if(e.xRadius=1/v,e.yRadius=1/y,e.aRotation=Math.atan2(p.sn,p.cs),!((e.aEndAngle-e.aStartAngle)%(2*Math.PI)<Number.EPSILON)){let r=A.set(v,0,0,0,y,0,0,0,1),n=g.set(p.cs,p.sn,0,-p.sn,p.cs,0,0,0,1),i=r.multiply(n).multiply(h),a=e=>{let{x:t,y:r}=new eQ.Vector3(Math.cos(e),Math.sin(e),0).applyMatrix3(i);return Math.atan2(r,t)};e.aStartAngle=a(e.aStartAngle),e.aEndAngle=a(e.aEndAngle),c(t)&&(e.aClockwise=!e.aClockwise)}}(n):function(e){let r=u(t),n=h(t);e.xRadius*=r,e.yRadius*=n;let i=r>Number.EPSILON?Math.atan2(t.elements[1],t.elements[0]):Math.atan2(-t.elements[3],t.elements[4]);e.aRotation+=i,c(t)&&(e.aStartAngle*=-1,e.aEndAngle*=-1,e.aClockwise=!e.aClockwise)}(n))}}}(_,E),d.push(_),_.userData={node:t,style:n});let w=t.childNodes;for(let t=0;t<w.length;t++){let r=w[t];s&&"style"!==r.nodeName&&"defs"!==r.nodeName||e(r,n)}o&&(p.pop(),p.length>0?E.copy(p[p.length-1]):E.identity())}(_.documentElement,{fill:"#000",fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeLineJoin:"miter",strokeLineCap:"butt",strokeMiterLimit:4}),{paths:d,xml:_.documentElement}}static createShapes(e){let t={ORIGIN:0,DESTINATION:1,BETWEEN:2,LEFT:3,RIGHT:4,BEHIND:5,BEYOND:6},r={loc:t.ORIGIN,t:0};function n(e,n,i){let a;let o=i.x-n.x,s=i.y-n.y,l=e.x-n.x,c=e.y-n.y,u=o*c-l*s;if(e.x===n.x&&e.y===n.y){r.loc=t.ORIGIN,r.t=0;return}if(e.x===i.x&&e.y===i.y){r.loc=t.DESTINATION,r.t=1;return}if(u<-Number.EPSILON){r.loc=t.LEFT;return}if(u>Number.EPSILON){r.loc=t.RIGHT;return}if(o*l<0||s*c<0){r.loc=t.BEHIND;return}if(Math.sqrt(o*o+s*s)<Math.sqrt(l*l+c*c)){r.loc=t.BEYOND;return}a=0!==o?l/o:c/s,r.loc=t.BETWEEN,r.t=a}let i=999999999,a=-999999999,o=e.subPaths.map(e=>{let t=e.getPoints(),r=-999999999,n=999999999,o=-999999999,s=999999999;for(let e=0;e<t.length;e++){let i=t[e];i.y>r&&(r=i.y),i.y<n&&(n=i.y),i.x>o&&(o=i.x),i.x<s&&(s=i.x)}return a<=o&&(a=o+1),i>=s&&(i=s-1),{curves:e.curves,points:t,isCW:eQ.ShapeUtils.isClockWise(t),identifier:-1,boundingBox:new eQ.Box2(new eQ.Vector2(s,n),new eQ.Vector2(o,r))}});o=o.filter(e=>e.points.length>1);for(let e=0;e<o.length;e++)o[e].identifier=e;let s=o.map(s=>(function(e,i,a,o,s){(null==s||""===s)&&(s="nonzero");let l=new eQ.Vector2;e.boundingBox.getCenter(l);let c=function(e,i,a){let o=new eQ.Vector2;i.getCenter(o);let s=[];return a.forEach(i=>{i.boundingBox.containsPoint(o)&&(function(e,i){let a=[],o=[];for(let s=1;s<e.length;s++){let l=e[s-1],c=e[s];for(let e=1;e<i.length;e++){let s=function(e,i,a,o){let s=e.x,l=i.x,c=a.x,u=o.x,h=e.y,d=i.y,f=a.y,p=o.y,m=(u-c)*(h-f)-(p-f)*(s-c),A=(p-f)*(l-s)-(u-c)*(d-h),g=m/A,v=((l-s)*(h-f)-(d-h)*(s-c))/A;if(0===A&&0!==m||g<=0||g>=1||v<0||v>1)return null;if(0===m&&0===A){for(let c=0;c<2;c++){if(n(0===c?a:o,e,i),r.loc==t.ORIGIN){let e=0===c?a:o;return{x:e.x,y:e.y,t:r.t}}if(r.loc==t.BETWEEN)return{x:+(s+r.t*(l-s)).toPrecision(10),y:+(h+r.t*(d-h)).toPrecision(10),t:r.t}}return null}for(let s=0;s<2;s++)if(n(0===s?a:o,e,i),r.loc==t.ORIGIN){let e=0===s?a:o;return{x:e.x,y:e.y,t:r.t}}return{x:+(s+g*(l-s)).toPrecision(10),y:+(h+g*(d-h)).toPrecision(10),t:g}}(l,c,i[e-1],i[e]);null!==s&&void 0===a.find(e=>e.t<=s.t+Number.EPSILON&&e.t>=s.t-Number.EPSILON)&&(a.push(s),o.push(new eQ.Vector2(s.x,s.y)))}}return o})(e,i.points).forEach(e=>{s.push({identifier:i.identifier,isCW:i.isCW,point:e})})}),s.sort((e,t)=>e.point.x-t.point.x),s}([new eQ.Vector2(a,l.y),new eQ.Vector2(o,l.y)],e.boundingBox,i);c.sort((e,t)=>e.point.x-t.point.x);let u=[],h=[];c.forEach(t=>{t.identifier===e.identifier?u.push(t):h.push(t)});let d=u[0].point.x,f=[],p=0;for(;p<h.length&&h[p].point.x<d;)f.length>0&&f[f.length-1]===h[p].identifier?f.pop():f.push(h[p].identifier),p++;if(f.push(e.identifier),"evenodd"===s){let t=f.length%2==0,r=f[f.length-2];return{identifier:e.identifier,isHole:t,for:r}}if("nonzero"===s){let t=!0,r=null,n=null;for(let e=0;e<f.length;e++){let a=f[e];t?(n=i[a].isCW,t=!1,r=a):n!==i[a].isCW&&(n=i[a].isCW,t=!0)}return{identifier:e.identifier,isHole:t,for:r}}console.warn('fill-rule: "'+s+'" is currently not implemented.')})(s,o,i,a,e.userData?e.userData.style.fillRule:void 0)),l=[];return o.forEach(e=>{if(!s[e.identifier].isHole){let t=new eQ.Shape;t.curves=e.curves,s.filter(t=>t.isHole&&t.for===e.identifier).forEach(e=>{let r=o[e.identifier],n=new eQ.Path;n.curves=r.curves,t.holes.push(n)}),l.push(t)}}),l}static getStrokeStyle(e,t,r,n,i){return{strokeColor:t=void 0!==t?t:"#000",strokeWidth:e=void 0!==e?e:1,strokeLineJoin:r=void 0!==r?r:"miter",strokeLineCap:n=void 0!==n?n:"butt",strokeMiterLimit:i=void 0!==i?i:4}}static pointsToStroke(e,t,r,n){let i=[],a=[],o=[];if(0===s7.pointsToStrokeWithBuffers(e,t,r,n,i,a,o))return null;let s=new eQ.BufferGeometry;return s.setAttribute("position",new eQ.Float32BufferAttribute(i,3)),s.setAttribute("normal",new eQ.Float32BufferAttribute(a,3)),s.setAttribute("uv",new eQ.Float32BufferAttribute(o,2)),s}static pointsToStrokeWithBuffers(e,t,r,n,i,a,o,s){let l,c,u,h,d;let f=new eQ.Vector2,p=new eQ.Vector2,m=new eQ.Vector2,A=new eQ.Vector2,g=new eQ.Vector2,v=new eQ.Vector2,y=new eQ.Vector2,x=new eQ.Vector2,E=new eQ.Vector2,_=new eQ.Vector2,C=new eQ.Vector2,b=new eQ.Vector2,w=new eQ.Vector2,B=new eQ.Vector2,I=new eQ.Vector2,M=new eQ.Vector2,S=new eQ.Vector2;r=void 0!==r?r:12,n=void 0!==n?n:.001,s=void 0!==s?s:0;let T=(e=function(e){let t=!1;for(let r=1,i=e.length-1;r<i;r++)if(e[r].distanceTo(e[r+1])<n){t=!0;break}if(!t)return e;let r=[];r.push(e[0]);for(let t=1,i=e.length-1;t<i;t++)e[t].distanceTo(e[t+1])>=n&&r.push(e[t]);return r.push(e[e.length-1]),r}(e)).length;if(T<2)return 0;let P=e[0].equals(e[T-1]),D=e[0],R=t.strokeWidth/2,F=1/(T-1),z=0,O,Q=!1,L=0,k=3*s,U=2*s;N(e[0],e[1],f).multiplyScalar(R),x.copy(e[0]).sub(f),E.copy(e[0]).add(f),_.copy(x),C.copy(E);for(let r=1;r<T;r++){if(l=e[r],c=r===T-1?P?e[1]:void 0:e[r+1],N(D,l,f),m.copy(f).multiplyScalar(R),b.copy(l).sub(m),w.copy(l).add(m),O=z+F,u=!1,void 0!==c){N(l,c,p),m.copy(p).multiplyScalar(R),B.copy(l).sub(m),I.copy(l).add(m),h=!0,m.subVectors(c,D),0>f.dot(m)&&(h=!1),1===r&&(Q=h),m.subVectors(c,l),m.normalize();let e=Math.abs(f.dot(m));if(e>Number.EPSILON){let r=R/e;m.multiplyScalar(-r),A.subVectors(l,D),g.copy(A).setLength(r).add(m),M.copy(g).negate();let n=g.length(),i=A.length();A.divideScalar(i),v.subVectors(c,l);let a=v.length();switch(v.divideScalar(a),A.dot(M)<i&&v.dot(M)<a&&(u=!0),S.copy(g).add(l),M.add(l),d=!1,u?h?(I.copy(M),w.copy(M)):(B.copy(M),b.copy(M)):V(),t.strokeLineJoin){case"bevel":j(h,u,O);break;case"round":Y(h,u),h?H(l,b,B,O,0):H(l,I,w,O,1);break;default:let o=R*t.strokeMiterLimit/n;o<1?"miter-clip"!==t.strokeLineJoin?j(h,u,O):(Y(h,u),h?(v.subVectors(S,b).multiplyScalar(o).add(b),y.subVectors(S,B).multiplyScalar(o).add(B),G(b,O,0),G(v,O,0),G(l,O,.5),G(l,O,.5),G(v,O,0),G(y,O,0),G(l,O,.5),G(y,O,0),G(B,O,0)):(v.subVectors(S,w).multiplyScalar(o).add(w),y.subVectors(S,I).multiplyScalar(o).add(I),G(w,O,1),G(v,O,1),G(l,O,.5),G(l,O,.5),G(v,O,1),G(y,O,1),G(l,O,.5),G(y,O,1),G(I,O,1))):(u?(h?(G(E,z,1),G(x,z,0),G(S,O,0),G(E,z,1),G(S,O,0),G(M,O,1)):(G(E,z,1),G(x,z,0),G(S,O,1),G(x,z,0),G(M,O,0),G(S,O,1)),h?B.copy(S):I.copy(S)):h?(G(b,O,0),G(S,O,0),G(l,O,.5),G(l,O,.5),G(S,O,0),G(B,O,0)):(G(w,O,1),G(S,O,1),G(l,O,.5),G(l,O,.5),G(S,O,1),G(I,O,1)),d=!0)}}else V()}else V();P||r!==T-1||J(e[0],_,C,h,!0,z),z=O,D=l,x.copy(B),E.copy(I)}if(P){if(u&&i){let e=S,t=M;Q!==h&&(e=M,t=S),h?(d||Q)&&(t.toArray(i,0),t.toArray(i,9),d&&e.toArray(i,3)):(d||!Q)&&(t.toArray(i,3),t.toArray(i,9),d&&e.toArray(i,0))}}else J(l,b,w,h,!1,O);return L;function N(e,t,r){return r.subVectors(t,e),r.set(-r.y,r.x).normalize()}function G(e,t,r){i&&(i[k]=e.x,i[k+1]=e.y,i[k+2]=0,a&&(a[k]=0,a[k+1]=0,a[k+2]=1),k+=3,o&&(o[U]=t,o[U+1]=r,U+=2)),L+=3}function H(e,t,n,i,a){f.copy(t).sub(e).normalize(),p.copy(n).sub(e).normalize();let o=Math.PI,s=f.dot(p);1>Math.abs(s)&&(o=Math.abs(Math.acos(s))),o/=r,m.copy(t);for(let t=0,n=r-1;t<n;t++)A.copy(m).rotateAround(e,o),G(m,i,a),G(A,i,a),G(e,i,.5),m.copy(A);G(A,i,a),G(n,i,a),G(e,i,.5)}function V(){G(E,z,1),G(x,z,0),G(b,O,0),G(E,z,1),G(b,O,0),G(w,O,1)}function j(e,t,r){t?e?(G(E,z,1),G(x,z,0),G(b,O,0),G(E,z,1),G(b,O,0),G(M,O,1),G(b,r,0),G(B,r,0),G(M,r,.5)):(G(E,z,1),G(x,z,0),G(w,O,1),G(x,z,0),G(M,O,0),G(w,O,1),G(w,r,1),G(M,r,0),G(I,r,1)):(e?(G(b,r,0),G(B,r,0)):(G(w,r,1),G(I,r,0)),G(l,r,.5))}function Y(e,t){t&&(e?(G(E,z,1),G(x,z,0),G(b,O,0),G(E,z,1),G(b,O,0),G(M,O,1),G(b,z,0),G(l,O,.5),G(M,O,1),G(l,O,.5),G(B,z,0),G(M,O,1)):(G(E,z,1),G(x,z,0),G(w,O,1),G(x,z,0),G(M,O,0),G(w,O,1),G(w,z,1),G(M,O,0),G(l,O,.5),G(l,O,.5),G(M,O,0),G(I,z,1)))}function J(e,r,n,a,s,l){switch(t.strokeLineCap){case"round":s?H(e,n,r,l,.5):H(e,r,n,l,.5);break;case"square":if(s)f.subVectors(r,e),p.set(f.y,-f.x),m.addVectors(f,p).add(e),A.subVectors(p,f).add(e),a?(m.toArray(i,3),A.toArray(i,0),A.toArray(i,9)):(m.toArray(i,3),1===o[7]?A.toArray(i,9):m.toArray(i,9),A.toArray(i,0));else{f.subVectors(n,e),p.set(f.y,-f.x),m.addVectors(f,p).add(e),A.subVectors(p,f).add(e);let t=i.length;a?(m.toArray(i,t-3),A.toArray(i,t-6)):(A.toArray(i,t-6),m.toArray(i,t-3)),A.toArray(i,t-12)}}}}}let le=(0,ez.forwardRef)(function({src:e,skipFill:t,skipStrokes:r,fillMaterial:n,strokeMaterial:i,fillMeshProps:a,strokeMeshProps:o,...s},l){let c=(0,eL.F)(s7,e.startsWith("<svg")?`data:image/svg+xml;utf8,${e}`:e),u=(0,ez.useMemo)(()=>r?[]:c.paths.map(e=>{var t;return(null==(t=e.userData)?void 0:t.style.stroke)===void 0||"none"===e.userData.style.stroke?null:e.subPaths.map(t=>s7.pointsToStroke(t.getPoints(),e.userData.style))}),[c,r]);return(0,ez.useEffect)(()=>()=>u.forEach(e=>e&&e.map(e=>e.dispose())),[u]),ez.createElement("object3D",ee({ref:l},s),ez.createElement("object3D",{scale:[1,-1,1]},c.paths.map((e,s)=>{var l,c;return ez.createElement(ez.Fragment,{key:s},!t&&(null==(l=e.userData)?void 0:l.style.fill)!==void 0&&"none"!==e.userData.style.fill&&s7.createShapes(e).map((t,r)=>ez.createElement("mesh",ee({key:r},a),ez.createElement("shapeGeometry",{args:[t]}),ez.createElement("meshBasicMaterial",ee({color:e.userData.style.fill,opacity:e.userData.style.fillOpacity,transparent:!0,side:eQ.DoubleSide,depthWrite:!1},n)))),!r&&(null==(c=e.userData)?void 0:c.style.stroke)!==void 0&&"none"!==e.userData.style.stroke&&e.subPaths.map((t,r)=>ez.createElement("mesh",ee({key:r,geometry:u[s][r]},o),ez.createElement("meshBasicMaterial",ee({color:e.userData.style.stroke,opacity:e.userData.style.strokeOpacity,transparent:!0,side:eQ.DoubleSide,depthWrite:!1},i)))))})))}),lt=new WeakMap;class lr extends eQ.Loader{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,r,n){let i=new eQ.FileLoader(this.manager);i.setPath(this.path),i.setResponseType("arraybuffer"),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials),i.load(e,e=>{let r={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(e,r).then(t).catch(n)},r,n)}decodeDracoFile(e,t,r,n){let i={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:n||this.defaultAttributeTypes,useUniqueIDs:!!r};this.decodeGeometry(e,i).then(t)}decodeGeometry(e,t){let r;for(let e in t.attributeTypes){let r=t.attributeTypes[e];void 0!==r.BYTES_PER_ELEMENT&&(t.attributeTypes[e]=r.name)}let n=JSON.stringify(t);if(lt.has(e)){let t=lt.get(e);if(t.key===n)return t.promise;if(0===e.byteLength)throw Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let i=this.workerNextTaskID++,a=e.byteLength,o=this._getWorker(i,a).then(n=>(r=n,new Promise((n,a)=>{r._callbacks[i]={resolve:n,reject:a},r.postMessage({type:"decode",id:i,taskConfig:t,buffer:e},[e])}))).then(e=>this._createGeometry(e.geometry));return o.catch(()=>!0).then(()=>{r&&i&&this._releaseTask(r,i)}),lt.set(e,{key:n,promise:o}),o}_createGeometry(e){let t=new eQ.BufferGeometry;e.index&&t.setIndex(new eQ.BufferAttribute(e.index.array,1));for(let r=0;r<e.attributes.length;r++){let n=e.attributes[r],i=n.name,a=n.array,o=n.itemSize;t.setAttribute(i,new eQ.BufferAttribute(a,o))}return t}_loadLibrary(e,t){let r=new eQ.FileLoader(this.manager);return r.setPath(this.decoderPath),r.setResponseType(t),r.setWithCredentials(this.withCredentials),new Promise((t,n)=>{r.load(e,t,void 0,n)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;let e="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(t=>{let r=t[0];e||(this.decoderConfig.wasmBinary=t[1]);let n=ln.toString(),i=["/* draco decoder */",r,"","/* worker */",n.substring(n.indexOf("{")+1,n.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([i]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){let e=new Worker(this.workerSourceURL);e._callbacks={},e._taskCosts={},e._taskLoad=0,e.postMessage({type:"init",decoderConfig:this.decoderConfig}),e.onmessage=function(t){let r=t.data;switch(r.type){case"decode":e._callbacks[r.id].resolve(r);break;case"error":e._callbacks[r.id].reject(r);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+r.type+'"')}},this.workerPool.push(e)}else this.workerPool.sort(function(e,t){return e._taskLoad>t._taskLoad?-1:1});let r=this.workerPool[this.workerPool.length-1];return r._taskCosts[e]=t,r._taskLoad+=t,r})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function ln(){let e,t;onmessage=function(r){let n=r.data;switch(n.type){case"init":e=n.decoderConfig,t=new Promise(function(t){e.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(e)});break;case"decode":let i=n.buffer,a=n.taskConfig;t.then(e=>{let t=e.draco,r=new t.Decoder,o=new t.DecoderBuffer;o.Init(new Int8Array(i),i.byteLength);try{let e=function(e,t,r,n){let i,a;let o=n.attributeIDs,s=n.attributeTypes,l=t.GetEncodedGeometryType(r);if(l===e.TRIANGULAR_MESH)i=new e.Mesh,a=t.DecodeBufferToMesh(r,i);else if(l===e.POINT_CLOUD)i=new e.PointCloud,a=t.DecodeBufferToPointCloud(r,i);else throw Error("THREE.DRACOLoader: Unexpected geometry type.");if(!a.ok()||0===i.ptr)throw Error("THREE.DRACOLoader: Decoding failed: "+a.error_msg());let c={index:null,attributes:[]};for(let r in o){let a,l;let u=self[s[r]];if(n.useUniqueIDs)l=o[r],a=t.GetAttributeByUniqueId(i,l);else{if(-1===(l=t.GetAttributeId(i,e[o[r]])))continue;a=t.GetAttribute(i,l)}c.attributes.push(function(e,t,r,n,i,a){let o=a.num_components(),s=r.num_points()*o,l=s*i.BYTES_PER_ELEMENT,c=function(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32}}(e,i),u=e._malloc(l);t.GetAttributeDataArrayForAllPoints(r,a,c,l,u);let h=new i(e.HEAPF32.buffer,u,s).slice();return e._free(u),{name:n,array:h,itemSize:o}}(e,t,i,r,u,a))}return l===e.TRIANGULAR_MESH&&(c.index=function(e,t,r){let n=3*r.num_faces(),i=4*n,a=e._malloc(i);t.GetTrianglesUInt32Array(r,i,a);let o=new Uint32Array(e.HEAPF32.buffer,a,n).slice();return e._free(a),{array:o,itemSize:1}}(e,t,i)),e.destroy(i),c}(t,r,o,a),i=e.attributes.map(e=>e.array.buffer);e.index&&i.push(e.index.array.buffer),self.postMessage({type:"decode",id:n.id,geometry:e},i)}catch(e){console.error(e),self.postMessage({type:"error",id:n.id,error:e.message})}finally{t.destroy(o),t.destroy(r)}})}}}let li=()=>{let e;if(h)return h;let t=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),r=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if("object"!=typeof WebAssembly)return{supported:!1};let n="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB";WebAssembly.validate(t)&&(n="B9h9z9tFBBBFiI9gBB9gLaaaaaFa9gEaaaB9gFaFaEMcBBFBFFGGGEILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBOn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBNI9z9iqlBVc+N9IcIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMk8lLbaE97F9+FaL978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAeDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAeDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBReCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBH8ZCFD9tA8ZAPD9OD9hD9RH8ZDQBTFtGmEYIPLdKeOnHpAIAQJDBIBHyCFD9tAyAPD9OD9hD9RHyAIASJDBIBH8cCFD9tA8cAPD9OD9hD9RH8cDQBTFtGmEYIPLdKeOnH8dDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAeD9uHeDyBjGBAEAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeApA8dDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNiV8ZcpMyS8cQ8df8eb8fHdAyA8cDQNiV8ZcpMyS8cQ8df8eb8fH8ZDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/dLEK97FaF97GXGXAGCI9HQBAF9FQFCBRGEXABABDBBBHECiD+rFCiD+sFD/6FHIAECND+rFCiD+sFD/6FAID/gFAECTD+rFCiD+sFD/6FHLD/gFD/kFD/lFHKCBDtD+2FHOAICUUUU94DtHND9OD9RD/kFHI9DBB/+hDYAIAID/mFAKAKD/mFALAOALAND9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHLD/mF9DBBX9LDYHOD/kFCgFDtD9OAECUUU94DtD9OD9QAIALD/mFAOD/kFCND+rFCU/+EDtD9OD9QAKALD/mFAOD/kFCTD+rFCUU/8ODtD9OD9QDMBBABCTJRBAGCIJHGAF9JQBSGMMAF9FQBCBRGEXABCTJHVAVDBBBHECBDtHOCUU98D8cFCUU98D8cEHND9OABDBBBHKAEDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAKAEDQBFGENVcMTtmYi8ZpyHECTD+sFD/6FHID/gFAECTD+rFCTD+sFD/6FHLD/gFD/kFD/lFHE9DB/+g6DYALAEAOD+2FHOALCUUUU94DtHcD9OD9RD/kFHLALD/mFAEAED/mFAIAOAIAcD9OD9RD/kFHEAED/mFD/kFD/kFD/jFD/nFHID/mF9DBBX9LDYHOD/kFCTD+rFALAID/mFAOD/kFCggEDtD9OD9QHLAEAID/mFAOD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHEDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAKAND9OALAEDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM/hEIGaF97FaL978jUUUUBCTlREGXAF9FQBCBRIEXAEABDBBBHLABCTJHKDBBBHODQILKOSQfbPden8c8d8e8fHNCTD+sFHVCID+rFDMIBAB9DBBU8/DY9D/zI818/DYAVCEDtD9QD/6FD/nFHVALAODQBFGENVcMTtmYi8ZpyHLCTD+rFCTD+sFD/6FD/mFHOAOD/mFAVALCTD+sFD/6FD/mFHcAcD/mFAVANCTD+rFCTD+sFD/6FD/mFHNAND/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHVD/mF9DBBX9LDYHLD/kFCggEDtHMD9OAcAVD/mFALD/kFCTD+rFD9QHcANAVD/mFALD/kFCTD+rFAOAVD/mFALD/kFAMD9OD9QHVDQBFTtGEmYILPdKOenHLD8dBAEDBIBDyB+t+J83EBABCNJALD8dFAEDBIBDyF+t+J83EBAKAcAVDQNVi8ZcMpySQ8c8dfb8e8fHVD8dBAEDBIBDyG+t+J83EBABCiJAVD8dFAEDBIBDyE+t+J83EBABCAJRBAICIJHIAF9JQBMMM9jFF97GXAGCGrAF9sHG9FQBCBRFEXABABDBBBHECND+rFCND+sFD/6FAECiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBABCTJRBAFCIJHFAG9JQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB");let i=WebAssembly.instantiate(function(e){let t=new Uint8Array(e.length);for(let r=0;r<e.length;++r){let n=e.charCodeAt(r);t[r]=n>96?n-71:n>64?n-65:n>47?n+4:n>46?63:62}let n=0;for(let i=0;i<e.length;++i)t[n++]=t[i]<60?r[t[i]]:(t[i]-60)*64+t[++i];return t.buffer.slice(0,n)}(n),{}).then(t=>{(e=t.instance).exports.__wasm_call_ctors()});function a(t,r,n,i,a,o){let s=e.exports.sbrk,l=n+3&-4,c=s(l*i),u=s(a.length),h=new Uint8Array(e.exports.memory.buffer);h.set(a,u);let d=t(c,n,i,u,a.length);if(0===d&&o&&o(c,l,i),r.set(h.subarray(c,c+n*i)),s(c-s(0)),0!==d)throw Error(`Malformed buffer data: ${d}`)}let o={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},s={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return h={ready:i,supported:!0,decodeVertexBuffer(t,r,n,i,s){a(e.exports.meshopt_decodeVertexBuffer,t,r,n,i,e.exports[o[s]])},decodeIndexBuffer(t,r,n,i){a(e.exports.meshopt_decodeIndexBuffer,t,r,n,i)},decodeIndexSequence(t,r,n,i){a(e.exports.meshopt_decodeIndexSequence,t,r,n,i)},decodeGltfBuffer(t,r,n,i,l,c){a(e.exports[s[l]],t,r,n,i,e.exports[o[c]])}}},la=parseInt(eQ.REVISION.replace(/\D+/g,""));function lo(e){if("undefined"!=typeof TextDecoder)return new TextDecoder().decode(e);let t="";for(let r=0,n=e.length;r<n;r++)t+=String.fromCharCode(e[r]);try{return decodeURIComponent(escape(t))}catch(e){return t}}let ls="srgb",ll="srgb-linear";class lc extends eQ.Loader{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(e){return new lm(e)}),this.register(function(e){return new lA(e)}),this.register(function(e){return new lw(e)}),this.register(function(e){return new lB(e)}),this.register(function(e){return new lI(e)}),this.register(function(e){return new lv(e)}),this.register(function(e){return new ly(e)}),this.register(function(e){return new lx(e)}),this.register(function(e){return new lE(e)}),this.register(function(e){return new lp(e)}),this.register(function(e){return new l_(e)}),this.register(function(e){return new lg(e)}),this.register(function(e){return new lb(e)}),this.register(function(e){return new lC(e)}),this.register(function(e){return new ld(e)}),this.register(function(e){return new lM(e)}),this.register(function(e){return new lS(e)})}load(e,t,r,n){let i;let a=this;if(""!==this.resourcePath)i=this.resourcePath;else if(""!==this.path){let t=eQ.LoaderUtils.extractUrlBase(e);i=eQ.LoaderUtils.resolveURL(t,this.path)}else i=eQ.LoaderUtils.extractUrlBase(e);this.manager.itemStart(e);let o=function(t){n?n(t):console.error(t),a.manager.itemError(e),a.manager.itemEnd(e)},s=new eQ.FileLoader(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,function(r){try{a.parse(r,i,function(r){t(r),a.manager.itemEnd(e)},o)}catch(e){o(e)}},r,o)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return -1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return -1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,r,n){let i;let a={},o={};if("string"==typeof e)i=JSON.parse(e);else if(e instanceof ArrayBuffer){if(lo(new Uint8Array(e.slice(0,4)))===lT){try{a[lh.KHR_BINARY_GLTF]=new lD(e)}catch(e){n&&n(e);return}i=JSON.parse(a[lh.KHR_BINARY_GLTF].content)}else i=JSON.parse(lo(new Uint8Array(e)))}else i=e;if(void 0===i.asset||i.asset.version[0]<2){n&&n(Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}let s=new l$(i,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});s.fileLoader.setRequestHeader(this.requestHeader);for(let e=0;e<this.pluginCallbacks.length;e++){let t=this.pluginCallbacks[e](s);t.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),o[t.name]=t,a[t.name]=!0}if(i.extensionsUsed)for(let e=0;e<i.extensionsUsed.length;++e){let t=i.extensionsUsed[e],r=i.extensionsRequired||[];switch(t){case lh.KHR_MATERIALS_UNLIT:a[t]=new lf;break;case lh.KHR_DRACO_MESH_COMPRESSION:a[t]=new lR(i,this.dracoLoader);break;case lh.KHR_TEXTURE_TRANSFORM:a[t]=new lF;break;case lh.KHR_MESH_QUANTIZATION:a[t]=new lz;break;default:r.indexOf(t)>=0&&void 0===o[t]&&console.warn('THREE.GLTFLoader: Unknown extension "'+t+'".')}}s.setExtensions(a),s.setPlugins(o),s.parse(r,n)}parseAsync(e,t){let r=this;return new Promise(function(n,i){r.parse(e,t,n,i)})}}function lu(){let e={};return{get:function(t){return e[t]},add:function(t,r){e[t]=r},remove:function(t){delete e[t]},removeAll:function(){e={}}}}let lh={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class ld{constructor(e){this.parser=e,this.name=lh.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){let e=this.parser,t=this.parser.json.nodes||[];for(let r=0,n=t.length;r<n;r++){let n=t[r];n.extensions&&n.extensions[this.name]&&void 0!==n.extensions[this.name].light&&e._addNodeRef(this.cache,n.extensions[this.name].light)}}_loadLight(e){let t;let r=this.parser,n="light:"+e,i=r.cache.get(n);if(i)return i;let a=r.json,o=((a.extensions&&a.extensions[this.name]||{}).lights||[])[e],s=new eQ.Color(16777215);void 0!==o.color&&s.setRGB(o.color[0],o.color[1],o.color[2],ll);let l=void 0!==o.range?o.range:0;switch(o.type){case"directional":(t=new eQ.DirectionalLight(s)).target.position.set(0,0,-1),t.add(t.target);break;case"point":(t=new eQ.PointLight(s)).distance=l;break;case"spot":(t=new eQ.SpotLight(s)).distance=l,o.spot=o.spot||{},o.spot.innerConeAngle=void 0!==o.spot.innerConeAngle?o.spot.innerConeAngle:0,o.spot.outerConeAngle=void 0!==o.spot.outerConeAngle?o.spot.outerConeAngle:Math.PI/4,t.angle=o.spot.outerConeAngle,t.penumbra=1-o.spot.innerConeAngle/o.spot.outerConeAngle,t.target.position.set(0,0,-1),t.add(t.target);break;default:throw Error("THREE.GLTFLoader: Unexpected light type: "+o.type)}return t.position.set(0,0,0),t.decay=2,lq(t,o),void 0!==o.intensity&&(t.intensity=o.intensity),t.name=r.createUniqueName(o.name||"light_"+e),i=Promise.resolve(t),r.cache.add(n,i),i}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){let t=this,r=this.parser,n=r.json.nodes[e],i=(n.extensions&&n.extensions[this.name]||{}).light;return void 0===i?null:this._loadLight(i).then(function(e){return r._getNodeRef(t.cache,i,e)})}}class lf{constructor(){this.name=lh.KHR_MATERIALS_UNLIT}getMaterialType(){return eQ.MeshBasicMaterial}extendParams(e,t,r){let n=[];e.color=new eQ.Color(1,1,1),e.opacity=1;let i=t.pbrMetallicRoughness;if(i){if(Array.isArray(i.baseColorFactor)){let t=i.baseColorFactor;e.color.setRGB(t[0],t[1],t[2],ll),e.opacity=t[3]}void 0!==i.baseColorTexture&&n.push(r.assignTexture(e,"map",i.baseColorTexture,ls))}return Promise.all(n)}}class lp{constructor(e){this.parser=e,this.name=lh.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){let r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let n=r.extensions[this.name].emissiveStrength;return void 0!==n&&(t.emissiveIntensity=n),Promise.resolve()}}class lm{constructor(e){this.parser=e,this.name=lh.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?eQ.MeshPhysicalMaterial:null}extendMaterialParams(e,t){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let i=[],a=n.extensions[this.name];if(void 0!==a.clearcoatFactor&&(t.clearcoat=a.clearcoatFactor),void 0!==a.clearcoatTexture&&i.push(r.assignTexture(t,"clearcoatMap",a.clearcoatTexture)),void 0!==a.clearcoatRoughnessFactor&&(t.clearcoatRoughness=a.clearcoatRoughnessFactor),void 0!==a.clearcoatRoughnessTexture&&i.push(r.assignTexture(t,"clearcoatRoughnessMap",a.clearcoatRoughnessTexture)),void 0!==a.clearcoatNormalTexture&&(i.push(r.assignTexture(t,"clearcoatNormalMap",a.clearcoatNormalTexture)),void 0!==a.clearcoatNormalTexture.scale)){let e=a.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new eQ.Vector2(e,e)}return Promise.all(i)}}class lA{constructor(e){this.parser=e,this.name=lh.KHR_MATERIALS_DISPERSION}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?eQ.MeshPhysicalMaterial:null}extendMaterialParams(e,t){let r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let n=r.extensions[this.name];return t.dispersion=void 0!==n.dispersion?n.dispersion:0,Promise.resolve()}}class lg{constructor(e){this.parser=e,this.name=lh.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?eQ.MeshPhysicalMaterial:null}extendMaterialParams(e,t){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let i=[],a=n.extensions[this.name];return void 0!==a.iridescenceFactor&&(t.iridescence=a.iridescenceFactor),void 0!==a.iridescenceTexture&&i.push(r.assignTexture(t,"iridescenceMap",a.iridescenceTexture)),void 0!==a.iridescenceIor&&(t.iridescenceIOR=a.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==a.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=a.iridescenceThicknessMinimum),void 0!==a.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=a.iridescenceThicknessMaximum),void 0!==a.iridescenceThicknessTexture&&i.push(r.assignTexture(t,"iridescenceThicknessMap",a.iridescenceThicknessTexture)),Promise.all(i)}}class lv{constructor(e){this.parser=e,this.name=lh.KHR_MATERIALS_SHEEN}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?eQ.MeshPhysicalMaterial:null}extendMaterialParams(e,t){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let i=[];t.sheenColor=new eQ.Color(0,0,0),t.sheenRoughness=0,t.sheen=1;let a=n.extensions[this.name];if(void 0!==a.sheenColorFactor){let e=a.sheenColorFactor;t.sheenColor.setRGB(e[0],e[1],e[2],ll)}return void 0!==a.sheenRoughnessFactor&&(t.sheenRoughness=a.sheenRoughnessFactor),void 0!==a.sheenColorTexture&&i.push(r.assignTexture(t,"sheenColorMap",a.sheenColorTexture,ls)),void 0!==a.sheenRoughnessTexture&&i.push(r.assignTexture(t,"sheenRoughnessMap",a.sheenRoughnessTexture)),Promise.all(i)}}class ly{constructor(e){this.parser=e,this.name=lh.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?eQ.MeshPhysicalMaterial:null}extendMaterialParams(e,t){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let i=[],a=n.extensions[this.name];return void 0!==a.transmissionFactor&&(t.transmission=a.transmissionFactor),void 0!==a.transmissionTexture&&i.push(r.assignTexture(t,"transmissionMap",a.transmissionTexture)),Promise.all(i)}}class lx{constructor(e){this.parser=e,this.name=lh.KHR_MATERIALS_VOLUME}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?eQ.MeshPhysicalMaterial:null}extendMaterialParams(e,t){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let i=[],a=n.extensions[this.name];t.thickness=void 0!==a.thicknessFactor?a.thicknessFactor:0,void 0!==a.thicknessTexture&&i.push(r.assignTexture(t,"thicknessMap",a.thicknessTexture)),t.attenuationDistance=a.attenuationDistance||1/0;let o=a.attenuationColor||[1,1,1];return t.attenuationColor=new eQ.Color().setRGB(o[0],o[1],o[2],ll),Promise.all(i)}}class lE{constructor(e){this.parser=e,this.name=lh.KHR_MATERIALS_IOR}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?eQ.MeshPhysicalMaterial:null}extendMaterialParams(e,t){let r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let n=r.extensions[this.name];return t.ior=void 0!==n.ior?n.ior:1.5,Promise.resolve()}}class l_{constructor(e){this.parser=e,this.name=lh.KHR_MATERIALS_SPECULAR}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?eQ.MeshPhysicalMaterial:null}extendMaterialParams(e,t){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let i=[],a=n.extensions[this.name];t.specularIntensity=void 0!==a.specularFactor?a.specularFactor:1,void 0!==a.specularTexture&&i.push(r.assignTexture(t,"specularIntensityMap",a.specularTexture));let o=a.specularColorFactor||[1,1,1];return t.specularColor=new eQ.Color().setRGB(o[0],o[1],o[2],ll),void 0!==a.specularColorTexture&&i.push(r.assignTexture(t,"specularColorMap",a.specularColorTexture,ls)),Promise.all(i)}}class lC{constructor(e){this.parser=e,this.name=lh.EXT_MATERIALS_BUMP}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?eQ.MeshPhysicalMaterial:null}extendMaterialParams(e,t){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let i=[],a=n.extensions[this.name];return t.bumpScale=void 0!==a.bumpFactor?a.bumpFactor:1,void 0!==a.bumpTexture&&i.push(r.assignTexture(t,"bumpMap",a.bumpTexture)),Promise.all(i)}}class lb{constructor(e){this.parser=e,this.name=lh.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?eQ.MeshPhysicalMaterial:null}extendMaterialParams(e,t){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let i=[],a=n.extensions[this.name];return void 0!==a.anisotropyStrength&&(t.anisotropy=a.anisotropyStrength),void 0!==a.anisotropyRotation&&(t.anisotropyRotation=a.anisotropyRotation),void 0!==a.anisotropyTexture&&i.push(r.assignTexture(t,"anisotropyMap",a.anisotropyTexture)),Promise.all(i)}}class lw{constructor(e){this.parser=e,this.name=lh.KHR_TEXTURE_BASISU}loadTexture(e){let t=this.parser,r=t.json,n=r.textures[e];if(!n.extensions||!n.extensions[this.name])return null;let i=n.extensions[this.name],a=t.options.ktx2Loader;if(!a){if(!(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0))return null;throw Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures")}return t.loadTextureImage(e,i.source,a)}}class lB{constructor(e){this.parser=e,this.name=lh.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){let t=this.name,r=this.parser,n=r.json,i=n.textures[e];if(!i.extensions||!i.extensions[t])return null;let a=i.extensions[t],o=n.images[a.source],s=r.textureLoader;if(o.uri){let e=r.options.manager.getHandler(o.uri);null!==e&&(s=e)}return this.detectSupport().then(function(i){if(i)return r.loadTextureImage(e,a.source,s);if(n.extensionsRequired&&n.extensionsRequired.indexOf(t)>=0)throw Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){let t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class lI{constructor(e){this.parser=e,this.name=lh.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){let t=this.name,r=this.parser,n=r.json,i=n.textures[e];if(!i.extensions||!i.extensions[t])return null;let a=i.extensions[t],o=n.images[a.source],s=r.textureLoader;if(o.uri){let e=r.options.manager.getHandler(o.uri);null!==e&&(s=e)}return this.detectSupport().then(function(i){if(i)return r.loadTextureImage(e,a.source,s);if(n.extensionsRequired&&n.extensionsRequired.indexOf(t)>=0)throw Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){let t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class lM{constructor(e){this.name=lh.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){let t=this.parser.json,r=t.bufferViews[e];if(!r.extensions||!r.extensions[this.name])return null;{let e=r.extensions[this.name],n=this.parser.getDependency("buffer",e.buffer),i=this.parser.options.meshoptDecoder;if(!i||!i.supported){if(!(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0))return null;throw Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files")}return n.then(function(t){let r=e.byteOffset||0,n=e.byteLength||0,a=e.count,o=e.byteStride,s=new Uint8Array(t,r,n);return i.decodeGltfBufferAsync?i.decodeGltfBufferAsync(a,o,s,e.mode,e.filter).then(function(e){return e.buffer}):i.ready.then(function(){let t=new ArrayBuffer(a*o);return i.decodeGltfBuffer(new Uint8Array(t),a,o,s,e.mode,e.filter),t})})}}}class lS{constructor(e){this.name=lh.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){let t=this.parser.json,r=t.nodes[e];if(!r.extensions||!r.extensions[this.name]||void 0===r.mesh)return null;for(let e of t.meshes[r.mesh].primitives)if(e.mode!==lk.TRIANGLES&&e.mode!==lk.TRIANGLE_STRIP&&e.mode!==lk.TRIANGLE_FAN&&void 0!==e.mode)return null;let n=r.extensions[this.name].attributes,i=[],a={};for(let e in n)i.push(this.parser.getDependency("accessor",n[e]).then(t=>(a[e]=t,a[e])));return i.length<1?null:(i.push(this.parser.createNodeMesh(e)),Promise.all(i).then(e=>{let t=e.pop(),r=t.isGroup?t.children:[t],n=e[0].count,i=[];for(let e of r){let t=new eQ.Matrix4,r=new eQ.Vector3,o=new eQ.Quaternion,s=new eQ.Vector3(1,1,1),l=new eQ.InstancedMesh(e.geometry,e.material,n);for(let e=0;e<n;e++)a.TRANSLATION&&r.fromBufferAttribute(a.TRANSLATION,e),a.ROTATION&&o.fromBufferAttribute(a.ROTATION,e),a.SCALE&&s.fromBufferAttribute(a.SCALE,e),l.setMatrixAt(e,t.compose(r,o,s));for(let t in a)if("_COLOR_0"===t){let e=a[t];l.instanceColor=new eQ.InstancedBufferAttribute(e.array,e.itemSize,e.normalized)}else"TRANSLATION"!==t&&"ROTATION"!==t&&"SCALE"!==t&&e.geometry.setAttribute(t,a[t]);eQ.Object3D.prototype.copy.call(l,e),this.parser.assignFinalMaterial(l),i.push(l)}return t.isGroup?(t.clear(),t.add(...i),t):i[0]}))}}let lT="glTF",lP={JSON:1313821514,BIN:5130562};class lD{constructor(e){this.name=lh.KHR_BINARY_GLTF,this.content=null,this.body=null;let t=new DataView(e,0,12);if(this.header={magic:lo(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==lT)throw Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw Error("THREE.GLTFLoader: Legacy binary file detected.");let r=this.header.length-12,n=new DataView(e,12),i=0;for(;i<r;){let t=n.getUint32(i,!0);i+=4;let r=n.getUint32(i,!0);if(i+=4,r===lP.JSON){let r=new Uint8Array(e,12+i,t);this.content=lo(r)}else if(r===lP.BIN){let r=12+i;this.body=e.slice(r,r+t)}i+=t}if(null===this.content)throw Error("THREE.GLTFLoader: JSON content not found.")}}class lR{constructor(e,t){if(!t)throw Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=lh.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){let r=this.json,n=this.dracoLoader,i=e.extensions[this.name].bufferView,a=e.extensions[this.name].attributes,o={},s={},l={};for(let e in a)o[lV[e]||e.toLowerCase()]=a[e];for(let t in e.attributes){let n=lV[t]||t.toLowerCase();if(void 0!==a[t]){let i=r.accessors[e.attributes[t]],a=lU[i.componentType];l[n]=a.name,s[n]=!0===i.normalized}}return t.getDependency("bufferView",i).then(function(e){return new Promise(function(t,r){n.decodeDracoFile(e,function(e){for(let t in e.attributes){let r=e.attributes[t],n=s[t];void 0!==n&&(r.normalized=n)}t(e)},o,l,ll,r)})})}}class lF{constructor(){this.name=lh.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(void 0===t.texCoord||t.texCoord===e.channel)&&void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.texCoord&&(e.channel=t.texCoord),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class lz{constructor(){this.name=lh.KHR_MESH_QUANTIZATION}}class lO extends eQ.Interpolant{constructor(e,t,r,n){super(e,t,r,n)}copySampleValue_(e){let t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,i=e*n*3+n;for(let e=0;e!==n;e++)t[e]=r[i+e];return t}interpolate_(e,t,r,n){let i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=2*o,l=3*o,c=n-t,u=(r-t)/c,h=u*u,d=h*u,f=e*l,p=f-l,m=-2*d+3*h,A=d-h,g=1-m,v=A-h+u;for(let e=0;e!==o;e++){let t=a[p+e+o],r=a[p+e+s]*c,n=a[f+e+o],l=a[f+e]*c;i[e]=g*t+v*r+m*n+A*l}return i}}let lQ=new eQ.Quaternion;class lL extends lO{interpolate_(e,t,r,n){let i=super.interpolate_(e,t,r,n);return lQ.fromArray(i).normalize().toArray(i),i}}let lk={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},lU={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},lN={9728:eQ.NearestFilter,9729:eQ.LinearFilter,9984:eQ.NearestMipmapNearestFilter,9985:eQ.LinearMipmapNearestFilter,9986:eQ.NearestMipmapLinearFilter,9987:eQ.LinearMipmapLinearFilter},lG={33071:eQ.ClampToEdgeWrapping,33648:eQ.MirroredRepeatWrapping,10497:eQ.RepeatWrapping},lH={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},lV={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...la>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},lj={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},lY={CUBICSPLINE:void 0,LINEAR:eQ.InterpolateLinear,STEP:eQ.InterpolateDiscrete},lJ={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function lW(e,t,r){for(let n in r.extensions)void 0===e[n]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[n]=r.extensions[n])}function lq(e,t){void 0!==t.extras&&("object"==typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function lK(e){let t="",r=Object.keys(e).sort();for(let n=0,i=r.length;n<i;n++)t+=r[n]+":"+e[r[n]]+";";return t}function lX(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}let lZ=new eQ.Matrix4;class l${constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new lu,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let r=!1,n=!1,i=-1;"undefined"!=typeof navigator&&void 0!==navigator.userAgent&&(r=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),i=(n=navigator.userAgent.indexOf("Firefox")>-1)?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),"undefined"==typeof createImageBitmap||r||n&&i<98?this.textureLoader=new eQ.TextureLoader(this.options.manager):this.textureLoader=new eQ.ImageBitmapLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new eQ.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){let r=this,n=this.json,i=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(e){return e._markDefs&&e._markDefs()}),Promise.all(this._invokeAll(function(e){return e.beforeRoot&&e.beforeRoot()})).then(function(){return Promise.all([r.getDependencies("scene"),r.getDependencies("animation"),r.getDependencies("camera")])}).then(function(t){let a={scene:t[0][n.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:n.asset,parser:r,userData:{}};return lW(i,a,n),lq(a,n),Promise.all(r._invokeAll(function(e){return e.afterRoot&&e.afterRoot(a)})).then(function(){for(let e of a.scenes)e.updateMatrixWorld();e(a)})}).catch(t)}_markDefs(){let e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[];for(let r=0,n=t.length;r<n;r++){let n=t[r].joints;for(let t=0,r=n.length;t<r;t++)e[n[t]].isBone=!0}for(let t=0,n=e.length;t<n;t++){let n=e[t];void 0!==n.mesh&&(this._addNodeRef(this.meshCache,n.mesh),void 0!==n.skin&&(r[n.mesh].isSkinnedMesh=!0)),void 0!==n.camera&&this._addNodeRef(this.cameraCache,n.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,r){if(e.refs[t]<=1)return r;let n=r.clone(),i=(e,t)=>{let r=this.associations.get(e);for(let[n,a]of(null!=r&&this.associations.set(t,r),e.children.entries()))i(a,t.children[n])};return i(r,n),n.name+="_instance_"+e.uses[t]++,n}_invokeOne(e){let t=Object.values(this.plugins);t.push(this);for(let r=0;r<t.length;r++){let n=e(t[r]);if(n)return n}return null}_invokeAll(e){let t=Object.values(this.plugins);t.unshift(this);let r=[];for(let n=0;n<t.length;n++){let i=e(t[n]);i&&r.push(i)}return r}getDependency(e,t){let r=e+":"+t,n=this.cache.get(r);if(!n){switch(e){case"scene":n=this.loadScene(t);break;case"node":n=this._invokeOne(function(e){return e.loadNode&&e.loadNode(t)});break;case"mesh":n=this._invokeOne(function(e){return e.loadMesh&&e.loadMesh(t)});break;case"accessor":n=this.loadAccessor(t);break;case"bufferView":n=this._invokeOne(function(e){return e.loadBufferView&&e.loadBufferView(t)});break;case"buffer":n=this.loadBuffer(t);break;case"material":n=this._invokeOne(function(e){return e.loadMaterial&&e.loadMaterial(t)});break;case"texture":n=this._invokeOne(function(e){return e.loadTexture&&e.loadTexture(t)});break;case"skin":n=this.loadSkin(t);break;case"animation":n=this._invokeOne(function(e){return e.loadAnimation&&e.loadAnimation(t)});break;case"camera":n=this.loadCamera(t);break;default:if(!(n=this._invokeOne(function(r){return r!=this&&r.getDependency&&r.getDependency(e,t)})))throw Error("Unknown type: "+e)}this.cache.add(r,n)}return n}getDependencies(e){let t=this.cache.get(e);if(!t){let r=this;t=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map(function(t,n){return r.getDependency(e,n)})),this.cache.add(e,t)}return t}loadBuffer(e){let t=this.json.buffers[e],r=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[lh.KHR_BINARY_GLTF].body);let n=this.options;return new Promise(function(e,i){r.load(eQ.LoaderUtils.resolveURL(t.uri,n.path),e,void 0,function(){i(Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){let t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(e){let r=t.byteLength||0,n=t.byteOffset||0;return e.slice(n,n+r)})}loadAccessor(e){let t=this,r=this.json,n=this.json.accessors[e];if(void 0===n.bufferView&&void 0===n.sparse){let e=lH[n.type],t=lU[n.componentType],r=!0===n.normalized,i=new t(n.count*e);return Promise.resolve(new eQ.BufferAttribute(i,e,r))}let i=[];return void 0!==n.bufferView?i.push(this.getDependency("bufferView",n.bufferView)):i.push(null),void 0!==n.sparse&&(i.push(this.getDependency("bufferView",n.sparse.indices.bufferView)),i.push(this.getDependency("bufferView",n.sparse.values.bufferView))),Promise.all(i).then(function(e){let i,a;let o=e[0],s=lH[n.type],l=lU[n.componentType],c=l.BYTES_PER_ELEMENT,u=c*s,h=n.byteOffset||0,d=void 0!==n.bufferView?r.bufferViews[n.bufferView].byteStride:void 0,f=!0===n.normalized;if(d&&d!==u){let e=Math.floor(h/d),r="InterleavedBuffer:"+n.bufferView+":"+n.componentType+":"+e+":"+n.count,u=t.cache.get(r);u||(i=new l(o,e*d,n.count*d/c),u=new eQ.InterleavedBuffer(i,d/c),t.cache.add(r,u)),a=new eQ.InterleavedBufferAttribute(u,s,h%d/c,f)}else i=null===o?new l(n.count*s):new l(o,h,n.count*s),a=new eQ.BufferAttribute(i,s,f);if(void 0!==n.sparse){let t=lH.SCALAR,r=lU[n.sparse.indices.componentType],i=n.sparse.indices.byteOffset||0,c=n.sparse.values.byteOffset||0,u=new r(e[1],i,n.sparse.count*t),h=new l(e[2],c,n.sparse.count*s);null!==o&&(a=new eQ.BufferAttribute(a.array.slice(),a.itemSize,a.normalized));for(let e=0,t=u.length;e<t;e++){let t=u[e];if(a.setX(t,h[e*s]),s>=2&&a.setY(t,h[e*s+1]),s>=3&&a.setZ(t,h[e*s+2]),s>=4&&a.setW(t,h[e*s+3]),s>=5)throw Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return a})}loadTexture(e){let t=this.json,r=this.options,n=t.textures[e].source,i=t.images[n],a=this.textureLoader;if(i.uri){let e=r.manager.getHandler(i.uri);null!==e&&(a=e)}return this.loadTextureImage(e,n,a)}loadTextureImage(e,t,r){let n=this,i=this.json,a=i.textures[e],o=i.images[t],s=(o.uri||o.bufferView)+":"+a.sampler;if(this.textureCache[s])return this.textureCache[s];let l=this.loadImageSource(t,r).then(function(t){t.flipY=!1,t.name=a.name||o.name||"",""===t.name&&"string"==typeof o.uri&&!1===o.uri.startsWith("data:image/")&&(t.name=o.uri);let r=(i.samplers||{})[a.sampler]||{};return t.magFilter=lN[r.magFilter]||eQ.LinearFilter,t.minFilter=lN[r.minFilter]||eQ.LinearMipmapLinearFilter,t.wrapS=lG[r.wrapS]||eQ.RepeatWrapping,t.wrapT=lG[r.wrapT]||eQ.RepeatWrapping,n.associations.set(t,{textures:e}),t}).catch(function(){return null});return this.textureCache[s]=l,l}loadImageSource(e,t){let r=this.json,n=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(e=>e.clone());let i=r.images[e],a=self.URL||self.webkitURL,o=i.uri||"",s=!1;if(void 0!==i.bufferView)o=this.getDependency("bufferView",i.bufferView).then(function(e){s=!0;let t=new Blob([e],{type:i.mimeType});return o=a.createObjectURL(t)});else if(void 0===i.uri)throw Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");let l=Promise.resolve(o).then(function(e){return new Promise(function(r,i){let a=r;!0===t.isImageBitmapLoader&&(a=function(e){let t=new eQ.Texture(e);t.needsUpdate=!0,r(t)}),t.load(eQ.LoaderUtils.resolveURL(e,n.path),a,void 0,i)})}).then(function(e){var t;return!0===s&&a.revokeObjectURL(o),lq(e,i),e.userData.mimeType=i.mimeType||((t=i.uri).search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/)?"image/jpeg":t.search(/\.webp($|\?)/i)>0||0===t.search(/^data\:image\/webp/)?"image/webp":"image/png"),e}).catch(function(e){throw console.error("THREE.GLTFLoader: Couldn't load texture",o),e});return this.sourceCache[e]=l,l}assignTexture(e,t,r,n){let i=this;return this.getDependency("texture",r.index).then(function(a){if(!a)return null;if(void 0!==r.texCoord&&r.texCoord>0&&((a=a.clone()).channel=r.texCoord),i.extensions[lh.KHR_TEXTURE_TRANSFORM]){let e=void 0!==r.extensions?r.extensions[lh.KHR_TEXTURE_TRANSFORM]:void 0;if(e){let t=i.associations.get(a);a=i.extensions[lh.KHR_TEXTURE_TRANSFORM].extendTexture(a,e),i.associations.set(a,t)}}return void 0!==n&&("number"==typeof n&&(n=3001===n?ls:ll),"colorSpace"in a?a.colorSpace=n:a.encoding=n===ls?3001:3e3),e[t]=a,a})}assignFinalMaterial(e){let t=e.geometry,r=e.material,n=void 0===t.attributes.tangent,i=void 0!==t.attributes.color,a=void 0===t.attributes.normal;if(e.isPoints){let e="PointsMaterial:"+r.uuid,t=this.cache.get(e);t||(t=new eQ.PointsMaterial,eQ.Material.prototype.copy.call(t,r),t.color.copy(r.color),t.map=r.map,t.sizeAttenuation=!1,this.cache.add(e,t)),r=t}else if(e.isLine){let e="LineBasicMaterial:"+r.uuid,t=this.cache.get(e);t||(t=new eQ.LineBasicMaterial,eQ.Material.prototype.copy.call(t,r),t.color.copy(r.color),t.map=r.map,this.cache.add(e,t)),r=t}if(n||i||a){let e="ClonedMaterial:"+r.uuid+":";n&&(e+="derivative-tangents:"),i&&(e+="vertex-colors:"),a&&(e+="flat-shading:");let t=this.cache.get(e);t||(t=r.clone(),i&&(t.vertexColors=!0),a&&(t.flatShading=!0),n&&(t.normalScale&&(t.normalScale.y*=-1),t.clearcoatNormalScale&&(t.clearcoatNormalScale.y*=-1)),this.cache.add(e,t),this.associations.set(t,this.associations.get(r))),r=t}e.material=r}getMaterialType(){return eQ.MeshStandardMaterial}loadMaterial(e){let t;let r=this,n=this.json,i=this.extensions,a=n.materials[e],o={},s=a.extensions||{},l=[];if(s[lh.KHR_MATERIALS_UNLIT]){let e=i[lh.KHR_MATERIALS_UNLIT];t=e.getMaterialType(),l.push(e.extendParams(o,a,r))}else{let n=a.pbrMetallicRoughness||{};if(o.color=new eQ.Color(1,1,1),o.opacity=1,Array.isArray(n.baseColorFactor)){let e=n.baseColorFactor;o.color.setRGB(e[0],e[1],e[2],ll),o.opacity=e[3]}void 0!==n.baseColorTexture&&l.push(r.assignTexture(o,"map",n.baseColorTexture,ls)),o.metalness=void 0!==n.metallicFactor?n.metallicFactor:1,o.roughness=void 0!==n.roughnessFactor?n.roughnessFactor:1,void 0!==n.metallicRoughnessTexture&&(l.push(r.assignTexture(o,"metalnessMap",n.metallicRoughnessTexture)),l.push(r.assignTexture(o,"roughnessMap",n.metallicRoughnessTexture))),t=this._invokeOne(function(t){return t.getMaterialType&&t.getMaterialType(e)}),l.push(Promise.all(this._invokeAll(function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,o)})))}!0===a.doubleSided&&(o.side=eQ.DoubleSide);let c=a.alphaMode||lJ.OPAQUE;if(c===lJ.BLEND?(o.transparent=!0,o.depthWrite=!1):(o.transparent=!1,c===lJ.MASK&&(o.alphaTest=void 0!==a.alphaCutoff?a.alphaCutoff:.5)),void 0!==a.normalTexture&&t!==eQ.MeshBasicMaterial&&(l.push(r.assignTexture(o,"normalMap",a.normalTexture)),o.normalScale=new eQ.Vector2(1,1),void 0!==a.normalTexture.scale)){let e=a.normalTexture.scale;o.normalScale.set(e,e)}if(void 0!==a.occlusionTexture&&t!==eQ.MeshBasicMaterial&&(l.push(r.assignTexture(o,"aoMap",a.occlusionTexture)),void 0!==a.occlusionTexture.strength&&(o.aoMapIntensity=a.occlusionTexture.strength)),void 0!==a.emissiveFactor&&t!==eQ.MeshBasicMaterial){let e=a.emissiveFactor;o.emissive=new eQ.Color().setRGB(e[0],e[1],e[2],ll)}return void 0!==a.emissiveTexture&&t!==eQ.MeshBasicMaterial&&l.push(r.assignTexture(o,"emissiveMap",a.emissiveTexture,ls)),Promise.all(l).then(function(){let n=new t(o);return a.name&&(n.name=a.name),lq(n,a),r.associations.set(n,{materials:e}),a.extensions&&lW(i,n,a),n})}createUniqueName(e){let t=eQ.PropertyBinding.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){let t=this,r=this.extensions,n=this.primitiveCache,i=[];for(let a=0,o=e.length;a<o;a++){let o=e[a],s=function(e){let t;let r=e.extensions&&e.extensions[lh.KHR_DRACO_MESH_COMPRESSION];if(t=r?"draco:"+r.bufferView+":"+r.indices+":"+lK(r.attributes):e.indices+":"+lK(e.attributes)+":"+e.mode,void 0!==e.targets)for(let r=0,n=e.targets.length;r<n;r++)t+=":"+lK(e.targets[r]);return t}(o),l=n[s];if(l)i.push(l.promise);else{let e;e=o.extensions&&o.extensions[lh.KHR_DRACO_MESH_COMPRESSION]?function(e){return r[lh.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then(function(r){return l0(r,e,t)})}(o):l0(new eQ.BufferGeometry,o,t),n[s]={primitive:o,promise:e},i.push(e)}}return Promise.all(i)}loadMesh(e){let t=this,r=this.json,n=this.extensions,i=r.meshes[e],a=i.primitives,o=[];for(let e=0,t=a.length;e<t;e++){var s;let t=void 0===a[e].material?(void 0===(s=this.cache).DefaultMaterial&&(s.DefaultMaterial=new eQ.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:eQ.FrontSide})),s.DefaultMaterial):this.getDependency("material",a[e].material);o.push(t)}return o.push(t.loadGeometries(a)),Promise.all(o).then(function(r){let o=r.slice(0,r.length-1),s=r[r.length-1],l=[];for(let r=0,c=s.length;r<c;r++){let c;let u=s[r],h=a[r],d=o[r];if(h.mode===lk.TRIANGLES||h.mode===lk.TRIANGLE_STRIP||h.mode===lk.TRIANGLE_FAN||void 0===h.mode)!0===(c=!0===i.isSkinnedMesh?new eQ.SkinnedMesh(u,d):new eQ.Mesh(u,d)).isSkinnedMesh&&c.normalizeSkinWeights(),h.mode===lk.TRIANGLE_STRIP?c.geometry=oU(c.geometry,eQ.TriangleStripDrawMode):h.mode===lk.TRIANGLE_FAN&&(c.geometry=oU(c.geometry,eQ.TriangleFanDrawMode));else if(h.mode===lk.LINES)c=new eQ.LineSegments(u,d);else if(h.mode===lk.LINE_STRIP)c=new eQ.Line(u,d);else if(h.mode===lk.LINE_LOOP)c=new eQ.LineLoop(u,d);else if(h.mode===lk.POINTS)c=new eQ.Points(u,d);else throw Error("THREE.GLTFLoader: Primitive mode unsupported: "+h.mode);Object.keys(c.geometry.morphAttributes).length>0&&function(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(let r=0,n=t.weights.length;r<n;r++)e.morphTargetInfluences[r]=t.weights[r];if(t.extras&&Array.isArray(t.extras.targetNames)){let r=t.extras.targetNames;if(e.morphTargetInfluences.length===r.length){e.morphTargetDictionary={};for(let t=0,n=r.length;t<n;t++)e.morphTargetDictionary[r[t]]=t}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}(c,i),c.name=t.createUniqueName(i.name||"mesh_"+e),lq(c,i),h.extensions&&lW(n,c,h),t.assignFinalMaterial(c),l.push(c)}for(let r=0,n=l.length;r<n;r++)t.associations.set(l[r],{meshes:e,primitives:r});if(1===l.length)return i.extensions&&lW(n,l[0],i),l[0];let c=new eQ.Group;i.extensions&&lW(n,c,i),t.associations.set(c,{meshes:e});for(let e=0,t=l.length;e<t;e++)c.add(l[e]);return c})}loadCamera(e){let t;let r=this.json.cameras[e],n=r[r.type];if(!n){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return"perspective"===r.type?t=new eQ.PerspectiveCamera(eQ.MathUtils.radToDeg(n.yfov),n.aspectRatio||1,n.znear||1,n.zfar||2e6):"orthographic"===r.type&&(t=new eQ.OrthographicCamera(-n.xmag,n.xmag,n.ymag,-n.ymag,n.znear,n.zfar)),r.name&&(t.name=this.createUniqueName(r.name)),lq(t,r),Promise.resolve(t)}loadSkin(e){let t=this.json.skins[e],r=[];for(let e=0,n=t.joints.length;e<n;e++)r.push(this._loadNodeShallow(t.joints[e]));return void 0!==t.inverseBindMatrices?r.push(this.getDependency("accessor",t.inverseBindMatrices)):r.push(null),Promise.all(r).then(function(e){let r=e.pop(),n=[],i=[];for(let a=0,o=e.length;a<o;a++){let o=e[a];if(o){n.push(o);let e=new eQ.Matrix4;null!==r&&e.fromArray(r.array,16*a),i.push(e)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[a])}return new eQ.Skeleton(n,i)})}loadAnimation(e){let t=this.json,r=this,n=t.animations[e],i=n.name?n.name:"animation_"+e,a=[],o=[],s=[],l=[],c=[];for(let e=0,t=n.channels.length;e<t;e++){let t=n.channels[e],r=n.samplers[t.sampler],i=t.target,u=i.node,h=void 0!==n.parameters?n.parameters[r.input]:r.input,d=void 0!==n.parameters?n.parameters[r.output]:r.output;void 0!==i.node&&(a.push(this.getDependency("node",u)),o.push(this.getDependency("accessor",h)),s.push(this.getDependency("accessor",d)),l.push(r),c.push(i))}return Promise.all([Promise.all(a),Promise.all(o),Promise.all(s),Promise.all(l),Promise.all(c)]).then(function(e){let t=e[0],n=e[1],a=e[2],o=e[3],s=e[4],l=[];for(let e=0,i=t.length;e<i;e++){let i=t[e],c=n[e],u=a[e],h=o[e],d=s[e];if(void 0===i)continue;i.updateMatrix&&i.updateMatrix();let f=r._createAnimationTracks(i,c,u,h,d);if(f)for(let e=0;e<f.length;e++)l.push(f[e])}return new eQ.AnimationClip(i,void 0,l)})}createNodeMesh(e){let t=this.json,r=this,n=t.nodes[e];return void 0===n.mesh?null:r.getDependency("mesh",n.mesh).then(function(e){let t=r._getNodeRef(r.meshCache,n.mesh,e);return void 0!==n.weights&&t.traverse(function(e){if(e.isMesh)for(let t=0,r=n.weights.length;t<r;t++)e.morphTargetInfluences[t]=n.weights[t]}),t})}loadNode(e){let t=this.json.nodes[e],r=this._loadNodeShallow(e),n=[],i=t.children||[];for(let e=0,t=i.length;e<t;e++)n.push(this.getDependency("node",i[e]));let a=void 0===t.skin?Promise.resolve(null):this.getDependency("skin",t.skin);return Promise.all([r,Promise.all(n),a]).then(function(e){let t=e[0],r=e[1],n=e[2];null!==n&&t.traverse(function(e){e.isSkinnedMesh&&e.bind(n,lZ)});for(let e=0,n=r.length;e<n;e++)t.add(r[e]);return t})}_loadNodeShallow(e){let t=this.json,r=this.extensions,n=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];let i=t.nodes[e],a=i.name?n.createUniqueName(i.name):"",o=[],s=n._invokeOne(function(t){return t.createNodeMesh&&t.createNodeMesh(e)});return s&&o.push(s),void 0!==i.camera&&o.push(n.getDependency("camera",i.camera).then(function(e){return n._getNodeRef(n.cameraCache,i.camera,e)})),n._invokeAll(function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)}).forEach(function(e){o.push(e)}),this.nodeCache[e]=Promise.all(o).then(function(t){let o;if((o=!0===i.isBone?new eQ.Bone:t.length>1?new eQ.Group:1===t.length?t[0]:new eQ.Object3D)!==t[0])for(let e=0,r=t.length;e<r;e++)o.add(t[e]);if(i.name&&(o.userData.name=i.name,o.name=a),lq(o,i),i.extensions&&lW(r,o,i),void 0!==i.matrix){let e=new eQ.Matrix4;e.fromArray(i.matrix),o.applyMatrix4(e)}else void 0!==i.translation&&o.position.fromArray(i.translation),void 0!==i.rotation&&o.quaternion.fromArray(i.rotation),void 0!==i.scale&&o.scale.fromArray(i.scale);return n.associations.has(o)||n.associations.set(o,{}),n.associations.get(o).nodes=e,o}),this.nodeCache[e]}loadScene(e){let t=this.extensions,r=this.json.scenes[e],n=this,i=new eQ.Group;r.name&&(i.name=n.createUniqueName(r.name)),lq(i,r),r.extensions&&lW(t,i,r);let a=r.nodes||[],o=[];for(let e=0,t=a.length;e<t;e++)o.push(n.getDependency("node",a[e]));return Promise.all(o).then(function(e){for(let t=0,r=e.length;t<r;t++)i.add(e[t]);return n.associations=(e=>{let t=new Map;for(let[e,r]of n.associations)(e instanceof eQ.Material||e instanceof eQ.Texture)&&t.set(e,r);return e.traverse(e=>{let r=n.associations.get(e);null!=r&&t.set(e,r)}),t})(i),i})}_createAnimationTracks(e,t,r,n,i){let a;let o=[],s=e.name?e.name:e.uuid,l=[];switch(lj[i.path]===lj.weights?e.traverse(function(e){e.morphTargetInfluences&&l.push(e.name?e.name:e.uuid)}):l.push(s),lj[i.path]){case lj.weights:a=eQ.NumberKeyframeTrack;break;case lj.rotation:a=eQ.QuaternionKeyframeTrack;break;case lj.position:case lj.scale:a=eQ.VectorKeyframeTrack;break;default:a=1===r.itemSize?eQ.NumberKeyframeTrack:eQ.VectorKeyframeTrack}let c=void 0!==n.interpolation?lY[n.interpolation]:eQ.InterpolateLinear,u=this._getArrayFromAccessor(r);for(let e=0,r=l.length;e<r;e++){let r=new a(l[e]+"."+lj[i.path],t.array,u,c);"CUBICSPLINE"===n.interpolation&&this._createCubicSplineTrackInterpolant(r),o.push(r)}return o}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){let e=lX(t.constructor),r=new Float32Array(t.length);for(let n=0,i=t.length;n<i;n++)r[n]=t[n]*e;t=r}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(e){return new(this instanceof eQ.QuaternionKeyframeTrack?lL:lO)(this.times,this.values,this.getValueSize()/3,e)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function l0(e,t,r){let n=t.attributes,i=[];for(let t in n){let a=lV[t]||t.toLowerCase();a in e.attributes||i.push(function(t,n){return r.getDependency("accessor",t).then(function(t){e.setAttribute(n,t)})}(n[t],a))}if(void 0!==t.indices&&!e.index){let n=r.getDependency("accessor",t.indices).then(function(t){e.setIndex(t)});i.push(n)}return lq(e,t),!function(e,t,r){let n=t.attributes,i=new eQ.Box3;if(void 0===n.POSITION)return;{let e=r.json.accessors[n.POSITION],t=e.min,a=e.max;if(void 0!==t&&void 0!==a){if(i.set(new eQ.Vector3(t[0],t[1],t[2]),new eQ.Vector3(a[0],a[1],a[2])),e.normalized){let t=lX(lU[e.componentType]);i.min.multiplyScalar(t),i.max.multiplyScalar(t)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}let a=t.targets;if(void 0!==a){let e=new eQ.Vector3,t=new eQ.Vector3;for(let n=0,i=a.length;n<i;n++){let i=a[n];if(void 0!==i.POSITION){let n=r.json.accessors[i.POSITION],a=n.min,o=n.max;if(void 0!==a&&void 0!==o){if(t.setX(Math.max(Math.abs(a[0]),Math.abs(o[0]))),t.setY(Math.max(Math.abs(a[1]),Math.abs(o[1]))),t.setZ(Math.max(Math.abs(a[2]),Math.abs(o[2]))),n.normalized){let e=lX(lU[n.componentType]);t.multiplyScalar(e)}e.max(t)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}i.expandByVector(e)}e.boundingBox=i;let o=new eQ.Sphere;i.getCenter(o.center),o.radius=i.min.distanceTo(i.max)/2,e.boundingSphere=o}(e,t,r),Promise.all(i).then(function(){return void 0!==t.targets?function(e,t,r){let n=!1,i=!1,a=!1;for(let e=0,r=t.length;e<r;e++){let r=t[e];if(void 0!==r.POSITION&&(n=!0),void 0!==r.NORMAL&&(i=!0),void 0!==r.COLOR_0&&(a=!0),n&&i&&a)break}if(!n&&!i&&!a)return Promise.resolve(e);let o=[],s=[],l=[];for(let c=0,u=t.length;c<u;c++){let u=t[c];if(n){let t=void 0!==u.POSITION?r.getDependency("accessor",u.POSITION):e.attributes.position;o.push(t)}if(i){let t=void 0!==u.NORMAL?r.getDependency("accessor",u.NORMAL):e.attributes.normal;s.push(t)}if(a){let t=void 0!==u.COLOR_0?r.getDependency("accessor",u.COLOR_0):e.attributes.color;l.push(t)}}return Promise.all([Promise.all(o),Promise.all(s),Promise.all(l)]).then(function(t){let r=t[0],o=t[1],s=t[2];return n&&(e.morphAttributes.position=r),i&&(e.morphAttributes.normal=o),a&&(e.morphAttributes.color=s),e.morphTargetsRelative=!0,e})}(e,t.targets,r):e})}let l1=null,l2="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function l3(e,t,r){return n=>{r&&r(n),e&&(l1||(l1=new lr),l1.setDecoderPath("string"==typeof e?e:l2),n.setDRACOLoader(l1)),t&&n.setMeshoptDecoder("function"==typeof li?li():li)}}function l4(e,t=!0,r=!0,n){return(0,eL.F)(lc,e,l3(t,r,n))}l4.preload=(e,t=!0,r=!0,n)=>eL.F.preload(lc,e,l3(t,r,n)),l4.clear=e=>eL.F.clear(lc,e),l4.setDecoderPath=e=>{l2=e};let l5=ez.forwardRef(({src:e,useDraco:t,useMeshOpt:r,extendLoader:n,...i},a)=>{let{scene:o}=l4(e,t,r,n);return ez.createElement(sX,ee({ref:a},i,{object:o}))});class l6{constructor(e,t=" .:-=+*#%@",r={}){let n,i,a,o,s;let l=r.resolution||.15,c=r.scale||1,u=r.color||!1,h=r.alpha||!1,d=r.block||!1,f=r.invert||!1,p=r.strResolution||"low",m=document.createElement("div");m.style.cursor="default";let A=document.createElement("table");m.appendChild(A),this.setSize=function(t,r){n=t,i=r,e.setSize(t,r),function(){a=Math.floor(n*l),o=Math.floor(i*l),y.width=a,y.height=o,(s=e.domElement).style.backgroundColor&&(A.rows[0].cells[0].style.backgroundColor=s.style.backgroundColor,A.rows[0].cells[0].style.color=s.style.color),A.cellSpacing=0,A.cellPadding=0;let t=A.style;t.whiteSpace="pre",t.margin="0px",t.padding="0px",t.letterSpacing=b+"px",t.fontFamily=g,t.fontSize=_+"px",t.lineHeight=C+"px",t.textAlign="left",t.textDecoration="none"}()},this.render=function(t,r){e.render(t,r),function(e){x.clearRect(0,0,a,o),x.drawImage(v,0,0,a,o);let t=x.getImageData(0,0,a,o).data,r="";for(let e=0;e<o;e+=2){for(let n=0;n<a;n++){let i,o;let s=(e*a+n)*4,l=t[s],c=t[s+1],p=t[s+2],m=t[s+3];o=(.3*l+.59*c+.11*p)/255,0==m&&(o=1),i=Math.floor((1-o)*(E.length-1)),f&&(i=E.length-i-1);let A=E[i];(void 0===A||" "==A)&&(A="&nbsp;"),u?r+="<span style='color:rgb("+l+","+c+","+p+");"+(d?"background-color:rgb("+l+","+c+","+p+");":"")+(h?"opacity:"+m/255+";":"")+"'>"+A+"</span>":r+=A}r+="<br/>"}e.innerHTML=`<tr><td style="display:block;width:${n}px;height:${i}px;overflow:hidden">${r}</td></tr>`}(A)},this.domElement=m;let g="courier new, monospace",v=e.domElement,y=document.createElement("canvas");if(!y.getContext)return;let x=y.getContext("2d");if(!x.getImageData)return;let E=u?" CGO08@".split(""):" .,:;i1tfLCG08@".split("");t&&(E=t);let _=2/l*c,C=2/l*c,b=0;if("low"==p)switch(c){case 1:b=-1;break;case 2:case 3:b=-2.1;break;case 4:b=-3.1;break;case 5:b=-4.15}if("medium"==p)switch(c){case 1:b=0;break;case 2:b=-1;break;case 3:b=-1.04;break;case 4:case 5:b=-2.1}if("high"==p)switch(c){case 1:case 2:b=0;break;case 3:case 4:case 5:b=-1}}}function l8({renderIndex:e=1,bgColor:t="black",fgColor:r="white",characters:n=" .:-+*=%@#",invert:i=!0,color:a=!1,resolution:o=.15}){let{size:s,gl:l,scene:c,camera:u}=(0,eL.A)(),h=ez.useMemo(()=>{let e=new l6(l,n,{invert:i,color:a,resolution:o});return e.domElement.style.position="absolute",e.domElement.style.top="0px",e.domElement.style.left="0px",e.domElement.style.pointerEvents="none",e},[n,i,a,o]);return ez.useLayoutEffect(()=>{h.domElement.style.color=r,h.domElement.style.backgroundColor=t},[r,t]),ez.useEffect(()=>(l.domElement.style.opacity="0",l.domElement.parentNode.appendChild(h.domElement),()=>{l.domElement.style.opacity="1",l.domElement.parentNode.removeChild(h.domElement)}),[h]),ez.useEffect(()=>{h.setSize(s.width,s.height)},[h,s]),(0,eL.C)(e=>{h.render(c,u)},e),ez.createElement(ez.Fragment,null)}let l9=sv({alphaTest:0,viewport:new eQ.Vector2(1980,1080),focal:1e3,centerAndScaleTexture:null,covAndColorTexture:null},`
    precision highp sampler2D;
    precision highp usampler2D;
    out vec4 vColor;
    out vec3 vPosition;
    uniform vec2 resolution;
    uniform vec2 viewport;
    uniform float focal;
    attribute uint splatIndex;
    uniform sampler2D centerAndScaleTexture;
    uniform usampler2D covAndColorTexture;    

    vec2 unpackInt16(in uint value) {
      int v = int(value);
      int v0 = v >> 16;
      int v1 = (v & 0xFFFF);
      if((v & 0x8000) != 0)
        v1 |= 0xFFFF0000;
      return vec2(float(v1), float(v0));
    }

    void main () {
      ivec2 texSize = textureSize(centerAndScaleTexture, 0);
      ivec2 texPos = ivec2(splatIndex%uint(texSize.x), splatIndex/uint(texSize.x));
      vec4 centerAndScaleData = texelFetch(centerAndScaleTexture, texPos, 0);
      vec4 center = vec4(centerAndScaleData.xyz, 1);
      vec4 camspace = modelViewMatrix * center;
      vec4 pos2d = projectionMatrix * camspace;

      float bounds = 1.2 * pos2d.w;
      if (pos2d.z < -pos2d.w || pos2d.x < -bounds || pos2d.x > bounds
        || pos2d.y < -bounds || pos2d.y > bounds) {
        gl_Position = vec4(0.0, 0.0, 2.0, 1.0);
        return;
      }

      uvec4 covAndColorData = texelFetch(covAndColorTexture, texPos, 0);
      vec2 cov3D_M11_M12 = unpackInt16(covAndColorData.x) * centerAndScaleData.w;
      vec2 cov3D_M13_M22 = unpackInt16(covAndColorData.y) * centerAndScaleData.w;
      vec2 cov3D_M23_M33 = unpackInt16(covAndColorData.z) * centerAndScaleData.w;
      mat3 Vrk = mat3(
        cov3D_M11_M12.x, cov3D_M11_M12.y, cov3D_M13_M22.x,
        cov3D_M11_M12.y, cov3D_M13_M22.y, cov3D_M23_M33.x,
        cov3D_M13_M22.x, cov3D_M23_M33.x, cov3D_M23_M33.y
      );

      mat3 J = mat3(
        focal / camspace.z, 0., -(focal * camspace.x) / (camspace.z * camspace.z),
        0., focal / camspace.z, -(focal * camspace.y) / (camspace.z * camspace.z),
        0., 0., 0.
      );

      mat3 W = transpose(mat3(modelViewMatrix));
      mat3 T = W * J;
      mat3 cov = transpose(T) * Vrk * T;
      vec2 vCenter = vec2(pos2d) / pos2d.w;
      float diagonal1 = cov[0][0] + 0.3;
      float offDiagonal = cov[0][1];
      float diagonal2 = cov[1][1] + 0.3;
      float mid = 0.5 * (diagonal1 + diagonal2);
      float radius = length(vec2((diagonal1 - diagonal2) / 2.0, offDiagonal));
      float lambda1 = mid + radius;
      float lambda2 = max(mid - radius, 0.1);
      vec2 diagonalVector = normalize(vec2(offDiagonal, lambda1 - diagonal1));
      vec2 v1 = min(sqrt(2.0 * lambda1), 1024.0) * diagonalVector;
      vec2 v2 = min(sqrt(2.0 * lambda2), 1024.0) * vec2(diagonalVector.y, -diagonalVector.x);
      uint colorUint = covAndColorData.w;
      vColor = vec4(
        float(colorUint & uint(0xFF)) / 255.0,
        float((colorUint >> uint(8)) & uint(0xFF)) / 255.0,
        float((colorUint >> uint(16)) & uint(0xFF)) / 255.0,
        float(colorUint >> uint(24)) / 255.0
      );
      vPosition = position;

      gl_Position = vec4(
        vCenter 
          + position.x * v2 / viewport * 2.0 
          + position.y * v1 / viewport * 2.0, pos2d.z / pos2d.w, 1.0);
    }
    `,`
    #include <alphatest_pars_fragment>
    #include <alphahash_pars_fragment>
    in vec4 vColor;
    in vec3 vPosition;
    void main () {
      float A = -dot(vPosition.xy, vPosition.xy);
      if (A < -4.0) discard;
      float B = exp(A) * vColor.a;
      vec4 diffuseColor = vec4(vColor.rgb, B);
      #include <alphatest_fragment>
      #include <alphahash_fragment>
      gl_FragColor = diffuseColor;
      #include <tonemapping_fragment>
      #include <${parseInt(eQ.REVISION.replace(/\D+/g,""))>=154?"colorspace_fragment":"encodings_fragment"}>
    }
  `);function l7(e){let t=null,r=0;e.onmessage=n=>{if("push"==n.data.method){0===r&&(t=new Float32Array(n.data.length));let e=new Float32Array(n.data.matrices);t.set(e,r),r+=e.length}else if("sort"==n.data.method&&null!==t){let r=function(e,r=!1){let n=t.length/16,i=-1/0,a=1/0,o=new Float32Array(n),s=new Int32Array(o.buffer),l=new Int32Array(n),c=0;for(let s=0;s<n;s++){let n=e[0]*t[16*s+12]+e[1]*t[16*s+13]+e[2]*t[16*s+14]+e[3];(r||n<0&&t[16*s+15]>-.0001*n)&&(o[c]=n,l[c]=s,c++,n>i&&(i=n),n<a&&(a=n))}let u=65535/(i-a),h=new Uint32Array(65536);for(let e=0;e<c;e++)s[e]=(o[e]-a)*u|0,h[s[e]]++;let d=new Uint32Array(65536);for(let e=1;e<65536;e++)d[e]=d[e-1]+h[e-1];let f=new Uint32Array(c);for(let e=0;e<c;e++)f[d[s[e]]++]=l[e];return f}(new Float32Array(n.data.view),n.data.hashed);e.postMessage({indices:r,key:n.data.key},[r.buffer])}}}class ce extends eQ.Loader{constructor(...e){super(...e),this.gl=null,this.chunkSize=25e3}load(e,t,r,n){let i={gl:this.gl,url:this.manager.resolveURL(e),worker:new Worker(URL.createObjectURL(new Blob(["(",l7.toString(),")(self)"],{type:"application/javascript"}))),manager:this.manager,update:(e,t,r)=>(function(e,t,r,n){if(e.updateMatrixWorld(),t.gl.getCurrentViewport(r.viewport),r.material.viewport.x=r.viewport.z,r.material.viewport.y=r.viewport.w,r.material.focal=r.viewport.w/2*Math.abs(e.projectionMatrix.elements[5]),r.ready){if(n&&r.sorted)return;r.ready=!1;let e=new Float32Array([r.modelViewMatrix.elements[2],-r.modelViewMatrix.elements[6],r.modelViewMatrix.elements[10],r.modelViewMatrix.elements[14]]);t.worker.postMessage({method:"sort",src:t.url,key:r.uuid,view:e.buffer,hashed:n},[e.buffer]),n&&t.loaded&&(r.sorted=!0)}})(t,i,e,r),connect:e=>(function(e,t){e.loading||cr(e),t.ready=!1,t.pm=new eQ.Matrix4,t.vm1=new eQ.Matrix4,t.vm2=new eQ.Matrix4,t.viewport=new eQ.Vector4;let r=new Uint32Array(e.bufferTextureWidth*e.bufferTextureHeight),n=new eQ.InstancedBufferAttribute(r,1,!1);n.setUsage(eQ.DynamicDrawUsage);let i=t.geometry=new eQ.InstancedBufferGeometry,a=new Float32Array(18),o=new eQ.BufferAttribute(a,3);function s(e){if(t&&e.data.key===t.uuid){let r=new Uint32Array(e.data.indices);i.attributes.splatIndex.set(r),i.attributes.splatIndex.needsUpdate=!0,i.instanceCount=r.length,t.ready=!0}}return i.setAttribute("position",o),o.setXYZ(2,-2,2,0),o.setXYZ(1,2,2,0),o.setXYZ(0,-2,-2,0),o.setXYZ(5,-2,-2,0),o.setXYZ(4,2,2,0),o.setXYZ(3,2,-2,0),o.needsUpdate=!0,i.setAttribute("splatIndex",n),i.instanceCount=1,e.worker.addEventListener("message",s),async function(){for(;;){let t=e.gl.properties.get(e.centerAndScaleTexture),r=e.gl.properties.get(e.covAndColorTexture);if(null!=t&&t.__webglTexture&&null!=r&&r.__webglTexture&&e.loadedVertexCount>0)break;await new Promise(e=>setTimeout(e,10))}t.ready=!0}(),()=>e.worker.removeEventListener("message",s)})(i,e),loading:!1,loaded:!1,loadedVertexCount:0,chunkSize:this.chunkSize,totalDownloadBytes:0,numVertices:0,rowLength:32,maxVertexes:0,bufferTextureWidth:0,bufferTextureHeight:0,stream:null,centerAndScaleData:null,covAndColorData:null,covAndColorTexture:null,centerAndScaleTexture:null,onProgress:r};ct(i).then(t).catch(e=>{null==n||n(e),i.manager.itemError(i.url)})}}async function ct(e){e.manager.itemStart(e.url);let t=await fetch(e.url);if(null===t.body)throw"Failed to fetch file";let r=t.headers.get("Content-Length"),n=r?parseInt(r):void 0;if(void 0==n)throw"Failed to get content length";e.stream=t.body.getReader(),e.totalDownloadBytes=n,e.numVertices=Math.floor(e.totalDownloadBytes/e.rowLength);let i=e.gl.getContext(),a=i.getParameter(i.MAX_TEXTURE_SIZE);return e.maxVertexes=a*a,e.numVertices>e.maxVertexes&&(e.numVertices=e.maxVertexes),e.bufferTextureWidth=a,e.bufferTextureHeight=Math.floor((e.numVertices-1)/a)+1,e.centerAndScaleData=new Float32Array(e.bufferTextureWidth*e.bufferTextureHeight*4),e.covAndColorData=new Uint32Array(e.bufferTextureWidth*e.bufferTextureHeight*4),e.centerAndScaleTexture=new eQ.DataTexture(e.centerAndScaleData,e.bufferTextureWidth,e.bufferTextureHeight,eQ.RGBAFormat,eQ.FloatType),e.centerAndScaleTexture.needsUpdate=!0,e.covAndColorTexture=new eQ.DataTexture(e.covAndColorData,e.bufferTextureWidth,e.bufferTextureHeight,eQ.RGBAIntegerFormat,eQ.UnsignedIntType),e.covAndColorTexture.internalFormat="RGBA32UI",e.covAndColorTexture.needsUpdate=!0,e}async function cr(e){e.loading=!0;let t=0,r=0,n=[],i=0,a=0!==e.totalDownloadBytes;for(;;)try{let{value:o,done:s}=await e.stream.read();if(s)break;if(t+=o.length,void 0!=e.totalDownloadBytes){let r=t/e.totalDownloadBytes*100;if(e.onProgress&&r-i>1){let n=new ProgressEvent("progress",{lengthComputable:a,loaded:t,total:e.totalDownloadBytes});e.onProgress(n),i=r}}n.push(o);let l=t-r;if(void 0!=e.totalDownloadBytes&&l>e.rowLength*e.chunkSize){let t=Math.floor(l/e.rowLength),i=new Uint8Array(l),o=0;for(let e of n)i.set(e,o),o+=e.length;if(n.length=0,l>t*e.rowLength){let r=new Uint8Array(l-t*e.rowLength);r.set(i.subarray(l-r.length,l),0),n.push(r)}let s=new Uint8Array(t*e.rowLength);s.set(i.subarray(0,s.byteLength),0);let c=cn(e,s.buffer,t);if(e.worker.postMessage({method:"push",src:e.url,length:16*e.numVertices,matrices:c.buffer},[c.buffer]),r+=t*e.rowLength,e.onProgress){let t=new ProgressEvent("progress",{lengthComputable:a,loaded:e.totalDownloadBytes,total:e.totalDownloadBytes});e.onProgress(t)}}}catch(e){console.error(e);break}if(t-r>0){let t=new Uint8Array(n.reduce((e,t)=>e+t.length,0)),r=0;for(let e of n)t.set(e,r),r+=e.length;let i=Math.floor(t.byteLength/e.rowLength),a=cn(e,t.buffer,i);e.worker.postMessage({method:"push",src:e.url,length:16*i,matrices:a.buffer},[a.buffer])}e.loaded=!0,e.manager.itemEnd(e.url)}function cn(e,t,r){let n=e.gl.getContext();if(e.loadedVertexCount+r>e.maxVertexes&&(r=e.maxVertexes-e.loadedVertexCount),r<=0)throw"Failed to parse file";let i=new Uint8Array(t),a=new Float32Array(t),o=new Float32Array(16*r),s=new Uint8Array(e.covAndColorData.buffer),l=new Int16Array(e.covAndColorData.buffer);for(let t=0;t<r;t++){let r=new eQ.Quaternion(-(i[32*t+28+1]-128)/128,(i[32*t+28+2]-128)/128,(i[32*t+28+3]-128)/128,-(i[32*t+28+0]-128)/128);r.invert();let n=new eQ.Vector3(a[8*t+0],a[8*t+1],-a[8*t+2]),c=new eQ.Vector3(a[8*t+3+0],a[8*t+3+1],a[8*t+3+2]),u=new eQ.Matrix4;u.makeRotationFromQuaternion(r),u.transpose(),u.scale(c);let h=u.clone();u.transpose(),u.premultiply(h),u.setPosition(n);let d=[0,1,2,5,6,10],f=0;for(let e=0;e<d.length;e++)Math.abs(u.elements[d[e]])>f&&(f=Math.abs(u.elements[d[e]]));let p=4*e.loadedVertexCount+4*t;e.centerAndScaleData[p+0]=n.x,e.centerAndScaleData[p+1]=-n.y,e.centerAndScaleData[p+2]=n.z,e.centerAndScaleData[p+3]=f/32767,p=8*e.loadedVertexCount+8*t;for(let e=0;e<d.length;e++)l[p+e]=32767*u.elements[d[e]]/f;p=16*e.loadedVertexCount+(4*t+3)*4;let m=new eQ.Color(i[32*t+24+0]/255,i[32*t+24+1]/255,i[32*t+24+2]/255);m.convertSRGBToLinear(),s[p+0]=255*m.r,s[p+1]=255*m.g,s[p+2]=255*m.b,s[p+3]=i[32*t+24+3],u.elements[15]=Math.max(c.x,c.y,c.z)*i[32*t+24+3]/255;for(let e=0;e<16;e++)o[16*t+e]=u.elements[e]}for(;r>0;){let t=0,i=0,a=e.loadedVertexCount%e.bufferTextureWidth,o=Math.floor(e.loadedVertexCount/e.bufferTextureWidth);e.loadedVertexCount%e.bufferTextureWidth!=0?(t=Math.min(e.bufferTextureWidth,a+r)-a,i=1):Math.floor(r/e.bufferTextureWidth)>0?(t=e.bufferTextureWidth,i=Math.floor(r/e.bufferTextureWidth)):(t=r%e.bufferTextureWidth,i=1);let s=e.gl.properties.get(e.centerAndScaleTexture);n.bindTexture(n.TEXTURE_2D,s.__webglTexture),n.texSubImage2D(n.TEXTURE_2D,0,a,o,t,i,n.RGBA,n.FLOAT,e.centerAndScaleData,4*e.loadedVertexCount);let l=e.gl.properties.get(e.covAndColorTexture);n.bindTexture(n.TEXTURE_2D,l.__webglTexture),n.texSubImage2D(n.TEXTURE_2D,0,a,o,t,i,n.RGBA_INTEGER,n.UNSIGNED_INT,e.covAndColorData,4*e.loadedVertexCount),e.gl.resetState(),e.loadedVertexCount+=t*i,r-=t*i}return o}function ci({src:e,toneMapped:t=!1,alphaTest:r=0,alphaHash:n=!1,chunkSize:i=25e3,...a}){(0,eL.e)({SplatMaterial:l9});let o=ez.useRef(null),s=(0,eL.A)(e=>e.gl),l=(0,eL.A)(e=>e.camera),c=(0,eL.F)(ce,e,e=>{e.gl=s,e.chunkSize=i});return ez.useLayoutEffect(()=>c.connect(o.current),[e]),(0,eL.C)(()=>c.update(o.current,l,n)),ez.createElement("mesh",ee({ref:o,frustumCulled:!1},a),ez.createElement("splatMaterial",{key:`${e}/${r}/${n}${l9.key}`,transparent:!n,depthTest:!0,alphaTest:n?0:r,centerAndScaleTexture:c.centerAndScaleTexture,covAndColorTexture:c.covAndColorTexture,depthWrite:!!n||r>0,blending:n?eQ.NormalBlending:eQ.CustomBlending,blendSrcAlpha:eQ.OneFactor,alphaHash:!!n,toneMapped:t}))}function ca(e,t,r){let n=(0,eL.A)(e=>e.size),i=(0,eL.A)(e=>e.viewport),a="number"==typeof e?e:n.width*i.dpr,o="number"==typeof t?t:n.height*i.dpr,{samples:s=0,depth:l,...c}=("number"==typeof e?r:e)||{},u=ez.useMemo(()=>{let e=new eQ.WebGLRenderTarget(a,o,{minFilter:eQ.LinearFilter,magFilter:eQ.LinearFilter,type:eQ.HalfFloatType,...c});return l&&(e.depthTexture=new eQ.DepthTexture(a,o,eQ.FloatType)),e.samples=s,e},[]);return ez.useLayoutEffect(()=>{u.setSize(a,o),s&&(u.samples=s)},[s,u,a,o]),ez.useEffect(()=>()=>u.dispose(),[]),u}let co=({children:e,width:t,height:r,...n})=>{let i=ca(t,r,n);return ez.createElement(ez.Fragment,null,null==e?void 0:e(i))},cs=e=>"function"==typeof e,cl=ez.forwardRef(({envMap:e,resolution:t=256,frames:r=1/0,children:n,makeDefault:i,...a},o)=>{let s=(0,eL.A)(({set:e})=>e),l=(0,eL.A)(({camera:e})=>e),c=(0,eL.A)(({size:e})=>e),u=ez.useRef(null);ez.useImperativeHandle(o,()=>u.current,[]);let h=ez.useRef(null),d=ca(t);ez.useLayoutEffect(()=>{a.manual||u.current.updateProjectionMatrix()},[c,a]),ez.useLayoutEffect(()=>{u.current.updateProjectionMatrix()}),ez.useLayoutEffect(()=>{if(i)return s(()=>({camera:u.current})),()=>s(()=>({camera:l}))},[u,i,s]);let f=0,p=null,m=cs(n);return(0,eL.C)(t=>{m&&(r===1/0||f<r)&&(h.current.visible=!1,t.gl.setRenderTarget(d),p=t.scene.background,e&&(t.scene.background=e),t.gl.render(t.scene,u.current),t.scene.background=p,t.gl.setRenderTarget(null),h.current.visible=!0,f++)}),ez.createElement(ez.Fragment,null,ez.createElement("orthographicCamera",ee({left:-(c.width/2),right:c.width/2,top:c.height/2,bottom:-(c.height/2),ref:u},a),!m&&n),ez.createElement("group",{ref:h},m&&n(d.texture)))}),cc=e=>"function"==typeof e,cu=ez.forwardRef(({envMap:e,resolution:t=256,frames:r=1/0,makeDefault:n,children:i,...a},o)=>{let s=(0,eL.A)(({set:e})=>e),l=(0,eL.A)(({camera:e})=>e),c=(0,eL.A)(({size:e})=>e),u=ez.useRef(null);ez.useImperativeHandle(o,()=>u.current,[]);let h=ez.useRef(null),d=ca(t);ez.useLayoutEffect(()=>{a.manual||(u.current.aspect=c.width/c.height)},[c,a]),ez.useLayoutEffect(()=>{u.current.updateProjectionMatrix()});let f=0,p=null,m=cc(i);return(0,eL.C)(t=>{m&&(r===1/0||f<r)&&(h.current.visible=!1,t.gl.setRenderTarget(d),p=t.scene.background,e&&(t.scene.background=e),t.gl.render(t.scene,u.current),t.scene.background=p,t.gl.setRenderTarget(null),h.current.visible=!0,f++)}),ez.useLayoutEffect(()=>{if(n)return s(()=>({camera:u.current})),()=>s(()=>({camera:l}))},[u,n,s]),ez.createElement(ez.Fragment,null,ez.createElement("perspectiveCamera",ee({ref:u},a),!m&&i),ez.createElement("group",{ref:h},m&&i(d.texture)))});function ch({resolution:e=256,near:t=.1,far:r=1e3,envMap:n,fog:i}={}){let a,o;let s=(0,eL.A)(({gl:e})=>e),l=(0,eL.A)(({scene:e})=>e),c=(0,ez.useMemo)(()=>{let t=new eQ.WebGLCubeRenderTarget(e);return t.texture.type=eQ.HalfFloatType,t},[e]);(0,ez.useEffect)(()=>()=>{c.dispose()},[c]);let u=(0,ez.useMemo)(()=>new eQ.CubeCamera(t,r,c),[t,r,c]),h=ez.useCallback(()=>{a=l.fog,o=l.background,l.background=n||o,l.fog=i||a,u.update(s,l),l.fog=a,l.background=o},[s,l,u]);return{fbo:c,camera:u,update:h}}function cd({children:e,frames:t=1/0,resolution:r,near:n,far:i,envMap:a,fog:o,...s}){let l=ez.useRef(null),{fbo:c,camera:u,update:h}=ch({resolution:r,near:n,far:i,envMap:a,fog:o}),d=0;return(0,eL.C)(()=>{l.current&&(t===1/0||d<t)&&(l.current.visible=!1,h(),l.current.visible=!0,d++)}),ez.createElement("group",s,ez.createElement("primitive",{object:u}),ez.createElement("group",{ref:l},null==e?void 0:e(c.texture)))}var cf=Object.defineProperty,cp=(e,t,r)=>t in e?cf(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,cm=(e,t,r)=>(cp(e,"symbol"!=typeof t?t+"":t,r),r);class cA extends eQ.EventDispatcher{constructor(e){super(),cm(this,"object"),cm(this,"changeEvent",{type:"change"}),cm(this,"EPS",1e-6),cm(this,"enabled",!0),cm(this,"deviceOrientation",{alpha:0,beta:0,gamma:0}),cm(this,"screenOrientation",0),cm(this,"alphaOffset",0),cm(this,"onDeviceOrientationChangeEvent",e=>{this.deviceOrientation=e}),cm(this,"onScreenOrientationChangeEvent",()=>{this.screenOrientation=window.orientation||0}),cm(this,"zee",new eQ.Vector3(0,0,1)),cm(this,"euler",new eQ.Euler),cm(this,"q0",new eQ.Quaternion),cm(this,"q1",new eQ.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5))),cm(this,"setObjectQuaternion",(e,t,r,n,i)=>{this.euler.set(r,t,-n,"YXZ"),e.setFromEuler(this.euler),e.multiply(this.q1),e.multiply(this.q0.setFromAxisAngle(this.zee,-i))}),cm(this,"connect",()=>{this.onScreenOrientationChangeEvent(),void 0!==window.DeviceOrientationEvent&&"function"==typeof window.DeviceOrientationEvent.requestPermission?window.DeviceOrientationEvent.requestPermission().then(e=>{"granted"==e&&(window.addEventListener("orientationchange",this.onScreenOrientationChangeEvent),window.addEventListener("deviceorientation",this.onDeviceOrientationChangeEvent))}).catch(e=>{console.error("THREE.DeviceOrientationControls: Unable to use DeviceOrientation API:",e)}):(window.addEventListener("orientationchange",this.onScreenOrientationChangeEvent),window.addEventListener("deviceorientation",this.onDeviceOrientationChangeEvent)),this.enabled=!0}),cm(this,"disconnect",()=>{window.removeEventListener("orientationchange",this.onScreenOrientationChangeEvent),window.removeEventListener("deviceorientation",this.onDeviceOrientationChangeEvent),this.enabled=!1}),cm(this,"lastQuaternion",new eQ.Quaternion),cm(this,"update",()=>{if(!1===this.enabled)return;let e=this.deviceOrientation;if(e){let t=e.alpha?eQ.MathUtils.degToRad(e.alpha)+this.alphaOffset:0,r=e.beta?eQ.MathUtils.degToRad(e.beta):0,n=e.gamma?eQ.MathUtils.degToRad(e.gamma):0,i=this.screenOrientation?eQ.MathUtils.degToRad(this.screenOrientation):0;this.setObjectQuaternion(this.object.quaternion,t,r,n,i),8*(1-this.lastQuaternion.dot(this.object.quaternion))>this.EPS&&(this.lastQuaternion.copy(this.object.quaternion),this.dispatchEvent(this.changeEvent))}}),cm(this,"dispose",()=>this.disconnect()),this.object=e,this.object.rotation.reorder("YXZ"),this.connect()}}let cg=ez.forwardRef((e,t)=>{let{camera:r,onChange:n,makeDefault:i,...a}=e,o=(0,eL.A)(e=>e.camera),s=(0,eL.A)(e=>e.invalidate),l=(0,eL.A)(e=>e.get),c=(0,eL.A)(e=>e.set),u=r||o,h=ez.useMemo(()=>new cA(u),[u]);return ez.useEffect(()=>{let e=e=>{s(),n&&n(e)};return null==h||null==h.addEventListener||h.addEventListener("change",e),()=>null==h||null==h.removeEventListener?void 0:h.removeEventListener("change",e)},[n,h,s]),(0,eL.C)(()=>null==h?void 0:h.update(),-1),ez.useEffect(()=>(null==h||h.connect(),()=>null==h?void 0:h.dispose()),[h]),ez.useEffect(()=>{if(i){let e=l().controls;return c({controls:h}),()=>c({controls:e})}},[i,h]),h?ez.createElement("primitive",ee({ref:t,object:h},a)):null});var cv=Object.defineProperty,cy=(e,t,r)=>t in e?cv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,cx=(e,t,r)=>(cy(e,"symbol"!=typeof t?t+"":t,r),r);function cE(e){e.preventDefault()}class c_ extends eQ.EventDispatcher{constructor(e,t){super(),cx(this,"object"),cx(this,"domElement",null),cx(this,"movementSpeed",1),cx(this,"rollSpeed",.005),cx(this,"dragToLook",!1),cx(this,"autoForward",!1),cx(this,"changeEvent",{type:"change"}),cx(this,"EPS",1e-6),cx(this,"tmpQuaternion",new eQ.Quaternion),cx(this,"mouseStatus",0),cx(this,"movementSpeedMultiplier",1),cx(this,"moveState",{up:0,down:0,left:0,right:0,forward:0,back:0,pitchUp:0,pitchDown:0,yawLeft:0,yawRight:0,rollLeft:0,rollRight:0}),cx(this,"moveVector",new eQ.Vector3(0,0,0)),cx(this,"rotationVector",new eQ.Vector3(0,0,0)),cx(this,"keydown",e=>{if(!e.altKey){switch(e.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=.1;break;case"KeyW":this.moveState.forward=1;break;case"KeyS":this.moveState.back=1;break;case"KeyA":this.moveState.left=1;break;case"KeyD":this.moveState.right=1;break;case"KeyR":this.moveState.up=1;break;case"KeyF":this.moveState.down=1;break;case"ArrowUp":this.moveState.pitchUp=1;break;case"ArrowDown":this.moveState.pitchDown=1;break;case"ArrowLeft":this.moveState.yawLeft=1;break;case"ArrowRight":this.moveState.yawRight=1;break;case"KeyQ":this.moveState.rollLeft=1;break;case"KeyE":this.moveState.rollRight=1}this.updateMovementVector(),this.updateRotationVector()}}),cx(this,"keyup",e=>{switch(e.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=1;break;case"KeyW":this.moveState.forward=0;break;case"KeyS":this.moveState.back=0;break;case"KeyA":this.moveState.left=0;break;case"KeyD":this.moveState.right=0;break;case"KeyR":this.moveState.up=0;break;case"KeyF":this.moveState.down=0;break;case"ArrowUp":this.moveState.pitchUp=0;break;case"ArrowDown":this.moveState.pitchDown=0;break;case"ArrowLeft":this.moveState.yawLeft=0;break;case"ArrowRight":this.moveState.yawRight=0;break;case"KeyQ":this.moveState.rollLeft=0;break;case"KeyE":this.moveState.rollRight=0}this.updateMovementVector(),this.updateRotationVector()}),cx(this,"pointerdown",e=>{if(this.dragToLook)this.mouseStatus++;else{switch(e.button){case 0:this.moveState.forward=1;break;case 2:this.moveState.back=1}this.updateMovementVector()}}),cx(this,"pointermove",e=>{if(!this.dragToLook||this.mouseStatus>0){let t=this.getContainerDimensions(),r=t.size[0]/2,n=t.size[1]/2;this.moveState.yawLeft=-(e.pageX-t.offset[0]-r)/r,this.moveState.pitchDown=(e.pageY-t.offset[1]-n)/n,this.updateRotationVector()}}),cx(this,"pointerup",e=>{if(this.dragToLook)this.mouseStatus--,this.moveState.yawLeft=this.moveState.pitchDown=0;else{switch(e.button){case 0:this.moveState.forward=0;break;case 2:this.moveState.back=0}this.updateMovementVector()}this.updateRotationVector()}),cx(this,"lastQuaternion",new eQ.Quaternion),cx(this,"lastPosition",new eQ.Vector3),cx(this,"update",e=>{let t=e*this.movementSpeed,r=e*this.rollSpeed;this.object.translateX(this.moveVector.x*t),this.object.translateY(this.moveVector.y*t),this.object.translateZ(this.moveVector.z*t),this.tmpQuaternion.set(this.rotationVector.x*r,this.rotationVector.y*r,this.rotationVector.z*r,1).normalize(),this.object.quaternion.multiply(this.tmpQuaternion),(this.lastPosition.distanceToSquared(this.object.position)>this.EPS||8*(1-this.lastQuaternion.dot(this.object.quaternion))>this.EPS)&&(this.dispatchEvent(this.changeEvent),this.lastQuaternion.copy(this.object.quaternion),this.lastPosition.copy(this.object.position))}),cx(this,"updateMovementVector",()=>{let e=this.moveState.forward||this.autoForward&&!this.moveState.back?1:0;this.moveVector.x=-this.moveState.left+this.moveState.right,this.moveVector.y=-this.moveState.down+this.moveState.up,this.moveVector.z=-e+this.moveState.back}),cx(this,"updateRotationVector",()=>{this.rotationVector.x=-this.moveState.pitchDown+this.moveState.pitchUp,this.rotationVector.y=-this.moveState.yawRight+this.moveState.yawLeft,this.rotationVector.z=-this.moveState.rollRight+this.moveState.rollLeft}),cx(this,"getContainerDimensions",()=>this.domElement==document||this.domElement instanceof Document?{size:[window.innerWidth,window.innerHeight],offset:[0,0]}:{size:[this.domElement.offsetWidth,this.domElement.offsetHeight],offset:[this.domElement.offsetLeft,this.domElement.offsetTop]}),cx(this,"connect",e=>{this.domElement=e,e instanceof Document||e.setAttribute("tabindex",-1),this.domElement.addEventListener("contextmenu",cE),this.domElement.addEventListener("pointermove",this.pointermove),this.domElement.addEventListener("pointerdown",this.pointerdown),this.domElement.addEventListener("pointerup",this.pointerup),window.addEventListener("keydown",this.keydown),window.addEventListener("keyup",this.keyup)}),cx(this,"dispose",()=>{this.domElement.removeEventListener("contextmenu",cE),this.domElement.removeEventListener("pointermove",this.pointermove),this.domElement.removeEventListener("pointerdown",this.pointerdown),this.domElement.removeEventListener("pointerup",this.pointerup),window.removeEventListener("keydown",this.keydown),window.removeEventListener("keyup",this.keyup)}),this.object=e,void 0!==t&&this.connect(t),this.updateMovementVector(),this.updateRotationVector()}}let cC=ez.forwardRef(({domElement:e,...t},r)=>{let{onChange:n,makeDefault:i,...a}=t,o=(0,eL.A)(e=>e.invalidate),s=(0,eL.A)(e=>e.camera),l=(0,eL.A)(e=>e.gl),c=(0,eL.A)(e=>e.events),u=(0,eL.A)(e=>e.get),h=(0,eL.A)(e=>e.set),d=e||c.connected||l.domElement,f=ez.useMemo(()=>new c_(s),[s]);return ez.useEffect(()=>(f.connect(d),()=>void f.dispose()),[d,f,o]),ez.useEffect(()=>{let e=e=>{o(),n&&n(e)};return null==f.addEventListener||f.addEventListener("change",e),()=>null==f.removeEventListener?void 0:f.removeEventListener("change",e)},[n,o]),ez.useEffect(()=>{if(i){let e=u().controls;return h({controls:f}),()=>h({controls:e})}},[i,f]),(0,eL.C)((e,t)=>f.update(t)),ez.createElement("primitive",ee({ref:r,object:f,args:[s,d]},a))});var cb=Object.defineProperty,cw=(e,t,r)=>t in e?cb(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,cB=(e,t,r)=>(cw(e,"symbol"!=typeof t?t+"":t,r),r);let cI=new eQ.Ray,cM=new eQ.Plane,cS=Math.cos(Math.PI/180*70),cT=(e,t)=>(e%t+t)%t;class cP extends eQ.EventDispatcher{constructor(e,t){super(),cB(this,"object"),cB(this,"domElement"),cB(this,"enabled",!0),cB(this,"target",new eQ.Vector3),cB(this,"minDistance",0),cB(this,"maxDistance",1/0),cB(this,"minZoom",0),cB(this,"maxZoom",1/0),cB(this,"minPolarAngle",0),cB(this,"maxPolarAngle",Math.PI),cB(this,"minAzimuthAngle",-1/0),cB(this,"maxAzimuthAngle",1/0),cB(this,"enableDamping",!1),cB(this,"dampingFactor",.05),cB(this,"enableZoom",!0),cB(this,"zoomSpeed",1),cB(this,"enableRotate",!0),cB(this,"rotateSpeed",1),cB(this,"enablePan",!0),cB(this,"panSpeed",1),cB(this,"screenSpacePanning",!0),cB(this,"keyPanSpeed",7),cB(this,"zoomToCursor",!1),cB(this,"autoRotate",!1),cB(this,"autoRotateSpeed",2),cB(this,"reverseOrbit",!1),cB(this,"reverseHorizontalOrbit",!1),cB(this,"reverseVerticalOrbit",!1),cB(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),cB(this,"mouseButtons",{LEFT:eQ.MOUSE.ROTATE,MIDDLE:eQ.MOUSE.DOLLY,RIGHT:eQ.MOUSE.PAN}),cB(this,"touches",{ONE:eQ.TOUCH.ROTATE,TWO:eQ.TOUCH.DOLLY_PAN}),cB(this,"target0"),cB(this,"position0"),cB(this,"zoom0"),cB(this,"_domElementKeyEvents",null),cB(this,"getPolarAngle"),cB(this,"getAzimuthalAngle"),cB(this,"setPolarAngle"),cB(this,"setAzimuthalAngle"),cB(this,"getDistance"),cB(this,"listenToKeyEvents"),cB(this,"stopListenToKeyEvents"),cB(this,"saveState"),cB(this,"reset"),cB(this,"update"),cB(this,"connect"),cB(this,"dispose"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>c.phi,this.getAzimuthalAngle=()=>c.theta,this.setPolarAngle=e=>{let t=cT(e,2*Math.PI),n=c.phi;n<0&&(n+=2*Math.PI),t<0&&(t+=2*Math.PI);let i=Math.abs(t-n);2*Math.PI-i<i&&(t<n?t+=2*Math.PI:n+=2*Math.PI),u.phi=t-n,r.update()},this.setAzimuthalAngle=e=>{let t=cT(e,2*Math.PI),n=c.theta;n<0&&(n+=2*Math.PI),t<0&&(t+=2*Math.PI);let i=Math.abs(t-n);2*Math.PI-i<i&&(t<n?t+=2*Math.PI:n+=2*Math.PI),u.theta=t-n,r.update()},this.getDistance=()=>r.object.position.distanceTo(r.target),this.listenToKeyEvents=e=>{e.addEventListener("keydown",q),this._domElementKeyEvents=e},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",q),this._domElementKeyEvents=null},this.saveState=()=>{r.target0.copy(r.target),r.position0.copy(r.object.position),r.zoom0=r.object.zoom},this.reset=()=>{r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),r.dispatchEvent(n),r.update(),s=o.NONE},this.update=(()=>{let t=new eQ.Vector3,i=new eQ.Vector3(0,1,0),a=new eQ.Quaternion().setFromUnitVectors(e.up,i),f=a.clone().invert(),p=new eQ.Vector3,m=new eQ.Quaternion,A=2*Math.PI;return function(){let g=r.object.position;a.setFromUnitVectors(e.up,i),f.copy(a).invert(),t.copy(g).sub(r.target),t.applyQuaternion(a),c.setFromVector3(t),r.autoRotate&&s===o.NONE&&M(2*Math.PI/60/60*r.autoRotateSpeed),r.enableDamping?(c.theta+=u.theta*r.dampingFactor,c.phi+=u.phi*r.dampingFactor):(c.theta+=u.theta,c.phi+=u.phi);let v=r.minAzimuthAngle,y=r.maxAzimuthAngle;isFinite(v)&&isFinite(y)&&(v<-Math.PI?v+=A:v>Math.PI&&(v-=A),y<-Math.PI?y+=A:y>Math.PI&&(y-=A),v<=y?c.theta=Math.max(v,Math.min(y,c.theta)):c.theta=c.theta>(v+y)/2?Math.max(v,c.theta):Math.min(y,c.theta)),c.phi=Math.max(r.minPolarAngle,Math.min(r.maxPolarAngle,c.phi)),c.makeSafe(),!0===r.enableDamping?r.target.addScaledVector(d,r.dampingFactor):r.target.add(d),r.zoomToCursor&&b||r.object.isOrthographicCamera?c.radius=O(c.radius):c.radius=O(c.radius*h),t.setFromSpherical(c),t.applyQuaternion(f),g.copy(r.target).add(t),r.object.matrixAutoUpdate||r.object.updateMatrix(),r.object.lookAt(r.target),!0===r.enableDamping?(u.theta*=1-r.dampingFactor,u.phi*=1-r.dampingFactor,d.multiplyScalar(1-r.dampingFactor)):(u.set(0,0,0),d.set(0,0,0));let x=!1;if(r.zoomToCursor&&b){let n=null;if(r.object instanceof eQ.PerspectiveCamera&&r.object.isPerspectiveCamera){let e=t.length();n=O(e*h);let i=e-n;r.object.position.addScaledVector(_,i),r.object.updateMatrixWorld()}else if(r.object.isOrthographicCamera){let e=new eQ.Vector3(C.x,C.y,0);e.unproject(r.object),r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/h)),r.object.updateProjectionMatrix(),x=!0;let i=new eQ.Vector3(C.x,C.y,0);i.unproject(r.object),r.object.position.sub(i).add(e),r.object.updateMatrixWorld(),n=t.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),r.zoomToCursor=!1;null!==n&&(r.screenSpacePanning?r.target.set(0,0,-1).transformDirection(r.object.matrix).multiplyScalar(n).add(r.object.position):(cI.origin.copy(r.object.position),cI.direction.set(0,0,-1).transformDirection(r.object.matrix),Math.abs(r.object.up.dot(cI.direction))<cS?e.lookAt(r.target):(cM.setFromNormalAndCoplanarPoint(r.object.up,r.target),cI.intersectPlane(cM,r.target))))}else r.object instanceof eQ.OrthographicCamera&&r.object.isOrthographicCamera&&(x=1!==h)&&(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/h)),r.object.updateProjectionMatrix());return h=1,b=!1,!!(x||p.distanceToSquared(r.object.position)>l||8*(1-m.dot(r.object.quaternion))>l)&&(r.dispatchEvent(n),p.copy(r.object.position),m.copy(r.object.quaternion),x=!1,!0)}})(),this.connect=e=>{e===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),r.domElement=e,r.domElement.style.touchAction="none",r.domElement.addEventListener("contextmenu",K),r.domElement.addEventListener("pointerdown",j),r.domElement.addEventListener("pointercancel",J),r.domElement.addEventListener("wheel",W)},this.dispose=()=>{var e,t,n,i,a,o;r.domElement&&(r.domElement.style.touchAction="auto"),null==(e=r.domElement)||e.removeEventListener("contextmenu",K),null==(t=r.domElement)||t.removeEventListener("pointerdown",j),null==(n=r.domElement)||n.removeEventListener("pointercancel",J),null==(i=r.domElement)||i.removeEventListener("wheel",W),null==(a=r.domElement)||a.ownerDocument.removeEventListener("pointermove",Y),null==(o=r.domElement)||o.ownerDocument.removeEventListener("pointerup",J),null!==r._domElementKeyEvents&&r._domElementKeyEvents.removeEventListener("keydown",q)};let r=this,n={type:"change"},i={type:"start"},a={type:"end"},o={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},s=o.NONE,l=1e-6,c=new eQ.Spherical,u=new eQ.Spherical,h=1,d=new eQ.Vector3,f=new eQ.Vector2,p=new eQ.Vector2,m=new eQ.Vector2,A=new eQ.Vector2,g=new eQ.Vector2,v=new eQ.Vector2,y=new eQ.Vector2,x=new eQ.Vector2,E=new eQ.Vector2,_=new eQ.Vector3,C=new eQ.Vector2,b=!1,w=[],B={};function I(){return Math.pow(.95,r.zoomSpeed)}function M(e){r.reverseOrbit||r.reverseHorizontalOrbit?u.theta+=e:u.theta-=e}function S(e){r.reverseOrbit||r.reverseVerticalOrbit?u.phi+=e:u.phi-=e}let T=(()=>{let e=new eQ.Vector3;return function(t,r){e.setFromMatrixColumn(r,0),e.multiplyScalar(-t),d.add(e)}})(),P=(()=>{let e=new eQ.Vector3;return function(t,n){!0===r.screenSpacePanning?e.setFromMatrixColumn(n,1):(e.setFromMatrixColumn(n,0),e.crossVectors(r.object.up,e)),e.multiplyScalar(t),d.add(e)}})(),D=(()=>{let e=new eQ.Vector3;return function(t,n){let i=r.domElement;if(i&&r.object instanceof eQ.PerspectiveCamera&&r.object.isPerspectiveCamera){let a=r.object.position;e.copy(a).sub(r.target);let o=e.length();T(2*t*(o*=Math.tan(r.object.fov/2*Math.PI/180))/i.clientHeight,r.object.matrix),P(2*n*o/i.clientHeight,r.object.matrix)}else i&&r.object instanceof eQ.OrthographicCamera&&r.object.isOrthographicCamera?(T(t*(r.object.right-r.object.left)/r.object.zoom/i.clientWidth,r.object.matrix),P(n*(r.object.top-r.object.bottom)/r.object.zoom/i.clientHeight,r.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),r.enablePan=!1)}})();function R(e){r.object instanceof eQ.PerspectiveCamera&&r.object.isPerspectiveCamera||r.object instanceof eQ.OrthographicCamera&&r.object.isOrthographicCamera?h/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function F(e){r.object instanceof eQ.PerspectiveCamera&&r.object.isPerspectiveCamera||r.object instanceof eQ.OrthographicCamera&&r.object.isOrthographicCamera?h*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function z(e){if(!r.zoomToCursor||!r.domElement)return;b=!0;let t=r.domElement.getBoundingClientRect(),n=e.clientX-t.left,i=e.clientY-t.top,a=t.width,o=t.height;C.x=n/a*2-1,C.y=-(i/o*2)+1,_.set(C.x,C.y,1).unproject(r.object).sub(r.object.position).normalize()}function O(e){return Math.max(r.minDistance,Math.min(r.maxDistance,e))}function Q(e){f.set(e.clientX,e.clientY)}function L(e){A.set(e.clientX,e.clientY)}function k(){if(1==w.length)f.set(w[0].pageX,w[0].pageY);else{let e=.5*(w[0].pageX+w[1].pageX),t=.5*(w[0].pageY+w[1].pageY);f.set(e,t)}}function U(){if(1==w.length)A.set(w[0].pageX,w[0].pageY);else{let e=.5*(w[0].pageX+w[1].pageX),t=.5*(w[0].pageY+w[1].pageY);A.set(e,t)}}function N(){let e=w[0].pageX-w[1].pageX,t=w[0].pageY-w[1].pageY;y.set(0,Math.sqrt(e*e+t*t))}function G(e){if(1==w.length)p.set(e.pageX,e.pageY);else{let t=Z(e),r=.5*(e.pageX+t.x),n=.5*(e.pageY+t.y);p.set(r,n)}m.subVectors(p,f).multiplyScalar(r.rotateSpeed);let t=r.domElement;t&&(M(2*Math.PI*m.x/t.clientHeight),S(2*Math.PI*m.y/t.clientHeight)),f.copy(p)}function H(e){if(1==w.length)g.set(e.pageX,e.pageY);else{let t=Z(e),r=.5*(e.pageX+t.x),n=.5*(e.pageY+t.y);g.set(r,n)}v.subVectors(g,A).multiplyScalar(r.panSpeed),D(v.x,v.y),A.copy(g)}function V(e){let t=Z(e),n=e.pageX-t.x,i=e.pageY-t.y;x.set(0,Math.sqrt(n*n+i*i)),E.set(0,Math.pow(x.y/y.y,r.zoomSpeed)),R(E.y),y.copy(x)}function j(e){var t,n;!1!==r.enabled&&(0===w.length&&(null==(t=r.domElement)||t.ownerDocument.addEventListener("pointermove",Y),null==(n=r.domElement)||n.ownerDocument.addEventListener("pointerup",J)),w.push(e),"touch"===e.pointerType?function(e){switch(X(e),w.length){case 1:switch(r.touches.ONE){case eQ.TOUCH.ROTATE:if(!1===r.enableRotate)return;k(),s=o.TOUCH_ROTATE;break;case eQ.TOUCH.PAN:if(!1===r.enablePan)return;U(),s=o.TOUCH_PAN;break;default:s=o.NONE}break;case 2:switch(r.touches.TWO){case eQ.TOUCH.DOLLY_PAN:if(!1===r.enableZoom&&!1===r.enablePan)return;r.enableZoom&&N(),r.enablePan&&U(),s=o.TOUCH_DOLLY_PAN;break;case eQ.TOUCH.DOLLY_ROTATE:if(!1===r.enableZoom&&!1===r.enableRotate)return;r.enableZoom&&N(),r.enableRotate&&k(),s=o.TOUCH_DOLLY_ROTATE;break;default:s=o.NONE}break;default:s=o.NONE}s!==o.NONE&&r.dispatchEvent(i)}(e):function(e){let t;switch(e.button){case 0:t=r.mouseButtons.LEFT;break;case 1:t=r.mouseButtons.MIDDLE;break;case 2:t=r.mouseButtons.RIGHT;break;default:t=-1}switch(t){case eQ.MOUSE.DOLLY:if(!1===r.enableZoom)return;z(e),y.set(e.clientX,e.clientY),s=o.DOLLY;break;case eQ.MOUSE.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===r.enablePan)return;L(e),s=o.PAN}else{if(!1===r.enableRotate)return;Q(e),s=o.ROTATE}break;case eQ.MOUSE.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===r.enableRotate)return;Q(e),s=o.ROTATE}else{if(!1===r.enablePan)return;L(e),s=o.PAN}break;default:s=o.NONE}s!==o.NONE&&r.dispatchEvent(i)}(e))}function Y(e){!1!==r.enabled&&("touch"===e.pointerType?function(e){switch(X(e),s){case o.TOUCH_ROTATE:if(!1===r.enableRotate)return;G(e),r.update();break;case o.TOUCH_PAN:if(!1===r.enablePan)return;H(e),r.update();break;case o.TOUCH_DOLLY_PAN:if(!1===r.enableZoom&&!1===r.enablePan)return;r.enableZoom&&V(e),r.enablePan&&H(e),r.update();break;case o.TOUCH_DOLLY_ROTATE:if(!1===r.enableZoom&&!1===r.enableRotate)return;r.enableZoom&&V(e),r.enableRotate&&G(e),r.update();break;default:s=o.NONE}}(e):function(e){if(!1!==r.enabled)switch(s){case o.ROTATE:if(!1===r.enableRotate)return;!function(e){p.set(e.clientX,e.clientY),m.subVectors(p,f).multiplyScalar(r.rotateSpeed);let t=r.domElement;t&&(M(2*Math.PI*m.x/t.clientHeight),S(2*Math.PI*m.y/t.clientHeight)),f.copy(p),r.update()}(e);break;case o.DOLLY:if(!1===r.enableZoom)return;x.set(e.clientX,e.clientY),E.subVectors(x,y),E.y>0?R(I()):E.y<0&&F(I()),y.copy(x),r.update();break;case o.PAN:if(!1===r.enablePan)return;g.set(e.clientX,e.clientY),v.subVectors(g,A).multiplyScalar(r.panSpeed),D(v.x,v.y),A.copy(g),r.update()}}(e))}function J(e){var t,n,i;(function(e){delete B[e.pointerId];for(let t=0;t<w.length;t++)if(w[t].pointerId==e.pointerId){w.splice(t,1);return}})(e),0===w.length&&(null==(t=r.domElement)||t.releasePointerCapture(e.pointerId),null==(n=r.domElement)||n.ownerDocument.removeEventListener("pointermove",Y),null==(i=r.domElement)||i.ownerDocument.removeEventListener("pointerup",J)),r.dispatchEvent(a),s=o.NONE}function W(e){!1!==r.enabled&&!1!==r.enableZoom&&(s===o.NONE||s===o.ROTATE)&&(e.preventDefault(),r.dispatchEvent(i),z(e),e.deltaY<0?F(I()):e.deltaY>0&&R(I()),r.update(),r.dispatchEvent(a))}function q(e){!1!==r.enabled&&!1!==r.enablePan&&function(e){let t=!1;switch(e.code){case r.keys.UP:D(0,r.keyPanSpeed),t=!0;break;case r.keys.BOTTOM:D(0,-r.keyPanSpeed),t=!0;break;case r.keys.LEFT:D(r.keyPanSpeed,0),t=!0;break;case r.keys.RIGHT:D(-r.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),r.update())}(e)}function K(e){!1!==r.enabled&&e.preventDefault()}function X(e){let t=B[e.pointerId];void 0===t&&(t=new eQ.Vector2,B[e.pointerId]=t),t.set(e.pageX,e.pageY)}function Z(e){return B[(e.pointerId===w[0].pointerId?w[1]:w[0]).pointerId]}void 0!==t&&this.connect(t),this.update()}}class cD extends cP{constructor(e,t){super(e,t),this.screenSpacePanning=!1,this.mouseButtons.LEFT=eQ.MOUSE.PAN,this.mouseButtons.RIGHT=eQ.MOUSE.ROTATE,this.touches.ONE=eQ.TOUCH.PAN,this.touches.TWO=eQ.TOUCH.DOLLY_ROTATE}}let cR=ez.forwardRef((e={enableDamping:!0},t)=>{let{domElement:r,camera:n,makeDefault:i,onChange:a,onStart:o,onEnd:s,...l}=e,c=(0,eL.A)(e=>e.invalidate),u=(0,eL.A)(e=>e.camera),h=(0,eL.A)(e=>e.gl),d=(0,eL.A)(e=>e.events),f=(0,eL.A)(e=>e.set),p=(0,eL.A)(e=>e.get),m=r||d.connected||h.domElement,A=n||u,g=ez.useMemo(()=>new cD(A),[A]);return ez.useEffect(()=>{g.connect(m);let e=e=>{c(),a&&a(e)};return g.addEventListener("change",e),o&&g.addEventListener("start",o),s&&g.addEventListener("end",s),()=>{g.dispose(),g.removeEventListener("change",e),o&&g.removeEventListener("start",o),s&&g.removeEventListener("end",s)}},[a,o,s,g,c,m]),ez.useEffect(()=>{if(i){let e=p().controls;return f({controls:g}),()=>f({controls:e})}},[i,g]),(0,eL.C)(()=>g.update(),-1),ez.createElement("primitive",ee({ref:t,object:g,enableDamping:!0},l))}),cF=ez.forwardRef(({makeDefault:e,camera:t,regress:r,domElement:n,enableDamping:i=!0,keyEvents:a=!1,onChange:o,onStart:s,onEnd:l,...c},u)=>{let h=(0,eL.A)(e=>e.invalidate),d=(0,eL.A)(e=>e.camera),f=(0,eL.A)(e=>e.gl),p=(0,eL.A)(e=>e.events),m=(0,eL.A)(e=>e.setEvents),A=(0,eL.A)(e=>e.set),g=(0,eL.A)(e=>e.get),v=(0,eL.A)(e=>e.performance),y=t||d,x=n||p.connected||f.domElement,E=ez.useMemo(()=>new cP(y),[y]);return(0,eL.C)(()=>{E.enabled&&E.update()},-1),ez.useEffect(()=>(a&&E.connect(!0===a?x:a),E.connect(x),()=>void E.dispose()),[a,x,r,E,h]),ez.useEffect(()=>{let e=e=>{h(),r&&v.regress(),o&&o(e)},t=e=>{s&&s(e)},n=e=>{l&&l(e)};return E.addEventListener("change",e),E.addEventListener("start",t),E.addEventListener("end",n),()=>{E.removeEventListener("start",t),E.removeEventListener("end",n),E.removeEventListener("change",e)}},[o,s,l,E,h,m]),ez.useEffect(()=>{if(e){let e=g().controls;return A({controls:E}),()=>A({controls:e})}},[e,E]),ez.createElement("primitive",ee({ref:u,object:E,enableDamping:i},c))});var cz=Object.defineProperty,cO=(e,t,r)=>t in e?cz(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,cQ=(e,t,r)=>(cO(e,"symbol"!=typeof t?t+"":t,r),r);class cL extends eQ.EventDispatcher{constructor(e,t){super(),cQ(this,"enabled",!0),cQ(this,"screen",{left:0,top:0,width:0,height:0}),cQ(this,"rotateSpeed",1),cQ(this,"zoomSpeed",1.2),cQ(this,"panSpeed",.3),cQ(this,"noRotate",!1),cQ(this,"noZoom",!1),cQ(this,"noPan",!1),cQ(this,"staticMoving",!1),cQ(this,"dynamicDampingFactor",.2),cQ(this,"minDistance",0),cQ(this,"maxDistance",1/0),cQ(this,"keys",["KeyA","KeyS","KeyD"]),cQ(this,"mouseButtons",{LEFT:eQ.MOUSE.ROTATE,MIDDLE:eQ.MOUSE.DOLLY,RIGHT:eQ.MOUSE.PAN}),cQ(this,"object"),cQ(this,"domElement"),cQ(this,"cursorZoom",!1),cQ(this,"target",new eQ.Vector3),cQ(this,"mousePosition",new eQ.Vector2),cQ(this,"STATE",{NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4}),cQ(this,"EPS",1e-6),cQ(this,"lastZoom",1),cQ(this,"lastPosition",new eQ.Vector3),cQ(this,"cursorVector",new eQ.Vector3),cQ(this,"targetVector",new eQ.Vector3),cQ(this,"_state",this.STATE.NONE),cQ(this,"_keyState",this.STATE.NONE),cQ(this,"_eye",new eQ.Vector3),cQ(this,"_movePrev",new eQ.Vector2),cQ(this,"_moveCurr",new eQ.Vector2),cQ(this,"_lastAxis",new eQ.Vector3),cQ(this,"_lastAngle",0),cQ(this,"_zoomStart",new eQ.Vector2),cQ(this,"_zoomEnd",new eQ.Vector2),cQ(this,"_touchZoomDistanceStart",0),cQ(this,"_touchZoomDistanceEnd",0),cQ(this,"_panStart",new eQ.Vector2),cQ(this,"_panEnd",new eQ.Vector2),cQ(this,"target0"),cQ(this,"position0"),cQ(this,"up0"),cQ(this,"zoom0"),cQ(this,"changeEvent",{type:"change"}),cQ(this,"startEvent",{type:"start"}),cQ(this,"endEvent",{type:"end"}),cQ(this,"onScreenVector",new eQ.Vector2),cQ(this,"getMouseOnScreen",(e,t)=>(this.onScreenVector.set((e-this.screen.left)/this.screen.width,(t-this.screen.top)/this.screen.height),this.onScreenVector)),cQ(this,"onCircleVector",new eQ.Vector2),cQ(this,"getMouseOnCircle",(e,t)=>(this.onCircleVector.set((e-.5*this.screen.width-this.screen.left)/(.5*this.screen.width),(this.screen.height+2*(this.screen.top-t))/this.screen.width),this.onCircleVector)),cQ(this,"axis",new eQ.Vector3),cQ(this,"quaternion",new eQ.Quaternion),cQ(this,"eyeDirection",new eQ.Vector3),cQ(this,"objectUpDirection",new eQ.Vector3),cQ(this,"objectSidewaysDirection",new eQ.Vector3),cQ(this,"moveDirection",new eQ.Vector3),cQ(this,"angle",0),cQ(this,"rotateCamera",()=>{this.moveDirection.set(this._moveCurr.x-this._movePrev.x,this._moveCurr.y-this._movePrev.y,0),this.angle=this.moveDirection.length(),this.angle?(this._eye.copy(this.object.position).sub(this.target),this.eyeDirection.copy(this._eye).normalize(),this.objectUpDirection.copy(this.object.up).normalize(),this.objectSidewaysDirection.crossVectors(this.objectUpDirection,this.eyeDirection).normalize(),this.objectUpDirection.setLength(this._moveCurr.y-this._movePrev.y),this.objectSidewaysDirection.setLength(this._moveCurr.x-this._movePrev.x),this.moveDirection.copy(this.objectUpDirection.add(this.objectSidewaysDirection)),this.axis.crossVectors(this.moveDirection,this._eye).normalize(),this.angle*=this.rotateSpeed,this.quaternion.setFromAxisAngle(this.axis,this.angle),this._eye.applyQuaternion(this.quaternion),this.object.up.applyQuaternion(this.quaternion),this._lastAxis.copy(this.axis),this._lastAngle=this.angle):!this.staticMoving&&this._lastAngle&&(this._lastAngle*=Math.sqrt(1-this.dynamicDampingFactor),this._eye.copy(this.object.position).sub(this.target),this.quaternion.setFromAxisAngle(this._lastAxis,this._lastAngle),this._eye.applyQuaternion(this.quaternion),this.object.up.applyQuaternion(this.quaternion)),this._movePrev.copy(this._moveCurr)}),cQ(this,"zoomCamera",()=>{let e;if(this._state===this.STATE.TOUCH_ZOOM_PAN)e=this._touchZoomDistanceStart/this._touchZoomDistanceEnd,this._touchZoomDistanceStart=this._touchZoomDistanceEnd,this.object.isPerspectiveCamera?this._eye.multiplyScalar(e):this.object.isOrthographicCamera?(this.object.zoom/=e,this.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type");else{if(Math.abs((e=1+(this._zoomEnd.y-this._zoomStart.y)*this.zoomSpeed)-1)>this.EPS&&e>0&&(this.object.isPerspectiveCamera?(e>1&&this._eye.length()>=this.maxDistance-this.EPS&&(e=1),this._eye.multiplyScalar(e)):this.object.isOrthographicCamera?(e>1&&this.object.zoom<this.maxDistance*this.maxDistance&&(e=1),this.object.zoom/=e):console.warn("THREE.TrackballControls: Unsupported camera type")),this.staticMoving?this._zoomStart.copy(this._zoomEnd):this._zoomStart.y+=(this._zoomEnd.y-this._zoomStart.y)*this.dynamicDampingFactor,this.cursorZoom){this.targetVector.copy(this.target).project(this.object);let t=this.cursorVector.set(this.mousePosition.x,this.mousePosition.y,this.targetVector.z).unproject(this.object);this.target.lerpVectors(t,this.target,e)}this.object.isOrthographicCamera&&this.object.updateProjectionMatrix()}}),cQ(this,"mouseChange",new eQ.Vector2),cQ(this,"objectUp",new eQ.Vector3),cQ(this,"pan",new eQ.Vector3),cQ(this,"panCamera",()=>{if(this.domElement&&(this.mouseChange.copy(this._panEnd).sub(this._panStart),this.mouseChange.lengthSq()>this.EPS)){if(this.object.isOrthographicCamera){let e=this.object,t=(e.right-e.left)/this.object.zoom,r=(e.top-e.bottom)/this.object.zoom;this.mouseChange.x*=t,this.mouseChange.y*=r}else this.mouseChange.multiplyScalar(this._eye.length()*this.panSpeed);this.pan.copy(this._eye).cross(this.object.up).setLength(this.mouseChange.x),this.pan.add(this.objectUp.copy(this.object.up).setLength(this.mouseChange.y)),this.object.position.add(this.pan),this.target.add(this.pan),this.staticMoving?this._panStart.copy(this._panEnd):this._panStart.add(this.mouseChange.subVectors(this._panEnd,this._panStart).multiplyScalar(this.dynamicDampingFactor))}}),cQ(this,"checkDistances",()=>{this.noZoom&&this.noPan||(this._eye.lengthSq()>this.maxDistance*this.maxDistance&&(this.object.position.addVectors(this.target,this._eye.setLength(this.maxDistance)),this._zoomStart.copy(this._zoomEnd)),this._eye.lengthSq()<this.minDistance*this.minDistance&&(this.object.position.addVectors(this.target,this._eye.setLength(this.minDistance)),this._zoomStart.copy(this._zoomEnd)))}),cQ(this,"handleResize",()=>{if(!this.domElement)return;let e=this.domElement.getBoundingClientRect(),t=this.domElement.ownerDocument.documentElement;this.screen.left=e.left+window.pageXOffset-t.clientLeft,this.screen.top=e.top+window.pageYOffset-t.clientTop,this.screen.width=e.width,this.screen.height=e.height}),cQ(this,"update",()=>{this._eye.subVectors(this.object.position,this.target),this.noRotate||this.rotateCamera(),this.noZoom||this.zoomCamera(),this.noPan||this.panCamera(),this.object.position.addVectors(this.target,this._eye),this.object.isPerspectiveCamera?(this.checkDistances(),this.object.lookAt(this.target),this.lastPosition.distanceToSquared(this.object.position)>this.EPS&&(this.dispatchEvent(this.changeEvent),this.lastPosition.copy(this.object.position))):this.object.isOrthographicCamera?(this.object.lookAt(this.target),(this.lastPosition.distanceToSquared(this.object.position)>this.EPS||this.lastZoom!==this.object.zoom)&&(this.dispatchEvent(this.changeEvent),this.lastPosition.copy(this.object.position),this.lastZoom=this.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type")}),cQ(this,"reset",()=>{this._state=this.STATE.NONE,this._keyState=this.STATE.NONE,this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.up.copy(this.up0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this._eye.subVectors(this.object.position,this.target),this.object.lookAt(this.target),this.dispatchEvent(this.changeEvent),this.lastPosition.copy(this.object.position),this.lastZoom=this.object.zoom}),cQ(this,"keydown",e=>{!1!==this.enabled&&(window.removeEventListener("keydown",this.keydown),this._keyState===this.STATE.NONE&&(e.code!==this.keys[this.STATE.ROTATE]||this.noRotate?e.code!==this.keys[this.STATE.ZOOM]||this.noZoom?e.code!==this.keys[this.STATE.PAN]||this.noPan||(this._keyState=this.STATE.PAN):this._keyState=this.STATE.ZOOM:this._keyState=this.STATE.ROTATE))}),cQ(this,"onPointerDown",e=>{if(!1!==this.enabled)switch(e.pointerType){case"mouse":case"pen":this.onMouseDown(e)}}),cQ(this,"onPointerMove",e=>{if(!1!==this.enabled)switch(e.pointerType){case"mouse":case"pen":this.onMouseMove(e)}}),cQ(this,"onPointerUp",e=>{if(!1!==this.enabled)switch(e.pointerType){case"mouse":case"pen":this.onMouseUp()}}),cQ(this,"keyup",()=>{!1!==this.enabled&&(this._keyState=this.STATE.NONE,window.addEventListener("keydown",this.keydown))}),cQ(this,"onMouseDown",e=>{if(!this.domElement)return;if(this._state===this.STATE.NONE)switch(e.button){case this.mouseButtons.LEFT:this._state=this.STATE.ROTATE;break;case this.mouseButtons.MIDDLE:this._state=this.STATE.ZOOM;break;case this.mouseButtons.RIGHT:this._state=this.STATE.PAN}let t=this._keyState!==this.STATE.NONE?this._keyState:this._state;t!==this.STATE.ROTATE||this.noRotate?t!==this.STATE.ZOOM||this.noZoom?t!==this.STATE.PAN||this.noPan||(this._panStart.copy(this.getMouseOnScreen(e.pageX,e.pageY)),this._panEnd.copy(this._panStart)):(this._zoomStart.copy(this.getMouseOnScreen(e.pageX,e.pageY)),this._zoomEnd.copy(this._zoomStart)):(this._moveCurr.copy(this.getMouseOnCircle(e.pageX,e.pageY)),this._movePrev.copy(this._moveCurr)),this.domElement.ownerDocument.addEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.addEventListener("pointerup",this.onPointerUp),this.dispatchEvent(this.startEvent)}),cQ(this,"onMouseMove",e=>{if(!1===this.enabled)return;let t=this._keyState!==this.STATE.NONE?this._keyState:this._state;t!==this.STATE.ROTATE||this.noRotate?t!==this.STATE.ZOOM||this.noZoom?t!==this.STATE.PAN||this.noPan||this._panEnd.copy(this.getMouseOnScreen(e.pageX,e.pageY)):this._zoomEnd.copy(this.getMouseOnScreen(e.pageX,e.pageY)):(this._movePrev.copy(this._moveCurr),this._moveCurr.copy(this.getMouseOnCircle(e.pageX,e.pageY)))}),cQ(this,"onMouseUp",()=>{this.domElement&&!1!==this.enabled&&(this._state=this.STATE.NONE,this.domElement.ownerDocument.removeEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this.onPointerUp),this.dispatchEvent(this.endEvent))}),cQ(this,"mousewheel",e=>{if(!1!==this.enabled&&!0!==this.noZoom){switch(e.preventDefault(),e.deltaMode){case 2:this._zoomStart.y-=.025*e.deltaY;break;case 1:this._zoomStart.y-=.01*e.deltaY;break;default:this._zoomStart.y-=25e-5*e.deltaY}this.mousePosition.x=e.offsetX/this.screen.width*2-1,this.mousePosition.y=-(e.offsetY/this.screen.height*2)+1,this.dispatchEvent(this.startEvent),this.dispatchEvent(this.endEvent)}}),cQ(this,"touchstart",e=>{if(!1!==this.enabled){if(e.preventDefault(),1===e.touches.length)this._state=this.STATE.TOUCH_ROTATE,this._moveCurr.copy(this.getMouseOnCircle(e.touches[0].pageX,e.touches[0].pageY)),this._movePrev.copy(this._moveCurr);else{this._state=this.STATE.TOUCH_ZOOM_PAN;let t=e.touches[0].pageX-e.touches[1].pageX,r=e.touches[0].pageY-e.touches[1].pageY;this._touchZoomDistanceEnd=this._touchZoomDistanceStart=Math.sqrt(t*t+r*r);let n=(e.touches[0].pageX+e.touches[1].pageX)/2,i=(e.touches[0].pageY+e.touches[1].pageY)/2;this._panStart.copy(this.getMouseOnScreen(n,i)),this._panEnd.copy(this._panStart)}this.dispatchEvent(this.startEvent)}}),cQ(this,"touchmove",e=>{if(!1!==this.enabled){if(e.preventDefault(),1===e.touches.length)this._movePrev.copy(this._moveCurr),this._moveCurr.copy(this.getMouseOnCircle(e.touches[0].pageX,e.touches[0].pageY));else{let t=e.touches[0].pageX-e.touches[1].pageX,r=e.touches[0].pageY-e.touches[1].pageY;this._touchZoomDistanceEnd=Math.sqrt(t*t+r*r);let n=(e.touches[0].pageX+e.touches[1].pageX)/2,i=(e.touches[0].pageY+e.touches[1].pageY)/2;this._panEnd.copy(this.getMouseOnScreen(n,i))}}}),cQ(this,"touchend",e=>{if(!1!==this.enabled){switch(e.touches.length){case 0:this._state=this.STATE.NONE;break;case 1:this._state=this.STATE.TOUCH_ROTATE,this._moveCurr.copy(this.getMouseOnCircle(e.touches[0].pageX,e.touches[0].pageY)),this._movePrev.copy(this._moveCurr)}this.dispatchEvent(this.endEvent)}}),cQ(this,"contextmenu",e=>{!1!==this.enabled&&e.preventDefault()}),cQ(this,"connect",e=>{e===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.domElement=e,this.domElement.addEventListener("contextmenu",this.contextmenu),this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("wheel",this.mousewheel),this.domElement.addEventListener("touchstart",this.touchstart),this.domElement.addEventListener("touchend",this.touchend),this.domElement.addEventListener("touchmove",this.touchmove),this.domElement.ownerDocument.addEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.addEventListener("pointerup",this.onPointerUp),window.addEventListener("keydown",this.keydown),window.addEventListener("keyup",this.keyup),this.handleResize()}),cQ(this,"dispose",()=>{this.domElement&&(this.domElement.removeEventListener("contextmenu",this.contextmenu),this.domElement.removeEventListener("pointerdown",this.onPointerDown),this.domElement.removeEventListener("wheel",this.mousewheel),this.domElement.removeEventListener("touchstart",this.touchstart),this.domElement.removeEventListener("touchend",this.touchend),this.domElement.removeEventListener("touchmove",this.touchmove),this.domElement.ownerDocument.removeEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this.onPointerUp),window.removeEventListener("keydown",this.keydown),window.removeEventListener("keyup",this.keyup))}),this.object=e,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this.zoom0=this.object.zoom,void 0!==t&&this.connect(t),this.update()}}let ck=ez.forwardRef(({makeDefault:e,camera:t,domElement:r,regress:n,onChange:i,onStart:a,onEnd:o,...s},l)=>{let{invalidate:c,camera:u,gl:h,events:d,set:f,get:p,performance:m,viewport:A}=(0,eL.A)(),g=t||u,v=r||d.connected||h.domElement,y=ez.useMemo(()=>new cL(g),[g]);return(0,eL.C)(()=>{y.enabled&&y.update()},-1),ez.useEffect(()=>(y.connect(v),()=>void y.dispose()),[v,n,y,c]),ez.useEffect(()=>{let e=e=>{c(),n&&m.regress(),i&&i(e)};return y.addEventListener("change",e),a&&y.addEventListener("start",a),o&&y.addEventListener("end",o),()=>{a&&y.removeEventListener("start",a),o&&y.removeEventListener("end",o),y.removeEventListener("change",e)}},[i,a,o,y,c]),ez.useEffect(()=>{y.handleResize()},[A]),ez.useEffect(()=>{if(e){let e=p().controls;return f({controls:y}),()=>f({controls:e})}},[e,y]),ez.createElement("primitive",ee({ref:l,object:y},s))});var cU=Object.defineProperty,cN=(e,t,r)=>t in e?cU(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,cG=(e,t,r)=>(cN(e,"symbol"!=typeof t?t+"":t,r),r);let cH={IDLE:Symbol(),ROTATE:Symbol(),PAN:Symbol(),SCALE:Symbol(),FOV:Symbol(),FOCUS:Symbol(),ZROTATE:Symbol(),TOUCH_MULTI:Symbol(),ANIMATION_FOCUS:Symbol(),ANIMATION_ROTATE:Symbol()},cV={NONE:Symbol(),ONE_FINGER:Symbol(),ONE_FINGER_SWITCHED:Symbol(),TWO_FINGER:Symbol(),MULT_FINGER:Symbol(),CURSOR:Symbol()},cj={x:0,y:0},cY={camera:new eQ.Matrix4,gizmos:new eQ.Matrix4},cJ={type:"change"},cW={type:"start"},cq={type:"end"};class cK extends eQ.EventDispatcher{constructor(e,t=null,r=null){super(),cG(this,"camera"),cG(this,"domElement"),cG(this,"scene"),cG(this,"mouseActions"),cG(this,"_mouseOp"),cG(this,"_v2_1"),cG(this,"_v3_1"),cG(this,"_v3_2"),cG(this,"_m4_1"),cG(this,"_m4_2"),cG(this,"_quat"),cG(this,"_translationMatrix"),cG(this,"_rotationMatrix"),cG(this,"_scaleMatrix"),cG(this,"_rotationAxis"),cG(this,"_cameraMatrixState"),cG(this,"_cameraProjectionState"),cG(this,"_fovState"),cG(this,"_upState"),cG(this,"_zoomState"),cG(this,"_nearPos"),cG(this,"_farPos"),cG(this,"_gizmoMatrixState"),cG(this,"_up0"),cG(this,"_zoom0"),cG(this,"_fov0"),cG(this,"_initialNear"),cG(this,"_nearPos0"),cG(this,"_initialFar"),cG(this,"_farPos0"),cG(this,"_cameraMatrixState0"),cG(this,"_gizmoMatrixState0"),cG(this,"_button"),cG(this,"_touchStart"),cG(this,"_touchCurrent"),cG(this,"_input"),cG(this,"_switchSensibility"),cG(this,"_startFingerDistance"),cG(this,"_currentFingerDistance"),cG(this,"_startFingerRotation"),cG(this,"_currentFingerRotation"),cG(this,"_devPxRatio"),cG(this,"_downValid"),cG(this,"_nclicks"),cG(this,"_downEvents"),cG(this,"_clickStart"),cG(this,"_maxDownTime"),cG(this,"_maxInterval"),cG(this,"_posThreshold"),cG(this,"_movementThreshold"),cG(this,"_currentCursorPosition"),cG(this,"_startCursorPosition"),cG(this,"_grid"),cG(this,"_gridPosition"),cG(this,"_gizmos"),cG(this,"_curvePts"),cG(this,"_timeStart"),cG(this,"_animationId"),cG(this,"focusAnimationTime"),cG(this,"_timePrev"),cG(this,"_timeCurrent"),cG(this,"_anglePrev"),cG(this,"_angleCurrent"),cG(this,"_cursorPosPrev"),cG(this,"_cursorPosCurr"),cG(this,"_wPrev"),cG(this,"_wCurr"),cG(this,"adjustNearFar"),cG(this,"scaleFactor"),cG(this,"dampingFactor"),cG(this,"wMax"),cG(this,"enableAnimations"),cG(this,"enableGrid"),cG(this,"cursorZoom"),cG(this,"minFov"),cG(this,"maxFov"),cG(this,"enabled"),cG(this,"enablePan"),cG(this,"enableRotate"),cG(this,"enableZoom"),cG(this,"minDistance"),cG(this,"maxDistance"),cG(this,"minZoom"),cG(this,"maxZoom"),cG(this,"target"),cG(this,"_currentTarget"),cG(this,"_tbRadius"),cG(this,"_state"),cG(this,"onWindowResize",()=>{let e=(this._gizmos.scale.x+this._gizmos.scale.y+this._gizmos.scale.z)/3;if(this.camera){let e=this.calculateTbRadius(this.camera);void 0!==e&&(this._tbRadius=e)}let t=this._tbRadius/e,r=new eQ.EllipseCurve(0,0,t,t).getPoints(this._curvePts),n=new eQ.BufferGeometry().setFromPoints(r);for(let e in this._gizmos.children)this._gizmos.children[e].geometry=n;this.dispatchEvent(cJ)}),cG(this,"onContextMenu",e=>{if(this.enabled){for(let t=0;t<this.mouseActions.length;t++)if(2==this.mouseActions[t].mouse){e.preventDefault();break}}}),cG(this,"onPointerCancel",()=>{this._touchStart.splice(0,this._touchStart.length),this._touchCurrent.splice(0,this._touchCurrent.length),this._input=cV.NONE}),cG(this,"onPointerDown",e=>{if(0==e.button&&e.isPrimary?(this._downValid=!0,this._downEvents.push(e)):this._downValid=!1,"touch"==e.pointerType&&this._input!=cV.CURSOR)switch(this._touchStart.push(e),this._touchCurrent.push(e),this._input){case cV.NONE:this._input=cV.ONE_FINGER,this.onSinglePanStart(e,"ROTATE"),window.addEventListener("pointermove",this.onPointerMove),window.addEventListener("pointerup",this.onPointerUp);break;case cV.ONE_FINGER:case cV.ONE_FINGER_SWITCHED:this._input=cV.TWO_FINGER,this.onRotateStart(),this.onPinchStart(),this.onDoublePanStart();break;case cV.TWO_FINGER:this._input=cV.MULT_FINGER,this.onTriplePanStart()}else if("touch"!=e.pointerType&&this._input==cV.NONE){let t=null;e.ctrlKey||e.metaKey?t="CTRL":e.shiftKey&&(t="SHIFT"),this._mouseOp=this.getOpFromAction(e.button,t),this._mouseOp&&(window.addEventListener("pointermove",this.onPointerMove),window.addEventListener("pointerup",this.onPointerUp),this._input=cV.CURSOR,this._button=e.button,this.onSinglePanStart(e,this._mouseOp))}}),cG(this,"onPointerMove",e=>{if("touch"==e.pointerType&&this._input!=cV.CURSOR)switch(this._input){case cV.ONE_FINGER:this.updateTouchEvent(e),this.onSinglePanMove(e,cH.ROTATE);break;case cV.ONE_FINGER_SWITCHED:this.calculatePointersDistance(this._touchCurrent[0],e)*this._devPxRatio>=this._switchSensibility&&(this._input=cV.ONE_FINGER,this.updateTouchEvent(e),this.onSinglePanStart(e,"ROTATE"));break;case cV.TWO_FINGER:this.updateTouchEvent(e),this.onRotateMove(),this.onPinchMove(),this.onDoublePanMove();break;case cV.MULT_FINGER:this.updateTouchEvent(e),this.onTriplePanMove()}else if("touch"!=e.pointerType&&this._input==cV.CURSOR){let t=null;e.ctrlKey||e.metaKey?t="CTRL":e.shiftKey&&(t="SHIFT");let r=this.getOpStateFromAction(this._button,t);r&&this.onSinglePanMove(e,r)}this._downValid&&this.calculatePointersDistance(this._downEvents[this._downEvents.length-1],e)*this._devPxRatio>this._movementThreshold&&(this._downValid=!1)}),cG(this,"onPointerUp",e=>{if("touch"==e.pointerType&&this._input!=cV.CURSOR){let t=this._touchCurrent.length;for(let r=0;r<t;r++)if(this._touchCurrent[r].pointerId==e.pointerId){this._touchCurrent.splice(r,1),this._touchStart.splice(r,1);break}switch(this._input){case cV.ONE_FINGER:case cV.ONE_FINGER_SWITCHED:window.removeEventListener("pointermove",this.onPointerMove),window.removeEventListener("pointerup",this.onPointerUp),this._input=cV.NONE,this.onSinglePanEnd();break;case cV.TWO_FINGER:this.onDoublePanEnd(),this.onPinchEnd(),this.onRotateEnd(),this._input=cV.ONE_FINGER_SWITCHED;break;case cV.MULT_FINGER:0==this._touchCurrent.length&&(window.removeEventListener("pointermove",this.onPointerMove),window.removeEventListener("pointerup",this.onPointerUp),this._input=cV.NONE,this.onTriplePanEnd())}}else"touch"!=e.pointerType&&this._input==cV.CURSOR&&(window.removeEventListener("pointermove",this.onPointerMove),window.removeEventListener("pointerup",this.onPointerUp),this._input=cV.NONE,this.onSinglePanEnd(),this._button=-1);if(e.isPrimary){if(this._downValid){if(e.timeStamp-this._downEvents[this._downEvents.length-1].timeStamp<=this._maxDownTime){if(0==this._nclicks)this._nclicks=1,this._clickStart=performance.now();else{let t=e.timeStamp-this._clickStart,r=this.calculatePointersDistance(this._downEvents[1],this._downEvents[0])*this._devPxRatio;t<=this._maxInterval&&r<=this._posThreshold?(this._nclicks=0,this._downEvents.splice(0,this._downEvents.length),this.onDoubleTap(e)):(this._nclicks=1,this._downEvents.shift(),this._clickStart=performance.now())}}else this._downValid=!1,this._nclicks=0,this._downEvents.splice(0,this._downEvents.length)}else this._nclicks=0,this._downEvents.splice(0,this._downEvents.length)}}),cG(this,"onWheel",e=>{var t,r;if(this.enabled&&this.enableZoom&&this.domElement){let n=null;e.ctrlKey||e.metaKey?n="CTRL":e.shiftKey&&(n="SHIFT");let i=this.getOpFromAction("WHEEL",n);if(i){e.preventDefault(),this.dispatchEvent(cW);let n=e.deltaY/125,a=1;switch(n>0?a=1/this.scaleFactor:n<0&&(a=this.scaleFactor),i){case"ZOOM":if(this.updateTbState(cH.SCALE,!0),n>0?a=1/Math.pow(this.scaleFactor,n):n<0&&(a=Math.pow(this.scaleFactor,-n)),this.cursorZoom&&this.enablePan){let n;this.camera instanceof eQ.OrthographicCamera&&(n=null==(t=this.unprojectOnTbPlane(this.camera,e.clientX,e.clientY,this.domElement))?void 0:t.applyQuaternion(this.camera.quaternion).multiplyScalar(1/this.camera.zoom).add(this._gizmos.position)),this.camera instanceof eQ.PerspectiveCamera&&(n=null==(r=this.unprojectOnTbPlane(this.camera,e.clientX,e.clientY,this.domElement))?void 0:r.applyQuaternion(this.camera.quaternion).add(this._gizmos.position)),void 0!==n&&this.applyTransformMatrix(this.applyScale(a,n))}else this.applyTransformMatrix(this.applyScale(a,this._gizmos.position));this._grid&&(this.disposeGrid(),this.drawGrid()),this.updateTbState(cH.IDLE,!1),this.dispatchEvent(cJ),this.dispatchEvent(cq);break;case"FOV":if(this.camera instanceof eQ.PerspectiveCamera){this.updateTbState(cH.FOV,!0),0!=e.deltaX&&(n=e.deltaX/125,a=1,n>0?a=1/Math.pow(this.scaleFactor,n):n<0&&(a=Math.pow(this.scaleFactor,-n))),this._v3_1.setFromMatrixPosition(this._cameraMatrixState);let t=this._v3_1.distanceTo(this._gizmos.position),r=t/a;r=eQ.MathUtils.clamp(r,this.minDistance,this.maxDistance);let i=t*Math.tan(eQ.MathUtils.DEG2RAD*this.camera.fov*.5),o=eQ.MathUtils.RAD2DEG*(2*Math.atan(i/r));o>this.maxFov?o=this.maxFov:o<this.minFov&&(o=this.minFov),a=t/(i/Math.tan(eQ.MathUtils.DEG2RAD*(o/2))),this.setFov(o),this.applyTransformMatrix(this.applyScale(a,this._gizmos.position,!1))}this._grid&&(this.disposeGrid(),this.drawGrid()),this.updateTbState(cH.IDLE,!1),this.dispatchEvent(cJ),this.dispatchEvent(cq)}}}}),cG(this,"onSinglePanStart",(e,t)=>{if(this.enabled&&this.domElement)switch(this.dispatchEvent(cW),this.setCenter(e.clientX,e.clientY),t){case"PAN":if(!this.enablePan)return;if(-1!=this._animationId&&(cancelAnimationFrame(this._animationId),this._animationId=-1,this._timeStart=-1,this.activateGizmos(!1),this.dispatchEvent(cJ)),this.camera){this.updateTbState(cH.PAN,!0);let e=this.unprojectOnTbPlane(this.camera,cj.x,cj.y,this.domElement);void 0!==e&&this._startCursorPosition.copy(e),this.enableGrid&&(this.drawGrid(),this.dispatchEvent(cJ))}break;case"ROTATE":if(!this.enableRotate)return;if(-1!=this._animationId&&(cancelAnimationFrame(this._animationId),this._animationId=-1,this._timeStart=-1),this.camera){this.updateTbState(cH.ROTATE,!0);let e=this.unprojectOnTbSurface(this.camera,cj.x,cj.y,this.domElement,this._tbRadius);void 0!==e&&this._startCursorPosition.copy(e),this.activateGizmos(!0),this.enableAnimations&&(this._timePrev=this._timeCurrent=performance.now(),this._angleCurrent=this._anglePrev=0,this._cursorPosPrev.copy(this._startCursorPosition),this._cursorPosCurr.copy(this._cursorPosPrev),this._wCurr=0,this._wPrev=this._wCurr)}this.dispatchEvent(cJ);break;case"FOV":if(!this.enableZoom)return;this.camera instanceof eQ.PerspectiveCamera&&(-1!=this._animationId&&(cancelAnimationFrame(this._animationId),this._animationId=-1,this._timeStart=-1,this.activateGizmos(!1),this.dispatchEvent(cJ)),this.updateTbState(cH.FOV,!0),this._startCursorPosition.setY(.5*this.getCursorNDC(cj.x,cj.y,this.domElement).y),this._currentCursorPosition.copy(this._startCursorPosition));break;case"ZOOM":if(!this.enableZoom)return;-1!=this._animationId&&(cancelAnimationFrame(this._animationId),this._animationId=-1,this._timeStart=-1,this.activateGizmos(!1),this.dispatchEvent(cJ)),this.updateTbState(cH.SCALE,!0),this._startCursorPosition.setY(.5*this.getCursorNDC(cj.x,cj.y,this.domElement).y),this._currentCursorPosition.copy(this._startCursorPosition)}}),cG(this,"onSinglePanMove",(e,t)=>{if(this.enabled&&this.domElement){let r=t!=this._state;switch(this.setCenter(e.clientX,e.clientY),t){case cH.PAN:if(this.enablePan&&this.camera){if(r){this.dispatchEvent(cq),this.dispatchEvent(cW),this.updateTbState(t,!0);let e=this.unprojectOnTbPlane(this.camera,cj.x,cj.y,this.domElement);void 0!==e&&this._startCursorPosition.copy(e),this.enableGrid&&this.drawGrid(),this.activateGizmos(!1)}else{let e=this.unprojectOnTbPlane(this.camera,cj.x,cj.y,this.domElement);void 0!==e&&this._currentCursorPosition.copy(e),this.applyTransformMatrix(this.pan(this._startCursorPosition,this._currentCursorPosition))}}break;case cH.ROTATE:if(this.enableRotate&&this.camera){if(r){this.dispatchEvent(cq),this.dispatchEvent(cW),this.updateTbState(t,!0);let e=this.unprojectOnTbSurface(this.camera,cj.x,cj.y,this.domElement,this._tbRadius);void 0!==e&&this._startCursorPosition.copy(e),this.enableGrid&&this.disposeGrid(),this.activateGizmos(!0)}else{let e=this.unprojectOnTbSurface(this.camera,cj.x,cj.y,this.domElement,this._tbRadius);void 0!==e&&this._currentCursorPosition.copy(e);let t=this._startCursorPosition.distanceTo(this._currentCursorPosition),r=this._startCursorPosition.angleTo(this._currentCursorPosition),n=Math.max(t/this._tbRadius,r);this.applyTransformMatrix(this.rotate(this.calculateRotationAxis(this._startCursorPosition,this._currentCursorPosition),n)),this.enableAnimations&&(this._timePrev=this._timeCurrent,this._timeCurrent=performance.now(),this._anglePrev=this._angleCurrent,this._angleCurrent=n,this._cursorPosPrev.copy(this._cursorPosCurr),this._cursorPosCurr.copy(this._currentCursorPosition),this._wPrev=this._wCurr,this._wCurr=this.calculateAngularSpeed(this._anglePrev,this._angleCurrent,this._timePrev,this._timeCurrent))}}break;case cH.SCALE:if(this.enableZoom){if(r)this.dispatchEvent(cq),this.dispatchEvent(cW),this.updateTbState(t,!0),this._startCursorPosition.setY(.5*this.getCursorNDC(cj.x,cj.y,this.domElement).y),this._currentCursorPosition.copy(this._startCursorPosition),this.enableGrid&&this.disposeGrid(),this.activateGizmos(!1);else{this._currentCursorPosition.setY(.5*this.getCursorNDC(cj.x,cj.y,this.domElement).y);let e=this._currentCursorPosition.y-this._startCursorPosition.y,t=1;e<0?t=1/Math.pow(this.scaleFactor,-(8*e)):e>0&&(t=Math.pow(this.scaleFactor,8*e)),this.applyTransformMatrix(this.applyScale(t,this._gizmos.position))}}break;case cH.FOV:if(this.enableZoom&&this.camera instanceof eQ.PerspectiveCamera){if(r)this.dispatchEvent(cq),this.dispatchEvent(cW),this.updateTbState(t,!0),this._startCursorPosition.setY(.5*this.getCursorNDC(cj.x,cj.y,this.domElement).y),this._currentCursorPosition.copy(this._startCursorPosition),this.enableGrid&&this.disposeGrid(),this.activateGizmos(!1);else{this._currentCursorPosition.setY(.5*this.getCursorNDC(cj.x,cj.y,this.domElement).y);let e=this._currentCursorPosition.y-this._startCursorPosition.y,t=1;e<0?t=1/Math.pow(this.scaleFactor,-(8*e)):e>0&&(t=Math.pow(this.scaleFactor,8*e)),this._v3_1.setFromMatrixPosition(this._cameraMatrixState);let r=this._v3_1.distanceTo(this._gizmos.position),n=r/t;n=eQ.MathUtils.clamp(n,this.minDistance,this.maxDistance);let i=r*Math.tan(eQ.MathUtils.DEG2RAD*this._fovState*.5),a=eQ.MathUtils.RAD2DEG*(2*Math.atan(i/n));a=eQ.MathUtils.clamp(a,this.minFov,this.maxFov);let o=i/Math.tan(eQ.MathUtils.DEG2RAD*(a/2));t=r/o,this._v3_2.setFromMatrixPosition(this._gizmoMatrixState),this.setFov(a),this.applyTransformMatrix(this.applyScale(t,this._v3_2,!1));let s=this._gizmos.position.clone().sub(this.camera.position).normalize().multiplyScalar(o/r);this._m4_1.makeTranslation(s.x,s.y,s.z)}}}this.dispatchEvent(cJ)}}),cG(this,"onSinglePanEnd",()=>{if(this._state==cH.ROTATE){if(!this.enableRotate)return;if(this.enableAnimations){if(performance.now()-this._timeCurrent<120){let e=Math.abs((this._wPrev+this._wCurr)/2),t=this;this._animationId=window.requestAnimationFrame(function(r){t.updateTbState(cH.ANIMATION_ROTATE,!0);let n=t.calculateRotationAxis(t._cursorPosPrev,t._cursorPosCurr);t.onRotationAnim(r,n,Math.min(e,t.wMax))})}else this.updateTbState(cH.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(cJ)}else this.updateTbState(cH.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(cJ)}else(this._state==cH.PAN||this._state==cH.IDLE)&&(this.updateTbState(cH.IDLE,!1),this.enableGrid&&this.disposeGrid(),this.activateGizmos(!1),this.dispatchEvent(cJ));this.dispatchEvent(cq)}),cG(this,"onDoubleTap",e=>{if(this.enabled&&this.enablePan&&this.scene&&this.camera&&this.domElement){this.dispatchEvent(cW),this.setCenter(e.clientX,e.clientY);let t=this.unprojectOnObj(this.getCursorNDC(cj.x,cj.y,this.domElement),this.camera);if(t&&this.enableAnimations){let e=this;-1!=this._animationId&&window.cancelAnimationFrame(this._animationId),this._timeStart=-1,this._animationId=window.requestAnimationFrame(function(r){e.updateTbState(cH.ANIMATION_FOCUS,!0),e.onFocusAnim(r,t,e._cameraMatrixState,e._gizmoMatrixState)})}else t&&!this.enableAnimations&&(this.updateTbState(cH.FOCUS,!0),this.focus(t,this.scaleFactor),this.updateTbState(cH.IDLE,!1),this.dispatchEvent(cJ))}this.dispatchEvent(cq)}),cG(this,"onDoublePanStart",()=>{if(this.enabled&&this.enablePan&&this.camera&&this.domElement){this.dispatchEvent(cW),this.updateTbState(cH.PAN,!0),this.setCenter((this._touchCurrent[0].clientX+this._touchCurrent[1].clientX)/2,(this._touchCurrent[0].clientY+this._touchCurrent[1].clientY)/2);let e=this.unprojectOnTbPlane(this.camera,cj.x,cj.y,this.domElement,!0);void 0!==e&&this._startCursorPosition.copy(e),this._currentCursorPosition.copy(this._startCursorPosition),this.activateGizmos(!1)}}),cG(this,"onDoublePanMove",()=>{if(this.enabled&&this.enablePan&&this.camera&&this.domElement){this.setCenter((this._touchCurrent[0].clientX+this._touchCurrent[1].clientX)/2,(this._touchCurrent[0].clientY+this._touchCurrent[1].clientY)/2),this._state!=cH.PAN&&(this.updateTbState(cH.PAN,!0),this._startCursorPosition.copy(this._currentCursorPosition));let e=this.unprojectOnTbPlane(this.camera,cj.x,cj.y,this.domElement,!0);void 0!==e&&this._currentCursorPosition.copy(e),this.applyTransformMatrix(this.pan(this._startCursorPosition,this._currentCursorPosition,!0)),this.dispatchEvent(cJ)}}),cG(this,"onDoublePanEnd",()=>{this.updateTbState(cH.IDLE,!1),this.dispatchEvent(cq)}),cG(this,"onRotateStart",()=>{var e;this.enabled&&this.enableRotate&&(this.dispatchEvent(cW),this.updateTbState(cH.ZROTATE,!0),this._startFingerRotation=this.getAngle(this._touchCurrent[1],this._touchCurrent[0])+this.getAngle(this._touchStart[1],this._touchStart[0]),this._currentFingerRotation=this._startFingerRotation,null==(e=this.camera)||e.getWorldDirection(this._rotationAxis),this.enablePan||this.enableZoom||this.activateGizmos(!0))}),cG(this,"onRotateMove",()=>{var e;if(this.enabled&&this.enableRotate&&this.camera&&this.domElement){let t;this.setCenter((this._touchCurrent[0].clientX+this._touchCurrent[1].clientX)/2,(this._touchCurrent[0].clientY+this._touchCurrent[1].clientY)/2),this._state!=cH.ZROTATE&&(this.updateTbState(cH.ZROTATE,!0),this._startFingerRotation=this._currentFingerRotation),this._currentFingerRotation=this.getAngle(this._touchCurrent[1],this._touchCurrent[0])+this.getAngle(this._touchStart[1],this._touchStart[0]),this.enablePan?this.camera&&(this._v3_2.setFromMatrixPosition(this._gizmoMatrixState),t=null==(e=this.unprojectOnTbPlane(this.camera,cj.x,cj.y,this.domElement))?void 0:e.applyQuaternion(this.camera.quaternion).multiplyScalar(1/this.camera.zoom).add(this._v3_2)):t=new eQ.Vector3().setFromMatrixPosition(this._gizmoMatrixState);let r=eQ.MathUtils.DEG2RAD*(this._startFingerRotation-this._currentFingerRotation);void 0!==t&&this.applyTransformMatrix(this.zRotate(t,r)),this.dispatchEvent(cJ)}}),cG(this,"onRotateEnd",()=>{this.updateTbState(cH.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(cq)}),cG(this,"onPinchStart",()=>{this.enabled&&this.enableZoom&&(this.dispatchEvent(cW),this.updateTbState(cH.SCALE,!0),this._startFingerDistance=this.calculatePointersDistance(this._touchCurrent[0],this._touchCurrent[1]),this._currentFingerDistance=this._startFingerDistance,this.activateGizmos(!1))}),cG(this,"onPinchMove",()=>{var e,t;if(this.enabled&&this.enableZoom&&this.domElement){let r;this.setCenter((this._touchCurrent[0].clientX+this._touchCurrent[1].clientX)/2,(this._touchCurrent[0].clientY+this._touchCurrent[1].clientY)/2),this._state!=cH.SCALE&&(this._startFingerDistance=this._currentFingerDistance,this.updateTbState(cH.SCALE,!0)),this._currentFingerDistance=Math.max(this.calculatePointersDistance(this._touchCurrent[0],this._touchCurrent[1]),12*this._devPxRatio);let n=this._currentFingerDistance/this._startFingerDistance;this.enablePan?this.camera instanceof eQ.OrthographicCamera?r=null==(e=this.unprojectOnTbPlane(this.camera,cj.x,cj.y,this.domElement))?void 0:e.applyQuaternion(this.camera.quaternion).multiplyScalar(1/this.camera.zoom).add(this._gizmos.position):this.camera instanceof eQ.PerspectiveCamera&&(r=null==(t=this.unprojectOnTbPlane(this.camera,cj.x,cj.y,this.domElement))?void 0:t.applyQuaternion(this.camera.quaternion).add(this._gizmos.position)):r=this._gizmos.position,void 0!==r&&this.applyTransformMatrix(this.applyScale(n,r)),this.dispatchEvent(cJ)}}),cG(this,"onPinchEnd",()=>{this.updateTbState(cH.IDLE,!1),this.dispatchEvent(cq)}),cG(this,"onTriplePanStart",()=>{if(this.enabled&&this.enableZoom&&this.domElement){this.dispatchEvent(cW),this.updateTbState(cH.SCALE,!0);let e=0,t=0,r=this._touchCurrent.length;for(let n=0;n<r;n++)e+=this._touchCurrent[n].clientX,t+=this._touchCurrent[n].clientY;this.setCenter(e/r,t/r),this._startCursorPosition.setY(.5*this.getCursorNDC(cj.x,cj.y,this.domElement).y),this._currentCursorPosition.copy(this._startCursorPosition)}}),cG(this,"onTriplePanMove",()=>{if(this.enabled&&this.enableZoom&&this.camera&&this.domElement){let e=0,t=0,r=this._touchCurrent.length;for(let n=0;n<r;n++)e+=this._touchCurrent[n].clientX,t+=this._touchCurrent[n].clientY;this.setCenter(e/r,t/r),this._currentCursorPosition.setY(.5*this.getCursorNDC(cj.x,cj.y,this.domElement).y);let n=this._currentCursorPosition.y-this._startCursorPosition.y,i=1;n<0?i=1/Math.pow(this.scaleFactor,-(8*n)):n>0&&(i=Math.pow(this.scaleFactor,8*n)),this._v3_1.setFromMatrixPosition(this._cameraMatrixState);let a=this._v3_1.distanceTo(this._gizmos.position),o=a/i;o=eQ.MathUtils.clamp(o,this.minDistance,this.maxDistance);let s=a*Math.tan(eQ.MathUtils.DEG2RAD*this._fovState*.5),l=eQ.MathUtils.RAD2DEG*(2*Math.atan(s/o));l=eQ.MathUtils.clamp(l,this.minFov,this.maxFov);let c=s/Math.tan(eQ.MathUtils.DEG2RAD*(l/2));i=a/c,this._v3_2.setFromMatrixPosition(this._gizmoMatrixState),this.setFov(l),this.applyTransformMatrix(this.applyScale(i,this._v3_2,!1));let u=this._gizmos.position.clone().sub(this.camera.position).normalize().multiplyScalar(c/a);this._m4_1.makeTranslation(u.x,u.y,u.z),this.dispatchEvent(cJ)}}),cG(this,"onTriplePanEnd",()=>{this.updateTbState(cH.IDLE,!1),this.dispatchEvent(cq)}),cG(this,"setCenter",(e,t)=>{cj.x=e,cj.y=t}),cG(this,"initializeMouseActions",()=>{this.setMouseAction("PAN",0,"CTRL"),this.setMouseAction("PAN",2),this.setMouseAction("ROTATE",0),this.setMouseAction("ZOOM","WHEEL"),this.setMouseAction("ZOOM",1),this.setMouseAction("FOV","WHEEL","SHIFT"),this.setMouseAction("FOV",1,"SHIFT")}),cG(this,"setMouseAction",(e,t,r=null)=>{let n;if(!["PAN","ROTATE","ZOOM","FOV"].includes(e)||![0,1,2,"WHEEL"].includes(t)||!["CTRL","SHIFT",null].includes(r)||"WHEEL"==t&&"ZOOM"!=e&&"FOV"!=e)return!1;switch(e){case"PAN":n=cH.PAN;break;case"ROTATE":n=cH.ROTATE;break;case"ZOOM":n=cH.SCALE;break;case"FOV":n=cH.FOV}let i={operation:e,mouse:t,key:r,state:n};for(let e=0;e<this.mouseActions.length;e++)if(this.mouseActions[e].mouse==i.mouse&&this.mouseActions[e].key==i.key)return this.mouseActions.splice(e,1,i),!0;return this.mouseActions.push(i),!0}),cG(this,"getOpFromAction",(e,t)=>{let r;for(let n=0;n<this.mouseActions.length;n++)if((r=this.mouseActions[n]).mouse==e&&r.key==t)return r.operation;if(t){for(let t=0;t<this.mouseActions.length;t++)if((r=this.mouseActions[t]).mouse==e&&null==r.key)return r.operation}return null}),cG(this,"getOpStateFromAction",(e,t)=>{let r;for(let n=0;n<this.mouseActions.length;n++)if((r=this.mouseActions[n]).mouse==e&&r.key==t)return r.state;if(t){for(let t=0;t<this.mouseActions.length;t++)if((r=this.mouseActions[t]).mouse==e&&null==r.key)return r.state}return null}),cG(this,"getAngle",(e,t)=>180*Math.atan2(t.clientY-e.clientY,t.clientX-e.clientX)/Math.PI),cG(this,"updateTouchEvent",e=>{for(let t=0;t<this._touchCurrent.length;t++)if(this._touchCurrent[t].pointerId==e.pointerId){this._touchCurrent.splice(t,1,e);break}}),cG(this,"calculateAngularSpeed",(e,t,r,n)=>{let i=(n-r)/1e3;return 0==i?0:(t-e)/i}),cG(this,"calculatePointersDistance",(e,t)=>Math.sqrt(Math.pow(t.clientX-e.clientX,2)+Math.pow(t.clientY-e.clientY,2))),cG(this,"calculateRotationAxis",(e,t)=>(this._rotationMatrix.extractRotation(this._cameraMatrixState),this._quat.setFromRotationMatrix(this._rotationMatrix),this._rotationAxis.crossVectors(e,t).applyQuaternion(this._quat),this._rotationAxis.normalize().clone())),cG(this,"calculateTbRadius",e=>{let t=e.position.distanceTo(this._gizmos.position);if(e instanceof eQ.PerspectiveCamera){let r=eQ.MathUtils.DEG2RAD*e.fov*.5,n=Math.atan(e.aspect*Math.tan(r));return Math.tan(Math.min(r,n))*t*.67}if(e instanceof eQ.OrthographicCamera)return .67*Math.min(e.top,e.right)}),cG(this,"focus",(e,t,r=1)=>{if(this.camera){let n=e.clone();n.sub(this._gizmos.position).multiplyScalar(r),this._translationMatrix.makeTranslation(n.x,n.y,n.z);let i=this._gizmoMatrixState.clone();this._gizmoMatrixState.premultiply(this._translationMatrix),this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale);let a=this._cameraMatrixState.clone();this._cameraMatrixState.premultiply(this._translationMatrix),this._cameraMatrixState.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.enableZoom&&this.applyTransformMatrix(this.applyScale(t,this._gizmos.position)),this._gizmoMatrixState.copy(i),this._cameraMatrixState.copy(a)}}),cG(this,"drawGrid",()=>{if(this.scene){let e,t,r,n;if(this.camera instanceof eQ.OrthographicCamera)n=(r=Math.max(this.camera.right-this.camera.left,this.camera.bottom-this.camera.top))/20,t=(e=r/this.camera.zoom*3)/n*this.camera.zoom;else if(this.camera instanceof eQ.PerspectiveCamera){let i=this.camera.position.distanceTo(this._gizmos.position),a=eQ.MathUtils.DEG2RAD*this.camera.fov*.5,o=Math.atan(this.camera.aspect*Math.tan(a));n=(r=Math.tan(Math.max(a,o))*i*2)/20,t=(e=3*r)/n}null==this._grid&&this.camera&&(this._grid=new eQ.GridHelper(e,t,8947848,8947848),this._grid.position.copy(this._gizmos.position),this._gridPosition.copy(this._grid.position),this._grid.quaternion.copy(this.camera.quaternion),this._grid.rotateX(.5*Math.PI),this.scene.add(this._grid))}}),cG(this,"connect",e=>{e===document&&console.error('THREE.ArcballControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.domElement=e,this.domElement.style.touchAction="none",this.domElement.addEventListener("contextmenu",this.onContextMenu),this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("pointercancel",this.onPointerCancel),this.domElement.addEventListener("wheel",this.onWheel)}),cG(this,"dispose",()=>{var e,t,r,n,i;-1!=this._animationId&&window.cancelAnimationFrame(this._animationId),null==(e=this.domElement)||e.removeEventListener("pointerdown",this.onPointerDown),null==(t=this.domElement)||t.removeEventListener("pointercancel",this.onPointerCancel),null==(r=this.domElement)||r.removeEventListener("wheel",this.onWheel),null==(n=this.domElement)||n.removeEventListener("contextmenu",this.onContextMenu),window.removeEventListener("pointermove",this.onPointerMove),window.removeEventListener("pointerup",this.onPointerUp),window.removeEventListener("resize",this.onWindowResize),null==(i=this.scene)||i.remove(this._gizmos),this.disposeGrid()}),cG(this,"disposeGrid",()=>{this._grid&&this.scene&&(this.scene.remove(this._grid),this._grid=null)}),cG(this,"easeOutCubic",e=>1-Math.pow(1-e,3)),cG(this,"activateGizmos",e=>{for(let t of this._gizmos.children)t.material.setValues({opacity:e?1:.6})}),cG(this,"getCursorNDC",(e,t,r)=>{let n=r.getBoundingClientRect();return this._v2_1.setX((e-n.left)/n.width*2-1),this._v2_1.setY((n.bottom-t)/n.height*2-1),this._v2_1.clone()}),cG(this,"getCursorPosition",(e,t,r)=>(this._v2_1.copy(this.getCursorNDC(e,t,r)),this.camera instanceof eQ.OrthographicCamera&&(this._v2_1.x*=(this.camera.right-this.camera.left)*.5,this._v2_1.y*=(this.camera.top-this.camera.bottom)*.5),this._v2_1.clone())),cG(this,"setCamera",e=>{if(e){e.lookAt(this.target),e.updateMatrix(),e instanceof eQ.PerspectiveCamera&&(this._fov0=e.fov,this._fovState=e.fov),this._cameraMatrixState0.copy(e.matrix),this._cameraMatrixState.copy(this._cameraMatrixState0),this._cameraProjectionState.copy(e.projectionMatrix),this._zoom0=e.zoom,this._zoomState=this._zoom0,this._initialNear=e.near,this._nearPos0=e.position.distanceTo(this.target)-e.near,this._nearPos=this._initialNear,this._initialFar=e.far,this._farPos0=e.position.distanceTo(this.target)-e.far,this._farPos=this._initialFar,this._up0.copy(e.up),this._upState.copy(e.up),this.camera=e,this.camera.updateProjectionMatrix();let t=this.calculateTbRadius(e);void 0!==t&&(this._tbRadius=t),this.makeGizmos(this.target,this._tbRadius)}}),cG(this,"makeGizmos",(e,t)=>{let r=new eQ.EllipseCurve(0,0,t,t).getPoints(this._curvePts),n=new eQ.BufferGeometry().setFromPoints(r),i=new eQ.LineBasicMaterial({color:16744576,fog:!1,transparent:!0,opacity:.6}),a=new eQ.LineBasicMaterial({color:8454016,fog:!1,transparent:!0,opacity:.6}),o=new eQ.LineBasicMaterial({color:8421631,fog:!1,transparent:!0,opacity:.6}),s=new eQ.Line(n,i),l=new eQ.Line(n,a),c=new eQ.Line(n,o),u=.5*Math.PI;if(s.rotation.x=u,l.rotation.y=u,this._gizmoMatrixState0.identity().setPosition(e),this._gizmoMatrixState.copy(this._gizmoMatrixState0),this.camera&&1!=this.camera.zoom){let t=1/this.camera.zoom;this._scaleMatrix.makeScale(t,t,t),this._translationMatrix.makeTranslation(-e.x,-e.y,-e.z),this._gizmoMatrixState.premultiply(this._translationMatrix).premultiply(this._scaleMatrix),this._translationMatrix.makeTranslation(e.x,e.y,e.z),this._gizmoMatrixState.premultiply(this._translationMatrix)}this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this._gizmos.clear(),this._gizmos.add(s),this._gizmos.add(l),this._gizmos.add(c)}),cG(this,"onFocusAnim",(e,t,r,n)=>{if(-1==this._timeStart&&(this._timeStart=e),this._state==cH.ANIMATION_FOCUS){let i=(e-this._timeStart)/this.focusAnimationTime;if(this._gizmoMatrixState.copy(n),i>=1)this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this.focus(t,this.scaleFactor),this._timeStart=-1,this.updateTbState(cH.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(cJ);else{let e=this.easeOutCubic(i),a=1-e+this.scaleFactor*e;this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this.focus(t,a,e),this.dispatchEvent(cJ);let o=this;this._animationId=window.requestAnimationFrame(function(e){o.onFocusAnim(e,t,r,n.clone())})}}else this._animationId=-1,this._timeStart=-1}),cG(this,"onRotationAnim",(e,t,r)=>{if(-1==this._timeStart&&(this._anglePrev=0,this._angleCurrent=0,this._timeStart=e),this._state==cH.ANIMATION_ROTATE){let n=(e-this._timeStart)/1e3;if(r+-this.dampingFactor*n>0){this._angleCurrent=-(.5*this.dampingFactor)*Math.pow(n,2)+r*n+0,this.applyTransformMatrix(this.rotate(t,this._angleCurrent)),this.dispatchEvent(cJ);let e=this;this._animationId=window.requestAnimationFrame(function(n){e.onRotationAnim(n,t,r)})}else this._animationId=-1,this._timeStart=-1,this.updateTbState(cH.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(cJ)}else this._animationId=-1,this._timeStart=-1,this._state!=cH.ROTATE&&(this.activateGizmos(!1),this.dispatchEvent(cJ))}),cG(this,"pan",(e,t,r=!1)=>{if(this.camera){let n=e.clone().sub(t);if(this.camera instanceof eQ.OrthographicCamera&&n.multiplyScalar(1/this.camera.zoom),this.camera instanceof eQ.PerspectiveCamera&&r){this._v3_1.setFromMatrixPosition(this._cameraMatrixState0),this._v3_2.setFromMatrixPosition(this._gizmoMatrixState0);let e=this._v3_1.distanceTo(this._v3_2)/this.camera.position.distanceTo(this._gizmos.position);n.multiplyScalar(1/e)}this._v3_1.set(n.x,n.y,0).applyQuaternion(this.camera.quaternion),this._m4_1.makeTranslation(this._v3_1.x,this._v3_1.y,this._v3_1.z),this.setTransformationMatrices(this._m4_1,this._m4_1)}return cY}),cG(this,"reset",()=>{if(this.camera){this.camera.zoom=this._zoom0,this.camera instanceof eQ.PerspectiveCamera&&(this.camera.fov=this._fov0),this.camera.near=this._nearPos,this.camera.far=this._farPos,this._cameraMatrixState.copy(this._cameraMatrixState0),this._cameraMatrixState.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.up.copy(this._up0),this.camera.updateMatrix(),this.camera.updateProjectionMatrix(),this._gizmoMatrixState.copy(this._gizmoMatrixState0),this._gizmoMatrixState0.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this._gizmos.updateMatrix();let e=this.calculateTbRadius(this.camera);void 0!==e&&(this._tbRadius=e),this.makeGizmos(this._gizmos.position,this._tbRadius),this.camera.lookAt(this._gizmos.position),this.updateTbState(cH.IDLE,!1),this.dispatchEvent(cJ)}}),cG(this,"rotate",(e,t)=>{let r=this._gizmos.position;return this._translationMatrix.makeTranslation(-r.x,-r.y,-r.z),this._rotationMatrix.makeRotationAxis(e,-t),this._m4_1.makeTranslation(r.x,r.y,r.z),this._m4_1.multiply(this._rotationMatrix),this._m4_1.multiply(this._translationMatrix),this.setTransformationMatrices(this._m4_1),cY}),cG(this,"copyState",()=>{if(this.camera){let e=JSON.stringify(this.camera instanceof eQ.OrthographicCamera?{arcballState:{cameraFar:this.camera.far,cameraMatrix:this.camera.matrix,cameraNear:this.camera.near,cameraUp:this.camera.up,cameraZoom:this.camera.zoom,gizmoMatrix:this._gizmos.matrix}}:{arcballState:{cameraFar:this.camera.far,cameraFov:this.camera.fov,cameraMatrix:this.camera.matrix,cameraNear:this.camera.near,cameraUp:this.camera.up,cameraZoom:this.camera.zoom,gizmoMatrix:this._gizmos.matrix}});navigator.clipboard.writeText(e)}}),cG(this,"pasteState",()=>{let e=this;navigator.clipboard.readText().then(function(t){e.setStateFromJSON(t)})}),cG(this,"saveState",()=>{this.camera&&(this._cameraMatrixState0.copy(this.camera.matrix),this._gizmoMatrixState0.copy(this._gizmos.matrix),this._nearPos=this.camera.near,this._farPos=this.camera.far,this._zoom0=this.camera.zoom,this._up0.copy(this.camera.up),this.camera instanceof eQ.PerspectiveCamera&&(this._fov0=this.camera.fov))}),cG(this,"applyScale",(e,t,r=!0)=>{if(!this.camera)return;let n=t.clone(),i=1/e;if(this.camera instanceof eQ.OrthographicCamera){this.camera.zoom=this._zoomState,this.camera.zoom*=e,this.camera.zoom>this.maxZoom?(this.camera.zoom=this.maxZoom,i=this._zoomState/this.maxZoom):this.camera.zoom<this.minZoom&&(this.camera.zoom=this.minZoom,i=this._zoomState/this.minZoom),this.camera.updateProjectionMatrix(),this._v3_1.setFromMatrixPosition(this._gizmoMatrixState),this._scaleMatrix.makeScale(i,i,i),this._translationMatrix.makeTranslation(-this._v3_1.x,-this._v3_1.y,-this._v3_1.z),this._m4_2.makeTranslation(this._v3_1.x,this._v3_1.y,this._v3_1.z).multiply(this._scaleMatrix),this._m4_2.multiply(this._translationMatrix),n.sub(this._v3_1);let t=n.clone().multiplyScalar(i);return n.sub(t),this._m4_1.makeTranslation(n.x,n.y,n.z),this._m4_2.premultiply(this._m4_1),this.setTransformationMatrices(this._m4_1,this._m4_2),cY}if(this.camera instanceof eQ.PerspectiveCamera){this._v3_1.setFromMatrixPosition(this._cameraMatrixState),this._v3_2.setFromMatrixPosition(this._gizmoMatrixState);let e=this._v3_1.distanceTo(n),t=e-e*i,a=e-t;a<this.minDistance?(i=this.minDistance/e,t=e-e*i):a>this.maxDistance&&(i=this.maxDistance/e,t=e-e*i);let o=n.clone().sub(this._v3_1).normalize().multiplyScalar(t);if(this._m4_1.makeTranslation(o.x,o.y,o.z),r){let r=this._v3_2;t=(e=r.distanceTo(n))-e*i,o=n.clone().sub(this._v3_2).normalize().multiplyScalar(t),this._translationMatrix.makeTranslation(r.x,r.y,r.z),this._scaleMatrix.makeScale(i,i,i),this._m4_2.makeTranslation(o.x,o.y,o.z).multiply(this._translationMatrix),this._m4_2.multiply(this._scaleMatrix),this._translationMatrix.makeTranslation(-r.x,-r.y,-r.z),this._m4_2.multiply(this._translationMatrix),this.setTransformationMatrices(this._m4_1,this._m4_2)}else this.setTransformationMatrices(this._m4_1);return cY}}),cG(this,"setFov",e=>{this.camera instanceof eQ.PerspectiveCamera&&(this.camera.fov=eQ.MathUtils.clamp(e,this.minFov,this.maxFov),this.camera.updateProjectionMatrix())}),cG(this,"setTarget",(e,t,r)=>{if(this.camera){this.target.set(e,t,r),this._gizmos.position.set(e,t,r);let n=this.calculateTbRadius(this.camera);void 0!==n&&(this._tbRadius=n),this.makeGizmos(this.target,this._tbRadius),this.camera.lookAt(this.target)}}),cG(this,"zRotate",(e,t)=>(this._rotationMatrix.makeRotationAxis(this._rotationAxis,t),this._translationMatrix.makeTranslation(-e.x,-e.y,-e.z),this._m4_1.makeTranslation(e.x,e.y,e.z),this._m4_1.multiply(this._rotationMatrix),this._m4_1.multiply(this._translationMatrix),this._v3_1.setFromMatrixPosition(this._gizmoMatrixState).sub(e),this._v3_2.copy(this._v3_1).applyAxisAngle(this._rotationAxis,t),this._v3_2.sub(this._v3_1),this._m4_2.makeTranslation(this._v3_2.x,this._v3_2.y,this._v3_2.z),this.setTransformationMatrices(this._m4_1,this._m4_2),cY)),cG(this,"unprojectOnObj",(e,t)=>{if(!this.scene)return null;let r=new eQ.Raycaster;r.near=t.near,r.far=t.far,r.setFromCamera(e,t);let n=r.intersectObjects(this.scene.children,!0);for(let e=0;e<n.length;e++)if(n[e].object.uuid!=this._gizmos.uuid&&n[e].face)return n[e].point.clone();return null}),cG(this,"unprojectOnTbSurface",(e,t,r,n,i)=>{if(e instanceof eQ.OrthographicCamera){this._v2_1.copy(this.getCursorPosition(t,r,n)),this._v3_1.set(this._v2_1.x,this._v2_1.y,0);let e=Math.pow(this._v2_1.x,2),i=Math.pow(this._v2_1.y,2),a=Math.pow(this._tbRadius,2);return e+i<=.5*a?this._v3_1.setZ(Math.sqrt(a-(e+i))):this._v3_1.setZ(.5*a/Math.sqrt(e+i)),this._v3_1}if(e instanceof eQ.PerspectiveCamera){this._v2_1.copy(this.getCursorNDC(t,r,n)),this._v3_1.set(this._v2_1.x,this._v2_1.y,-1),this._v3_1.applyMatrix4(e.projectionMatrixInverse);let a=this._v3_1.clone().normalize(),o=e.position.distanceTo(this._gizmos.position),s=Math.pow(i,2),l=this._v3_1.z,c=Math.sqrt(Math.pow(this._v3_1.x,2)+Math.pow(this._v3_1.y,2));if(0==c)return a.set(this._v3_1.x,this._v3_1.y,i),a;let u=l/c,h=Math.pow(u,2)+1,d=2*u*o,f=Math.pow(o,2)-s,p=Math.pow(d,2)-4*h*f;if(p>=0&&(this._v2_1.setX((-d-Math.sqrt(p))/(2*h)),this._v2_1.setY(u*this._v2_1.x+o),eQ.MathUtils.RAD2DEG*this._v2_1.angle()>=45)){let e=Math.sqrt(Math.pow(this._v2_1.x,2)+Math.pow(o-this._v2_1.y,2));return a.multiplyScalar(e),a.z+=o,a}h=u,p=Math.pow(d=o,2)-4*h*(f=-(.5*s)),this._v2_1.setX((-d-Math.sqrt(p))/(2*h)),this._v2_1.setY(u*this._v2_1.x+o);let m=Math.sqrt(Math.pow(this._v2_1.x,2)+Math.pow(o-this._v2_1.y,2));return a.multiplyScalar(m),a.z+=o,a}}),cG(this,"unprojectOnTbPlane",(e,t,r,n,i=!1)=>{if(e instanceof eQ.OrthographicCamera)return this._v2_1.copy(this.getCursorPosition(t,r,n)),this._v3_1.set(this._v2_1.x,this._v2_1.y,0),this._v3_1.clone();if(e instanceof eQ.PerspectiveCamera){let a;this._v2_1.copy(this.getCursorNDC(t,r,n)),this._v3_1.set(this._v2_1.x,this._v2_1.y,-1),this._v3_1.applyMatrix4(e.projectionMatrixInverse);let o=this._v3_1.clone().normalize(),s=this._v3_1.z,l=Math.sqrt(Math.pow(this._v3_1.x,2)+Math.pow(this._v3_1.y,2));return(a=i?this._v3_1.setFromMatrixPosition(this._cameraMatrixState0).distanceTo(this._v3_2.setFromMatrixPosition(this._gizmoMatrixState0)):e.position.distanceTo(this._gizmos.position),0==l)?o.set(0,0,0):(o.multiplyScalar(Math.sqrt(Math.pow(a,2)+Math.pow(-a/(s/l),2))),o.z=0),o}}),cG(this,"updateMatrixState",()=>{this.camera&&(this._cameraMatrixState.copy(this.camera.matrix),this._gizmoMatrixState.copy(this._gizmos.matrix),this.camera instanceof eQ.OrthographicCamera&&(this._cameraProjectionState.copy(this.camera.projectionMatrix),this.camera.updateProjectionMatrix(),this._zoomState=this.camera.zoom),this.camera instanceof eQ.PerspectiveCamera&&(this._fovState=this.camera.fov))}),cG(this,"updateTbState",(e,t)=>{this._state=e,t&&this.updateMatrixState()}),cG(this,"update",()=>{if(!this.target.equals(this._currentTarget)&&this.camera){this._gizmos.position.set(this.target.x,this.target.y,this.target.z);let e=this.calculateTbRadius(this.camera);void 0!==e&&(this._tbRadius=e),this.makeGizmos(this.target,this._tbRadius),this._currentTarget.copy(this.target)}if(this.camera){if(this.camera instanceof eQ.OrthographicCamera&&(this.camera.zoom>this.maxZoom||this.camera.zoom<this.minZoom)){let e=eQ.MathUtils.clamp(this.camera.zoom,this.minZoom,this.maxZoom);this.applyTransformMatrix(this.applyScale(e/this.camera.zoom,this._gizmos.position,!0))}if(this.camera instanceof eQ.PerspectiveCamera){let e=this.camera.position.distanceTo(this._gizmos.position);if(e>this.maxDistance+1e-6||e<this.minDistance-1e-6){let t=eQ.MathUtils.clamp(e,this.minDistance,this.maxDistance);this.applyTransformMatrix(this.applyScale(t/e,this._gizmos.position)),this.updateMatrixState()}(this.camera.fov<this.minFov||this.camera.fov>this.maxFov)&&(this.camera.fov=eQ.MathUtils.clamp(this.camera.fov,this.minFov,this.maxFov),this.camera.updateProjectionMatrix());let t=this._tbRadius,r=this.calculateTbRadius(this.camera);if(void 0!==r&&(this._tbRadius=r),t<this._tbRadius-1e-6||t>this._tbRadius+1e-6){let e=(this._gizmos.scale.x+this._gizmos.scale.y+this._gizmos.scale.z)/3,t=this._tbRadius/e,r=new eQ.EllipseCurve(0,0,t,t).getPoints(this._curvePts),n=new eQ.BufferGeometry().setFromPoints(r);for(let e in this._gizmos.children)this._gizmos.children[e].geometry=n}}this.camera.lookAt(this._gizmos.position)}}),cG(this,"setStateFromJSON",e=>{let t=JSON.parse(e);if(t.arcballState&&this.camera){this._cameraMatrixState.fromArray(t.arcballState.cameraMatrix.elements),this._cameraMatrixState.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.up.copy(t.arcballState.cameraUp),this.camera.near=t.arcballState.cameraNear,this.camera.far=t.arcballState.cameraFar,this.camera.zoom=t.arcballState.cameraZoom,this.camera instanceof eQ.PerspectiveCamera&&(this.camera.fov=t.arcballState.cameraFov),this._gizmoMatrixState.fromArray(t.arcballState.gizmoMatrix.elements),this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this.camera.updateMatrix(),this.camera.updateProjectionMatrix(),this._gizmos.updateMatrix();let e=this.calculateTbRadius(this.camera);void 0!==e&&(this._tbRadius=e);let r=new eQ.Matrix4().copy(this._gizmoMatrixState0);this.makeGizmos(this._gizmos.position,this._tbRadius),this._gizmoMatrixState0.copy(r),this.camera.lookAt(this._gizmos.position),this.updateTbState(cH.IDLE,!1),this.dispatchEvent(cJ)}}),this.camera=null,this.domElement=t,this.scene=r,this.mouseActions=[],this._mouseOp=null,this._v2_1=new eQ.Vector2,this._v3_1=new eQ.Vector3,this._v3_2=new eQ.Vector3,this._m4_1=new eQ.Matrix4,this._m4_2=new eQ.Matrix4,this._quat=new eQ.Quaternion,this._translationMatrix=new eQ.Matrix4,this._rotationMatrix=new eQ.Matrix4,this._scaleMatrix=new eQ.Matrix4,this._rotationAxis=new eQ.Vector3,this._cameraMatrixState=new eQ.Matrix4,this._cameraProjectionState=new eQ.Matrix4,this._fovState=1,this._upState=new eQ.Vector3,this._zoomState=1,this._nearPos=0,this._farPos=0,this._gizmoMatrixState=new eQ.Matrix4,this._up0=new eQ.Vector3,this._zoom0=1,this._fov0=0,this._initialNear=0,this._nearPos0=0,this._initialFar=0,this._farPos0=0,this._cameraMatrixState0=new eQ.Matrix4,this._gizmoMatrixState0=new eQ.Matrix4,this._button=-1,this._touchStart=[],this._touchCurrent=[],this._input=cV.NONE,this._switchSensibility=32,this._startFingerDistance=0,this._currentFingerDistance=0,this._startFingerRotation=0,this._currentFingerRotation=0,this._devPxRatio=0,this._downValid=!0,this._nclicks=0,this._downEvents=[],this._clickStart=0,this._maxDownTime=250,this._maxInterval=300,this._posThreshold=24,this._movementThreshold=24,this._currentCursorPosition=new eQ.Vector3,this._startCursorPosition=new eQ.Vector3,this._grid=null,this._gridPosition=new eQ.Vector3,this._gizmos=new eQ.Group,this._curvePts=128,this._timeStart=-1,this._animationId=-1,this.focusAnimationTime=500,this._timePrev=0,this._timeCurrent=0,this._anglePrev=0,this._angleCurrent=0,this._cursorPosPrev=new eQ.Vector3,this._cursorPosCurr=new eQ.Vector3,this._wPrev=0,this._wCurr=0,this.adjustNearFar=!1,this.scaleFactor=1.1,this.dampingFactor=25,this.wMax=20,this.enableAnimations=!0,this.enableGrid=!1,this.cursorZoom=!1,this.minFov=5,this.maxFov=90,this.enabled=!0,this.enablePan=!0,this.enableRotate=!0,this.enableZoom=!0,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.target=new eQ.Vector3(0,0,0),this._currentTarget=new eQ.Vector3(0,0,0),this._tbRadius=1,this._state=cH.IDLE,this.setCamera(e),this.scene&&this.scene.add(this._gizmos),this._devPxRatio=window.devicePixelRatio,this.initializeMouseActions(),this.domElement&&this.connect(this.domElement),window.addEventListener("resize",this.onWindowResize)}applyTransformMatrix(e){if((null==e?void 0:e.camera)&&this.camera&&(this._m4_1.copy(this._cameraMatrixState).premultiply(e.camera),this._m4_1.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.updateMatrix(),(this._state==cH.ROTATE||this._state==cH.ZROTATE||this._state==cH.ANIMATION_ROTATE)&&this.camera.up.copy(this._upState).applyQuaternion(this.camera.quaternion)),(null==e?void 0:e.gizmos)&&(this._m4_1.copy(this._gizmoMatrixState).premultiply(e.gizmos),this._m4_1.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this._gizmos.updateMatrix()),(this._state==cH.SCALE||this._state==cH.FOCUS||this._state==cH.ANIMATION_FOCUS)&&this.camera){let e=this.calculateTbRadius(this.camera);if(void 0!==e&&(this._tbRadius=e),this.adjustNearFar){let e=this.camera.position.distanceTo(this._gizmos.position),t=new eQ.Box3;t.setFromObject(this._gizmos);let r=new eQ.Sphere;t.getBoundingSphere(r);let n=Math.min(Math.max(this._nearPos0,r.radius+r.center.length()),e-this._initialNear);this.camera.near=e-n;let i=Math.min(Math.min(this._farPos0,-r.radius+r.center.length()),e-this._initialFar);this.camera.far=e-i,this.camera.updateProjectionMatrix()}else{let e=!1;this.camera.near!=this._initialNear&&(this.camera.near=this._initialNear,e=!0),this.camera.far!=this._initialFar&&(this.camera.far=this._initialFar,e=!0),e&&this.camera.updateProjectionMatrix()}}}setGizmosVisible(e){this._gizmos.visible=e,this.dispatchEvent(cJ)}setTransformationMatrices(e=null,t=null){e?cY.camera?cY.camera.copy(e):cY.camera=e.clone():cY.camera=null,t?cY.gizmos?cY.gizmos.copy(t):cY.gizmos=t.clone():cY.gizmos=null}}let cX=(0,ez.forwardRef)(({camera:e,makeDefault:t,regress:r,domElement:n,onChange:i,onStart:a,onEnd:o,...s},l)=>{let c=(0,eL.A)(e=>e.invalidate),u=(0,eL.A)(e=>e.camera),h=(0,eL.A)(e=>e.gl),d=(0,eL.A)(e=>e.events),f=(0,eL.A)(e=>e.set),p=(0,eL.A)(e=>e.get),m=(0,eL.A)(e=>e.performance),A=e||u,g=n||d.connected||h.domElement,v=(0,ez.useMemo)(()=>new cK(A),[A]);return(0,eL.C)(()=>{v.enabled&&v.update()},-1),(0,ez.useEffect)(()=>(v.connect(g),()=>void v.dispose()),[g,r,v,c]),(0,ez.useEffect)(()=>{let e=e=>{c(),r&&m.regress(),i&&i(e)};return v.addEventListener("change",e),a&&v.addEventListener("start",a),o&&v.addEventListener("end",o),()=>{v.removeEventListener("change",e),a&&v.removeEventListener("start",a),o&&v.removeEventListener("end",o)}},[i,a,o]),(0,ez.useEffect)(()=>{if(t){let e=p().controls;return f({controls:v}),()=>f({controls:e})}},[t,v]),ez.createElement("primitive",ee({ref:l,object:v},s))});var cZ=Object.defineProperty,c$=(e,t,r)=>t in e?cZ(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,c0=(e,t,r)=>(c$(e,"symbol"!=typeof t?t+"":t,r),r);class c1 extends eQ.Object3D{constructor(e,t){super(),c0(this,"isTransformControls",!0),c0(this,"visible",!1),c0(this,"domElement"),c0(this,"raycaster",new eQ.Raycaster),c0(this,"gizmo"),c0(this,"plane"),c0(this,"tempVector",new eQ.Vector3),c0(this,"tempVector2",new eQ.Vector3),c0(this,"tempQuaternion",new eQ.Quaternion),c0(this,"unit",{X:new eQ.Vector3(1,0,0),Y:new eQ.Vector3(0,1,0),Z:new eQ.Vector3(0,0,1)}),c0(this,"pointStart",new eQ.Vector3),c0(this,"pointEnd",new eQ.Vector3),c0(this,"offset",new eQ.Vector3),c0(this,"rotationAxis",new eQ.Vector3),c0(this,"startNorm",new eQ.Vector3),c0(this,"endNorm",new eQ.Vector3),c0(this,"rotationAngle",0),c0(this,"cameraPosition",new eQ.Vector3),c0(this,"cameraQuaternion",new eQ.Quaternion),c0(this,"cameraScale",new eQ.Vector3),c0(this,"parentPosition",new eQ.Vector3),c0(this,"parentQuaternion",new eQ.Quaternion),c0(this,"parentQuaternionInv",new eQ.Quaternion),c0(this,"parentScale",new eQ.Vector3),c0(this,"worldPositionStart",new eQ.Vector3),c0(this,"worldQuaternionStart",new eQ.Quaternion),c0(this,"worldScaleStart",new eQ.Vector3),c0(this,"worldPosition",new eQ.Vector3),c0(this,"worldQuaternion",new eQ.Quaternion),c0(this,"worldQuaternionInv",new eQ.Quaternion),c0(this,"worldScale",new eQ.Vector3),c0(this,"eye",new eQ.Vector3),c0(this,"positionStart",new eQ.Vector3),c0(this,"quaternionStart",new eQ.Quaternion),c0(this,"scaleStart",new eQ.Vector3),c0(this,"camera"),c0(this,"object"),c0(this,"enabled",!0),c0(this,"axis",null),c0(this,"mode","translate"),c0(this,"translationSnap",null),c0(this,"rotationSnap",null),c0(this,"scaleSnap",null),c0(this,"space","world"),c0(this,"size",1),c0(this,"dragging",!1),c0(this,"showX",!0),c0(this,"showY",!0),c0(this,"showZ",!0),c0(this,"changeEvent",{type:"change"}),c0(this,"mouseDownEvent",{type:"mouseDown",mode:this.mode}),c0(this,"mouseUpEvent",{type:"mouseUp",mode:this.mode}),c0(this,"objectChangeEvent",{type:"objectChange"}),c0(this,"intersectObjectWithRay",(e,t,r)=>{let n=t.intersectObject(e,!0);for(let e=0;e<n.length;e++)if(n[e].object.visible||r)return n[e];return!1}),c0(this,"attach",e=>(this.object=e,this.visible=!0,this)),c0(this,"detach",()=>(this.object=void 0,this.visible=!1,this.axis=null,this)),c0(this,"reset",()=>(this.enabled&&this.dragging&&void 0!==this.object&&(this.object.position.copy(this.positionStart),this.object.quaternion.copy(this.quaternionStart),this.object.scale.copy(this.scaleStart),this.dispatchEvent(this.changeEvent),this.dispatchEvent(this.objectChangeEvent),this.pointStart.copy(this.pointEnd)),this)),c0(this,"updateMatrixWorld",()=>{void 0!==this.object&&(this.object.updateMatrixWorld(),null===this.object.parent?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this.parentPosition,this.parentQuaternion,this.parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this.worldScale),this.parentQuaternionInv.copy(this.parentQuaternion).invert(),this.worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this.cameraScale),this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld()}),c0(this,"pointerHover",e=>{if(void 0===this.object||!0===this.dragging)return;this.raycaster.setFromCamera(e,this.camera);let t=this.intersectObjectWithRay(this.gizmo.picker[this.mode],this.raycaster);t?this.axis=t.object.name:this.axis=null}),c0(this,"pointerDown",e=>{if(void 0!==this.object&&!0!==this.dragging&&0===e.button&&null!==this.axis){this.raycaster.setFromCamera(e,this.camera);let t=this.intersectObjectWithRay(this.plane,this.raycaster,!0);if(t){let e=this.space;if("scale"===this.mode?e="local":("E"===this.axis||"XYZE"===this.axis||"XYZ"===this.axis)&&(e="world"),"local"===e&&"rotate"===this.mode){let e=this.rotationSnap;"X"===this.axis&&e&&(this.object.rotation.x=Math.round(this.object.rotation.x/e)*e),"Y"===this.axis&&e&&(this.object.rotation.y=Math.round(this.object.rotation.y/e)*e),"Z"===this.axis&&e&&(this.object.rotation.z=Math.round(this.object.rotation.z/e)*e)}this.object.updateMatrixWorld(),this.object.parent&&this.object.parent.updateMatrixWorld(),this.positionStart.copy(this.object.position),this.quaternionStart.copy(this.object.quaternion),this.scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this.worldScaleStart),this.pointStart.copy(t.point).sub(this.worldPositionStart)}this.dragging=!0,this.mouseDownEvent.mode=this.mode,this.dispatchEvent(this.mouseDownEvent)}}),c0(this,"pointerMove",e=>{let t=this.axis,r=this.mode,n=this.object,i=this.space;if("scale"===r?i="local":("E"===t||"XYZE"===t||"XYZ"===t)&&(i="world"),void 0===n||null===t||!1===this.dragging||-1!==e.button)return;this.raycaster.setFromCamera(e,this.camera);let a=this.intersectObjectWithRay(this.plane,this.raycaster,!0);if(a){if(this.pointEnd.copy(a.point).sub(this.worldPositionStart),"translate"===r)this.offset.copy(this.pointEnd).sub(this.pointStart),"local"===i&&"XYZ"!==t&&this.offset.applyQuaternion(this.worldQuaternionInv),-1===t.indexOf("X")&&(this.offset.x=0),-1===t.indexOf("Y")&&(this.offset.y=0),-1===t.indexOf("Z")&&(this.offset.z=0),"local"===i&&"XYZ"!==t?this.offset.applyQuaternion(this.quaternionStart).divide(this.parentScale):this.offset.applyQuaternion(this.parentQuaternionInv).divide(this.parentScale),n.position.copy(this.offset).add(this.positionStart),this.translationSnap&&("local"===i&&(n.position.applyQuaternion(this.tempQuaternion.copy(this.quaternionStart).invert()),-1!==t.search("X")&&(n.position.x=Math.round(n.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(n.position.y=Math.round(n.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(n.position.z=Math.round(n.position.z/this.translationSnap)*this.translationSnap),n.position.applyQuaternion(this.quaternionStart)),"world"===i&&(n.parent&&n.position.add(this.tempVector.setFromMatrixPosition(n.parent.matrixWorld)),-1!==t.search("X")&&(n.position.x=Math.round(n.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(n.position.y=Math.round(n.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(n.position.z=Math.round(n.position.z/this.translationSnap)*this.translationSnap),n.parent&&n.position.sub(this.tempVector.setFromMatrixPosition(n.parent.matrixWorld))));else if("scale"===r){if(-1!==t.search("XYZ")){let e=this.pointEnd.length()/this.pointStart.length();0>this.pointEnd.dot(this.pointStart)&&(e*=-1),this.tempVector2.set(e,e,e)}else this.tempVector.copy(this.pointStart),this.tempVector2.copy(this.pointEnd),this.tempVector.applyQuaternion(this.worldQuaternionInv),this.tempVector2.applyQuaternion(this.worldQuaternionInv),this.tempVector2.divide(this.tempVector),-1===t.search("X")&&(this.tempVector2.x=1),-1===t.search("Y")&&(this.tempVector2.y=1),-1===t.search("Z")&&(this.tempVector2.z=1);n.scale.copy(this.scaleStart).multiply(this.tempVector2),this.scaleSnap&&this.object&&(-1!==t.search("X")&&(this.object.scale.x=Math.round(n.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Y")&&(n.scale.y=Math.round(n.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Z")&&(n.scale.z=Math.round(n.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if("rotate"===r){this.offset.copy(this.pointEnd).sub(this.pointStart);let e=20/this.worldPosition.distanceTo(this.tempVector.setFromMatrixPosition(this.camera.matrixWorld));"E"===t?(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this.startNorm.copy(this.pointStart).normalize(),this.endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=0>this.endNorm.cross(this.startNorm).dot(this.eye)?1:-1):"XYZE"===t?(this.rotationAxis.copy(this.offset).cross(this.eye).normalize(),this.rotationAngle=this.offset.dot(this.tempVector.copy(this.rotationAxis).cross(this.eye))*e):("X"===t||"Y"===t||"Z"===t)&&(this.rotationAxis.copy(this.unit[t]),this.tempVector.copy(this.unit[t]),"local"===i&&this.tempVector.applyQuaternion(this.worldQuaternion),this.rotationAngle=this.offset.dot(this.tempVector.cross(this.eye).normalize())*e),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),"local"===i&&"E"!==t&&"XYZE"!==t?(n.quaternion.copy(this.quaternionStart),n.quaternion.multiply(this.tempQuaternion.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this.parentQuaternionInv),n.quaternion.copy(this.tempQuaternion.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),n.quaternion.multiply(this.quaternionStart).normalize())}this.dispatchEvent(this.changeEvent),this.dispatchEvent(this.objectChangeEvent)}}),c0(this,"pointerUp",e=>{0===e.button&&(this.dragging&&null!==this.axis&&(this.mouseUpEvent.mode=this.mode,this.dispatchEvent(this.mouseUpEvent)),this.dragging=!1,this.axis=null)}),c0(this,"getPointer",e=>{var t;if(this.domElement&&(null==(t=this.domElement.ownerDocument)?void 0:t.pointerLockElement))return{x:0,y:0,button:e.button};{let t=e.changedTouches?e.changedTouches[0]:e,r=this.domElement.getBoundingClientRect();return{x:(t.clientX-r.left)/r.width*2-1,y:-(t.clientY-r.top)/r.height*2+1,button:e.button}}}),c0(this,"onPointerHover",e=>{if(this.enabled)switch(e.pointerType){case"mouse":case"pen":this.pointerHover(this.getPointer(e))}}),c0(this,"onPointerDown",e=>{this.enabled&&this.domElement&&(this.domElement.style.touchAction="none",this.domElement.ownerDocument.addEventListener("pointermove",this.onPointerMove),this.pointerHover(this.getPointer(e)),this.pointerDown(this.getPointer(e)))}),c0(this,"onPointerMove",e=>{this.enabled&&this.pointerMove(this.getPointer(e))}),c0(this,"onPointerUp",e=>{this.enabled&&this.domElement&&(this.domElement.style.touchAction="",this.domElement.ownerDocument.removeEventListener("pointermove",this.onPointerMove),this.pointerUp(this.getPointer(e)))}),c0(this,"getMode",()=>this.mode),c0(this,"setMode",e=>{this.mode=e}),c0(this,"setTranslationSnap",e=>{this.translationSnap=e}),c0(this,"setRotationSnap",e=>{this.rotationSnap=e}),c0(this,"setScaleSnap",e=>{this.scaleSnap=e}),c0(this,"setSize",e=>{this.size=e}),c0(this,"setSpace",e=>{this.space=e}),c0(this,"update",()=>{console.warn("THREE.TransformControls: update function has no more functionality and therefore has been deprecated.")}),c0(this,"connect",e=>{e===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.domElement=e,this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("pointermove",this.onPointerHover),this.domElement.ownerDocument.addEventListener("pointerup",this.onPointerUp)}),c0(this,"dispose",()=>{var e,t,r,n,i,a;null==(e=this.domElement)||e.removeEventListener("pointerdown",this.onPointerDown),null==(t=this.domElement)||t.removeEventListener("pointermove",this.onPointerHover),null==(n=null==(r=this.domElement)?void 0:r.ownerDocument)||n.removeEventListener("pointermove",this.onPointerMove),null==(a=null==(i=this.domElement)?void 0:i.ownerDocument)||a.removeEventListener("pointerup",this.onPointerUp),this.traverse(e=>{e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()})}),this.domElement=t,this.camera=e,this.gizmo=new c2,this.add(this.gizmo),this.plane=new c3,this.add(this.plane);let r=(e,t)=>{let r=t;Object.defineProperty(this,e,{get:function(){return void 0!==r?r:t},set:function(t){r!==t&&(r=t,this.plane[e]=t,this.gizmo[e]=t,this.dispatchEvent({type:e+"-changed",value:t}),this.dispatchEvent(this.changeEvent))}}),this[e]=t,this.plane[e]=t,this.gizmo[e]=t};r("camera",this.camera),r("object",this.object),r("enabled",this.enabled),r("axis",this.axis),r("mode",this.mode),r("translationSnap",this.translationSnap),r("rotationSnap",this.rotationSnap),r("scaleSnap",this.scaleSnap),r("space",this.space),r("size",this.size),r("dragging",this.dragging),r("showX",this.showX),r("showY",this.showY),r("showZ",this.showZ),r("worldPosition",this.worldPosition),r("worldPositionStart",this.worldPositionStart),r("worldQuaternion",this.worldQuaternion),r("worldQuaternionStart",this.worldQuaternionStart),r("cameraPosition",this.cameraPosition),r("cameraQuaternion",this.cameraQuaternion),r("pointStart",this.pointStart),r("pointEnd",this.pointEnd),r("rotationAxis",this.rotationAxis),r("rotationAngle",this.rotationAngle),r("eye",this.eye),void 0!==t&&this.connect(t)}}class c2 extends eQ.Object3D{constructor(){super(),c0(this,"isTransformControlsGizmo",!0),c0(this,"type","TransformControlsGizmo"),c0(this,"tempVector",new eQ.Vector3(0,0,0)),c0(this,"tempEuler",new eQ.Euler),c0(this,"alignVector",new eQ.Vector3(0,1,0)),c0(this,"zeroVector",new eQ.Vector3(0,0,0)),c0(this,"lookAtMatrix",new eQ.Matrix4),c0(this,"tempQuaternion",new eQ.Quaternion),c0(this,"tempQuaternion2",new eQ.Quaternion),c0(this,"identityQuaternion",new eQ.Quaternion),c0(this,"unitX",new eQ.Vector3(1,0,0)),c0(this,"unitY",new eQ.Vector3(0,1,0)),c0(this,"unitZ",new eQ.Vector3(0,0,1)),c0(this,"gizmo"),c0(this,"picker"),c0(this,"helper"),c0(this,"rotationAxis",new eQ.Vector3),c0(this,"cameraPosition",new eQ.Vector3),c0(this,"worldPositionStart",new eQ.Vector3),c0(this,"worldQuaternionStart",new eQ.Quaternion),c0(this,"worldPosition",new eQ.Vector3),c0(this,"worldQuaternion",new eQ.Quaternion),c0(this,"eye",new eQ.Vector3),c0(this,"camera",null),c0(this,"enabled",!0),c0(this,"axis",null),c0(this,"mode","translate"),c0(this,"space","world"),c0(this,"size",1),c0(this,"dragging",!1),c0(this,"showX",!0),c0(this,"showY",!0),c0(this,"showZ",!0),c0(this,"updateMatrixWorld",()=>{let e=this.space;"scale"===this.mode&&(e="local");let t="local"===e?this.worldQuaternion:this.identityQuaternion;this.gizmo.translate.visible="translate"===this.mode,this.gizmo.rotate.visible="rotate"===this.mode,this.gizmo.scale.visible="scale"===this.mode,this.helper.translate.visible="translate"===this.mode,this.helper.rotate.visible="rotate"===this.mode,this.helper.scale.visible="scale"===this.mode;let r=[];r=(r=(r=r.concat(this.picker[this.mode].children)).concat(this.gizmo[this.mode].children)).concat(this.helper[this.mode].children);for(let e=0;e<r.length;e++){let n;let i=r[e];if(i.visible=!0,i.rotation.set(0,0,0),i.position.copy(this.worldPosition),n=this.camera.isOrthographicCamera?(this.camera.top-this.camera.bottom)/this.camera.zoom:this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),i.scale.set(1,1,1).multiplyScalar(n*this.size/7),"helper"===i.tag){i.visible=!1,"AXIS"===i.name?(i.position.copy(this.worldPositionStart),i.visible=!!this.axis,"X"===this.axis&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,0,0)),i.quaternion.copy(t).multiply(this.tempQuaternion),Math.abs(this.alignVector.copy(this.unitX).applyQuaternion(t).dot(this.eye))>.9&&(i.visible=!1)),"Y"===this.axis&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,0,Math.PI/2)),i.quaternion.copy(t).multiply(this.tempQuaternion),Math.abs(this.alignVector.copy(this.unitY).applyQuaternion(t).dot(this.eye))>.9&&(i.visible=!1)),"Z"===this.axis&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,Math.PI/2,0)),i.quaternion.copy(t).multiply(this.tempQuaternion),Math.abs(this.alignVector.copy(this.unitZ).applyQuaternion(t).dot(this.eye))>.9&&(i.visible=!1)),"XYZE"===this.axis&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,Math.PI/2,0)),this.alignVector.copy(this.rotationAxis),i.quaternion.setFromRotationMatrix(this.lookAtMatrix.lookAt(this.zeroVector,this.alignVector,this.unitY)),i.quaternion.multiply(this.tempQuaternion),i.visible=this.dragging),"E"===this.axis&&(i.visible=!1)):"START"===i.name?(i.position.copy(this.worldPositionStart),i.visible=this.dragging):"END"===i.name?(i.position.copy(this.worldPosition),i.visible=this.dragging):"DELTA"===i.name?(i.position.copy(this.worldPositionStart),i.quaternion.copy(this.worldQuaternionStart),this.tempVector.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),this.tempVector.applyQuaternion(this.worldQuaternionStart.clone().invert()),i.scale.copy(this.tempVector),i.visible=this.dragging):(i.quaternion.copy(t),this.dragging?i.position.copy(this.worldPositionStart):i.position.copy(this.worldPosition),this.axis&&(i.visible=-1!==this.axis.search(i.name)));continue}i.quaternion.copy(t),"translate"===this.mode||"scale"===this.mode?(("X"===i.name||"XYZX"===i.name)&&Math.abs(this.alignVector.copy(this.unitX).applyQuaternion(t).dot(this.eye))>.99&&(i.scale.set(1e-10,1e-10,1e-10),i.visible=!1),("Y"===i.name||"XYZY"===i.name)&&Math.abs(this.alignVector.copy(this.unitY).applyQuaternion(t).dot(this.eye))>.99&&(i.scale.set(1e-10,1e-10,1e-10),i.visible=!1),("Z"===i.name||"XYZZ"===i.name)&&Math.abs(this.alignVector.copy(this.unitZ).applyQuaternion(t).dot(this.eye))>.99&&(i.scale.set(1e-10,1e-10,1e-10),i.visible=!1),"XY"===i.name&&.2>Math.abs(this.alignVector.copy(this.unitZ).applyQuaternion(t).dot(this.eye))&&(i.scale.set(1e-10,1e-10,1e-10),i.visible=!1),"YZ"===i.name&&.2>Math.abs(this.alignVector.copy(this.unitX).applyQuaternion(t).dot(this.eye))&&(i.scale.set(1e-10,1e-10,1e-10),i.visible=!1),"XZ"===i.name&&.2>Math.abs(this.alignVector.copy(this.unitY).applyQuaternion(t).dot(this.eye))&&(i.scale.set(1e-10,1e-10,1e-10),i.visible=!1),-1!==i.name.search("X")&&(0>this.alignVector.copy(this.unitX).applyQuaternion(t).dot(this.eye)?"fwd"===i.tag?i.visible=!1:i.scale.x*=-1:"bwd"===i.tag&&(i.visible=!1)),-1!==i.name.search("Y")&&(0>this.alignVector.copy(this.unitY).applyQuaternion(t).dot(this.eye)?"fwd"===i.tag?i.visible=!1:i.scale.y*=-1:"bwd"===i.tag&&(i.visible=!1)),-1!==i.name.search("Z")&&(0>this.alignVector.copy(this.unitZ).applyQuaternion(t).dot(this.eye)?"fwd"===i.tag?i.visible=!1:i.scale.z*=-1:"bwd"===i.tag&&(i.visible=!1))):"rotate"===this.mode&&(this.tempQuaternion2.copy(t),this.alignVector.copy(this.eye).applyQuaternion(this.tempQuaternion.copy(t).invert()),-1!==i.name.search("E")&&i.quaternion.setFromRotationMatrix(this.lookAtMatrix.lookAt(this.eye,this.zeroVector,this.unitY)),"X"===i.name&&(this.tempQuaternion.setFromAxisAngle(this.unitX,Math.atan2(-this.alignVector.y,this.alignVector.z)),this.tempQuaternion.multiplyQuaternions(this.tempQuaternion2,this.tempQuaternion),i.quaternion.copy(this.tempQuaternion)),"Y"===i.name&&(this.tempQuaternion.setFromAxisAngle(this.unitY,Math.atan2(this.alignVector.x,this.alignVector.z)),this.tempQuaternion.multiplyQuaternions(this.tempQuaternion2,this.tempQuaternion),i.quaternion.copy(this.tempQuaternion)),"Z"===i.name&&(this.tempQuaternion.setFromAxisAngle(this.unitZ,Math.atan2(this.alignVector.y,this.alignVector.x)),this.tempQuaternion.multiplyQuaternions(this.tempQuaternion2,this.tempQuaternion),i.quaternion.copy(this.tempQuaternion))),i.visible=i.visible&&(-1===i.name.indexOf("X")||this.showX),i.visible=i.visible&&(-1===i.name.indexOf("Y")||this.showY),i.visible=i.visible&&(-1===i.name.indexOf("Z")||this.showZ),i.visible=i.visible&&(-1===i.name.indexOf("E")||this.showX&&this.showY&&this.showZ),i.material.tempOpacity=i.material.tempOpacity||i.material.opacity,i.material.tempColor=i.material.tempColor||i.material.color.clone(),i.material.color.copy(i.material.tempColor),i.material.opacity=i.material.tempOpacity,this.enabled?this.axis&&(i.name===this.axis?i.material.opacity=1:this.axis.split("").some(function(e){return i.name===e})?i.material.opacity=1:i.material.opacity*=.25,i.material.color.lerp(new eQ.Color(1,1,1),.5)):(i.material.opacity*=.5,i.material.color.lerp(new eQ.Color(1,1,1),.5))}super.updateMatrixWorld()});let e=new eQ.MeshBasicMaterial({depthTest:!1,depthWrite:!1,transparent:!0,side:eQ.DoubleSide,fog:!1,toneMapped:!1}),t=new eQ.LineBasicMaterial({depthTest:!1,depthWrite:!1,transparent:!0,linewidth:1,fog:!1,toneMapped:!1}),r=e.clone();r.opacity=.15;let n=e.clone();n.opacity=.33;let i=e.clone();i.color.set(16711680);let a=e.clone();a.color.set(65280);let o=e.clone();o.color.set(255);let s=e.clone();s.opacity=.25;let l=s.clone();l.color.set(16776960);let c=s.clone();c.color.set(65535);let u=s.clone();u.color.set(16711935),e.clone().color.set(16776960);let h=t.clone();h.color.set(16711680);let d=t.clone();d.color.set(65280);let f=t.clone();f.color.set(255);let p=t.clone();p.color.set(65535);let m=t.clone();m.color.set(16711935);let A=t.clone();A.color.set(16776960);let g=t.clone();g.color.set(7895160);let v=A.clone();v.opacity=.25;let y=new eQ.CylinderGeometry(0,.05,.2,12,1,!1),x=new eQ.BoxGeometry(.125,.125,.125),E=new eQ.BufferGeometry;E.setAttribute("position",new eQ.Float32BufferAttribute([0,0,0,1,0,0],3));let _=(e,t)=>{let r=new eQ.BufferGeometry,n=[];for(let r=0;r<=64*t;++r)n.push(0,Math.cos(r/32*Math.PI)*e,Math.sin(r/32*Math.PI)*e);return r.setAttribute("position",new eQ.Float32BufferAttribute(n,3)),r},C={X:[[new eQ.Mesh(y,i),[1,0,0],[0,0,-Math.PI/2],null,"fwd"],[new eQ.Mesh(y,i),[1,0,0],[0,0,Math.PI/2],null,"bwd"],[new eQ.Line(E,h)]],Y:[[new eQ.Mesh(y,a),[0,1,0],null,null,"fwd"],[new eQ.Mesh(y,a),[0,1,0],[Math.PI,0,0],null,"bwd"],[new eQ.Line(E,d),null,[0,0,Math.PI/2]]],Z:[[new eQ.Mesh(y,o),[0,0,1],[Math.PI/2,0,0],null,"fwd"],[new eQ.Mesh(y,o),[0,0,1],[-Math.PI/2,0,0],null,"bwd"],[new eQ.Line(E,f),null,[0,-Math.PI/2,0]]],XYZ:[[new eQ.Mesh(new eQ.OctahedronGeometry(.1,0),s.clone()),[0,0,0],[0,0,0]]],XY:[[new eQ.Mesh(new eQ.PlaneGeometry(.295,.295),l.clone()),[.15,.15,0]],[new eQ.Line(E,A),[.18,.3,0],null,[.125,1,1]],[new eQ.Line(E,A),[.3,.18,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new eQ.Mesh(new eQ.PlaneGeometry(.295,.295),c.clone()),[0,.15,.15],[0,Math.PI/2,0]],[new eQ.Line(E,p),[0,.18,.3],[0,0,Math.PI/2],[.125,1,1]],[new eQ.Line(E,p),[0,.3,.18],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new eQ.Mesh(new eQ.PlaneGeometry(.295,.295),u.clone()),[.15,0,.15],[-Math.PI/2,0,0]],[new eQ.Line(E,m),[.18,0,.3],null,[.125,1,1]],[new eQ.Line(E,m),[.3,0,.18],[0,-Math.PI/2,0],[.125,1,1]]]},b={X:[[new eQ.Mesh(new eQ.CylinderGeometry(.2,0,1,4,1,!1),r),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new eQ.Mesh(new eQ.CylinderGeometry(.2,0,1,4,1,!1),r),[0,.6,0]]],Z:[[new eQ.Mesh(new eQ.CylinderGeometry(.2,0,1,4,1,!1),r),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new eQ.Mesh(new eQ.OctahedronGeometry(.2,0),r)]],XY:[[new eQ.Mesh(new eQ.PlaneGeometry(.4,.4),r),[.2,.2,0]]],YZ:[[new eQ.Mesh(new eQ.PlaneGeometry(.4,.4),r),[0,.2,.2],[0,Math.PI/2,0]]],XZ:[[new eQ.Mesh(new eQ.PlaneGeometry(.4,.4),r),[.2,0,.2],[-Math.PI/2,0,0]]]},w={START:[[new eQ.Mesh(new eQ.OctahedronGeometry(.01,2),n),null,null,null,"helper"]],END:[[new eQ.Mesh(new eQ.OctahedronGeometry(.01,2),n),null,null,null,"helper"]],DELTA:[[new eQ.Line((()=>{let e=new eQ.BufferGeometry;return e.setAttribute("position",new eQ.Float32BufferAttribute([0,0,0,1,1,1],3)),e})(),n),null,null,null,"helper"]],X:[[new eQ.Line(E,n.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new eQ.Line(E,n.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new eQ.Line(E,n.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},B={X:[[new eQ.Line(_(1,.5),h)],[new eQ.Mesh(new eQ.OctahedronGeometry(.04,0),i),[0,0,.99],null,[1,3,1]]],Y:[[new eQ.Line(_(1,.5),d),null,[0,0,-Math.PI/2]],[new eQ.Mesh(new eQ.OctahedronGeometry(.04,0),a),[0,0,.99],null,[3,1,1]]],Z:[[new eQ.Line(_(1,.5),f),null,[0,Math.PI/2,0]],[new eQ.Mesh(new eQ.OctahedronGeometry(.04,0),o),[.99,0,0],null,[1,3,1]]],E:[[new eQ.Line(_(1.25,1),v),null,[0,Math.PI/2,0]],[new eQ.Mesh(new eQ.CylinderGeometry(.03,0,.15,4,1,!1),v),[1.17,0,0],[0,0,-Math.PI/2],[1,1,.001]],[new eQ.Mesh(new eQ.CylinderGeometry(.03,0,.15,4,1,!1),v),[-1.17,0,0],[0,0,Math.PI/2],[1,1,.001]],[new eQ.Mesh(new eQ.CylinderGeometry(.03,0,.15,4,1,!1),v),[0,-1.17,0],[Math.PI,0,0],[1,1,.001]],[new eQ.Mesh(new eQ.CylinderGeometry(.03,0,.15,4,1,!1),v),[0,1.17,0],[0,0,0],[1,1,.001]]],XYZE:[[new eQ.Line(_(1,1),g),null,[0,Math.PI/2,0]]]},I={AXIS:[[new eQ.Line(E,n.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},M={X:[[new eQ.Mesh(new eQ.TorusGeometry(1,.1,4,24),r),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new eQ.Mesh(new eQ.TorusGeometry(1,.1,4,24),r),[0,0,0],[Math.PI/2,0,0]]],Z:[[new eQ.Mesh(new eQ.TorusGeometry(1,.1,4,24),r),[0,0,0],[0,0,-Math.PI/2]]],E:[[new eQ.Mesh(new eQ.TorusGeometry(1.25,.1,2,24),r)]],XYZE:[[new eQ.Mesh(new eQ.SphereGeometry(.7,10,8),r)]]},S={X:[[new eQ.Mesh(x,i),[.8,0,0],[0,0,-Math.PI/2]],[new eQ.Line(E,h),null,null,[.8,1,1]]],Y:[[new eQ.Mesh(x,a),[0,.8,0]],[new eQ.Line(E,d),null,[0,0,Math.PI/2],[.8,1,1]]],Z:[[new eQ.Mesh(x,o),[0,0,.8],[Math.PI/2,0,0]],[new eQ.Line(E,f),null,[0,-Math.PI/2,0],[.8,1,1]]],XY:[[new eQ.Mesh(x,l),[.85,.85,0],null,[2,2,.2]],[new eQ.Line(E,A),[.855,.98,0],null,[.125,1,1]],[new eQ.Line(E,A),[.98,.855,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new eQ.Mesh(x,c),[0,.85,.85],null,[.2,2,2]],[new eQ.Line(E,p),[0,.855,.98],[0,0,Math.PI/2],[.125,1,1]],[new eQ.Line(E,p),[0,.98,.855],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new eQ.Mesh(x,u),[.85,0,.85],null,[2,.2,2]],[new eQ.Line(E,m),[.855,0,.98],null,[.125,1,1]],[new eQ.Line(E,m),[.98,0,.855],[0,-Math.PI/2,0],[.125,1,1]]],XYZX:[[new eQ.Mesh(new eQ.BoxGeometry(.125,.125,.125),s.clone()),[1.1,0,0]]],XYZY:[[new eQ.Mesh(new eQ.BoxGeometry(.125,.125,.125),s.clone()),[0,1.1,0]]],XYZZ:[[new eQ.Mesh(new eQ.BoxGeometry(.125,.125,.125),s.clone()),[0,0,1.1]]]},T={X:[[new eQ.Mesh(new eQ.CylinderGeometry(.2,0,.8,4,1,!1),r),[.5,0,0],[0,0,-Math.PI/2]]],Y:[[new eQ.Mesh(new eQ.CylinderGeometry(.2,0,.8,4,1,!1),r),[0,.5,0]]],Z:[[new eQ.Mesh(new eQ.CylinderGeometry(.2,0,.8,4,1,!1),r),[0,0,.5],[Math.PI/2,0,0]]],XY:[[new eQ.Mesh(x,r),[.85,.85,0],null,[3,3,.2]]],YZ:[[new eQ.Mesh(x,r),[0,.85,.85],null,[.2,3,3]]],XZ:[[new eQ.Mesh(x,r),[.85,0,.85],null,[3,.2,3]]],XYZX:[[new eQ.Mesh(new eQ.BoxGeometry(.2,.2,.2),r),[1.1,0,0]]],XYZY:[[new eQ.Mesh(new eQ.BoxGeometry(.2,.2,.2),r),[0,1.1,0]]],XYZZ:[[new eQ.Mesh(new eQ.BoxGeometry(.2,.2,.2),r),[0,0,1.1]]]},P={X:[[new eQ.Line(E,n.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new eQ.Line(E,n.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new eQ.Line(E,n.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},D=e=>{let t=new eQ.Object3D;for(let r in e)for(let n=e[r].length;n--;){let i=e[r][n][0].clone(),a=e[r][n][1],o=e[r][n][2],s=e[r][n][3],l=e[r][n][4];i.name=r,i.tag=l,a&&i.position.set(a[0],a[1],a[2]),o&&i.rotation.set(o[0],o[1],o[2]),s&&i.scale.set(s[0],s[1],s[2]),i.updateMatrix();let c=i.geometry.clone();c.applyMatrix4(i.matrix),i.geometry=c,i.renderOrder=1/0,i.position.set(0,0,0),i.rotation.set(0,0,0),i.scale.set(1,1,1),t.add(i)}return t};this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=D(C)),this.add(this.gizmo.rotate=D(B)),this.add(this.gizmo.scale=D(S)),this.add(this.picker.translate=D(b)),this.add(this.picker.rotate=D(M)),this.add(this.picker.scale=D(T)),this.add(this.helper.translate=D(w)),this.add(this.helper.rotate=D(I)),this.add(this.helper.scale=D(P)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}}class c3 extends eQ.Mesh{constructor(){super(new eQ.PlaneGeometry(1e5,1e5,2,2),new eQ.MeshBasicMaterial({visible:!1,wireframe:!0,side:eQ.DoubleSide,transparent:!0,opacity:.1,toneMapped:!1})),c0(this,"isTransformControlsPlane",!0),c0(this,"type","TransformControlsPlane"),c0(this,"unitX",new eQ.Vector3(1,0,0)),c0(this,"unitY",new eQ.Vector3(0,1,0)),c0(this,"unitZ",new eQ.Vector3(0,0,1)),c0(this,"tempVector",new eQ.Vector3),c0(this,"dirVector",new eQ.Vector3),c0(this,"alignVector",new eQ.Vector3),c0(this,"tempMatrix",new eQ.Matrix4),c0(this,"identityQuaternion",new eQ.Quaternion),c0(this,"cameraQuaternion",new eQ.Quaternion),c0(this,"worldPosition",new eQ.Vector3),c0(this,"worldQuaternion",new eQ.Quaternion),c0(this,"eye",new eQ.Vector3),c0(this,"axis",null),c0(this,"mode","translate"),c0(this,"space","world"),c0(this,"updateMatrixWorld",()=>{let e=this.space;switch(this.position.copy(this.worldPosition),"scale"===this.mode&&(e="local"),this.unitX.set(1,0,0).applyQuaternion("local"===e?this.worldQuaternion:this.identityQuaternion),this.unitY.set(0,1,0).applyQuaternion("local"===e?this.worldQuaternion:this.identityQuaternion),this.unitZ.set(0,0,1).applyQuaternion("local"===e?this.worldQuaternion:this.identityQuaternion),this.alignVector.copy(this.unitY),this.mode){case"translate":case"scale":switch(this.axis){case"X":this.alignVector.copy(this.eye).cross(this.unitX),this.dirVector.copy(this.unitX).cross(this.alignVector);break;case"Y":this.alignVector.copy(this.eye).cross(this.unitY),this.dirVector.copy(this.unitY).cross(this.alignVector);break;case"Z":this.alignVector.copy(this.eye).cross(this.unitZ),this.dirVector.copy(this.unitZ).cross(this.alignVector);break;case"XY":this.dirVector.copy(this.unitZ);break;case"YZ":this.dirVector.copy(this.unitX);break;case"XZ":this.alignVector.copy(this.unitZ),this.dirVector.copy(this.unitY);break;case"XYZ":case"E":this.dirVector.set(0,0,0)}break;default:this.dirVector.set(0,0,0)}0===this.dirVector.length()?this.quaternion.copy(this.cameraQuaternion):(this.tempMatrix.lookAt(this.tempVector.set(0,0,0),this.dirVector,this.alignVector),this.quaternion.setFromRotationMatrix(this.tempMatrix)),super.updateMatrixWorld()})}}let c4=ez.forwardRef(({children:e,domElement:t,onChange:r,onMouseDown:n,onMouseUp:i,onObjectChange:a,object:o,makeDefault:s,camera:l,enabled:c,axis:u,mode:h,translationSnap:d,rotationSnap:f,scaleSnap:p,space:m,size:A,showX:g,showY:v,showZ:y,...x},E)=>{let _=(0,eL.A)(e=>e.controls),C=(0,eL.A)(e=>e.gl),b=(0,eL.A)(e=>e.events),w=(0,eL.A)(e=>e.camera),B=(0,eL.A)(e=>e.invalidate),I=(0,eL.A)(e=>e.get),M=(0,eL.A)(e=>e.set),S=l||w,T=t||b.connected||C.domElement,P=ez.useMemo(()=>new c1(S,T),[S,T]),D=ez.useRef(null);ez.useLayoutEffect(()=>(o?P.attach(o instanceof eQ.Object3D?o:o.current):D.current instanceof eQ.Object3D&&P.attach(D.current),()=>void P.detach()),[o,e,P]),ez.useEffect(()=>{if(_){let e=e=>_.enabled=!e.value;return P.addEventListener("dragging-changed",e),()=>P.removeEventListener("dragging-changed",e)}},[P,_]);let R=ez.useRef(),F=ez.useRef(),z=ez.useRef(),O=ez.useRef();return ez.useLayoutEffect(()=>void(R.current=r),[r]),ez.useLayoutEffect(()=>void(F.current=n),[n]),ez.useLayoutEffect(()=>void(z.current=i),[i]),ez.useLayoutEffect(()=>void(O.current=a),[a]),ez.useEffect(()=>{let e=e=>{B(),null==R.current||R.current(e)},t=e=>null==F.current?void 0:F.current(e),r=e=>null==z.current?void 0:z.current(e),n=e=>null==O.current?void 0:O.current(e);return P.addEventListener("change",e),P.addEventListener("mouseDown",t),P.addEventListener("mouseUp",r),P.addEventListener("objectChange",n),()=>{P.removeEventListener("change",e),P.removeEventListener("mouseDown",t),P.removeEventListener("mouseUp",r),P.removeEventListener("objectChange",n)}},[B,P]),ez.useEffect(()=>{if(s){let e=I().controls;return M({controls:P}),()=>M({controls:e})}},[s,P]),ez.createElement(ez.Fragment,null,ez.createElement("primitive",{ref:E,object:P,enabled:c,axis:u,mode:h,translationSnap:d,rotationSnap:f,scaleSnap:p,space:m,size:A,showX:g,showY:v,showZ:y}),ez.createElement("group",ee({ref:D},x),e))});var c5=Object.defineProperty,c6=(e,t,r)=>t in e?c5(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,c8=(e,t,r)=>(c6(e,"symbol"!=typeof t?t+"":t,r),r);let c9=new eQ.Euler(0,0,0,"YXZ"),c7=new eQ.Vector3,ue={type:"change"},ut={type:"lock"},ur={type:"unlock"},un=Math.PI/2;class ui extends eQ.EventDispatcher{constructor(e,t){super(),c8(this,"camera"),c8(this,"domElement"),c8(this,"isLocked"),c8(this,"minPolarAngle"),c8(this,"maxPolarAngle"),c8(this,"pointerSpeed"),c8(this,"onMouseMove",e=>{if(!this.domElement||!1===this.isLocked)return;let t=e.movementX||e.mozMovementX||e.webkitMovementX||0,r=e.movementY||e.mozMovementY||e.webkitMovementY||0;c9.setFromQuaternion(this.camera.quaternion),c9.y-=.002*t*this.pointerSpeed,c9.x-=.002*r*this.pointerSpeed,c9.x=Math.max(un-this.maxPolarAngle,Math.min(un-this.minPolarAngle,c9.x)),this.camera.quaternion.setFromEuler(c9),this.dispatchEvent(ue)}),c8(this,"onPointerlockChange",()=>{this.domElement&&(this.domElement.ownerDocument.pointerLockElement===this.domElement?(this.dispatchEvent(ut),this.isLocked=!0):(this.dispatchEvent(ur),this.isLocked=!1))}),c8(this,"onPointerlockError",()=>{console.error("THREE.PointerLockControls: Unable to use Pointer Lock API")}),c8(this,"connect",e=>{this.domElement=e||this.domElement,this.domElement&&(this.domElement.ownerDocument.addEventListener("mousemove",this.onMouseMove),this.domElement.ownerDocument.addEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.addEventListener("pointerlockerror",this.onPointerlockError))}),c8(this,"disconnect",()=>{this.domElement&&(this.domElement.ownerDocument.removeEventListener("mousemove",this.onMouseMove),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this.onPointerlockError))}),c8(this,"dispose",()=>{this.disconnect()}),c8(this,"getObject",()=>this.camera),c8(this,"direction",new eQ.Vector3(0,0,-1)),c8(this,"getDirection",e=>e.copy(this.direction).applyQuaternion(this.camera.quaternion)),c8(this,"moveForward",e=>{c7.setFromMatrixColumn(this.camera.matrix,0),c7.crossVectors(this.camera.up,c7),this.camera.position.addScaledVector(c7,e)}),c8(this,"moveRight",e=>{c7.setFromMatrixColumn(this.camera.matrix,0),this.camera.position.addScaledVector(c7,e)}),c8(this,"lock",()=>{this.domElement&&this.domElement.requestPointerLock()}),c8(this,"unlock",()=>{this.domElement&&this.domElement.ownerDocument.exitPointerLock()}),this.camera=e,this.domElement=t,this.isLocked=!1,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.pointerSpeed=1,t&&this.connect(t)}}let ua=ez.forwardRef(({domElement:e,selector:t,onChange:r,onLock:n,onUnlock:i,enabled:a=!0,makeDefault:o,...s},l)=>{let{camera:c,...u}=s,h=(0,eL.A)(e=>e.setEvents),d=(0,eL.A)(e=>e.gl),f=(0,eL.A)(e=>e.camera),p=(0,eL.A)(e=>e.invalidate),m=(0,eL.A)(e=>e.events),A=(0,eL.A)(e=>e.get),g=(0,eL.A)(e=>e.set),v=c||f,y=e||m.connected||d.domElement,x=ez.useMemo(()=>new ui(v),[v]);return ez.useEffect(()=>{if(a){x.connect(y);let e=A().events.compute;return h({compute(e,t){let r=t.size.width/2,n=t.size.height/2;t.pointer.set(r/t.size.width*2-1,-(n/t.size.height*2)+1),t.raycaster.setFromCamera(t.pointer,t.camera)}}),()=>{x.disconnect(),h({compute:e})}}},[a,x]),ez.useEffect(()=>{let e=e=>{p(),r&&r(e)};x.addEventListener("change",e),n&&x.addEventListener("lock",n),i&&x.addEventListener("unlock",i);let a=()=>x.lock(),o=t?Array.from(document.querySelectorAll(t)):[document];return o.forEach(e=>e&&e.addEventListener("click",a)),()=>{x.removeEventListener("change",e),n&&x.removeEventListener("lock",n),i&&x.removeEventListener("unlock",i),o.forEach(e=>e?e.removeEventListener("click",a):void 0)}},[r,n,i,t,x,p]),ez.useEffect(()=>{if(o){let e=A().controls;return g({controls:x}),()=>g({controls:e})}},[o,x]),ez.createElement("primitive",ee({ref:l,object:x},u))});var uo=Object.defineProperty,us=(e,t,r)=>t in e?uo(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ul=(e,t,r)=>(us(e,"symbol"!=typeof t?t+"":t,r),r);let uc=new eQ.Vector3;class uu extends eQ.EventDispatcher{constructor(e,t){super(),ul(this,"object"),ul(this,"domElement"),ul(this,"enabled",!0),ul(this,"movementSpeed",1),ul(this,"lookSpeed",.005),ul(this,"lookVertical",!0),ul(this,"autoForward",!1),ul(this,"activeLook",!0),ul(this,"heightSpeed",!1),ul(this,"heightCoef",1),ul(this,"heightMin",0),ul(this,"heightMax",1),ul(this,"constrainVertical",!1),ul(this,"verticalMin",0),ul(this,"verticalMax",Math.PI),ul(this,"mouseDragOn",!1),ul(this,"autoSpeedFactor",0),ul(this,"mouseX",0),ul(this,"mouseY",0),ul(this,"moveForward",!1),ul(this,"moveBackward",!1),ul(this,"moveLeft",!1),ul(this,"moveRight",!1),ul(this,"moveUp",!1),ul(this,"moveDown",!1),ul(this,"viewHalfX",0),ul(this,"viewHalfY",0),ul(this,"lat",0),ul(this,"lon",0),ul(this,"lookDirection",new eQ.Vector3),ul(this,"spherical",new eQ.Spherical),ul(this,"target",new eQ.Vector3),ul(this,"connect",e=>{e.setAttribute("tabindex","-1"),e.style.touchAction="none",e.addEventListener("contextmenu",this.contextmenu),e.addEventListener("mousemove",this.onMouseMove),e.addEventListener("mousedown",this.onMouseDown),e.addEventListener("mouseup",this.onMouseUp),this.domElement=e,window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp),this.handleResize()}),ul(this,"dispose",()=>{var e,t,r,n;null==(e=this.domElement)||e.removeEventListener("contextmenu",this.contextmenu),null==(t=this.domElement)||t.removeEventListener("mousedown",this.onMouseDown),null==(r=this.domElement)||r.removeEventListener("mousemove",this.onMouseMove),null==(n=this.domElement)||n.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp)}),ul(this,"handleResize",()=>{this.domElement&&(this.viewHalfX=this.domElement.offsetWidth/2,this.viewHalfY=this.domElement.offsetHeight/2)}),ul(this,"onMouseDown",e=>{var t;if(null==(t=this.domElement)||t.focus(),this.activeLook)switch(e.button){case 0:this.moveForward=!0;break;case 2:this.moveBackward=!0}this.mouseDragOn=!0}),ul(this,"onMouseUp",e=>{if(this.activeLook)switch(e.button){case 0:this.moveForward=!1;break;case 2:this.moveBackward=!1}this.mouseDragOn=!1}),ul(this,"onMouseMove",e=>{this.domElement&&(this.mouseX=e.pageX-this.domElement.offsetLeft-this.viewHalfX,this.mouseY=e.pageY-this.domElement.offsetTop-this.viewHalfY)}),ul(this,"onKeyDown",e=>{switch(e.code){case"ArrowUp":case"KeyW":this.moveForward=!0;break;case"ArrowLeft":case"KeyA":this.moveLeft=!0;break;case"ArrowDown":case"KeyS":this.moveBackward=!0;break;case"ArrowRight":case"KeyD":this.moveRight=!0;break;case"KeyR":this.moveUp=!0;break;case"KeyF":this.moveDown=!0}}),ul(this,"onKeyUp",e=>{switch(e.code){case"ArrowUp":case"KeyW":this.moveForward=!1;break;case"ArrowLeft":case"KeyA":this.moveLeft=!1;break;case"ArrowDown":case"KeyS":this.moveBackward=!1;break;case"ArrowRight":case"KeyD":this.moveRight=!1;break;case"KeyR":this.moveUp=!1;break;case"KeyF":this.moveDown=!1}}),ul(this,"lookAt",(e,t,r)=>(e instanceof eQ.Vector3?this.target.copy(e):t&&r&&this.target.set(e,t,r),this.object.lookAt(this.target),this.setOrientation(),this)),ul(this,"update",e=>{if(!this.enabled)return;if(this.heightSpeed){let t=eQ.MathUtils.clamp(this.object.position.y,this.heightMin,this.heightMax)-this.heightMin;this.autoSpeedFactor=t*this.heightCoef*e}else this.autoSpeedFactor=0;let t=e*this.movementSpeed;(this.moveForward||this.autoForward&&!this.moveBackward)&&this.object.translateZ(-(t+this.autoSpeedFactor)),this.moveBackward&&this.object.translateZ(t),this.moveLeft&&this.object.translateX(-t),this.moveRight&&this.object.translateX(t),this.moveUp&&this.object.translateY(t),this.moveDown&&this.object.translateY(-t);let r=e*this.lookSpeed;this.activeLook||(r=0);let n=1;this.constrainVertical&&(n=Math.PI/(this.verticalMax-this.verticalMin)),this.lon-=this.mouseX*r,this.lookVertical&&(this.lat-=this.mouseY*r*n),this.lat=Math.max(-85,Math.min(85,this.lat));let i=eQ.MathUtils.degToRad(90-this.lat),a=eQ.MathUtils.degToRad(this.lon);this.constrainVertical&&(i=eQ.MathUtils.mapLinear(i,0,Math.PI,this.verticalMin,this.verticalMax));let o=this.object.position;uc.setFromSphericalCoords(1,i,a).add(o),this.object.lookAt(uc)}),ul(this,"contextmenu",e=>e.preventDefault()),ul(this,"setOrientation",()=>{this.lookDirection.set(0,0,-1).applyQuaternion(this.object.quaternion),this.spherical.setFromVector3(this.lookDirection),this.lat=90-eQ.MathUtils.radToDeg(this.spherical.phi),this.lon=eQ.MathUtils.radToDeg(this.spherical.theta)}),this.object=e,this.domElement=t,this.setOrientation(),t&&this.connect(t)}}let uh=ez.forwardRef(({domElement:e,makeDefault:t,...r},n)=>{let i=(0,eL.A)(e=>e.camera),a=(0,eL.A)(e=>e.gl),o=(0,eL.A)(e=>e.events),s=(0,eL.A)(e=>e.get),l=(0,eL.A)(e=>e.set),c=e||o.connected||a.domElement,[u]=ez.useState(()=>new uu(i,c));return ez.useEffect(()=>{if(t){let e=s().controls;return l({controls:u}),()=>l({controls:e})}},[t,u]),(0,eL.C)((e,t)=>{u.update(t)},-1),u?ez.createElement("primitive",ee({ref:n,object:u},r)):null}),ud={LEFT:1,RIGHT:2,MIDDLE:4},uf=Object.freeze({NONE:0,ROTATE:1,TRUCK:2,OFFSET:4,DOLLY:8,ZOOM:16,TOUCH_ROTATE:32,TOUCH_TRUCK:64,TOUCH_OFFSET:128,TOUCH_DOLLY:256,TOUCH_ZOOM:512,TOUCH_DOLLY_TRUCK:1024,TOUCH_DOLLY_OFFSET:2048,TOUCH_DOLLY_ROTATE:4096,TOUCH_ZOOM_TRUCK:8192,TOUCH_ZOOM_OFFSET:16384,TOUCH_ZOOM_ROTATE:32768}),up={NONE:0,IN:1,OUT:-1};function um(e){return e.isPerspectiveCamera}function uA(e){return e.isOrthographicCamera}let ug=2*Math.PI,uv=Math.PI/2,uy=Math.PI/180;function ux(e,t,r){return Math.max(t,Math.min(r,e))}function uE(e,t=1e-5){return Math.abs(e)<t}function u_(e,t,r=1e-5){return uE(e-t,r)}function uC(e,t){return Math.round(e/t)*t}function ub(e){return isFinite(e)?e:e<0?-Number.MAX_VALUE:Number.MAX_VALUE}function uw(e){return Math.abs(e)<Number.MAX_VALUE?e:1/0*e}function uB(e,t,r,n,i=1/0,a){let o=2/(n=Math.max(1e-4,n)),s=o*a,l=1/(1+s+.48*s*s+.235*s*s*s),c=e-t,u=t,h=i*n;t=e-(c=ux(c,-h,h));let d=(r.value+o*c)*a;r.value=(r.value-o*d)*l;let f=t+(c+d)*l;return u-e>0==f>u&&(f=u,r.value=(f-u)/a),f}function uI(e,t,r,n,i=1/0,a,o){let s=2/(n=Math.max(1e-4,n)),l=s*a,c=1/(1+l+.48*l*l+.235*l*l*l),u=t.x,h=t.y,d=t.z,f=e.x-u,p=e.y-h,m=e.z-d,A=u,g=h,v=d,y=i*n,x=f*f+p*p+m*m;if(x>y*y){let e=Math.sqrt(x);f=f/e*y,p=p/e*y,m=m/e*y}u=e.x-f,h=e.y-p,d=e.z-m;let E=(r.x+s*f)*a,_=(r.y+s*p)*a,C=(r.z+s*m)*a;r.x=(r.x-s*E)*c,r.y=(r.y-s*_)*c,r.z=(r.z-s*C)*c,o.x=u+(f+E)*c,o.y=h+(p+_)*c,o.z=d+(m+C)*c;let b=A-e.x,w=g-e.y,B=v-e.z;return b*(o.x-A)+w*(o.y-g)+B*(o.z-v)>0&&(o.x=A,o.y=g,o.z=v,r.x=(o.x-A)/a,r.y=(o.y-g)/a,r.z=(o.z-v)/a),o}function uM(e,t){t.set(0,0),e.forEach(e=>{t.x+=e.clientX,t.y+=e.clientY}),t.x/=e.length,t.y/=e.length}function uS(e,t){return!!uA(e)&&(console.warn(`${t} is not supported in OrthographicCamera`),!0)}class uT{constructor(){this._listeners={}}addEventListener(e,t){let r=this._listeners;void 0===r[e]&&(r[e]=[]),-1===r[e].indexOf(t)&&r[e].push(t)}hasEventListener(e,t){let r=this._listeners;return void 0!==r[e]&&-1!==r[e].indexOf(t)}removeEventListener(e,t){let r=this._listeners[e];if(void 0!==r){let e=r.indexOf(t);-1!==e&&r.splice(e,1)}}removeAllEventListeners(e){if(!e){this._listeners={};return}Array.isArray(this._listeners[e])&&(this._listeners[e].length=0)}dispatchEvent(e){let t=this._listeners[e.type];if(void 0!==t){e.target=this;let r=t.slice(0);for(let t=0,n=r.length;t<n;t++)r[t].call(this,e)}}}let uP=1/8,uD=/Mac/.test(null===(eT=null==globalThis?void 0:globalThis.navigator)||void 0===eT?void 0:eT.platform);class uR extends uT{static install(e){f=Object.freeze(new(d=e.THREE).Vector3(0,0,0)),p=Object.freeze(new d.Vector3(0,1,0)),m=Object.freeze(new d.Vector3(0,0,1)),A=new d.Vector2,g=new d.Vector3,v=new d.Vector3,y=new d.Vector3,x=new d.Vector3,E=new d.Vector3,_=new d.Vector3,C=new d.Vector3,b=new d.Vector3,w=new d.Vector3,B=new d.Spherical,I=new d.Spherical,M=new d.Box3,S=new d.Box3,T=new d.Sphere,P=new d.Quaternion,D=new d.Quaternion,R=new d.Matrix4,F=new d.Raycaster}static get ACTION(){return uf}constructor(e,t){super(),this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.minDistance=Number.EPSILON,this.maxDistance=1/0,this.infinityDolly=!1,this.minZoom=.01,this.maxZoom=1/0,this.smoothTime=.25,this.draggingSmoothTime=.125,this.maxSpeed=1/0,this.azimuthRotateSpeed=1,this.polarRotateSpeed=1,this.dollySpeed=1,this.dollyDragInverted=!1,this.truckSpeed=2,this.dollyToCursor=!1,this.dragToOffset=!1,this.verticalDragToForward=!1,this.boundaryFriction=0,this.restThreshold=.01,this.colliderMeshes=[],this.cancel=()=>{},this._enabled=!0,this._state=uf.NONE,this._viewport=null,this._changedDolly=0,this._changedZoom=0,this._hasRested=!0,this._boundaryEnclosesCamera=!1,this._needsUpdate=!0,this._updatedLastTime=!1,this._elementRect=new DOMRect,this._isDragging=!1,this._dragNeedsUpdate=!0,this._activePointers=[],this._lockedPointer=null,this._interactiveArea=new DOMRect(0,0,1,1),this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._isUserControllingOffset=!1,this._isUserControllingZoom=!1,this._lastDollyDirection=up.NONE,this._thetaVelocity={value:0},this._phiVelocity={value:0},this._radiusVelocity={value:0},this._targetVelocity=new d.Vector3,this._focalOffsetVelocity=new d.Vector3,this._zoomVelocity={value:0},this._truckInternal=(e,t,r)=>{let n,i;if(um(this._camera)){let r=g.copy(this._camera.position).sub(this._target),a=this._camera.getEffectiveFOV()*uy,o=r.length()*Math.tan(.5*a);n=this.truckSpeed*e*o/this._elementRect.height,i=this.truckSpeed*t*o/this._elementRect.height}else{if(!uA(this._camera))return;let r=this._camera;n=e*(r.right-r.left)/r.zoom/this._elementRect.width,i=t*(r.top-r.bottom)/r.zoom/this._elementRect.height}this.verticalDragToForward?(r?this.setFocalOffset(this._focalOffsetEnd.x+n,this._focalOffsetEnd.y,this._focalOffsetEnd.z,!0):this.truck(n,0,!0),this.forward(-i,!0)):r?this.setFocalOffset(this._focalOffsetEnd.x+n,this._focalOffsetEnd.y+i,this._focalOffsetEnd.z,!0):this.truck(n,i,!0)},this._rotateInternal=(e,t)=>{let r=ug*this.azimuthRotateSpeed*e/this._elementRect.height,n=ug*this.polarRotateSpeed*t/this._elementRect.height;this.rotate(r,n,!0)},this._dollyInternal=(e,t,r)=>{let n=Math.pow(.95,-e*this.dollySpeed),i=this._sphericalEnd.radius,a=this._sphericalEnd.radius*n,o=ux(a,this.minDistance,this.maxDistance);this.infinityDolly&&this.dollyToCursor?this._dollyToNoClamp(a,!0):(this.infinityDolly&&!this.dollyToCursor&&this.dollyInFixed(o-a,!0),this._dollyToNoClamp(o,!0)),this.dollyToCursor&&(this._changedDolly+=(this.infinityDolly?a:o)-i,this._dollyControlCoord.set(t,r)),this._lastDollyDirection=Math.sign(-e)},this._zoomInternal=(e,t,r)=>{let n=Math.pow(.95,e*this.dollySpeed),i=this._zoom,a=this._zoom*n;this.zoomTo(a,!0),this.dollyToCursor&&(this._changedZoom+=a-i,this._dollyControlCoord.set(t,r))},void 0===d&&console.error("camera-controls: `THREE` is undefined. You must first run `CameraControls.install( { THREE: THREE } )`. Check the docs for further information."),this._camera=e,this._yAxisUpSpace=new d.Quaternion().setFromUnitVectors(this._camera.up,p),this._yAxisUpSpaceInverse=this._yAxisUpSpace.clone().invert(),this._state=uf.NONE,this._target=new d.Vector3,this._targetEnd=this._target.clone(),this._focalOffset=new d.Vector3,this._focalOffsetEnd=this._focalOffset.clone(),this._spherical=new d.Spherical().setFromVector3(g.copy(this._camera.position).applyQuaternion(this._yAxisUpSpace)),this._sphericalEnd=this._spherical.clone(),this._lastDistance=this._spherical.radius,this._zoom=this._camera.zoom,this._zoomEnd=this._zoom,this._lastZoom=this._zoom,this._nearPlaneCorners=[new d.Vector3,new d.Vector3,new d.Vector3,new d.Vector3],this._updateNearPlaneCorners(),this._boundary=new d.Box3(new d.Vector3(-1/0,-1/0,-1/0),new d.Vector3(1/0,1/0,1/0)),this._cameraUp0=this._camera.up.clone(),this._target0=this._target.clone(),this._position0=this._camera.position.clone(),this._zoom0=this._zoom,this._focalOffset0=this._focalOffset.clone(),this._dollyControlCoord=new d.Vector2,this.mouseButtons={left:uf.ROTATE,middle:uf.DOLLY,right:uf.TRUCK,wheel:um(this._camera)?uf.DOLLY:uA(this._camera)?uf.ZOOM:uf.NONE},this.touches={one:uf.TOUCH_ROTATE,two:um(this._camera)?uf.TOUCH_DOLLY_TRUCK:uA(this._camera)?uf.TOUCH_ZOOM_TRUCK:uf.NONE,three:uf.TOUCH_TRUCK};let r=new d.Vector2,n=new d.Vector2,i=new d.Vector2,a=e=>{if(!this._enabled||!this._domElement)return;if(0!==this._interactiveArea.left||0!==this._interactiveArea.top||1!==this._interactiveArea.width||1!==this._interactiveArea.height){let t=this._domElement.getBoundingClientRect(),r=e.clientX/t.width,n=e.clientY/t.height;if(r<this._interactiveArea.left||r>this._interactiveArea.right||n<this._interactiveArea.top||n>this._interactiveArea.bottom)return}let t="mouse"!==e.pointerType?null:(e.buttons&ud.LEFT)===ud.LEFT?ud.LEFT:(e.buttons&ud.MIDDLE)===ud.MIDDLE?ud.MIDDLE:(e.buttons&ud.RIGHT)===ud.RIGHT?ud.RIGHT:null;if(null!==t){let e=this._findPointerByMouseButton(t);e&&this._disposePointer(e)}if((e.buttons&ud.LEFT)===ud.LEFT&&this._lockedPointer)return;let r={pointerId:e.pointerId,clientX:e.clientX,clientY:e.clientY,deltaX:0,deltaY:0,mouseButton:t};this._activePointers.push(r),this._domElement.ownerDocument.removeEventListener("pointermove",o,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",s),this._domElement.ownerDocument.addEventListener("pointermove",o,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",s),this._isDragging=!0,h(e)},o=e=>{e.cancelable&&e.preventDefault();let t=e.pointerId,r=this._lockedPointer||this._findPointerById(t);if(r){if(r.clientX=e.clientX,r.clientY=e.clientY,r.deltaX=e.movementX,r.deltaY=e.movementY,this._state=0,"touch"===e.pointerType)switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else(!this._isDragging&&this._lockedPointer||this._isDragging&&(e.buttons&ud.LEFT)===ud.LEFT)&&(this._state=this._state|this.mouseButtons.left),this._isDragging&&(e.buttons&ud.MIDDLE)===ud.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),this._isDragging&&(e.buttons&ud.RIGHT)===ud.RIGHT&&(this._state=this._state|this.mouseButtons.right);f()}},s=e=>{let t=this._findPointerById(e.pointerId);if(!t||t!==this._lockedPointer){if(t&&this._disposePointer(t),"touch"===e.pointerType)switch(this._activePointers.length){case 0:this._state=uf.NONE;break;case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else this._state=uf.NONE;m()}},l=-1,c=e=>{if(!this._domElement||!this._enabled||this.mouseButtons.wheel===uf.NONE)return;if(0!==this._interactiveArea.left||0!==this._interactiveArea.top||1!==this._interactiveArea.width||1!==this._interactiveArea.height){let t=this._domElement.getBoundingClientRect(),r=e.clientX/t.width,n=e.clientY/t.height;if(r<this._interactiveArea.left||r>this._interactiveArea.right||n<this._interactiveArea.top||n>this._interactiveArea.bottom)return}if(e.preventDefault(),this.dollyToCursor||this.mouseButtons.wheel===uf.ROTATE||this.mouseButtons.wheel===uf.TRUCK){let e=performance.now();l-e<1e3&&this._getClientRect(this._elementRect),l=e}let t=uD?-1:-3,r=1===e.deltaMode?e.deltaY/t:e.deltaY/(10*t),n=this.dollyToCursor?(e.clientX-this._elementRect.x)/this._elementRect.width*2-1:0,i=this.dollyToCursor?-((e.clientY-this._elementRect.y)/this._elementRect.height*2)+1:0;switch(this.mouseButtons.wheel){case uf.ROTATE:this._rotateInternal(e.deltaX,e.deltaY),this._isUserControllingRotate=!0;break;case uf.TRUCK:this._truckInternal(e.deltaX,e.deltaY,!1),this._isUserControllingTruck=!0;break;case uf.OFFSET:this._truckInternal(e.deltaX,e.deltaY,!0),this._isUserControllingOffset=!0;break;case uf.DOLLY:this._dollyInternal(-r,n,i),this._isUserControllingDolly=!0;break;case uf.ZOOM:this._zoomInternal(-r,n,i),this._isUserControllingZoom=!0}this.dispatchEvent({type:"control"})},u=e=>{if(this._domElement&&this._enabled){if(this.mouseButtons.right===uR.ACTION.NONE){let t=e instanceof PointerEvent?e.pointerId:0,r=this._findPointerById(t);r&&this._disposePointer(r),this._domElement.ownerDocument.removeEventListener("pointermove",o,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",s);return}e.preventDefault()}},h=e=>{if(this._enabled){if(uM(this._activePointers,A),this._getClientRect(this._elementRect),r.copy(A),n.copy(A),this._activePointers.length>=2){let e=A.x-this._activePointers[1].clientX,t=A.y-this._activePointers[1].clientY;i.set(0,Math.sqrt(e*e+t*t));let r=(this._activePointers[0].clientX+this._activePointers[1].clientX)*.5,a=(this._activePointers[0].clientY+this._activePointers[1].clientY)*.5;n.set(r,a)}if(this._state=0,e){if("pointerType"in e&&"touch"===e.pointerType)switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else this._lockedPointer||(e.buttons&ud.LEFT)!==ud.LEFT||(this._state=this._state|this.mouseButtons.left),(e.buttons&ud.MIDDLE)===ud.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),(e.buttons&ud.RIGHT)===ud.RIGHT&&(this._state=this._state|this.mouseButtons.right)}else this._lockedPointer&&(this._state=this._state|this.mouseButtons.left);((this._state&uf.ROTATE)===uf.ROTATE||(this._state&uf.TOUCH_ROTATE)===uf.TOUCH_ROTATE||(this._state&uf.TOUCH_DOLLY_ROTATE)===uf.TOUCH_DOLLY_ROTATE||(this._state&uf.TOUCH_ZOOM_ROTATE)===uf.TOUCH_ZOOM_ROTATE)&&(this._sphericalEnd.theta=this._spherical.theta,this._sphericalEnd.phi=this._spherical.phi,this._thetaVelocity.value=0,this._phiVelocity.value=0),((this._state&uf.TRUCK)===uf.TRUCK||(this._state&uf.TOUCH_TRUCK)===uf.TOUCH_TRUCK||(this._state&uf.TOUCH_DOLLY_TRUCK)===uf.TOUCH_DOLLY_TRUCK||(this._state&uf.TOUCH_ZOOM_TRUCK)===uf.TOUCH_ZOOM_TRUCK)&&(this._targetEnd.copy(this._target),this._targetVelocity.set(0,0,0)),((this._state&uf.DOLLY)===uf.DOLLY||(this._state&uf.TOUCH_DOLLY)===uf.TOUCH_DOLLY||(this._state&uf.TOUCH_DOLLY_TRUCK)===uf.TOUCH_DOLLY_TRUCK||(this._state&uf.TOUCH_DOLLY_OFFSET)===uf.TOUCH_DOLLY_OFFSET||(this._state&uf.TOUCH_DOLLY_ROTATE)===uf.TOUCH_DOLLY_ROTATE)&&(this._sphericalEnd.radius=this._spherical.radius,this._radiusVelocity.value=0),((this._state&uf.ZOOM)===uf.ZOOM||(this._state&uf.TOUCH_ZOOM)===uf.TOUCH_ZOOM||(this._state&uf.TOUCH_ZOOM_TRUCK)===uf.TOUCH_ZOOM_TRUCK||(this._state&uf.TOUCH_ZOOM_OFFSET)===uf.TOUCH_ZOOM_OFFSET||(this._state&uf.TOUCH_ZOOM_ROTATE)===uf.TOUCH_ZOOM_ROTATE)&&(this._zoomEnd=this._zoom,this._zoomVelocity.value=0),((this._state&uf.OFFSET)===uf.OFFSET||(this._state&uf.TOUCH_OFFSET)===uf.TOUCH_OFFSET||(this._state&uf.TOUCH_DOLLY_OFFSET)===uf.TOUCH_DOLLY_OFFSET||(this._state&uf.TOUCH_ZOOM_OFFSET)===uf.TOUCH_ZOOM_OFFSET)&&(this._focalOffsetEnd.copy(this._focalOffset),this._focalOffsetVelocity.set(0,0,0)),this.dispatchEvent({type:"controlstart"})}},f=()=>{if(!this._enabled||!this._dragNeedsUpdate)return;this._dragNeedsUpdate=!1,uM(this._activePointers,A);let e=this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement?this._lockedPointer||this._activePointers[0]:null,t=e?-e.deltaX:n.x-A.x,a=e?-e.deltaY:n.y-A.y;if(n.copy(A),((this._state&uf.ROTATE)===uf.ROTATE||(this._state&uf.TOUCH_ROTATE)===uf.TOUCH_ROTATE||(this._state&uf.TOUCH_DOLLY_ROTATE)===uf.TOUCH_DOLLY_ROTATE||(this._state&uf.TOUCH_ZOOM_ROTATE)===uf.TOUCH_ZOOM_ROTATE)&&(this._rotateInternal(t,a),this._isUserControllingRotate=!0),(this._state&uf.DOLLY)===uf.DOLLY||(this._state&uf.ZOOM)===uf.ZOOM){let e=this.dollyToCursor?(r.x-this._elementRect.x)/this._elementRect.width*2-1:0,t=this.dollyToCursor?-((r.y-this._elementRect.y)/this._elementRect.height*2)+1:0,n=this.dollyDragInverted?-1:1;(this._state&uf.DOLLY)===uf.DOLLY?(this._dollyInternal(n*a*uP,e,t),this._isUserControllingDolly=!0):(this._zoomInternal(n*a*uP,e,t),this._isUserControllingZoom=!0)}if((this._state&uf.TOUCH_DOLLY)===uf.TOUCH_DOLLY||(this._state&uf.TOUCH_ZOOM)===uf.TOUCH_ZOOM||(this._state&uf.TOUCH_DOLLY_TRUCK)===uf.TOUCH_DOLLY_TRUCK||(this._state&uf.TOUCH_ZOOM_TRUCK)===uf.TOUCH_ZOOM_TRUCK||(this._state&uf.TOUCH_DOLLY_OFFSET)===uf.TOUCH_DOLLY_OFFSET||(this._state&uf.TOUCH_ZOOM_OFFSET)===uf.TOUCH_ZOOM_OFFSET||(this._state&uf.TOUCH_DOLLY_ROTATE)===uf.TOUCH_DOLLY_ROTATE||(this._state&uf.TOUCH_ZOOM_ROTATE)===uf.TOUCH_ZOOM_ROTATE){let e=A.x-this._activePointers[1].clientX,t=A.y-this._activePointers[1].clientY,r=Math.sqrt(e*e+t*t),a=i.y-r;i.set(0,r);let o=this.dollyToCursor?(n.x-this._elementRect.x)/this._elementRect.width*2-1:0,s=this.dollyToCursor?-((n.y-this._elementRect.y)/this._elementRect.height*2)+1:0;(this._state&uf.TOUCH_DOLLY)===uf.TOUCH_DOLLY||(this._state&uf.TOUCH_DOLLY_ROTATE)===uf.TOUCH_DOLLY_ROTATE||(this._state&uf.TOUCH_DOLLY_TRUCK)===uf.TOUCH_DOLLY_TRUCK||(this._state&uf.TOUCH_DOLLY_OFFSET)===uf.TOUCH_DOLLY_OFFSET?(this._dollyInternal(a*uP,o,s),this._isUserControllingDolly=!0):(this._zoomInternal(a*uP,o,s),this._isUserControllingZoom=!0)}((this._state&uf.TRUCK)===uf.TRUCK||(this._state&uf.TOUCH_TRUCK)===uf.TOUCH_TRUCK||(this._state&uf.TOUCH_DOLLY_TRUCK)===uf.TOUCH_DOLLY_TRUCK||(this._state&uf.TOUCH_ZOOM_TRUCK)===uf.TOUCH_ZOOM_TRUCK)&&(this._truckInternal(t,a,!1),this._isUserControllingTruck=!0),((this._state&uf.OFFSET)===uf.OFFSET||(this._state&uf.TOUCH_OFFSET)===uf.TOUCH_OFFSET||(this._state&uf.TOUCH_DOLLY_OFFSET)===uf.TOUCH_DOLLY_OFFSET||(this._state&uf.TOUCH_ZOOM_OFFSET)===uf.TOUCH_ZOOM_OFFSET)&&(this._truckInternal(t,a,!0),this._isUserControllingOffset=!0),this.dispatchEvent({type:"control"})},m=()=>{uM(this._activePointers,A),n.copy(A),this._dragNeedsUpdate=!1,(0===this._activePointers.length||1===this._activePointers.length&&this._activePointers[0]===this._lockedPointer)&&(this._isDragging=!1),0===this._activePointers.length&&this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointermove",o,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",s),this.dispatchEvent({type:"controlend"}))};this.lockPointer=()=>{this._enabled&&this._domElement&&(this.cancel(),this._lockedPointer={pointerId:-1,clientX:0,clientY:0,deltaX:0,deltaY:0,mouseButton:null},this._activePointers.push(this._lockedPointer),this._domElement.ownerDocument.removeEventListener("pointermove",o,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",s),this._domElement.requestPointerLock(),this._domElement.ownerDocument.addEventListener("pointerlockchange",v),this._domElement.ownerDocument.addEventListener("pointerlockerror",y),this._domElement.ownerDocument.addEventListener("pointermove",o,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",s),h())},this.unlockPointer=()=>{var e,t,r;null!==this._lockedPointer&&(this._disposePointer(this._lockedPointer),this._lockedPointer=null),null===(e=this._domElement)||void 0===e||e.ownerDocument.exitPointerLock(),null===(t=this._domElement)||void 0===t||t.ownerDocument.removeEventListener("pointerlockchange",v),null===(r=this._domElement)||void 0===r||r.ownerDocument.removeEventListener("pointerlockerror",y),this.cancel()};let v=()=>{this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement||this.unlockPointer()},y=()=>{this.unlockPointer()};this._addAllEventListeners=e=>{this._domElement=e,this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none",this._domElement.addEventListener("pointerdown",a),this._domElement.addEventListener("pointercancel",s),this._domElement.addEventListener("wheel",c,{passive:!1}),this._domElement.addEventListener("contextmenu",u)},this._removeAllEventListeners=()=>{this._domElement&&(this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect="",this._domElement.removeEventListener("pointerdown",a),this._domElement.removeEventListener("pointercancel",s),this._domElement.removeEventListener("wheel",c,{passive:!1}),this._domElement.removeEventListener("contextmenu",u),this._domElement.ownerDocument.removeEventListener("pointermove",o,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",s),this._domElement.ownerDocument.removeEventListener("pointerlockchange",v),this._domElement.ownerDocument.removeEventListener("pointerlockerror",y))},this.cancel=()=>{this._state!==uf.NONE&&(this._state=uf.NONE,this._activePointers.length=0,m())},t&&this.connect(t),this.update(0)}get camera(){return this._camera}set camera(e){this._camera=e,this.updateCameraUp(),this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._domElement&&(e?(this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none"):(this.cancel(),this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect=""))}get active(){return!this._hasRested}get currentAction(){return this._state}get distance(){return this._spherical.radius}set distance(e){(this._spherical.radius!==e||this._sphericalEnd.radius!==e)&&(this._spherical.radius=e,this._sphericalEnd.radius=e,this._needsUpdate=!0)}get azimuthAngle(){return this._spherical.theta}set azimuthAngle(e){(this._spherical.theta!==e||this._sphericalEnd.theta!==e)&&(this._spherical.theta=e,this._sphericalEnd.theta=e,this._needsUpdate=!0)}get polarAngle(){return this._spherical.phi}set polarAngle(e){(this._spherical.phi!==e||this._sphericalEnd.phi!==e)&&(this._spherical.phi=e,this._sphericalEnd.phi=e,this._needsUpdate=!0)}get boundaryEnclosesCamera(){return this._boundaryEnclosesCamera}set boundaryEnclosesCamera(e){this._boundaryEnclosesCamera=e,this._needsUpdate=!0}set interactiveArea(e){this._interactiveArea.width=ux(e.width,0,1),this._interactiveArea.height=ux(e.height,0,1),this._interactiveArea.x=ux(e.x,0,1-this._interactiveArea.width),this._interactiveArea.y=ux(e.y,0,1-this._interactiveArea.height)}addEventListener(e,t){super.addEventListener(e,t)}removeEventListener(e,t){super.removeEventListener(e,t)}rotate(e,t,r=!1){return this.rotateTo(this._sphericalEnd.theta+e,this._sphericalEnd.phi+t,r)}rotateAzimuthTo(e,t=!1){return this.rotateTo(e,this._sphericalEnd.phi,t)}rotatePolarTo(e,t=!1){return this.rotateTo(this._sphericalEnd.theta,e,t)}rotateTo(e,t,r=!1){this._isUserControllingRotate=!1;let n=ux(e,this.minAzimuthAngle,this.maxAzimuthAngle),i=ux(t,this.minPolarAngle,this.maxPolarAngle);this._sphericalEnd.theta=n,this._sphericalEnd.phi=i,this._sphericalEnd.makeSafe(),this._needsUpdate=!0,r||(this._spherical.theta=this._sphericalEnd.theta,this._spherical.phi=this._sphericalEnd.phi);let a=!r||u_(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&u_(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold);return this._createOnRestPromise(a)}dolly(e,t=!1){return this.dollyTo(this._sphericalEnd.radius-e,t)}dollyTo(e,t=!1){return this._isUserControllingDolly=!1,this._lastDollyDirection=up.NONE,this._changedDolly=0,this._dollyToNoClamp(ux(e,this.minDistance,this.maxDistance),t)}_dollyToNoClamp(e,t=!1){let r=this._sphericalEnd.radius;if(this.colliderMeshes.length>=1){let t=this._collisionTest(),n=u_(t,this._spherical.radius);if(!(r>e)&&n)return Promise.resolve();this._sphericalEnd.radius=Math.min(e,t)}else this._sphericalEnd.radius=e;this._needsUpdate=!0,t||(this._spherical.radius=this._sphericalEnd.radius);let n=!t||u_(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(n)}dollyInFixed(e,t=!1){this._targetEnd.add(this._getCameraDirection(x).multiplyScalar(e)),t||this._target.copy(this._targetEnd);let r=!t||u_(this._target.x,this._targetEnd.x,this.restThreshold)&&u_(this._target.y,this._targetEnd.y,this.restThreshold)&&u_(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(r)}zoom(e,t=!1){return this.zoomTo(this._zoomEnd+e,t)}zoomTo(e,t=!1){this._isUserControllingZoom=!1,this._zoomEnd=ux(e,this.minZoom,this.maxZoom),this._needsUpdate=!0,t||(this._zoom=this._zoomEnd);let r=!t||u_(this._zoom,this._zoomEnd,this.restThreshold);return this._changedZoom=0,this._createOnRestPromise(r)}pan(e,t,r=!1){return console.warn("`pan` has been renamed to `truck`"),this.truck(e,t,r)}truck(e,t,r=!1){this._camera.updateMatrix(),E.setFromMatrixColumn(this._camera.matrix,0),_.setFromMatrixColumn(this._camera.matrix,1),E.multiplyScalar(e),_.multiplyScalar(-t);let n=g.copy(E).add(_),i=v.copy(this._targetEnd).add(n);return this.moveTo(i.x,i.y,i.z,r)}forward(e,t=!1){g.setFromMatrixColumn(this._camera.matrix,0),g.crossVectors(this._camera.up,g),g.multiplyScalar(e);let r=v.copy(this._targetEnd).add(g);return this.moveTo(r.x,r.y,r.z,t)}elevate(e,t=!1){return g.copy(this._camera.up).multiplyScalar(e),this.moveTo(this._targetEnd.x+g.x,this._targetEnd.y+g.y,this._targetEnd.z+g.z,t)}moveTo(e,t,r,n=!1){this._isUserControllingTruck=!1;let i=g.set(e,t,r).sub(this._targetEnd);this._encloseToBoundary(this._targetEnd,i,this.boundaryFriction),this._needsUpdate=!0,n||this._target.copy(this._targetEnd);let a=!n||u_(this._target.x,this._targetEnd.x,this.restThreshold)&&u_(this._target.y,this._targetEnd.y,this.restThreshold)&&u_(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(a)}lookInDirectionOf(e,t,r,n=!1){let i=g.set(e,t,r).sub(this._targetEnd).normalize().multiplyScalar(-this._sphericalEnd.radius).add(this._targetEnd);return this.setPosition(i.x,i.y,i.z,n)}fitToBox(e,t,{cover:r=!1,paddingLeft:n=0,paddingRight:i=0,paddingBottom:a=0,paddingTop:o=0}={}){let s=[],l=e.isBox3?M.copy(e):M.setFromObject(e);l.isEmpty()&&(console.warn("camera-controls: fitTo() cannot be used with an empty box. Aborting"),Promise.resolve());let c=uC(this._sphericalEnd.theta,uv),u=uC(this._sphericalEnd.phi,uv);s.push(this.rotateTo(c,u,t));let h=g.setFromSpherical(this._sphericalEnd).normalize(),d=P.setFromUnitVectors(h,m),f=u_(Math.abs(h.y),1);f&&d.multiply(D.setFromAxisAngle(p,c)),d.multiply(this._yAxisUpSpaceInverse);let A=S.makeEmpty();v.copy(l.min).applyQuaternion(d),A.expandByPoint(v),v.copy(l.min).setX(l.max.x).applyQuaternion(d),A.expandByPoint(v),v.copy(l.min).setY(l.max.y).applyQuaternion(d),A.expandByPoint(v),v.copy(l.max).setZ(l.min.z).applyQuaternion(d),A.expandByPoint(v),v.copy(l.min).setZ(l.max.z).applyQuaternion(d),A.expandByPoint(v),v.copy(l.max).setY(l.min.y).applyQuaternion(d),A.expandByPoint(v),v.copy(l.max).setX(l.min.x).applyQuaternion(d),A.expandByPoint(v),v.copy(l.max).applyQuaternion(d),A.expandByPoint(v),A.min.x-=n,A.min.y-=a,A.max.x+=i,A.max.y+=o,d.setFromUnitVectors(m,h),f&&d.premultiply(D.invert()),d.premultiply(this._yAxisUpSpace);let y=A.getSize(g),x=A.getCenter(v).applyQuaternion(d);if(um(this._camera)){let e=this.getDistanceToFitBox(y.x,y.y,y.z,r);s.push(this.moveTo(x.x,x.y,x.z,t)),s.push(this.dollyTo(e,t)),s.push(this.setFocalOffset(0,0,0,t))}else if(uA(this._camera)){let e=this._camera,n=e.right-e.left,i=e.top-e.bottom,a=r?Math.max(n/y.x,i/y.y):Math.min(n/y.x,i/y.y);s.push(this.moveTo(x.x,x.y,x.z,t)),s.push(this.zoomTo(a,t)),s.push(this.setFocalOffset(0,0,0,t))}return Promise.all(s)}fitToSphere(e,t){let r=[],n="isObject3D"in e?uR.createBoundingSphere(e,T):T.copy(e);if(r.push(this.moveTo(n.center.x,n.center.y,n.center.z,t)),um(this._camera)){let e=this.getDistanceToFitSphere(n.radius);r.push(this.dollyTo(e,t))}else if(uA(this._camera)){let e=this._camera.right-this._camera.left,i=this._camera.top-this._camera.bottom,a=2*n.radius;r.push(this.zoomTo(Math.min(e/a,i/a),t))}return r.push(this.setFocalOffset(0,0,0,t)),Promise.all(r)}setLookAt(e,t,r,n,i,a,o=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=up.NONE,this._changedDolly=0;let s=v.set(n,i,a),l=g.set(e,t,r);this._targetEnd.copy(s),this._sphericalEnd.setFromVector3(l.sub(s).applyQuaternion(this._yAxisUpSpace)),this.normalizeRotations(),this._needsUpdate=!0,o||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));let c=!o||u_(this._target.x,this._targetEnd.x,this.restThreshold)&&u_(this._target.y,this._targetEnd.y,this.restThreshold)&&u_(this._target.z,this._targetEnd.z,this.restThreshold)&&u_(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&u_(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&u_(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(c)}lerpLookAt(e,t,r,n,i,a,o,s,l,c,u,h,d,f=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=up.NONE,this._changedDolly=0;let p=g.set(n,i,a),m=v.set(e,t,r);B.setFromVector3(m.sub(p).applyQuaternion(this._yAxisUpSpace));let A=y.set(c,u,h),x=v.set(o,s,l);I.setFromVector3(x.sub(A).applyQuaternion(this._yAxisUpSpace)),this._targetEnd.copy(p.lerp(A,d));let E=I.theta-B.theta,_=I.phi-B.phi,C=I.radius-B.radius;this._sphericalEnd.set(B.radius+C*d,B.phi+_*d,B.theta+E*d),this.normalizeRotations(),this._needsUpdate=!0,f||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));let b=!f||u_(this._target.x,this._targetEnd.x,this.restThreshold)&&u_(this._target.y,this._targetEnd.y,this.restThreshold)&&u_(this._target.z,this._targetEnd.z,this.restThreshold)&&u_(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&u_(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&u_(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(b)}setPosition(e,t,r,n=!1){return this.setLookAt(e,t,r,this._targetEnd.x,this._targetEnd.y,this._targetEnd.z,n)}setTarget(e,t,r,n=!1){let i=this.getPosition(g),a=this.setLookAt(i.x,i.y,i.z,e,t,r,n);return this._sphericalEnd.phi=ux(this._sphericalEnd.phi,this.minPolarAngle,this.maxPolarAngle),a}setFocalOffset(e,t,r,n=!1){this._isUserControllingOffset=!1,this._focalOffsetEnd.set(e,t,r),this._needsUpdate=!0,n||this._focalOffset.copy(this._focalOffsetEnd);let i=!n||u_(this._focalOffset.x,this._focalOffsetEnd.x,this.restThreshold)&&u_(this._focalOffset.y,this._focalOffsetEnd.y,this.restThreshold)&&u_(this._focalOffset.z,this._focalOffsetEnd.z,this.restThreshold);return this._createOnRestPromise(i)}setOrbitPoint(e,t,r){this._camera.updateMatrixWorld(),E.setFromMatrixColumn(this._camera.matrixWorldInverse,0),_.setFromMatrixColumn(this._camera.matrixWorldInverse,1),C.setFromMatrixColumn(this._camera.matrixWorldInverse,2);let n=g.set(e,t,r),i=n.distanceTo(this._camera.position),a=n.sub(this._camera.position);E.multiplyScalar(a.x),_.multiplyScalar(a.y),C.multiplyScalar(a.z),g.copy(E).add(_).add(C),g.z=g.z+i,this.dollyTo(i,!1),this.setFocalOffset(-g.x,g.y,-g.z,!1),this.moveTo(e,t,r,!1)}setBoundary(e){if(!e){this._boundary.min.set(-1/0,-1/0,-1/0),this._boundary.max.set(1/0,1/0,1/0),this._needsUpdate=!0;return}this._boundary.copy(e),this._boundary.clampPoint(this._targetEnd,this._targetEnd),this._needsUpdate=!0}setViewport(e,t,r,n){if(null===e){this._viewport=null;return}this._viewport=this._viewport||new d.Vector4,"number"==typeof e?this._viewport.set(e,t,r,n):this._viewport.copy(e)}getDistanceToFitBox(e,t,r,n=!1){if(uS(this._camera,"getDistanceToFitBox"))return this._spherical.radius;let i=e/t,a=this._camera.getEffectiveFOV()*uy,o=this._camera.aspect;return .5*((n?i>o:i<o)?t:e/o)/Math.tan(.5*a)+.5*r}getDistanceToFitSphere(e){if(uS(this._camera,"getDistanceToFitSphere"))return this._spherical.radius;let t=this._camera.getEffectiveFOV()*uy,r=2*Math.atan(Math.tan(.5*t)*this._camera.aspect);return e/Math.sin(.5*(1<this._camera.aspect?t:r))}getTarget(e,t=!0){return(e&&e.isVector3?e:new d.Vector3).copy(t?this._targetEnd:this._target)}getPosition(e,t=!0){return(e&&e.isVector3?e:new d.Vector3).setFromSpherical(t?this._sphericalEnd:this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(t?this._targetEnd:this._target)}getSpherical(e,t=!0){return(e||new d.Spherical).copy(t?this._sphericalEnd:this._spherical)}getFocalOffset(e,t=!0){return(e&&e.isVector3?e:new d.Vector3).copy(t?this._focalOffsetEnd:this._focalOffset)}normalizeRotations(){this._sphericalEnd.theta=this._sphericalEnd.theta%ug,this._sphericalEnd.theta<0&&(this._sphericalEnd.theta+=ug),this._spherical.theta+=ug*Math.round((this._sphericalEnd.theta-this._spherical.theta)/ug)}reset(e=!1){if(!u_(this._camera.up.x,this._cameraUp0.x)||!u_(this._camera.up.y,this._cameraUp0.y)||!u_(this._camera.up.z,this._cameraUp0.z)){this._camera.up.copy(this._cameraUp0);let e=this.getPosition(g);this.updateCameraUp(),this.setPosition(e.x,e.y,e.z)}return Promise.all([this.setLookAt(this._position0.x,this._position0.y,this._position0.z,this._target0.x,this._target0.y,this._target0.z,e),this.setFocalOffset(this._focalOffset0.x,this._focalOffset0.y,this._focalOffset0.z,e),this.zoomTo(this._zoom0,e)])}saveState(){this._cameraUp0.copy(this._camera.up),this.getTarget(this._target0),this.getPosition(this._position0),this._zoom0=this._zoom,this._focalOffset0.copy(this._focalOffset)}updateCameraUp(){this._yAxisUpSpace.setFromUnitVectors(this._camera.up,p),this._yAxisUpSpaceInverse.copy(this._yAxisUpSpace).invert()}applyCameraUp(){let e=g.subVectors(this._target,this._camera.position).normalize(),t=v.crossVectors(e,this._camera.up);this._camera.up.crossVectors(t,e).normalize(),this._camera.updateMatrixWorld();let r=this.getPosition(g);this.updateCameraUp(),this.setPosition(r.x,r.y,r.z)}update(e){let t=this._sphericalEnd.theta-this._spherical.theta,r=this._sphericalEnd.phi-this._spherical.phi,n=this._sphericalEnd.radius-this._spherical.radius,i=b.subVectors(this._targetEnd,this._target),a=w.subVectors(this._focalOffsetEnd,this._focalOffset),o=this._zoomEnd-this._zoom;if(uE(t))this._thetaVelocity.value=0,this._spherical.theta=this._sphericalEnd.theta;else{let t=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.theta=uB(this._spherical.theta,this._sphericalEnd.theta,this._thetaVelocity,t,1/0,e),this._needsUpdate=!0}if(uE(r))this._phiVelocity.value=0,this._spherical.phi=this._sphericalEnd.phi;else{let t=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.phi=uB(this._spherical.phi,this._sphericalEnd.phi,this._phiVelocity,t,1/0,e),this._needsUpdate=!0}if(uE(n))this._radiusVelocity.value=0,this._spherical.radius=this._sphericalEnd.radius;else{let t=this._isUserControllingDolly?this.draggingSmoothTime:this.smoothTime;this._spherical.radius=uB(this._spherical.radius,this._sphericalEnd.radius,this._radiusVelocity,t,this.maxSpeed,e),this._needsUpdate=!0}if(uE(i.x)&&uE(i.y)&&uE(i.z))this._targetVelocity.set(0,0,0),this._target.copy(this._targetEnd);else{let t=this._isUserControllingTruck?this.draggingSmoothTime:this.smoothTime;uI(this._target,this._targetEnd,this._targetVelocity,t,this.maxSpeed,e,this._target),this._needsUpdate=!0}if(uE(a.x)&&uE(a.y)&&uE(a.z))this._focalOffsetVelocity.set(0,0,0),this._focalOffset.copy(this._focalOffsetEnd);else{let t=this._isUserControllingOffset?this.draggingSmoothTime:this.smoothTime;uI(this._focalOffset,this._focalOffsetEnd,this._focalOffsetVelocity,t,this.maxSpeed,e,this._focalOffset),this._needsUpdate=!0}if(uE(o))this._zoomVelocity.value=0,this._zoom=this._zoomEnd;else{let t=this._isUserControllingZoom?this.draggingSmoothTime:this.smoothTime;this._zoom=uB(this._zoom,this._zoomEnd,this._zoomVelocity,t,1/0,e)}if(this.dollyToCursor){if(um(this._camera)&&0!==this._changedDolly){let e=this._spherical.radius-this._lastDistance,t=this._camera,r=this._getCameraDirection(x),n=g.copy(r).cross(t.up).normalize();0===n.lengthSq()&&(n.x=1);let i=v.crossVectors(n,r),a=this._sphericalEnd.radius*Math.tan(t.getEffectiveFOV()*uy*.5),o=(this._sphericalEnd.radius-e-this._sphericalEnd.radius)/this._sphericalEnd.radius,s=y.copy(this._targetEnd).add(n.multiplyScalar(this._dollyControlCoord.x*a*t.aspect)).add(i.multiplyScalar(this._dollyControlCoord.y*a)),l=g.copy(this._targetEnd).lerp(s,o),c=this._lastDollyDirection===up.IN&&this._spherical.radius<=this.minDistance,u=this._lastDollyDirection===up.OUT&&this.maxDistance<=this._spherical.radius;if(this.infinityDolly&&(c||u)){this._sphericalEnd.radius-=e,this._spherical.radius-=e;let t=v.copy(r).multiplyScalar(-e);l.add(t)}this._boundary.clampPoint(l,l);let h=v.subVectors(l,this._targetEnd);this._targetEnd.copy(l),this._target.add(h),this._changedDolly-=e,uE(this._changedDolly)&&(this._changedDolly=0)}else if(uA(this._camera)&&0!==this._changedZoom){let e=this._zoom-this._lastZoom,t=this._camera,r=g.set(this._dollyControlCoord.x,this._dollyControlCoord.y,(t.near+t.far)/(t.near-t.far)).unproject(t),n=v.set(0,0,-1).applyQuaternion(t.quaternion),i=y.copy(r).add(n.multiplyScalar(-r.dot(t.up))),a=-(this._zoom-e-this._zoom)/this._zoom,o=this._getCameraDirection(x),s=this._targetEnd.dot(o),l=g.copy(this._targetEnd).lerp(i,a),c=l.dot(o),u=o.multiplyScalar(c-s);l.sub(u),this._boundary.clampPoint(l,l);let h=v.subVectors(l,this._targetEnd);this._targetEnd.copy(l),this._target.add(h),this._changedZoom-=e,uE(this._changedZoom)&&(this._changedZoom=0)}}this._camera.zoom!==this._zoom&&(this._camera.zoom=this._zoom,this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0),this._dragNeedsUpdate=!0;let s=this._collisionTest();this._spherical.radius=Math.min(this._spherical.radius,s),this._spherical.makeSafe(),this._camera.position.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(this._target),this._camera.lookAt(this._target),uE(this._focalOffset.x)&&uE(this._focalOffset.y)&&uE(this._focalOffset.z)||(this._camera.updateMatrixWorld(),E.setFromMatrixColumn(this._camera.matrix,0),_.setFromMatrixColumn(this._camera.matrix,1),C.setFromMatrixColumn(this._camera.matrix,2),E.multiplyScalar(this._focalOffset.x),_.multiplyScalar(-this._focalOffset.y),C.multiplyScalar(this._focalOffset.z),g.copy(E).add(_).add(C),this._camera.position.add(g)),this._boundaryEnclosesCamera&&this._encloseToBoundary(this._camera.position.copy(this._target),g.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse),1);let l=this._needsUpdate;return l&&!this._updatedLastTime?(this._hasRested=!1,this.dispatchEvent({type:"wake"}),this.dispatchEvent({type:"update"})):l?(this.dispatchEvent({type:"update"}),uE(t,this.restThreshold)&&uE(r,this.restThreshold)&&uE(n,this.restThreshold)&&uE(i.x,this.restThreshold)&&uE(i.y,this.restThreshold)&&uE(i.z,this.restThreshold)&&uE(a.x,this.restThreshold)&&uE(a.y,this.restThreshold)&&uE(a.z,this.restThreshold)&&uE(o,this.restThreshold)&&!this._hasRested&&(this._hasRested=!0,this.dispatchEvent({type:"rest"}))):!l&&this._updatedLastTime&&this.dispatchEvent({type:"sleep"}),this._lastDistance=this._spherical.radius,this._lastZoom=this._zoom,this._updatedLastTime=l,this._needsUpdate=!1,l}toJSON(){return JSON.stringify({enabled:this._enabled,minDistance:this.minDistance,maxDistance:ub(this.maxDistance),minZoom:this.minZoom,maxZoom:ub(this.maxZoom),minPolarAngle:this.minPolarAngle,maxPolarAngle:ub(this.maxPolarAngle),minAzimuthAngle:ub(this.minAzimuthAngle),maxAzimuthAngle:ub(this.maxAzimuthAngle),smoothTime:this.smoothTime,draggingSmoothTime:this.draggingSmoothTime,dollySpeed:this.dollySpeed,truckSpeed:this.truckSpeed,dollyToCursor:this.dollyToCursor,verticalDragToForward:this.verticalDragToForward,target:this._targetEnd.toArray(),position:g.setFromSpherical(this._sphericalEnd).add(this._targetEnd).toArray(),zoom:this._zoomEnd,focalOffset:this._focalOffsetEnd.toArray(),target0:this._target0.toArray(),position0:this._position0.toArray(),zoom0:this._zoom0,focalOffset0:this._focalOffset0.toArray()})}fromJSON(e,t=!1){let r=JSON.parse(e);this.enabled=r.enabled,this.minDistance=r.minDistance,this.maxDistance=uw(r.maxDistance),this.minZoom=r.minZoom,this.maxZoom=uw(r.maxZoom),this.minPolarAngle=r.minPolarAngle,this.maxPolarAngle=uw(r.maxPolarAngle),this.minAzimuthAngle=uw(r.minAzimuthAngle),this.maxAzimuthAngle=uw(r.maxAzimuthAngle),this.smoothTime=r.smoothTime,this.draggingSmoothTime=r.draggingSmoothTime,this.dollySpeed=r.dollySpeed,this.truckSpeed=r.truckSpeed,this.dollyToCursor=r.dollyToCursor,this.verticalDragToForward=r.verticalDragToForward,this._target0.fromArray(r.target0),this._position0.fromArray(r.position0),this._zoom0=r.zoom0,this._focalOffset0.fromArray(r.focalOffset0),this.moveTo(r.target[0],r.target[1],r.target[2],t),B.setFromVector3(g.fromArray(r.position).sub(this._targetEnd).applyQuaternion(this._yAxisUpSpace)),this.rotateTo(B.theta,B.phi,t),this.dollyTo(B.radius,t),this.zoomTo(r.zoom,t),this.setFocalOffset(r.focalOffset[0],r.focalOffset[1],r.focalOffset[2],t),this._needsUpdate=!0}connect(e){if(this._domElement){console.warn("camera-controls is already connected.");return}e.setAttribute("data-camera-controls-version","2.8.5"),this._addAllEventListeners(e),this._getClientRect(this._elementRect)}disconnect(){this.cancel(),this._removeAllEventListeners(),this._domElement&&(this._domElement.removeAttribute("data-camera-controls-version"),this._domElement=void 0)}dispose(){this.removeAllEventListeners(),this.disconnect()}_getTargetDirection(e){return e.setFromSpherical(this._spherical).divideScalar(this._spherical.radius).applyQuaternion(this._yAxisUpSpaceInverse)}_getCameraDirection(e){return this._getTargetDirection(e).negate()}_findPointerById(e){return this._activePointers.find(t=>t.pointerId===e)}_findPointerByMouseButton(e){return this._activePointers.find(t=>t.mouseButton===e)}_disposePointer(e){this._activePointers.splice(this._activePointers.indexOf(e),1)}_encloseToBoundary(e,t,r){let n=t.lengthSq();if(0===n)return e;let i=v.copy(t).add(e),a=this._boundary.clampPoint(i,y).sub(i),o=a.lengthSq();if(0===o)return e.add(t);if(o===n)return e;if(0===r)return e.add(t).add(a);{let n=1+r*o/t.dot(a);return e.add(v.copy(t).multiplyScalar(n)).add(a.multiplyScalar(1-r))}}_updateNearPlaneCorners(){if(um(this._camera)){let e=this._camera,t=e.near,r=Math.tan(e.getEffectiveFOV()*uy*.5)*t,n=r*e.aspect;this._nearPlaneCorners[0].set(-n,-r,0),this._nearPlaneCorners[1].set(n,-r,0),this._nearPlaneCorners[2].set(n,r,0),this._nearPlaneCorners[3].set(-n,r,0)}else if(uA(this._camera)){let e=this._camera,t=1/e.zoom,r=e.left*t,n=e.right*t,i=e.top*t,a=e.bottom*t;this._nearPlaneCorners[0].set(r,i,0),this._nearPlaneCorners[1].set(n,i,0),this._nearPlaneCorners[2].set(n,a,0),this._nearPlaneCorners[3].set(r,a,0)}}_collisionTest(){let e=1/0;if(!(this.colliderMeshes.length>=1)||uS(this._camera,"_collisionTest"))return e;let t=this._getTargetDirection(x);R.lookAt(f,t,this._camera.up);for(let r=0;r<4;r++){let n=v.copy(this._nearPlaneCorners[r]);n.applyMatrix4(R);let i=y.addVectors(this._target,n);F.set(i,t),F.far=this._spherical.radius+1;let a=F.intersectObjects(this.colliderMeshes);0!==a.length&&a[0].distance<e&&(e=a[0].distance)}return e}_getClientRect(e){if(!this._domElement)return;let t=this._domElement.getBoundingClientRect();return e.x=t.left,e.y=t.top,this._viewport?(e.x+=this._viewport.x,e.y+=t.height-this._viewport.w-this._viewport.y,e.width=this._viewport.z,e.height=this._viewport.w):(e.width=t.width,e.height=t.height),e}_createOnRestPromise(e){return e?Promise.resolve():(this._hasRested=!1,this.dispatchEvent({type:"transitionstart"}),new Promise(e=>{let t=()=>{this.removeEventListener("rest",t),e()};this.addEventListener("rest",t)}))}_addAllEventListeners(e){}_removeAllEventListeners(){}get dampingFactor(){return console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead."),0}set dampingFactor(e){console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead.")}get draggingDampingFactor(){return console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead."),0}set draggingDampingFactor(e){console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead.")}static createBoundingSphere(e,t=new d.Sphere){let r=t.center;M.makeEmpty(),e.traverseVisible(e=>{e.isMesh&&M.expandByObject(e)}),M.getCenter(r);let n=0;return e.traverseVisible(e=>{if(!e.isMesh)return;let t=e.geometry.clone();t.applyMatrix4(e.matrixWorld);let i=t.attributes.position;for(let e=0,t=i.count;e<t;e++)g.fromBufferAttribute(i,e),n=Math.max(n,r.distanceToSquared(g))}),t.radius=Math.sqrt(n),t}}let uF=(0,ez.forwardRef)((e,t)=>{(0,ez.useMemo)(()=>{let e={Box3:eQ.Box3,MathUtils:{clamp:eQ.MathUtils.clamp},Matrix4:eQ.Matrix4,Quaternion:eQ.Quaternion,Raycaster:eQ.Raycaster,Sphere:eQ.Sphere,Spherical:eQ.Spherical,Vector2:eQ.Vector2,Vector3:eQ.Vector3,Vector4:eQ.Vector4};uR.install({THREE:e}),(0,eL.e)({CameraControlsImpl:uR})},[]);let{camera:r,domElement:n,makeDefault:i,onStart:a,onEnd:o,onChange:s,regress:l,...c}=e,u=(0,eL.A)(e=>e.camera),h=(0,eL.A)(e=>e.gl),d=(0,eL.A)(e=>e.invalidate),f=(0,eL.A)(e=>e.events),p=(0,eL.A)(e=>e.setEvents),m=(0,eL.A)(e=>e.set),A=(0,eL.A)(e=>e.get),g=(0,eL.A)(e=>e.performance),v=r||u,y=n||f.connected||h.domElement,x=(0,ez.useMemo)(()=>new uR(v),[v]);return(0,eL.C)((e,t)=>{x.enabled&&x.update(t)},-1),(0,ez.useEffect)(()=>(x.connect(y),()=>void x.disconnect()),[y,x]),(0,ez.useEffect)(()=>{let e=e=>{d(),l&&g.regress(),s&&s(e)},t=e=>{a&&a(e)},r=e=>{o&&o(e)};return x.addEventListener("update",e),x.addEventListener("controlstart",t),x.addEventListener("controlend",r),x.addEventListener("control",e),x.addEventListener("transitionstart",e),x.addEventListener("wake",e),()=>{x.removeEventListener("update",e),x.removeEventListener("controlstart",t),x.removeEventListener("controlend",r),x.removeEventListener("control",e),x.removeEventListener("transitionstart",e),x.removeEventListener("wake",e)}},[x,a,o,d,p,l,s]),(0,ez.useEffect)(()=>{if(i){let e=A().controls;return m({controls:x}),()=>m({controls:e})}},[i,x]),ez.createElement("primitive",ee({ref:t,object:x},c))}),uz=e=>(null==e?void 0:e.current)instanceof eQ.Object3D,uO=ez.createContext(null);function uQ(){return ez.useContext(uO)}function uL({points:e=50}){let{path:t}=uQ(),[r,n]=ez.useState([]),[i]=ez.useState(()=>new eQ.MeshBasicMaterial({color:"black"})),[a]=ez.useState(()=>new eQ.SphereGeometry(.025,16,16)),o=ez.useRef([]);return ez.useEffect(()=>{t.curves!==o.current&&(n(t.getPoints(e)),o.current=t.curves)}),ez.createElement(ez.Fragment,null,r.map((e,t)=>ez.createElement("mesh",{key:t,material:i,geometry:a,position:[e.x,e.y,e.z]})))}let uk=ez.forwardRef(({children:e,curves:t=[],object:r,debug:n=!1,smooth:i=!1,focus:a,offset:o,eps:s=1e-5,damping:l=.1,focusDamping:c=.1,maxSpeed:u=1/0,...h},d)=>{let{camera:f}=(0,eL.A)(),p=ez.useRef(),[m]=ez.useState(()=>new eQ.CurvePath),A=ez.useRef(null!=o?o:0),g=ez.useMemo(()=>({focus:a,object:(null==r?void 0:r.current)instanceof eQ.Object3D?r:{current:f},path:m,current:A.current,offset:A.current,point:new eQ.Vector3,tangent:new eQ.Vector3,next:new eQ.Vector3}),[a,r]);ez.useLayoutEffect(()=>{var e;m.curves=[];let r=t.length>0?t:null==(e=p.current)?void 0:e.__r3f.objects;for(var n=0;n<r.length;n++)m.add(r[n]);if(i){let e=m.getPoints("number"==typeof i?i:1),t=new eQ.CatmullRomCurve3(e);m.curves=[t]}m.updateArcLengths()}),ez.useImperativeHandle(d,()=>p.current,[]),ez.useLayoutEffect(()=>{A.current=rv.repeat(A.current,1)},[o]);let v=0,[y]=ez.useState(()=>new eQ.Vector3);return(0,eL.C)((e,t)=>{if(v=g.offset,rK.damp(A,"current",void 0!==o?o:g.current,l,t,u,void 0,s),g.offset=rv.repeat(A.current,1),m.getCurveLengths().length>0){m.getPointAt(g.offset,g.point),m.getTangentAt(g.offset,g.tangent).normalize(),m.getPointAt(rv.repeat(A.current-(v-g.offset),1),g.next);let e=(null==r?void 0:r.current)instanceof eQ.Object3D?r.current:f;e.position.copy(g.point),a&&rK.dampLookAt(e,uz(a)?a.current.getWorldPosition(y):a,c,t,u,void 0,s)}}),ez.createElement("group",ee({ref:p},h),ez.createElement(uO.Provider,{value:g},e,n&&ez.createElement(uL,null)))});function uU({defaultScene:e,defaultCamera:t,renderPriority:r=1}){let n;let{gl:i,scene:a,camera:o}=(0,eL.A)();return(0,eL.C)(()=>{n=i.autoClear,1===r&&(i.autoClear=!0,i.render(e,t)),i.autoClear=!1,i.clearDepth(),i.render(a,o),i.autoClear=n},r),ez.createElement("group",{onPointerOver:()=>null})}function uN({children:e,renderPriority:t=1}){let{scene:r,camera:n}=(0,eL.A)(),[i]=ez.useState(()=>new eQ.Scene);return ez.createElement(ez.Fragment,null,(0,eL.g)(ez.createElement(ez.Fragment,null,e,ez.createElement(uU,{defaultScene:r,defaultCamera:n,renderPriority:t})),i,{events:{priority:t+1}}))}let uG=ez.createContext({}),uH=()=>ez.useContext(uG),uV=2*Math.PI,uj=new eQ.Object3D,uY=new eQ.Matrix4,[uJ,uW]=[new eQ.Quaternion,new eQ.Quaternion],uq=new eQ.Vector3,uK=new eQ.Vector3,uX=e=>"minPolarAngle"in e,uZ=({alignment:e="bottom-right",margin:t=[80,80],renderPriority:r=1,onUpdate:n,onTarget:i,children:a})=>{let o=(0,eL.A)(e=>e.size),s=(0,eL.A)(e=>e.camera),l=(0,eL.A)(e=>e.controls),c=(0,eL.A)(e=>e.invalidate),u=ez.useRef(null),h=ez.useRef(null),d=ez.useRef(!1),f=ez.useRef(0),p=ez.useRef(new eQ.Vector3(0,0,0)),m=ez.useRef(new eQ.Vector3(0,0,0));ez.useEffect(()=>{m.current.copy(s.up)},[s]);let A=ez.useCallback(e=>{d.current=!0,(l||i)&&(p.current=(null==l?void 0:l.target)||(null==i?void 0:i())),f.current=s.position.distanceTo(uq),uJ.copy(s.quaternion),uK.copy(e).multiplyScalar(f.current).add(uq),uj.lookAt(uK),uj.up.copy(s.up),uW.copy(uj.quaternion),c()},[l,s,i,c]);(0,eL.C)((e,t)=>{if(h.current&&u.current){var r;d.current&&(.01>uJ.angleTo(uW)?(d.current=!1,uX(l)&&s.up.copy(m.current)):(uJ.rotateTowards(uW,t*uV),s.position.set(0,0,1).applyQuaternion(uJ).multiplyScalar(f.current).add(p.current),s.up.set(0,1,0).applyQuaternion(uJ).normalize(),s.quaternion.copy(uJ),n?n():l&&l.update(),c())),uY.copy(s.matrix).invert(),null==(r=u.current)||r.quaternion.setFromRotationMatrix(uY)}});let g=ez.useMemo(()=>({tweenCamera:A}),[A]),[v,y]=t,x=e.endsWith("-center")?0:e.endsWith("-left")?-o.width/2+v:o.width/2-v,E=e.startsWith("center-")?0:e.startsWith("top-")?o.height/2-y:-o.height/2+y;return ez.createElement(uN,{renderPriority:r},ez.createElement(uG.Provider,{value:g},ez.createElement(cl,{makeDefault:!0,ref:h,position:[0,0,200]}),ez.createElement("group",{ref:u,position:[x,E,0]},a)))},u$="#f0f0f0",u0="#999",u1="black",u2="black",u3=["Right","Left","Top","Bottom","Front","Back"],u4=e=>new eQ.Vector3(...e).multiplyScalar(.38),u5=[[1,1,1],[1,1,-1],[1,-1,1],[1,-1,-1],[-1,1,1],[-1,1,-1],[-1,-1,1],[-1,-1,-1]].map(u4),u6=[.25,.25,.25],u8=[[1,1,0],[1,0,1],[1,0,-1],[1,-1,0],[0,1,1],[0,1,-1],[0,-1,1],[0,-1,-1],[-1,1,0],[-1,0,1],[-1,0,-1],[-1,-1,0]].map(u4),u9=u8.map(e=>e.toArray().map(e=>0==e?.5:.25)),u7=({hover:e,index:t,font:r="20px Inter var, Arial, sans-serif",faces:n=u3,color:i=u$,hoverColor:a=u0,textColor:o=u1,strokeColor:s=u2,opacity:l=1})=>{let c=(0,eL.A)(e=>e.gl),u=ez.useMemo(()=>{let e=document.createElement("canvas");e.width=128,e.height=128;let a=e.getContext("2d");return a.fillStyle=i,a.fillRect(0,0,e.width,e.height),a.strokeStyle=s,a.strokeRect(0,0,e.width,e.height),a.font=r,a.textAlign="center",a.fillStyle=o,a.fillText(n[t].toUpperCase(),64,76),new eQ.CanvasTexture(e)},[t,n,r,i,o,s]);return ez.createElement("meshBasicMaterial",{map:u,"map-anisotropy":c.capabilities.getMaxAnisotropy()||1,attach:`material-${t}`,color:e?a:"white",transparent:!0,opacity:l})},he=e=>{let{tweenCamera:t}=uH(),[r,n]=ez.useState(null);return ez.createElement("mesh",{onPointerOut:e=>{e.stopPropagation(),n(null)},onPointerMove:e=>{e.stopPropagation(),n(Math.floor(e.faceIndex/2))},onClick:e.onClick||(e=>{e.stopPropagation(),t(e.face.normal)})},[...Array(6)].map((t,n)=>ez.createElement(u7,ee({key:n,index:n,hover:r===n},e))),ez.createElement("boxGeometry",null))},ht=({onClick:e,dimensions:t,position:r,hoverColor:n=u0})=>{let{tweenCamera:i}=uH(),[a,o]=ez.useState(!1);return ez.createElement("mesh",{scale:1.01,position:r,onPointerOver:e=>{e.stopPropagation(),o(!0)},onPointerOut:e=>{e.stopPropagation(),o(!1)},onClick:e||(e=>{e.stopPropagation(),i(r)})},ez.createElement("meshBasicMaterial",{color:a?n:"white",transparent:!0,opacity:.6,visible:a}),ez.createElement("boxGeometry",{args:t}))},hr=e=>ez.createElement("group",{scale:[60,60,60]},ez.createElement(he,e),u8.map((t,r)=>ez.createElement(ht,ee({key:r,position:t,dimensions:u9[r]},e))),u5.map((t,r)=>ez.createElement(ht,ee({key:r,position:t,dimensions:u6},e))));function hn({scale:e=[.8,.05,.05],color:t,rotation:r}){return ez.createElement("group",{rotation:r},ez.createElement("mesh",{position:[.4,0,0]},ez.createElement("boxGeometry",{args:e}),ez.createElement("meshBasicMaterial",{color:t,toneMapped:!1})))}function hi({onClick:e,font:t,disabled:r,arcStyle:n,label:i,labelColor:a,axisHeadScale:o=1,...s}){let l=(0,eL.A)(e=>e.gl),c=ez.useMemo(()=>{let e=document.createElement("canvas");e.width=64,e.height=64;let r=e.getContext("2d");return r.beginPath(),r.arc(32,32,16,0,2*Math.PI),r.closePath(),r.fillStyle=n,r.fill(),i&&(r.font=t,r.textAlign="center",r.fillStyle=a,r.fillText(i,32,41)),new eQ.CanvasTexture(e)},[n,i,a,t]),[u,h]=ez.useState(!1),d=(i?1:.75)*(u?1.2:1)*o;return ez.createElement("sprite",ee({scale:d,onPointerOver:r?void 0:e=>{e.stopPropagation(),h(!0)},onPointerOut:r?void 0:e||(e=>{e.stopPropagation(),h(!1)})},s),ez.createElement("spriteMaterial",{map:c,"map-anisotropy":l.capabilities.getMaxAnisotropy()||1,alphaTest:.3,opacity:i?1:.75,toneMapped:!1}))}let ha=({hideNegativeAxes:e,hideAxisHeads:t,disabled:r,font:n="18px Inter var, Arial, sans-serif",axisColors:i=["#ff2060","#20df80","#2080ff"],axisHeadScale:a=1,axisScale:o,labels:s=["X","Y","Z"],labelColor:l="#000",onClick:c,...u})=>{let[h,d,f]=i,{tweenCamera:p}=uH(),m={font:n,disabled:r,labelColor:l,onClick:c,axisHeadScale:a,onPointerDown:r?void 0:e=>{p(e.object.position),e.stopPropagation()}};return ez.createElement("group",ee({scale:40},u),ez.createElement(hn,{color:h,rotation:[0,0,0],scale:o}),ez.createElement(hn,{color:d,rotation:[0,0,Math.PI/2],scale:o}),ez.createElement(hn,{color:f,rotation:[0,-Math.PI/2,0],scale:o}),!t&&ez.createElement(ez.Fragment,null,ez.createElement(hi,ee({arcStyle:h,position:[1,0,0],label:s[0]},m)),ez.createElement(hi,ee({arcStyle:d,position:[0,1,0],label:s[1]},m)),ez.createElement(hi,ee({arcStyle:f,position:[0,0,1],label:s[2]},m)),!e&&ez.createElement(ez.Fragment,null,ez.createElement(hi,ee({arcStyle:h,position:[-1,0,0]},m)),ez.createElement(hi,ee({arcStyle:d,position:[0,-1,0]},m)),ez.createElement(hi,ee({arcStyle:f,position:[0,0,-1]},m)))))},ho=sv({cellSize:.5,sectionSize:1,fadeDistance:100,fadeStrength:1,fadeFrom:1,cellThickness:.5,sectionThickness:1,cellColor:new eQ.Color,sectionColor:new eQ.Color,infiniteGrid:!1,followCamera:!1,worldCamProjPosition:new eQ.Vector3,worldPlanePosition:new eQ.Vector3},`
    varying vec3 localPosition;
    varying vec4 worldPosition;

    uniform vec3 worldCamProjPosition;
    uniform vec3 worldPlanePosition;
    uniform float fadeDistance;
    uniform bool infiniteGrid;
    uniform bool followCamera;

    void main() {
      localPosition = position.xzy;
      if (infiniteGrid) localPosition *= 1.0 + fadeDistance;
      
      worldPosition = modelMatrix * vec4(localPosition, 1.0);
      if (followCamera) {
        worldPosition.xyz += (worldCamProjPosition - worldPlanePosition);
        localPosition = (inverse(modelMatrix) * worldPosition).xyz;
      }

      gl_Position = projectionMatrix * viewMatrix * worldPosition;
    }
  `,`
    varying vec3 localPosition;
    varying vec4 worldPosition;

    uniform vec3 worldCamProjPosition;
    uniform float cellSize;
    uniform float sectionSize;
    uniform vec3 cellColor;
    uniform vec3 sectionColor;
    uniform float fadeDistance;
    uniform float fadeStrength;
    uniform float fadeFrom;
    uniform float cellThickness;
    uniform float sectionThickness;

    float getGrid(float size, float thickness) {
      vec2 r = localPosition.xz / size;
      vec2 grid = abs(fract(r - 0.5) - 0.5) / fwidth(r);
      float line = min(grid.x, grid.y) + 1.0 - thickness;
      return 1.0 - min(line, 1.0);
    }

    void main() {
      float g1 = getGrid(cellSize, cellThickness);
      float g2 = getGrid(sectionSize, sectionThickness);

      vec3 from = worldCamProjPosition*vec3(fadeFrom);
      float dist = distance(from, worldPosition.xyz);
      float d = 1.0 - min(dist / fadeDistance, 1.0);
      vec3 color = mix(cellColor, sectionColor, min(1.0, sectionThickness * g2));

      gl_FragColor = vec4(color, (g1 + g2) * pow(d, fadeStrength));
      gl_FragColor.a = mix(0.75 * gl_FragColor.a, gl_FragColor.a, g2);
      if (gl_FragColor.a <= 0.0) discard;

      #include <tonemapping_fragment>
      #include <${s_>=154?"colorspace_fragment":"encodings_fragment"}>
    }
  `),hs=ez.forwardRef(({args:e,cellColor:t="#000000",sectionColor:r="#2080ff",cellSize:n=.5,sectionSize:i=1,followCamera:a=!1,infiniteGrid:o=!1,fadeDistance:s=100,fadeStrength:l=1,fadeFrom:c=1,cellThickness:u=.5,sectionThickness:h=1,side:d=eQ.BackSide,...f},p)=>{(0,eL.e)({GridMaterial:ho});let m=ez.useRef(null);ez.useImperativeHandle(p,()=>m.current,[]);let A=new eQ.Plane,g=new eQ.Vector3(0,1,0),v=new eQ.Vector3(0,0,0);return(0,eL.C)(e=>{A.setFromNormalAndCoplanarPoint(g,v).applyMatrix4(m.current.matrixWorld);let t=m.current.material,r=t.uniforms.worldCamProjPosition,n=t.uniforms.worldPlanePosition;A.projectPoint(e.camera.position,r.value),n.value.set(0,0,0).applyMatrix4(m.current.matrixWorld)}),ez.createElement("mesh",ee({ref:m,frustumCulled:!1},f),ez.createElement("gridMaterial",ee({transparent:!0,"extensions-derivatives":!0,side:d},{cellSize:n,sectionSize:i,cellColor:t,sectionColor:r,cellThickness:u,sectionThickness:h},{fadeDistance:s,fadeStrength:l,fadeFrom:c,infiniteGrid:o,followCamera:a})),ez.createElement("planeGeometry",{args:e}))});function hl(e,{path:t}){let[r]=(0,eL.F)(eQ.CubeTextureLoader,[e],e=>e.setPath(t));return r}function hc({children:e,files:t,...r}){let n=hl(t,{...r});return ez.createElement(ez.Fragment,null,null==e?void 0:e(n))}hl.preload=(e,{path:t})=>eL.F.preload(eQ.CubeTextureLoader,[e],e=>e.setPath(t));var hu={},hh=Uint8Array,hd=Uint16Array,hf=Uint32Array,hp=new hh([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),hm=new hh([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),hA=new hh([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),hg=function(e,t){for(var r=new hd(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var i=new hf(r[30]),n=1;n<30;++n)for(var a=r[n];a<r[n+1];++a)i[a]=a-r[n]<<5|n;return[r,i]},hv=hg(hp,2),hy=hv[0],hx=hv[1];hy[28]=258,hx[258]=28;for(var hE=hg(hm,0),h_=hE[0],hC=hE[1],hb=new hd(32768),hw=0;hw<32768;++hw){var hB=(43690&hw)>>>1|(21845&hw)<<1;hB=(61680&(hB=(52428&hB)>>>2|(13107&hB)<<2))>>>4|(3855&hB)<<4,hb[hw]=((65280&hB)>>>8|(255&hB)<<8)>>>1}for(var hI=function(e,t,r){for(var n,i=e.length,a=0,o=new hd(t);a<i;++a)++o[e[a]-1];var s=new hd(t);for(a=0;a<t;++a)s[a]=s[a-1]+o[a-1]<<1;if(r){n=new hd(1<<t);var l=15-t;for(a=0;a<i;++a)if(e[a])for(var c=a<<4|e[a],u=t-e[a],h=s[e[a]-1]++<<u,d=h|(1<<u)-1;h<=d;++h)n[hb[h]>>>l]=c}else for(a=0,n=new hd(i);a<i;++a)e[a]&&(n[a]=hb[s[e[a]-1]++]>>>15-e[a]);return n},hM=new hh(288),hw=0;hw<144;++hw)hM[hw]=8;for(var hw=144;hw<256;++hw)hM[hw]=9;for(var hw=256;hw<280;++hw)hM[hw]=7;for(var hw=280;hw<288;++hw)hM[hw]=8;for(var hS=new hh(32),hw=0;hw<32;++hw)hS[hw]=5;var hT=hI(hM,9,1),hP=hI(hS,5,1),hD=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},hR=function(e,t,r){var n=t/8|0;return(e[n]|e[n+1]<<8)>>(7&t)&r},hF=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(7&t)},hz=function(e){return(e/8|0)+(7&e&&1)},hO=function(e,t,r){(null==t||t<0)&&(t=0),(null==r||r>e.length)&&(r=e.length);var n=new(e instanceof hd?hd:e instanceof hf?hf:hh)(r-t);return n.set(e.subarray(t,r)),n},hQ=function(e,t,r){var n=e.length;if(!n||r&&!r.l&&n<5)return t||new hh(0);var i=!t||r,a=!r||r.i;r||(r={}),t||(t=new hh(3*n));var o=function(e){var r=t.length;if(e>r){var n=new hh(Math.max(2*r,e));n.set(t),t=n}},s=r.f||0,l=r.p||0,c=r.b||0,u=r.l,h=r.d,d=r.m,f=r.n,p=8*n;do{if(!u){r.f=s=hR(e,l,1);var m=hR(e,l+1,3);if(l+=3,m){if(1==m)u=hT,h=hP,d=9,f=5;else if(2==m){var A=hR(e,l,31)+257,g=hR(e,l+10,15)+4,v=A+hR(e,l+5,31)+1;l+=14;for(var y=new hh(v),x=new hh(19),E=0;E<g;++E)x[hA[E]]=hR(e,l+3*E,7);l+=3*g;for(var _=hD(x),C=(1<<_)-1,b=hI(x,_,1),E=0;E<v;){var w=b[hR(e,l,C)];l+=15&w;var B=w>>>4;if(B<16)y[E++]=B;else{var I=0,M=0;for(16==B?(M=3+hR(e,l,3),l+=2,I=y[E-1]):17==B?(M=3+hR(e,l,7),l+=3):18==B&&(M=11+hR(e,l,127),l+=7);M--;)y[E++]=I}}var S=y.subarray(0,A),T=y.subarray(A);d=hD(S),f=hD(T),u=hI(S,d,1),h=hI(T,f,1)}else throw"invalid block type"}else{var B=hz(l)+4,P=e[B-4]|e[B-3]<<8,D=B+P;if(D>n){if(a)throw"unexpected EOF";break}i&&o(c+P),t.set(e.subarray(B,D),c),r.b=c+=P,r.p=l=8*D;continue}if(l>p){if(a)throw"unexpected EOF";break}}i&&o(c+131072);for(var R=(1<<d)-1,F=(1<<f)-1,z=l;;z=l){var I=u[hF(e,l)&R],O=I>>>4;if((l+=15&I)>p){if(a)throw"unexpected EOF";break}if(!I)throw"invalid length/literal";if(O<256)t[c++]=O;else if(256==O){z=l,u=null;break}else{var Q=O-254;if(O>264){var E=O-257,L=hp[E];Q=hR(e,l,(1<<L)-1)+hy[E],l+=L}var k=h[hF(e,l)&F],U=k>>>4;if(!k)throw"invalid distance";l+=15&k;var T=h_[U];if(U>3){var L=hm[U];T+=hF(e,l)&(1<<L)-1,l+=L}if(l>p){if(a)throw"unexpected EOF";break}i&&o(c+131072);for(var N=c+Q;c<N;c+=4)t[c]=t[c-T],t[c+1]=t[c+1-T],t[c+2]=t[c+2-T],t[c+3]=t[c+3-T];c=N}}r.l=u,r.p=z,r.b=c,u&&(s=1,r.m=d,r.d=h,r.n=f)}while(!s);return c==t.length?t:hO(t,0,c)},hL=function(e,t,r){r<<=7&t;var n=t/8|0;e[n]|=r,e[n+1]|=r>>>8},hk=function(e,t,r){r<<=7&t;var n=t/8|0;e[n]|=r,e[n+1]|=r>>>8,e[n+2]|=r>>>16},hU=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var i=r.length,a=r.slice();if(!i)return[hJ,0];if(1==i){var o=new hh(r[0].s+1);return o[r[0].s]=1,[o,1]}r.sort(function(e,t){return e.f-t.f}),r.push({s:-1,f:25001});var s=r[0],l=r[1],c=0,u=1,h=2;for(r[0]={s:-1,f:s.f+l.f,l:s,r:l};u!=i-1;)s=r[r[c].f<r[h].f?c++:h++],l=r[c!=u&&r[c].f<r[h].f?c++:h++],r[u++]={s:-1,f:s.f+l.f,l:s,r:l};for(var d=a[0].s,n=1;n<i;++n)a[n].s>d&&(d=a[n].s);var f=new hd(d+1),p=hN(r[u-1],f,0);if(p>t){var n=0,m=0,A=p-t,g=1<<A;for(a.sort(function(e,t){return f[t.s]-f[e.s]||e.f-t.f});n<i;++n){var v=a[n].s;if(f[v]>t)m+=g-(1<<p-f[v]),f[v]=t;else break}for(m>>>=A;m>0;){var y=a[n].s;f[y]<t?m-=1<<t-f[y]++-1:++n}for(;n>=0&&m;--n){var x=a[n].s;f[x]==t&&(--f[x],++m)}p=t}return[new hh(f),p]},hN=function(e,t,r){return -1==e.s?Math.max(hN(e.l,t,r+1),hN(e.r,t,r+1)):t[e.s]=r},hG=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new hd(++t),n=0,i=e[0],a=1,o=function(e){r[n++]=e},s=1;s<=t;++s)if(e[s]==i&&s!=t)++a;else{if(!i&&a>2){for(;a>138;a-=138)o(32754);a>2&&(o(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(o(i),--a;a>6;a-=6)o(8304);a>2&&(o(a-3<<5|8208),a=0)}for(;a--;)o(i);a=1,i=e[s]}return[r.subarray(0,n),t]},hH=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},hV=function(e,t,r){var n=r.length,i=hz(t+2);e[i]=255&n,e[i+1]=n>>>8,e[i+2]=255^e[i],e[i+3]=255^e[i+1];for(var a=0;a<n;++a)e[i+a+4]=r[a];return(i+4+n)*8},hj=function(e,t,r,n,i,a,o,s,l,c,u){hL(t,u++,r),++i[256];for(var h,d,f,p,m=hU(i,15),A=m[0],g=m[1],v=hU(a,15),y=v[0],x=v[1],E=hG(A),_=E[0],C=E[1],b=hG(y),w=b[0],B=b[1],I=new hd(19),M=0;M<_.length;++M)I[31&_[M]]++;for(var M=0;M<w.length;++M)I[31&w[M]]++;for(var S=hU(I,7),T=S[0],P=S[1],D=19;D>4&&!T[hA[D-1]];--D);var R=c+5<<3,F=hH(i,hM)+hH(a,hS)+o,z=hH(i,A)+hH(a,y)+o+14+3*D+hH(I,T)+(2*I[16]+3*I[17]+7*I[18]);if(R<=F&&R<=z)return hV(t,u,e.subarray(l,l+c));if(hL(t,u,1+(z<F)),u+=2,z<F){h=hI(A,g,0),d=A,f=hI(y,x,0),p=y;var O=hI(T,P,0);hL(t,u,C-257),hL(t,u+5,B-1),hL(t,u+10,D-4),u+=14;for(var M=0;M<D;++M)hL(t,u+3*M,T[hA[M]]);u+=3*D;for(var Q=[_,w],L=0;L<2;++L)for(var k=Q[L],M=0;M<k.length;++M){var U=31&k[M];hL(t,u,O[U]),u+=T[U],U>15&&(hL(t,u,k[M]>>>5&127),u+=k[M]>>>12)}}else h=null,d=hM,f=null,p=hS;for(var M=0;M<s;++M)if(n[M]>255){var U=n[M]>>>18&31;hk(t,u,h[U+257]),u+=d[U+257],U>7&&(hL(t,u,n[M]>>>23&31),u+=hp[U]);var N=31&n[M];hk(t,u,f[N]),u+=p[N],N>3&&(hk(t,u,n[M]>>>5&8191),u+=hm[N])}else hk(t,u,h[n[M]]),u+=d[n[M]];return hk(t,u,h[256]),u+d[256]},hY=new hf([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),hJ=new hh(0),hW=function(e){if((15&e[0])!=8||e[0]>>>4>7||(e[0]<<8|e[1])%31)throw"invalid zlib data";if(32&e[1])throw"invalid zlib data: preset dictionaries not supported"};function hq(e,t){return hQ((hW(e),e.subarray(2,-4)),t)}var hK="undefined"!=typeof TextDecoder&&new TextDecoder;try{hK.decode(hJ,{stream:!0})}catch(e){}function hX(e,t,r){let n=r.length-e-1;if(t>=r[n])return n-1;if(t<=r[e])return e;let i=e,a=n,o=Math.floor((i+a)/2);for(;t<r[o]||t>=r[o+1];)t<r[o]?a=o:i=o,o=Math.floor((i+a)/2);return o}class hZ extends eQ.Curve{constructor(e,t,r,n,i){super(),this.degree=e,this.knots=t,this.controlPoints=[],this.startKnot=n||0,this.endKnot=i||this.knots.length-1;for(let e=0;e<r.length;++e){let t=r[e];this.controlPoints[e]=new eQ.Vector4(t.x,t.y,t.z,t.w)}}getPoint(e,t){let r=t||new eQ.Vector3,n=this.knots[this.startKnot]+e*(this.knots[this.endKnot]-this.knots[this.startKnot]),i=function(e,t,r,n){let i=hX(e,n,t),a=function(e,t,r,n){let i=[],a=[],o=[];i[0]=1;for(let s=1;s<=r;++s){a[s]=t-n[e+1-s],o[s]=n[e+s]-t;let r=0;for(let e=0;e<s;++e){let t=o[e+1],n=a[s-e],l=i[e]/(t+n);i[e]=r+t*l,r=n*l}i[s]=r}return i}(i,n,e,t),o=new eQ.Vector4(0,0,0,0);for(let t=0;t<=e;++t){let n=r[i-e+t],s=a[t],l=n.w*s;o.x+=n.x*l,o.y+=n.y*l,o.z+=n.z*l,o.w+=n.w*s}return o}(this.degree,this.knots,this.controlPoints,n);return 1!=i.w&&i.divideScalar(i.w),r.set(i.x,i.y,i.z)}getTangent(e,t){var r;let n=t||new eQ.Vector3,i=this.knots[0]+e*(this.knots[this.knots.length-1]-this.knots[0]),a=(r=this.degree,function(e){let t=e.length,r=[],n=[];for(let i=0;i<t;++i){let t=e[i];r[i]=new eQ.Vector3(t.x,t.y,t.z),n[i]=t.w}let i=[];for(let e=0;e<t;++e){let t=r[e].clone();for(let r=1;r<=e;++r)t.sub(i[e-r].clone().multiplyScalar(function(e,t){let r=1;for(let t=2;t<=e;++t)r*=t;let n=1;for(let e=2;e<=t;++e)n*=e;for(let r=2;r<=e-t;++r)n*=r;return r/n}(e,r)*n[r]));i[e]=t.divideScalar(n[0])}return i}(function(e,t,r,n,i){let a=1<e?1:e,o=[],s=hX(e,n,t),l=function(e,t,r,n,i){let a=[];for(let e=0;e<=r;++e)a[e]=0;let o=[];for(let e=0;e<=n;++e)o[e]=a.slice(0);let s=[];for(let e=0;e<=r;++e)s[e]=a.slice(0);s[0][0]=1;let l=a.slice(0),c=a.slice(0);for(let n=1;n<=r;++n){l[n]=t-i[e+1-n],c[n]=i[e+n]-t;let r=0;for(let e=0;e<n;++e){let t=c[e+1],i=l[n-e];s[n][e]=t+i;let a=s[e][n-1]/s[n][e];s[e][n]=r+t*a,r=i*a}s[n][n]=r}for(let e=0;e<=r;++e)o[0][e]=s[e][r];for(let e=0;e<=r;++e){let t=0,i=1,l=[];for(let e=0;e<=r;++e)l[e]=a.slice(0);l[0][0]=1;for(let a=1;a<=n;++a){let n=0,c=e-a,u=r-a;e>=a&&(l[i][0]=l[t][0]/s[u+1][c],n=l[i][0]*s[c][u]);let h=c>=-1?1:-c,d=e-1<=u?a-1:r-e;for(let e=h;e<=d;++e)l[i][e]=(l[t][e]-l[t][e-1])/s[u+1][c+e],n+=l[i][e]*s[c+e][u];e<=u&&(l[i][a]=-l[t][a-1]/s[u+1][e],n+=l[i][a]*s[e][u]),o[a][e]=n;let f=t;t=i,i=f}}let u=r;for(let e=1;e<=n;++e){for(let t=0;t<=r;++t)o[e][t]*=u;u*=r-e}return o}(s,n,e,a,t),c=[];for(let e=0;e<r.length;++e){let t=r[e].clone(),n=t.w;t.x*=n,t.y*=n,t.z*=n,c[e]=t}for(let t=0;t<=a;++t){let r=c[s-e].clone().multiplyScalar(l[t][0]);for(let n=1;n<=e;++n)r.add(c[s-e+n].clone().multiplyScalar(l[t][n]));o[t]=r}for(let e=a+1;e<=i+1;++e)o[e]=new eQ.Vector4(0,0,0);return o}(r,this.knots,this.controlPoints,i,1)));return n.copy(a[1]).normalize(),n}}class h$ extends eQ.Loader{constructor(e){super(e)}load(e,t,r,n){let i=this,a=""===i.path?eQ.LoaderUtils.extractUrlBase(e):i.path,o=new eQ.FileLoader(this.manager);o.setPath(i.path),o.setResponseType("arraybuffer"),o.setRequestHeader(i.requestHeader),o.setWithCredentials(i.withCredentials),o.load(e,function(r){try{t(i.parse(r,a))}catch(t){n?n(t):console.error(t),i.manager.itemError(e)}},r,n)}parse(e,t){if(function(e){let t="Kaydara FBX Binary  \0";return e.byteLength>=t.length&&t===ds(e,0,t.length)}(e))z=new h4().parse(e);else{let t=ds(e);if(!function(e){let t=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"],r=0;for(let n=0;n<t.length;++n)if(function(t){let n=e[0];return e=e.slice(r+1),r++,n}(0)===t[n])return!1;return!0}(t))throw Error("THREE.FBXLoader: Unknown format.");if(7e3>h8(t))throw Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+h8(t));z=new h3().parse(t)}return new h0(new eQ.TextureLoader(this.manager).setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin),this.manager).parse(z)}}class h0{constructor(e,t){this.textureLoader=e,this.manager=t}parse(){O=this.parseConnections();let e=this.parseImages(),t=this.parseTextures(e),r=this.parseMaterials(t),n=this.parseDeformers(),i=new h1().parse(n);return this.parseScene(n,i,r),Q}parseConnections(){let e=new Map;return"Connections"in z&&z.Connections.connections.forEach(function(t){let r=t[0],n=t[1],i=t[2];e.has(r)||e.set(r,{parents:[],children:[]}),e.get(r).parents.push({ID:n,relationship:i}),e.has(n)||e.set(n,{parents:[],children:[]}),e.get(n).children.push({ID:r,relationship:i})}),e}parseImages(){let e={},t={};if("Video"in z.Objects){let r=z.Objects.Video;for(let n in r){let i=r[n];if(e[parseInt(n)]=i.RelativeFilename||i.Filename,"Content"in i){let e=i.Content instanceof ArrayBuffer&&i.Content.byteLength>0,a="string"==typeof i.Content&&""!==i.Content;if(e||a){let e=this.parseImage(r[n]);t[i.RelativeFilename||i.Filename]=e}}}}for(let r in e){let n=e[r];void 0!==t[n]?e[r]=t[n]:e[r]=e[r].split("\\").pop()}return e}parseImage(e){let t;let r=e.Content,n=e.RelativeFilename||e.Filename,i=n.slice(n.lastIndexOf(".")+1).toLowerCase();switch(i){case"bmp":t="image/bmp";break;case"jpg":case"jpeg":t="image/jpeg";break;case"png":t="image/png";break;case"tif":t="image/tiff";break;case"tga":null===this.manager.getHandler(".tga")&&console.warn("FBXLoader: TGA loader not found, skipping ",n),t="image/tga";break;default:console.warn('FBXLoader: Image type "'+i+'" is not supported.');return}if("string"==typeof r)return"data:"+t+";base64,"+r;{let e=new Uint8Array(r);return window.URL.createObjectURL(new Blob([e],{type:t}))}}parseTextures(e){let t=new Map;if("Texture"in z.Objects){let r=z.Objects.Texture;for(let n in r){let i=this.parseTexture(r[n],e);t.set(parseInt(n),i)}}return t}parseTexture(e,t){let r=this.loadTexture(e,t);r.ID=e.id,r.name=e.attrName;let n=e.WrapModeU,i=e.WrapModeV,a=void 0!==n?n.value:0,o=void 0!==i?i.value:0;if(r.wrapS=0===a?eQ.RepeatWrapping:eQ.ClampToEdgeWrapping,r.wrapT=0===o?eQ.RepeatWrapping:eQ.ClampToEdgeWrapping,"Scaling"in e){let t=e.Scaling.value;r.repeat.x=t[0],r.repeat.y=t[1]}return r}loadTexture(e,t){let r,n;let i=this.textureLoader.path,a=O.get(e.id).children;void 0!==a&&a.length>0&&void 0!==t[a[0].ID]&&(0===(r=t[a[0].ID]).indexOf("blob:")||0===r.indexOf("data:"))&&this.textureLoader.setPath(void 0);let o=e.FileName.slice(-3).toLowerCase();if("tga"===o){let t=this.manager.getHandler(".tga");null===t?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",e.RelativeFilename),n=new eQ.Texture):(t.setPath(this.textureLoader.path),n=t.load(r))}else"psd"===o?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",e.RelativeFilename),n=new eQ.Texture):n=this.textureLoader.load(r);return this.textureLoader.setPath(i),n}parseMaterials(e){let t=new Map;if("Material"in z.Objects){let r=z.Objects.Material;for(let n in r){let i=this.parseMaterial(r[n],e);null!==i&&t.set(parseInt(n),i)}}return t}parseMaterial(e,t){let r;let n=e.id,i=e.attrName,a=e.ShadingModel;if("object"==typeof a&&(a=a.value),!O.has(n))return null;let o=this.parseParameters(e,t,n);switch(a.toLowerCase()){case"phong":r=new eQ.MeshPhongMaterial;break;case"lambert":r=new eQ.MeshLambertMaterial;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',a),r=new eQ.MeshPhongMaterial}return r.setValues(o),r.name=i,r}parseParameters(e,t,r){let n={};e.BumpFactor&&(n.bumpScale=e.BumpFactor.value),e.Diffuse?n.color=new eQ.Color().fromArray(e.Diffuse.value):e.DiffuseColor&&("Color"===e.DiffuseColor.type||"ColorRGB"===e.DiffuseColor.type)&&(n.color=new eQ.Color().fromArray(e.DiffuseColor.value)),e.DisplacementFactor&&(n.displacementScale=e.DisplacementFactor.value),e.Emissive?n.emissive=new eQ.Color().fromArray(e.Emissive.value):e.EmissiveColor&&("Color"===e.EmissiveColor.type||"ColorRGB"===e.EmissiveColor.type)&&(n.emissive=new eQ.Color().fromArray(e.EmissiveColor.value)),e.EmissiveFactor&&(n.emissiveIntensity=parseFloat(e.EmissiveFactor.value)),e.Opacity&&(n.opacity=parseFloat(e.Opacity.value)),n.opacity<1&&(n.transparent=!0),e.ReflectionFactor&&(n.reflectivity=e.ReflectionFactor.value),e.Shininess&&(n.shininess=e.Shininess.value),e.Specular?n.specular=new eQ.Color().fromArray(e.Specular.value):e.SpecularColor&&"Color"===e.SpecularColor.type&&(n.specular=new eQ.Color().fromArray(e.SpecularColor.value));let i=this;return O.get(r).children.forEach(function(e){let r=e.relationship;switch(r){case"Bump":n.bumpMap=i.getTexture(t,e.ID);break;case"Maya|TEX_ao_map":n.aoMap=i.getTexture(t,e.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":n.map=i.getTexture(t,e.ID),void 0!==n.map&&("colorSpace"in n.map?n.map.colorSpace="srgb":n.map.encoding=3001);break;case"DisplacementColor":n.displacementMap=i.getTexture(t,e.ID);break;case"EmissiveColor":n.emissiveMap=i.getTexture(t,e.ID),void 0!==n.emissiveMap&&("colorSpace"in n.emissiveMap?n.emissiveMap.colorSpace="srgb":n.emissiveMap.encoding=3001);break;case"NormalMap":case"Maya|TEX_normal_map":n.normalMap=i.getTexture(t,e.ID);break;case"ReflectionColor":n.envMap=i.getTexture(t,e.ID),void 0!==n.envMap&&(n.envMap.mapping=eQ.EquirectangularReflectionMapping,"colorSpace"in n.envMap?n.envMap.colorSpace="srgb":n.envMap.encoding=3001);break;case"SpecularColor":n.specularMap=i.getTexture(t,e.ID),void 0!==n.specularMap&&("colorSpace"in n.specularMap?n.specularMap.colorSpace="srgb":n.specularMap.encoding=3001);break;case"TransparentColor":case"TransparencyFactor":n.alphaMap=i.getTexture(t,e.ID),n.transparent=!0;break;default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",r)}}),n}getTexture(e,t){return"LayeredTexture"in z.Objects&&t in z.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),t=O.get(t).children[0].ID),e.get(t)}parseDeformers(){let e={},t={};if("Deformer"in z.Objects){let r=z.Objects.Deformer;for(let n in r){let i=r[n],a=O.get(parseInt(n));if("Skin"===i.attrType){let t=this.parseSkeleton(a,r);t.ID=n,a.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),t.geometryID=a.parents[0].ID,e[n]=t}else if("BlendShape"===i.attrType){let e={id:n};e.rawTargets=this.parseMorphTargets(a,r),e.id=n,a.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),t[n]=e}}}return{skeletons:e,morphTargets:t}}parseSkeleton(e,t){let r=[];return e.children.forEach(function(e){let n=t[e.ID];if("Cluster"!==n.attrType)return;let i={ID:e.ID,indices:[],weights:[],transformLink:new eQ.Matrix4().fromArray(n.TransformLink.a)};"Indexes"in n&&(i.indices=n.Indexes.a,i.weights=n.Weights.a),r.push(i)}),{rawBones:r,bones:[]}}parseMorphTargets(e,t){let r=[];for(let n=0;n<e.children.length;n++){let i=e.children[n],a=t[i.ID],o={name:a.attrName,initialWeight:a.DeformPercent,id:a.id,fullWeights:a.FullWeights.a};if("BlendShapeChannel"!==a.attrType)return;o.geoID=O.get(parseInt(i.ID)).children.filter(function(e){return void 0===e.relationship})[0].ID,r.push(o)}return r}parseScene(e,t,r){Q=new eQ.Group;let n=this.parseModels(e.skeletons,t,r),i=z.Objects.Model,a=this;n.forEach(function(e){let t=i[e.ID];a.setLookAtProperties(e,t),O.get(e.ID).parents.forEach(function(t){let r=n.get(t.ID);void 0!==r&&r.add(e)}),null===e.parent&&Q.add(e)}),this.bindSkeleton(e.skeletons,t,n),this.createAmbientLight(),Q.traverse(function(e){if(e.userData.transformData){e.parent&&(e.userData.transformData.parentMatrix=e.parent.matrix,e.userData.transformData.parentMatrixWorld=e.parent.matrixWorld);let t=dn(e.userData.transformData);e.applyMatrix4(t),e.updateWorldMatrix()}});let o=new h2().parse();1===Q.children.length&&Q.children[0].isGroup&&(Q.children[0].animations=o,Q=Q.children[0]),Q.animations=o}parseModels(e,t,r){let n=new Map,i=z.Objects.Model;for(let a in i){let o=parseInt(a),s=i[a],l=O.get(o),c=this.buildSkeleton(l,e,o,s.attrName);if(!c){switch(s.attrType){case"Camera":c=this.createCamera(l);break;case"Light":c=this.createLight(l);break;case"Mesh":c=this.createMesh(l,t,r);break;case"NurbsCurve":c=this.createCurve(l,t);break;case"LimbNode":case"Root":c=new eQ.Bone;break;default:c=new eQ.Group}c.name=s.attrName?eQ.PropertyBinding.sanitizeNodeName(s.attrName):"",c.ID=o}this.getTransformData(c,s),n.set(o,c)}return n}buildSkeleton(e,t,r,n){let i=null;return e.parents.forEach(function(e){for(let a in t){let o=t[a];o.rawBones.forEach(function(t,a){if(t.ID===e.ID){let e=i;(i=new eQ.Bone).matrixWorld.copy(t.transformLink),i.name=n?eQ.PropertyBinding.sanitizeNodeName(n):"",i.ID=r,o.bones[a]=i,null!==e&&i.add(e)}})}}),i}createCamera(e){let t,r;if(e.children.forEach(function(e){let t=z.Objects.NodeAttribute[e.ID];void 0!==t&&(r=t)}),void 0===r)t=new eQ.Object3D;else{let e=0;void 0!==r.CameraProjectionType&&1===r.CameraProjectionType.value&&(e=1);let n=1;void 0!==r.NearPlane&&(n=r.NearPlane.value/1e3);let i=1e3;void 0!==r.FarPlane&&(i=r.FarPlane.value/1e3);let a=window.innerWidth,o=window.innerHeight;void 0!==r.AspectWidth&&void 0!==r.AspectHeight&&(a=r.AspectWidth.value,o=r.AspectHeight.value);let s=a/o,l=45;void 0!==r.FieldOfView&&(l=r.FieldOfView.value);let c=r.FocalLength?r.FocalLength.value:null;switch(e){case 0:t=new eQ.PerspectiveCamera(l,s,n,i),null!==c&&t.setFocalLength(c);break;case 1:t=new eQ.OrthographicCamera(-a/2,a/2,o/2,-o/2,n,i);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+e+"."),t=new eQ.Object3D}}return t}createLight(e){let t,r;if(e.children.forEach(function(e){let t=z.Objects.NodeAttribute[e.ID];void 0!==t&&(r=t)}),void 0===r)t=new eQ.Object3D;else{let e;e=void 0===r.LightType?0:r.LightType.value;let n=16777215;void 0!==r.Color&&(n=new eQ.Color().fromArray(r.Color.value));let i=void 0===r.Intensity?1:r.Intensity.value/100;void 0!==r.CastLightOnObject&&0===r.CastLightOnObject.value&&(i=0);let a=0;switch(void 0!==r.FarAttenuationEnd&&(a=void 0!==r.EnableFarAttenuation&&0===r.EnableFarAttenuation.value?0:r.FarAttenuationEnd.value),e){case 0:t=new eQ.PointLight(n,i,a,1);break;case 1:t=new eQ.DirectionalLight(n,i);break;case 2:let o=Math.PI/3;void 0!==r.InnerAngle&&(o=eQ.MathUtils.degToRad(r.InnerAngle.value));let s=0;void 0!==r.OuterAngle&&(s=Math.max(s=eQ.MathUtils.degToRad(r.OuterAngle.value),1)),t=new eQ.SpotLight(n,i,a,o,s,1);break;default:console.warn("THREE.FBXLoader: Unknown light type "+r.LightType.value+", defaulting to a PointLight."),t=new eQ.PointLight(n,i)}void 0!==r.CastShadows&&1===r.CastShadows.value&&(t.castShadow=!0)}return t}createMesh(e,t,r){let n;let i=null,a=null,o=[];return e.children.forEach(function(e){t.has(e.ID)&&(i=t.get(e.ID)),r.has(e.ID)&&o.push(r.get(e.ID))}),o.length>1?a=o:o.length>0?a=o[0]:(a=new eQ.MeshPhongMaterial({color:13421772}),o.push(a)),"color"in i.attributes&&o.forEach(function(e){e.vertexColors=!0}),i.FBX_Deformer?(n=new eQ.SkinnedMesh(i,a)).normalizeSkinWeights():n=new eQ.Mesh(i,a),n}createCurve(e,t){let r=e.children.reduce(function(e,r){return t.has(r.ID)&&(e=t.get(r.ID)),e},null),n=new eQ.LineBasicMaterial({color:3342591,linewidth:1});return new eQ.Line(r,n)}getTransformData(e,t){let r={};"InheritType"in t&&(r.inheritType=parseInt(t.InheritType.value)),"RotationOrder"in t?r.eulerOrder=di(t.RotationOrder.value):r.eulerOrder="ZYX","Lcl_Translation"in t&&(r.translation=t.Lcl_Translation.value),"PreRotation"in t&&(r.preRotation=t.PreRotation.value),"Lcl_Rotation"in t&&(r.rotation=t.Lcl_Rotation.value),"PostRotation"in t&&(r.postRotation=t.PostRotation.value),"Lcl_Scaling"in t&&(r.scale=t.Lcl_Scaling.value),"ScalingOffset"in t&&(r.scalingOffset=t.ScalingOffset.value),"ScalingPivot"in t&&(r.scalingPivot=t.ScalingPivot.value),"RotationOffset"in t&&(r.rotationOffset=t.RotationOffset.value),"RotationPivot"in t&&(r.rotationPivot=t.RotationPivot.value),e.userData.transformData=r}setLookAtProperties(e,t){"LookAtProperty"in t&&O.get(e.ID).children.forEach(function(t){if("LookAtProperty"===t.relationship){let r=z.Objects.Model[t.ID];if("Lcl_Translation"in r){let t=r.Lcl_Translation.value;void 0!==e.target?(e.target.position.fromArray(t),Q.add(e.target)):e.lookAt(new eQ.Vector3().fromArray(t))}}})}bindSkeleton(e,t,r){let n=this.parsePoseNodes();for(let i in e){let a=e[i];O.get(parseInt(a.ID)).parents.forEach(function(e){if(t.has(e.ID)){let t=e.ID;O.get(t).parents.forEach(function(e){r.has(e.ID)&&r.get(e.ID).bind(new eQ.Skeleton(a.bones),n[e.ID])})}})}}parsePoseNodes(){let e={};if("Pose"in z.Objects){let t=z.Objects.Pose;for(let r in t)if("BindPose"===t[r].attrType&&t[r].NbPoseNodes>0){let n=t[r].PoseNode;Array.isArray(n)?n.forEach(function(t){e[t.Node]=new eQ.Matrix4().fromArray(t.Matrix.a)}):e[n.Node]=new eQ.Matrix4().fromArray(n.Matrix.a)}}return e}createAmbientLight(){if("GlobalSettings"in z&&"AmbientColor"in z.GlobalSettings){let e=z.GlobalSettings.AmbientColor.value,t=e[0],r=e[1],n=e[2];if(0!==t||0!==r||0!==n){let e=new eQ.Color(t,r,n);Q.add(new eQ.AmbientLight(e,1))}}}}class h1{parse(e){let t=new Map;if("Geometry"in z.Objects){let r=z.Objects.Geometry;for(let n in r){let i=O.get(parseInt(n)),a=this.parseGeometry(i,r[n],e);t.set(parseInt(n),a)}}return t}parseGeometry(e,t,r){switch(t.attrType){case"Mesh":return this.parseMeshGeometry(e,t,r);case"NurbsCurve":return this.parseNurbsGeometry(t)}}parseMeshGeometry(e,t,r){let n=r.skeletons,i=[],a=e.parents.map(function(e){return z.Objects.Model[e.ID]});if(0===a.length)return;let o=e.children.reduce(function(e,t){return void 0!==n[t.ID]&&(e=n[t.ID]),e},null);e.children.forEach(function(e){void 0!==r.morphTargets[e.ID]&&i.push(r.morphTargets[e.ID])});let s=a[0],l={};"RotationOrder"in s&&(l.eulerOrder=di(s.RotationOrder.value)),"InheritType"in s&&(l.inheritType=parseInt(s.InheritType.value)),"GeometricTranslation"in s&&(l.translation=s.GeometricTranslation.value),"GeometricRotation"in s&&(l.rotation=s.GeometricRotation.value),"GeometricScaling"in s&&(l.scale=s.GeometricScaling.value);let c=dn(l);return this.genGeometry(t,o,i,c)}genGeometry(e,t,r,n){let i=new eQ.BufferGeometry;e.attrName&&(i.name=e.attrName);let a=this.parseGeoNode(e,t),o=this.genBuffers(a),s=new eQ.Float32BufferAttribute(o.vertex,3);if(s.applyMatrix4(n),i.setAttribute("position",s),o.colors.length>0&&i.setAttribute("color",new eQ.Float32BufferAttribute(o.colors,3)),t&&(i.setAttribute("skinIndex",new eQ.Uint16BufferAttribute(o.weightsIndices,4)),i.setAttribute("skinWeight",new eQ.Float32BufferAttribute(o.vertexWeights,4)),i.FBX_Deformer=t),o.normal.length>0){let e=new eQ.Matrix3().getNormalMatrix(n),t=new eQ.Float32BufferAttribute(o.normal,3);t.applyNormalMatrix(e),i.setAttribute("normal",t)}if(o.uvs.forEach(function(e,t){let r="uv"+(t+1).toString();0===t&&(r="uv"),i.setAttribute(r,new eQ.Float32BufferAttribute(o.uvs[t],2))}),a.material&&"AllSame"!==a.material.mappingType){let e=o.materialIndex[0],t=0;if(o.materialIndex.forEach(function(r,n){r!==e&&(i.addGroup(t,n-t,e),e=r,t=n)}),i.groups.length>0){let t=i.groups[i.groups.length-1],r=t.start+t.count;r!==o.materialIndex.length&&i.addGroup(r,o.materialIndex.length-r,e)}0===i.groups.length&&i.addGroup(0,o.materialIndex.length,o.materialIndex[0])}return this.addMorphTargets(i,e,r,n),i}parseGeoNode(e,t){let r={};if(r.vertexPositions=void 0!==e.Vertices?e.Vertices.a:[],r.vertexIndices=void 0!==e.PolygonVertexIndex?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(r.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(r.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(r.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){r.uv=[];let t=0;for(;e.LayerElementUV[t];)e.LayerElementUV[t].UV&&r.uv.push(this.parseUVs(e.LayerElementUV[t])),t++}return r.weightTable={},null!==t&&(r.skeleton=t,t.rawBones.forEach(function(e,t){e.indices.forEach(function(n,i){void 0===r.weightTable[n]&&(r.weightTable[n]=[]),r.weightTable[n].push({id:t,weight:e.weights[i]})})})),r}genBuffers(e){let t={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]},r=0,n=0,i=!1,a=[],o=[],s=[],l=[],c=[],u=[],h=this;return e.vertexIndices.forEach(function(d,f){let p;let m=!1;d<0&&(d^=-1,m=!0);let A=[],g=[];if(a.push(3*d,3*d+1,3*d+2),e.color){let t=de(f,r,d,e.color);s.push(t[0],t[1],t[2])}if(e.skeleton){if(void 0!==e.weightTable[d]&&e.weightTable[d].forEach(function(e){g.push(e.weight),A.push(e.id)}),g.length>4){i||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),i=!0);let e=[0,0,0,0],t=[0,0,0,0];g.forEach(function(r,n){let i=r,a=A[n];t.forEach(function(t,r,n){if(i>t){n[r]=i,i=t;let o=e[r];e[r]=a,a=o}})}),A=e,g=t}for(;g.length<4;)g.push(0),A.push(0);for(let e=0;e<4;++e)c.push(g[e]),u.push(A[e])}if(e.normal){let t=de(f,r,d,e.normal);o.push(t[0],t[1],t[2])}e.material&&"AllSame"!==e.material.mappingType&&(p=de(f,r,d,e.material)[0]),e.uv&&e.uv.forEach(function(e,t){let n=de(f,r,d,e);void 0===l[t]&&(l[t]=[]),l[t].push(n[0]),l[t].push(n[1])}),n++,m&&(h.genFace(t,e,a,p,o,s,l,c,u,n),r++,n=0,a=[],o=[],s=[],l=[],c=[],u=[])}),t}genFace(e,t,r,n,i,a,o,s,l,c){for(let u=2;u<c;u++)e.vertex.push(t.vertexPositions[r[0]]),e.vertex.push(t.vertexPositions[r[1]]),e.vertex.push(t.vertexPositions[r[2]]),e.vertex.push(t.vertexPositions[r[(u-1)*3]]),e.vertex.push(t.vertexPositions[r[(u-1)*3+1]]),e.vertex.push(t.vertexPositions[r[(u-1)*3+2]]),e.vertex.push(t.vertexPositions[r[3*u]]),e.vertex.push(t.vertexPositions[r[3*u+1]]),e.vertex.push(t.vertexPositions[r[3*u+2]]),t.skeleton&&(e.vertexWeights.push(s[0]),e.vertexWeights.push(s[1]),e.vertexWeights.push(s[2]),e.vertexWeights.push(s[3]),e.vertexWeights.push(s[(u-1)*4]),e.vertexWeights.push(s[(u-1)*4+1]),e.vertexWeights.push(s[(u-1)*4+2]),e.vertexWeights.push(s[(u-1)*4+3]),e.vertexWeights.push(s[4*u]),e.vertexWeights.push(s[4*u+1]),e.vertexWeights.push(s[4*u+2]),e.vertexWeights.push(s[4*u+3]),e.weightsIndices.push(l[0]),e.weightsIndices.push(l[1]),e.weightsIndices.push(l[2]),e.weightsIndices.push(l[3]),e.weightsIndices.push(l[(u-1)*4]),e.weightsIndices.push(l[(u-1)*4+1]),e.weightsIndices.push(l[(u-1)*4+2]),e.weightsIndices.push(l[(u-1)*4+3]),e.weightsIndices.push(l[4*u]),e.weightsIndices.push(l[4*u+1]),e.weightsIndices.push(l[4*u+2]),e.weightsIndices.push(l[4*u+3])),t.color&&(e.colors.push(a[0]),e.colors.push(a[1]),e.colors.push(a[2]),e.colors.push(a[(u-1)*3]),e.colors.push(a[(u-1)*3+1]),e.colors.push(a[(u-1)*3+2]),e.colors.push(a[3*u]),e.colors.push(a[3*u+1]),e.colors.push(a[3*u+2])),t.material&&"AllSame"!==t.material.mappingType&&(e.materialIndex.push(n),e.materialIndex.push(n),e.materialIndex.push(n)),t.normal&&(e.normal.push(i[0]),e.normal.push(i[1]),e.normal.push(i[2]),e.normal.push(i[(u-1)*3]),e.normal.push(i[(u-1)*3+1]),e.normal.push(i[(u-1)*3+2]),e.normal.push(i[3*u]),e.normal.push(i[3*u+1]),e.normal.push(i[3*u+2])),t.uv&&t.uv.forEach(function(t,r){void 0===e.uvs[r]&&(e.uvs[r]=[]),e.uvs[r].push(o[r][0]),e.uvs[r].push(o[r][1]),e.uvs[r].push(o[r][(u-1)*2]),e.uvs[r].push(o[r][(u-1)*2+1]),e.uvs[r].push(o[r][2*u]),e.uvs[r].push(o[r][2*u+1])})}addMorphTargets(e,t,r,n){if(0===r.length)return;e.morphTargetsRelative=!0,e.morphAttributes.position=[];let i=this;r.forEach(function(r){r.rawTargets.forEach(function(r){let a=z.Objects.Geometry[r.geoID];void 0!==a&&i.genMorphGeometry(e,t,a,n,r.name)})})}genMorphGeometry(e,t,r,n,i){let a=void 0!==t.PolygonVertexIndex?t.PolygonVertexIndex.a:[],o=void 0!==r.Vertices?r.Vertices.a:[],s=void 0!==r.Indexes?r.Indexes.a:[],l=new Float32Array(3*e.attributes.position.count);for(let e=0;e<s.length;e++){let t=3*s[e];l[t]=o[3*e],l[t+1]=o[3*e+1],l[t+2]=o[3*e+2]}let c=this.genBuffers({vertexIndices:a,vertexPositions:l}),u=new eQ.Float32BufferAttribute(c.vertex,3);u.name=i||r.attrName,u.applyMatrix4(n),e.morphAttributes.position.push(u)}parseNormals(e){let t=e.MappingInformationType,r=e.ReferenceInformationType,n=e.Normals.a,i=[];return"IndexToDirect"===r&&("NormalIndex"in e?i=e.NormalIndex.a:"NormalsIndex"in e&&(i=e.NormalsIndex.a)),{dataSize:3,buffer:n,indices:i,mappingType:t,referenceType:r}}parseUVs(e){let t=e.MappingInformationType,r=e.ReferenceInformationType,n=e.UV.a,i=[];return"IndexToDirect"===r&&(i=e.UVIndex.a),{dataSize:2,buffer:n,indices:i,mappingType:t,referenceType:r}}parseVertexColors(e){let t=e.MappingInformationType,r=e.ReferenceInformationType,n=e.Colors.a,i=[];return"IndexToDirect"===r&&(i=e.ColorIndex.a),{dataSize:4,buffer:n,indices:i,mappingType:t,referenceType:r}}parseMaterialIndices(e){let t=e.MappingInformationType,r=e.ReferenceInformationType;if("NoMappingInformation"===t)return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:r};let n=e.Materials.a,i=[];for(let e=0;e<n.length;++e)i.push(e);return{dataSize:1,buffer:n,indices:i,mappingType:t,referenceType:r}}parseNurbsGeometry(e){let t,r;if(void 0===hZ)return console.error("THREE.FBXLoader: The loader relies on NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new eQ.BufferGeometry;let n=parseInt(e.Order);if(isNaN(n))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new eQ.BufferGeometry;let i=n-1,a=e.KnotVector.a,o=[],s=e.Points.a;for(let e=0,t=s.length;e<t;e+=4)o.push(new eQ.Vector4().fromArray(s,e));if("Closed"===e.Form)o.push(o[0]);else if("Periodic"===e.Form){t=i,r=a.length-1-t;for(let e=0;e<i;++e)o.push(o[e])}let l=new hZ(i,a,o,t,r).getPoints(12*o.length);return new eQ.BufferGeometry().setFromPoints(l)}}class h2{parse(){let e=[],t=this.parseClips();if(void 0!==t)for(let r in t){let n=t[r],i=this.addClip(n);e.push(i)}return e}parseClips(){if(void 0===z.Objects.AnimationCurve)return;let e=this.parseAnimationCurveNodes();this.parseAnimationCurves(e);let t=this.parseAnimationLayers(e);return this.parseAnimStacks(t)}parseAnimationCurveNodes(){let e=z.Objects.AnimationCurveNode,t=new Map;for(let r in e){let n=e[r];if(null!==n.attrName.match(/S|R|T|DeformPercent/)){let e={id:n.id,attr:n.attrName,curves:{}};t.set(e.id,e)}}return t}parseAnimationCurves(e){let t=z.Objects.AnimationCurve;for(let r in t){let n={id:t[r].id,times:t[r].KeyTime.a.map(h9),values:t[r].KeyValueFloat.a},i=O.get(n.id);if(void 0!==i){let t=i.parents[0].ID,r=i.parents[0].relationship;r.match(/X/)?e.get(t).curves.x=n:r.match(/Y/)?e.get(t).curves.y=n:r.match(/Z/)?e.get(t).curves.z=n:r.match(/d|DeformPercent/)&&e.has(t)&&(e.get(t).curves.morph=n)}}}parseAnimationLayers(e){let t=z.Objects.AnimationLayer,r=new Map;for(let n in t){let t=[],i=O.get(parseInt(n));void 0!==i&&(i.children.forEach(function(r,n){if(e.has(r.ID)){let i=e.get(r.ID);if(void 0!==i.curves.x||void 0!==i.curves.y||void 0!==i.curves.z){if(void 0===t[n]){let e=O.get(r.ID).parents.filter(function(e){return void 0!==e.relationship})[0].ID;if(void 0!==e){let i=z.Objects.Model[e.toString()];if(void 0===i){console.warn("THREE.FBXLoader: Encountered a unused curve.",r);return}let a={modelName:i.attrName?eQ.PropertyBinding.sanitizeNodeName(i.attrName):"",ID:i.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};Q.traverse(function(e){e.ID===i.id&&(a.transform=e.matrix,e.userData.transformData&&(a.eulerOrder=e.userData.transformData.eulerOrder))}),a.transform||(a.transform=new eQ.Matrix4),"PreRotation"in i&&(a.preRotation=i.PreRotation.value),"PostRotation"in i&&(a.postRotation=i.PostRotation.value),t[n]=a}}t[n]&&(t[n][i.attr]=i)}else if(void 0!==i.curves.morph){if(void 0===t[n]){let e=O.get(r.ID).parents.filter(function(e){return void 0!==e.relationship})[0].ID,i=O.get(e).parents[0].ID,a=O.get(i).parents[0].ID,o=O.get(a).parents[0].ID,s=z.Objects.Model[o],l={modelName:s.attrName?eQ.PropertyBinding.sanitizeNodeName(s.attrName):"",morphName:z.Objects.Deformer[e].attrName};t[n]=l}t[n][i.attr]=i}}}),r.set(parseInt(n),t))}return r}parseAnimStacks(e){let t=z.Objects.AnimationStack,r={};for(let n in t){let i=O.get(parseInt(n)).children;i.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");let a=e.get(i[0].ID);r[n]={name:t[n].attrName,layer:a}}return r}addClip(e){let t=[],r=this;return e.layer.forEach(function(e){t=t.concat(r.generateTracks(e))}),new eQ.AnimationClip(e.name,-1,t)}generateTracks(e){let t=[],r=new eQ.Vector3,n=new eQ.Quaternion,i=new eQ.Vector3;if(e.transform&&e.transform.decompose(r,n,i),r=r.toArray(),n=new eQ.Euler().setFromQuaternion(n,e.eulerOrder).toArray(),i=i.toArray(),void 0!==e.T&&Object.keys(e.T.curves).length>0){let n=this.generateVectorTrack(e.modelName,e.T.curves,r,"position");void 0!==n&&t.push(n)}if(void 0!==e.R&&Object.keys(e.R.curves).length>0){let r=this.generateRotationTrack(e.modelName,e.R.curves,n,e.preRotation,e.postRotation,e.eulerOrder);void 0!==r&&t.push(r)}if(void 0!==e.S&&Object.keys(e.S.curves).length>0){let r=this.generateVectorTrack(e.modelName,e.S.curves,i,"scale");void 0!==r&&t.push(r)}if(void 0!==e.DeformPercent){let r=this.generateMorphTrack(e);void 0!==r&&t.push(r)}return t}generateVectorTrack(e,t,r,n){let i=this.getTimesForAllAxes(t),a=this.getKeyframeTrackValues(i,t,r);return new eQ.VectorKeyframeTrack(e+"."+n,i,a)}generateRotationTrack(e,t,r,n,i,a){void 0!==t.x&&(this.interpolateRotations(t.x),t.x.values=t.x.values.map(eQ.MathUtils.degToRad)),void 0!==t.y&&(this.interpolateRotations(t.y),t.y.values=t.y.values.map(eQ.MathUtils.degToRad)),void 0!==t.z&&(this.interpolateRotations(t.z),t.z.values=t.z.values.map(eQ.MathUtils.degToRad));let o=this.getTimesForAllAxes(t),s=this.getKeyframeTrackValues(o,t,r);void 0!==n&&((n=n.map(eQ.MathUtils.degToRad)).push(a),n=new eQ.Euler().fromArray(n),n=new eQ.Quaternion().setFromEuler(n)),void 0!==i&&((i=i.map(eQ.MathUtils.degToRad)).push(a),i=new eQ.Euler().fromArray(i),i=new eQ.Quaternion().setFromEuler(i).invert());let l=new eQ.Quaternion,c=new eQ.Euler,u=[];for(let e=0;e<s.length;e+=3)c.set(s[e],s[e+1],s[e+2],a),l.setFromEuler(c),void 0!==n&&l.premultiply(n),void 0!==i&&l.multiply(i),l.toArray(u,e/3*4);return new eQ.QuaternionKeyframeTrack(e+".quaternion",o,u)}generateMorphTrack(e){let t=e.DeformPercent.curves.morph,r=t.values.map(function(e){return e/100}),n=Q.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return new eQ.NumberKeyframeTrack(e.modelName+".morphTargetInfluences["+n+"]",t.times,r)}getTimesForAllAxes(e){let t=[];if(void 0!==e.x&&(t=t.concat(e.x.times)),void 0!==e.y&&(t=t.concat(e.y.times)),void 0!==e.z&&(t=t.concat(e.z.times)),(t=t.sort(function(e,t){return e-t})).length>1){let e=1,r=t[0];for(let n=1;n<t.length;n++){let i=t[n];i!==r&&(t[e]=i,r=i,e++)}t=t.slice(0,e)}return t}getKeyframeTrackValues(e,t,r){let n=[],i=-1,a=-1,o=-1;return e.forEach(function(e){if(t.x&&(i=t.x.times.indexOf(e)),t.y&&(a=t.y.times.indexOf(e)),t.z&&(o=t.z.times.indexOf(e)),-1!==i){let e=t.x.values[i];n.push(e),r[0]=e}else n.push(r[0]);if(-1!==a){let e=t.y.values[a];n.push(e),r[1]=e}else n.push(r[1]);if(-1!==o){let e=t.z.values[o];n.push(e),r[2]=e}else n.push(r[2])}),n}interpolateRotations(e){for(let t=1;t<e.values.length;t++){let r=e.values[t-1],n=e.values[t]-r,i=Math.abs(n);if(i>=180){let a=i/180,o=n/a,s=r+o,l=e.times[t-1],c=(e.times[t]-l)/a,u=l+c,h=[],d=[];for(;u<e.times[t];)h.push(u),u+=c,d.push(s),s+=o;e.times=dl(e.times,t,h),e.values=dl(e.values,t,d)}}}}class h3{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(e){this.nodeStack.push(e),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(e,t){this.currentProp=e,this.currentPropName=t}parse(e){this.currentIndent=0,this.allNodes=new h6,this.nodeStack=[],this.currentProp=[],this.currentPropName="";let t=this,r=e.split(/[\r\n]+/);return r.forEach(function(e,n){let i=e.match(/^[\s\t]*;/),a=e.match(/^[\s\t]*$/);if(i||a)return;let o=e.match("^\\t{"+t.currentIndent+"}(\\w+):(.*){",""),s=e.match("^\\t{"+t.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),l=e.match("^\\t{"+(t.currentIndent-1)+"}}");o?t.parseNodeBegin(e,o):s?t.parseNodeProperty(e,s,r[++n]):l?t.popStack():e.match(/^[^\s\t}]/)&&t.parseNodePropertyContinued(e)}),this.allNodes}parseNodeBegin(e,t){let r=t[1].trim().replace(/^"/,"").replace(/"$/,""),n=t[2].split(",").map(function(e){return e.trim().replace(/^"/,"").replace(/"$/,"")}),i={name:r},a=this.parseNodeAttr(n),o=this.getCurrentNode();0===this.currentIndent?this.allNodes.add(r,i):r in o?("PoseNode"===r?o.PoseNode.push(i):void 0!==o[r].id&&(o[r]={},o[r][o[r].id]=o[r]),""!==a.id&&(o[r][a.id]=i)):"number"==typeof a.id?(o[r]={},o[r][a.id]=i):"Properties70"!==r&&("PoseNode"===r?o[r]=[i]:o[r]=i),"number"==typeof a.id&&(i.id=a.id),""!==a.name&&(i.attrName=a.name),""!==a.type&&(i.attrType=a.type),this.pushStack(i)}parseNodeAttr(e){let t=e[0];""!==e[0]&&isNaN(t=parseInt(e[0]))&&(t=e[0]);let r="",n="";return e.length>1&&(r=e[1].replace(/^(\w+)::/,""),n=e[2]),{id:t,name:r,type:n}}parseNodeProperty(e,t,r){let n=t[1].replace(/^"/,"").replace(/"$/,"").trim(),i=t[2].replace(/^"/,"").replace(/"$/,"").trim();"Content"===n&&","===i&&(i=r.replace(/"/g,"").replace(/,$/,"").trim());let a=this.getCurrentNode();if("Properties70"===a.name){this.parseNodeSpecialProperty(e,n,i);return}if("C"===n){let e=i.split(",").slice(1),t=parseInt(e[0]),r=parseInt(e[1]),o=i.split(",").slice(3);o=o.map(function(e){return e.trim().replace(/^"/,"")}),n="connections",function(e,t){for(let r=0,n=e.length,i=t.length;r<i;r++,n++)e[n]=t[r]}(i=[t,r],o),void 0===a[n]&&(a[n]=[])}"Node"===n&&(a.id=i),n in a&&Array.isArray(a[n])?a[n].push(i):"a"!==n?a[n]=i:a.a=i,this.setCurrentProp(a,n),"a"===n&&","!==i.slice(-1)&&(a.a=da(i))}parseNodePropertyContinued(e){let t=this.getCurrentNode();t.a+=e,","!==e.slice(-1)&&(t.a=da(t.a))}parseNodeSpecialProperty(e,t,r){let n=r.split('",').map(function(e){return e.trim().replace(/^\"/,"").replace(/\s/,"_")}),i=n[0],a=n[1],o=n[2],s=n[3],l=n[4];switch(a){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":l=parseFloat(l);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":l=da(l)}this.getPrevNode()[i]={type:a,type2:o,flag:s,value:l},this.setCurrentProp(this.getPrevNode(),i)}}class h4{parse(e){let t=new h5(e);t.skip(23);let r=t.getUint32();if(r<6400)throw Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+r);let n=new h6;for(;!this.endOfContent(t);){let e=this.parseNode(t,r);null!==e&&n.add(e.name,e)}return n}endOfContent(e){return e.size()%16==0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()}parseNode(e,t){let r={},n=t>=7500?e.getUint64():e.getUint32(),i=t>=7500?e.getUint64():e.getUint32();t>=7500?e.getUint64():e.getUint32();let a=e.getUint8(),o=e.getString(a);if(0===n)return null;let s=[];for(let t=0;t<i;t++)s.push(this.parseProperty(e));let l=s.length>0?s[0]:"",c=s.length>1?s[1]:"",u=s.length>2?s[2]:"";for(r.singleProperty=1===i&&e.getOffset()===n;n>e.getOffset();){let n=this.parseNode(e,t);null!==n&&this.parseSubNode(o,r,n)}return r.propertyList=s,"number"==typeof l&&(r.id=l),""!==c&&(r.attrName=c),""!==u&&(r.attrType=u),""!==o&&(r.name=o),r}parseSubNode(e,t,r){if(!0===r.singleProperty){let e=r.propertyList[0];Array.isArray(e)?(t[r.name]=r,r.a=e):t[r.name]=e}else if("Connections"===e&&"C"===r.name){let e=[];r.propertyList.forEach(function(t,r){0!==r&&e.push(t)}),void 0===t.connections&&(t.connections=[]),t.connections.push(e)}else if("Properties70"===r.name)Object.keys(r).forEach(function(e){t[e]=r[e]});else if("Properties70"===e&&"P"===r.name){let e,n=r.propertyList[0],i=r.propertyList[1],a=r.propertyList[2],o=r.propertyList[3];0===n.indexOf("Lcl ")&&(n=n.replace("Lcl ","Lcl_")),0===i.indexOf("Lcl ")&&(i=i.replace("Lcl ","Lcl_")),e="Color"===i||"ColorRGB"===i||"Vector"===i||"Vector3D"===i||0===i.indexOf("Lcl_")?[r.propertyList[4],r.propertyList[5],r.propertyList[6]]:r.propertyList[4],t[n]={type:i,type2:a,flag:o,value:e}}else void 0===t[r.name]?"number"==typeof r.id?(t[r.name]={},t[r.name][r.id]=r):t[r.name]=r:"PoseNode"===r.name?(Array.isArray(t[r.name])||(t[r.name]=[t[r.name]]),t[r.name].push(r)):void 0===t[r.name][r.id]&&(t[r.name][r.id]=r)}parseProperty(e){let t;let r=e.getString(1);switch(r){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":return t=e.getUint32(),e.getArrayBuffer(t);case"S":return t=e.getUint32(),e.getString(t);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":let n=e.getUint32(),i=e.getUint32(),a=e.getUint32();if(0===i)switch(r){case"b":case"c":return e.getBooleanArray(n);case"d":return e.getFloat64Array(n);case"f":return e.getFloat32Array(n);case"i":return e.getInt32Array(n);case"l":return e.getInt64Array(n)}let o=new h5(hq(new Uint8Array(e.getArrayBuffer(a))).buffer);switch(r){case"b":case"c":return o.getBooleanArray(n);case"d":return o.getFloat64Array(n);case"f":return o.getFloat32Array(n);case"i":return o.getInt32Array(n);case"l":return o.getInt64Array(n)}default:throw Error("THREE.FBXLoader: Unknown property type "+r)}}}class h5{constructor(e,t){this.dv=new DataView(e),this.offset=0,this.littleEndian=void 0===t||t}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(e){this.offset+=e}getBoolean(){return(1&this.getUint8())==1}getBooleanArray(e){let t=[];for(let r=0;r<e;r++)t.push(this.getBoolean());return t}getUint8(){let e=this.dv.getUint8(this.offset);return this.offset+=1,e}getInt16(){let e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}getInt32(){let e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}getInt32Array(e){let t=[];for(let r=0;r<e;r++)t.push(this.getInt32());return t}getUint32(){let e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}getInt64(){let e,t;return(this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),2147483648&t)?(t=4294967295&~t,4294967295==(e=4294967295&~e)&&(t=t+1&4294967295),-(4294967296*t+(e=e+1&4294967295))):4294967296*t+e}getInt64Array(e){let t=[];for(let r=0;r<e;r++)t.push(this.getInt64());return t}getUint64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),4294967296*t+e}getFloat32(){let e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}getFloat32Array(e){let t=[];for(let r=0;r<e;r++)t.push(this.getFloat32());return t}getFloat64(){let e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}getFloat64Array(e){let t=[];for(let r=0;r<e;r++)t.push(this.getFloat64());return t}getArrayBuffer(e){let t=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}getString(e){let t=[];for(let r=0;r<e;r++)t[r]=this.getUint8();let r=t.indexOf(0);return r>=0&&(t=t.slice(0,r)),lo(new Uint8Array(t))}}class h6{add(e,t){this[e]=t}}function h8(e){let t=e.match(/FBXVersion: (\d+)/);if(t)return parseInt(t[1]);throw Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function h9(e){return e/46186158e3}let h7=[];function de(e,t,r,n){let i;switch(n.mappingType){case"ByPolygonVertex":i=e;break;case"ByPolygon":i=t;break;case"ByVertice":i=r;break;case"AllSame":i=n.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+n.mappingType)}"IndexToDirect"===n.referenceType&&(i=n.indices[i]);let a=i*n.dataSize,o=a+n.dataSize;return function(e,t,r,n){for(let i=r,a=0;i<n;i++,a++)e[a]=t[i];return e}(h7,n.buffer,a,o)}let dt=new eQ.Euler,dr=new eQ.Vector3;function dn(e){let t=new eQ.Matrix4,r=new eQ.Matrix4,n=new eQ.Matrix4,i=new eQ.Matrix4,a=new eQ.Matrix4,o=new eQ.Matrix4,s=new eQ.Matrix4,l=new eQ.Matrix4,c=new eQ.Matrix4,u=new eQ.Matrix4,h=new eQ.Matrix4,d=new eQ.Matrix4,f=e.inheritType?e.inheritType:0;if(e.translation&&t.setPosition(dr.fromArray(e.translation)),e.preRotation){let t=e.preRotation.map(eQ.MathUtils.degToRad);t.push(e.eulerOrder),r.makeRotationFromEuler(dt.fromArray(t))}if(e.rotation){let t=e.rotation.map(eQ.MathUtils.degToRad);t.push(e.eulerOrder),n.makeRotationFromEuler(dt.fromArray(t))}if(e.postRotation){let t=e.postRotation.map(eQ.MathUtils.degToRad);t.push(e.eulerOrder),i.makeRotationFromEuler(dt.fromArray(t)),i.invert()}e.scale&&a.scale(dr.fromArray(e.scale)),e.scalingOffset&&s.setPosition(dr.fromArray(e.scalingOffset)),e.scalingPivot&&o.setPosition(dr.fromArray(e.scalingPivot)),e.rotationOffset&&l.setPosition(dr.fromArray(e.rotationOffset)),e.rotationPivot&&c.setPosition(dr.fromArray(e.rotationPivot)),e.parentMatrixWorld&&(h.copy(e.parentMatrix),u.copy(e.parentMatrixWorld));let p=r.clone().multiply(n).multiply(i),m=new eQ.Matrix4;m.extractRotation(u);let A=new eQ.Matrix4;A.copyPosition(u);let g=A.clone().invert().multiply(u),v=m.clone().invert().multiply(g),y=new eQ.Matrix4;if(0===f)y.copy(m).multiply(p).multiply(v).multiply(a);else if(1===f)y.copy(m).multiply(v).multiply(p).multiply(a);else{let e=new eQ.Matrix4().scale(new eQ.Vector3().setFromMatrixScale(h)).clone().invert(),t=v.clone().multiply(e);y.copy(m).multiply(p).multiply(t).multiply(a)}let x=c.clone().invert(),E=o.clone().invert(),_=t.clone().multiply(l).multiply(c).multiply(r).multiply(n).multiply(i).multiply(x).multiply(s).multiply(o).multiply(a).multiply(E),C=new eQ.Matrix4().copyPosition(_),b=u.clone().multiply(C);return d.copyPosition(b),(_=d.clone().multiply(y)).premultiply(u.invert()),_}function di(e){return 6===(e=e||0)?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),"ZYX"):["ZYX","YZX","XZY","ZXY","YXZ","XYZ"][e]}function da(e){return e.split(",").map(function(e){return parseFloat(e)})}function ds(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=e.byteLength),lo(new Uint8Array(e,t,r))}function dl(e,t,r){return e.slice(0,t).concat(r).concat(e.slice(t))}function dc(e){return(0,eL.F)(h$,e)}function du({path:e,...t}){let r=dc(e).children[0];return ez.createElement(sX,ee({},t,{object:r}))}dc.preload=e=>eL.F.preload(h$,e),dc.clear=e=>eL.F.clear(h$,e);class dh{constructor(e=4){this.pool=e,this.queue=[],this.workers=[],this.workersResolve=[],this.workerStatus=0}_initWorker(e){if(!this.workers[e]){let t=this.workerCreator();t.addEventListener("message",this._onMessage.bind(this,e)),this.workers[e]=t}}_getIdleWorker(){for(let e=0;e<this.pool;e++)if(!(this.workerStatus&1<<e))return e;return -1}_onMessage(e,t){let r=this.workersResolve[e];if(r&&r(t),this.queue.length){let{resolve:t,msg:r,transfer:n}=this.queue.shift();this.workersResolve[e]=t,this.workers[e].postMessage(r,n)}else this.workerStatus^=1<<e}setWorkerCreator(e){this.workerCreator=e}setWorkerLimit(e){this.pool=e}postMessage(e,t){return new Promise(r=>{let n=this._getIdleWorker();-1!==n?(this._initWorker(n),this.workerStatus|=1<<n,this.workersResolve[n]=r,this.workers[n].postMessage(e,t)):this.queue.push({resolve:r,msg:e,transfer:t})})}dispose(){this.workers.forEach(e=>e.terminate()),this.workersResolve.length=0,this.workers.length=0,this.queue.length=0,this.workerStatus=0}}var dd=r(9109).lW;class df{constructor(){this.vkFormat=0,this.typeSize=1,this.pixelWidth=0,this.pixelHeight=0,this.pixelDepth=0,this.layerCount=0,this.faceCount=1,this.supercompressionScheme=0,this.levels=[],this.dataFormatDescriptor=[{vendorId:0,descriptorType:0,descriptorBlockSize:0,versionNumber:2,colorModel:0,colorPrimaries:1,transferFunction:2,flags:0,texelBlockDimension:[0,0,0,0],bytesPlane:[0,0,0,0,0,0,0,0],samples:[]}],this.keyValue={},this.globalData=null}}class dp{constructor(e,t,r,n){this._dataView=void 0,this._littleEndian=void 0,this._offset=void 0,this._dataView=new DataView(e.buffer,e.byteOffset+t,r),this._littleEndian=n,this._offset=0}_nextUint8(){let e=this._dataView.getUint8(this._offset);return this._offset+=1,e}_nextUint16(){let e=this._dataView.getUint16(this._offset,this._littleEndian);return this._offset+=2,e}_nextUint32(){let e=this._dataView.getUint32(this._offset,this._littleEndian);return this._offset+=4,e}_nextUint64(){let e=this._dataView.getUint32(this._offset,this._littleEndian),t=this._dataView.getUint32(this._offset+4,this._littleEndian);return this._offset+=8,e+4294967296*t}_nextInt32(){let e=this._dataView.getInt32(this._offset,this._littleEndian);return this._offset+=4,e}_nextUint8Array(e){let t=new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+this._offset,e);return this._offset+=e,t}_skip(e){return this._offset+=e,this}_scan(e,t){void 0===t&&(t=0);let r=this._offset,n=0;for(;this._dataView.getUint8(this._offset)!==t&&n<e;)n++,this._offset++;return n<e&&this._offset++,new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+r,n)}}let dm=[171,75,84,88,32,50,48,187,13,10,26,10];function dA(e){return"undefined"!=typeof TextDecoder?new TextDecoder().decode(e):dd.from(e).toString("utf8")}var dg=r(9109).lW;let dv={env:{emscripten_notify_memory_growth:function(e){U=new Uint8Array(k.exports.memory.buffer)}}};class dy{init(){return L||("undefined"!=typeof fetch?L=fetch("data:application/wasm;base64,"+dx).then(e=>e.arrayBuffer()).then(e=>WebAssembly.instantiate(e,dv)).then(this._init):L=WebAssembly.instantiate(dg.from(dx,"base64"),dv).then(this._init)),L}_init(e){k=e.instance,dv.env.emscripten_notify_memory_growth(0)}decode(e,t=0){if(!k)throw Error("ZSTDDecoder: Await .init() before decoding.");let r=e.byteLength,n=k.exports.malloc(r);U.set(e,n),t=t||Number(k.exports.ZSTD_findDecompressedSize(n,r));let i=k.exports.malloc(t),a=k.exports.ZSTD_decompress(i,t,n,r),o=U.slice(i,i+a);return k.exports.free(n),k.exports.free(i),o}}let dx="AGFzbQEAAAABpQEVYAF/AX9gAn9/AGADf39/AX9gBX9/f39/AX9gAX8AYAJ/fwF/YAR/f39/AX9gA39/fwBgBn9/f39/fwF/YAd/f39/f39/AX9gAn9/AX5gAn5+AX5gAABgBX9/f39/AGAGf39/f39/AGAIf39/f39/f38AYAl/f39/f39/f38AYAABf2AIf39/f39/f38Bf2ANf39/f39/f39/f39/fwF/YAF/AX4CJwEDZW52H2Vtc2NyaXB0ZW5fbm90aWZ5X21lbW9yeV9ncm93dGgABANpaAEFAAAFAgEFCwACAQABAgIFBQcAAwABDgsBAQcAEhMHAAUBDAQEAAANBwQCAgYCBAgDAwMDBgEACQkHBgICAAYGAgQUBwYGAwIGAAMCAQgBBwUGCgoEEQAEBAEIAwgDBQgDEA8IAAcABAUBcAECAgUEAQCAAgYJAX8BQaCgwAILB2AHBm1lbW9yeQIABm1hbGxvYwAoBGZyZWUAJgxaU1REX2lzRXJyb3IAaBlaU1REX2ZpbmREZWNvbXByZXNzZWRTaXplAFQPWlNURF9kZWNvbXByZXNzAEoGX3N0YXJ0ACQJBwEAQQELASQKussBaA8AIAAgACgCBCABajYCBAsZACAAKAIAIAAoAgRBH3F0QQAgAWtBH3F2CwgAIABBiH9LC34BBH9BAyEBIAAoAgQiA0EgTQRAIAAoAggiASAAKAIQTwRAIAAQDQ8LIAAoAgwiAiABRgRAQQFBAiADQSBJGw8LIAAgASABIAJrIANBA3YiBCABIARrIAJJIgEbIgJrIgQ2AgggACADIAJBA3RrNgIEIAAgBCgAADYCAAsgAQsUAQF/IAAgARACIQIgACABEAEgAgv3AQECfyACRQRAIABCADcCACAAQQA2AhAgAEIANwIIQbh/DwsgACABNgIMIAAgAUEEajYCECACQQRPBEAgACABIAJqIgFBfGoiAzYCCCAAIAMoAAA2AgAgAUF/ai0AACIBBEAgAEEIIAEQFGs2AgQgAg8LIABBADYCBEF/DwsgACABNgIIIAAgAS0AACIDNgIAIAJBfmoiBEEBTQRAIARBAWtFBEAgACABLQACQRB0IANyIgM2AgALIAAgAS0AAUEIdCADajYCAAsgASACakF/ai0AACIBRQRAIABBADYCBEFsDwsgAEEoIAEQFCACQQN0ams2AgQgAgsWACAAIAEpAAA3AAAgACABKQAINwAICy8BAX8gAUECdEGgHWooAgAgACgCAEEgIAEgACgCBGprQR9xdnEhAiAAIAEQASACCyEAIAFCz9bTvtLHq9lCfiAAfEIfiUKHla+vmLbem55/fgsdAQF/IAAoAgggACgCDEYEfyAAKAIEQSBGBUEACwuCBAEDfyACQYDAAE8EQCAAIAEgAhBnIAAPCyAAIAJqIQMCQCAAIAFzQQNxRQRAAkAgAkEBSARAIAAhAgwBCyAAQQNxRQRAIAAhAgwBCyAAIQIDQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADTw0BIAJBA3ENAAsLAkAgA0F8cSIEQcAASQ0AIAIgBEFAaiIFSw0AA0AgAiABKAIANgIAIAIgASgCBDYCBCACIAEoAgg2AgggAiABKAIMNgIMIAIgASgCEDYCECACIAEoAhQ2AhQgAiABKAIYNgIYIAIgASgCHDYCHCACIAEoAiA2AiAgAiABKAIkNgIkIAIgASgCKDYCKCACIAEoAiw2AiwgAiABKAIwNgIwIAIgASgCNDYCNCACIAEoAjg2AjggAiABKAI8NgI8IAFBQGshASACQUBrIgIgBU0NAAsLIAIgBE8NAQNAIAIgASgCADYCACABQQRqIQEgAkEEaiICIARJDQALDAELIANBBEkEQCAAIQIMAQsgA0F8aiIEIABJBEAgACECDAELIAAhAgNAIAIgAS0AADoAACACIAEtAAE6AAEgAiABLQACOgACIAIgAS0AAzoAAyABQQRqIQEgAkEEaiICIARNDQALCyACIANJBEADQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADRw0ACwsgAAsMACAAIAEpAAA3AAALQQECfyAAKAIIIgEgACgCEEkEQEEDDwsgACAAKAIEIgJBB3E2AgQgACABIAJBA3ZrIgE2AgggACABKAAANgIAQQALDAAgACABKAIANgAAC/cCAQJ/AkAgACABRg0AAkAgASACaiAASwRAIAAgAmoiBCABSw0BCyAAIAEgAhALDwsgACABc0EDcSEDAkACQCAAIAFJBEAgAwRAIAAhAwwDCyAAQQNxRQRAIAAhAwwCCyAAIQMDQCACRQ0EIAMgAS0AADoAACABQQFqIQEgAkF/aiECIANBAWoiA0EDcQ0ACwwBCwJAIAMNACAEQQNxBEADQCACRQ0FIAAgAkF/aiICaiIDIAEgAmotAAA6AAAgA0EDcQ0ACwsgAkEDTQ0AA0AgACACQXxqIgJqIAEgAmooAgA2AgAgAkEDSw0ACwsgAkUNAgNAIAAgAkF/aiICaiABIAJqLQAAOgAAIAINAAsMAgsgAkEDTQ0AIAIhBANAIAMgASgCADYCACABQQRqIQEgA0EEaiEDIARBfGoiBEEDSw0ACyACQQNxIQILIAJFDQADQCADIAEtAAA6AAAgA0EBaiEDIAFBAWohASACQX9qIgINAAsLIAAL8wICAn8BfgJAIAJFDQAgACACaiIDQX9qIAE6AAAgACABOgAAIAJBA0kNACADQX5qIAE6AAAgACABOgABIANBfWogAToAACAAIAE6AAIgAkEHSQ0AIANBfGogAToAACAAIAE6AAMgAkEJSQ0AIABBACAAa0EDcSIEaiIDIAFB/wFxQYGChAhsIgE2AgAgAyACIARrQXxxIgRqIgJBfGogATYCACAEQQlJDQAgAyABNgIIIAMgATYCBCACQXhqIAE2AgAgAkF0aiABNgIAIARBGUkNACADIAE2AhggAyABNgIUIAMgATYCECADIAE2AgwgAkFwaiABNgIAIAJBbGogATYCACACQWhqIAE2AgAgAkFkaiABNgIAIAQgA0EEcUEYciIEayICQSBJDQAgAa0iBUIghiAFhCEFIAMgBGohAQNAIAEgBTcDGCABIAU3AxAgASAFNwMIIAEgBTcDACABQSBqIQEgAkFgaiICQR9LDQALCyAACy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAIajYCACADCy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAFajYCACADCx8AIAAgASACKAIEEAg2AgAgARAEGiAAIAJBCGo2AgQLCAAgAGdBH3MLugUBDX8jAEEQayIKJAACfyAEQQNNBEAgCkEANgIMIApBDGogAyAEEAsaIAAgASACIApBDGpBBBAVIgBBbCAAEAMbIAAgACAESxsMAQsgAEEAIAEoAgBBAXRBAmoQECENQVQgAygAACIGQQ9xIgBBCksNABogAiAAQQVqNgIAIAMgBGoiAkF8aiEMIAJBeWohDiACQXtqIRAgAEEGaiELQQQhBSAGQQR2IQRBICAAdCIAQQFyIQkgASgCACEPQQAhAiADIQYCQANAIAlBAkggAiAPS3JFBEAgAiEHAkAgCARAA0AgBEH//wNxQf//A0YEQCAHQRhqIQcgBiAQSQR/IAZBAmoiBigAACAFdgUgBUEQaiEFIARBEHYLIQQMAQsLA0AgBEEDcSIIQQNGBEAgBUECaiEFIARBAnYhBCAHQQNqIQcMAQsLIAcgCGoiByAPSw0EIAVBAmohBQNAIAIgB0kEQCANIAJBAXRqQQA7AQAgAkEBaiECDAELCyAGIA5LQQAgBiAFQQN1aiIHIAxLG0UEQCAHKAAAIAVBB3EiBXYhBAwCCyAEQQJ2IQQLIAYhBwsCfyALQX9qIAQgAEF/anEiBiAAQQF0QX9qIgggCWsiEUkNABogBCAIcSIEQQAgESAEIABIG2shBiALCyEIIA0gAkEBdGogBkF/aiIEOwEAIAlBASAGayAEIAZBAUgbayEJA0AgCSAASARAIABBAXUhACALQX9qIQsMAQsLAn8gByAOS0EAIAcgBSAIaiIFQQN1aiIGIAxLG0UEQCAFQQdxDAELIAUgDCIGIAdrQQN0awshBSACQQFqIQIgBEUhCCAGKAAAIAVBH3F2IQQMAQsLQWwgCUEBRyAFQSBKcg0BGiABIAJBf2o2AgAgBiAFQQdqQQN1aiADawwBC0FQCyEAIApBEGokACAACwkAQQFBBSAAGwsMACAAIAEoAAA2AAALqgMBCn8jAEHwAGsiCiQAIAJBAWohDiAAQQhqIQtBgIAEIAVBf2p0QRB1IQxBACECQQEhBkEBIAV0IglBf2oiDyEIA0AgAiAORkUEQAJAIAEgAkEBdCINai8BACIHQf//A0YEQCALIAhBA3RqIAI2AgQgCEF/aiEIQQEhBwwBCyAGQQAgDCAHQRB0QRB1ShshBgsgCiANaiAHOwEAIAJBAWohAgwBCwsgACAFNgIEIAAgBjYCACAJQQN2IAlBAXZqQQNqIQxBACEAQQAhBkEAIQIDQCAGIA5GBEADQAJAIAAgCUYNACAKIAsgAEEDdGoiASgCBCIGQQF0aiICIAIvAQAiAkEBajsBACABIAUgAhAUayIIOgADIAEgAiAIQf8BcXQgCWs7AQAgASAEIAZBAnQiAmooAgA6AAIgASACIANqKAIANgIEIABBAWohAAwBCwsFIAEgBkEBdGouAQAhDUEAIQcDQCAHIA1ORQRAIAsgAkEDdGogBjYCBANAIAIgDGogD3EiAiAISw0ACyAHQQFqIQcMAQsLIAZBAWohBgwBCwsgCkHwAGokAAsjAEIAIAEQCSAAhUKHla+vmLbem55/fkLj3MqV/M7y9YV/fAsQACAAQn43AwggACABNgIACyQBAX8gAARAIAEoAgQiAgRAIAEoAgggACACEQEADwsgABAmCwsfACAAIAEgAi8BABAINgIAIAEQBBogACACQQRqNgIEC0oBAX9BoCAoAgAiASAAaiIAQX9MBEBBiCBBMDYCAEF/DwsCQCAAPwBBEHRNDQAgABBmDQBBiCBBMDYCAEF/DwtBoCAgADYCACABC9cBAQh/Qbp/IQoCQCACKAIEIgggAigCACIJaiIOIAEgAGtLDQBBbCEKIAkgBCADKAIAIgtrSw0AIAAgCWoiBCACKAIIIgxrIQ0gACABQWBqIg8gCyAJQQAQKSADIAkgC2o2AgACQAJAIAwgBCAFa00EQCANIQUMAQsgDCAEIAZrSw0CIAcgDSAFayIAaiIBIAhqIAdNBEAgBCABIAgQDxoMAgsgBCABQQAgAGsQDyEBIAIgACAIaiIINgIEIAEgAGshBAsgBCAPIAUgCEEBECkLIA4hCgsgCgubAgEBfyMAQYABayINJAAgDSADNgJ8AkAgAkEDSwRAQX8hCQwBCwJAAkACQAJAIAJBAWsOAwADAgELIAZFBEBBuH8hCQwEC0FsIQkgBS0AACICIANLDQMgACAHIAJBAnQiAmooAgAgAiAIaigCABA7IAEgADYCAEEBIQkMAwsgASAJNgIAQQAhCQwCCyAKRQRAQWwhCQwCC0EAIQkgC0UgDEEZSHINAUEIIAR0QQhqIQBBACECA0AgAiAATw0CIAJBQGshAgwAAAsAC0FsIQkgDSANQfwAaiANQfgAaiAFIAYQFSICEAMNACANKAJ4IgMgBEsNACAAIA0gDSgCfCAHIAggAxAYIAEgADYCACACIQkLIA1BgAFqJAAgCQsLACAAIAEgAhALGgsQACAALwAAIAAtAAJBEHRyCy8AAn9BuH8gAUEISQ0AGkFyIAAoAAQiAEF3Sw0AGkG4fyAAQQhqIgAgACABSxsLCwkAIAAgATsAAAsDAAELigYBBX8gACAAKAIAIgVBfnE2AgBBACAAIAVBAXZqQYQgKAIAIgQgAEYbIQECQAJAIAAoAgQiAkUNACACKAIAIgNBAXENACACQQhqIgUgA0EBdkF4aiIDQQggA0EISxtnQR9zQQJ0QYAfaiIDKAIARgRAIAMgAigCDDYCAAsgAigCCCIDBEAgAyACKAIMNgIECyACKAIMIgMEQCADIAIoAgg2AgALIAIgAigCACAAKAIAQX5xajYCAEGEICEAAkACQCABRQ0AIAEgAjYCBCABKAIAIgNBAXENASADQQF2QXhqIgNBCCADQQhLG2dBH3NBAnRBgB9qIgMoAgAgAUEIakYEQCADIAEoAgw2AgALIAEoAggiAwRAIAMgASgCDDYCBAsgASgCDCIDBEAgAyABKAIINgIAQYQgKAIAIQQLIAIgAigCACABKAIAQX5xajYCACABIARGDQAgASABKAIAQQF2akEEaiEACyAAIAI2AgALIAIoAgBBAXZBeGoiAEEIIABBCEsbZ0Efc0ECdEGAH2oiASgCACEAIAEgBTYCACACIAA2AgwgAkEANgIIIABFDQEgACAFNgIADwsCQCABRQ0AIAEoAgAiAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAigCACABQQhqRgRAIAIgASgCDDYCAAsgASgCCCICBEAgAiABKAIMNgIECyABKAIMIgIEQCACIAEoAgg2AgBBhCAoAgAhBAsgACAAKAIAIAEoAgBBfnFqIgI2AgACQCABIARHBEAgASABKAIAQQF2aiAANgIEIAAoAgAhAgwBC0GEICAANgIACyACQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgIoAgAhASACIABBCGoiAjYCACAAIAE2AgwgAEEANgIIIAFFDQEgASACNgIADwsgBUEBdkF4aiIBQQggAUEISxtnQR9zQQJ0QYAfaiICKAIAIQEgAiAAQQhqIgI2AgAgACABNgIMIABBADYCCCABRQ0AIAEgAjYCAAsLDgAgAARAIABBeGoQJQsLgAIBA38CQCAAQQ9qQXhxQYQgKAIAKAIAQQF2ayICEB1Bf0YNAAJAQYQgKAIAIgAoAgAiAUEBcQ0AIAFBAXZBeGoiAUEIIAFBCEsbZ0Efc0ECdEGAH2oiASgCACAAQQhqRgRAIAEgACgCDDYCAAsgACgCCCIBBEAgASAAKAIMNgIECyAAKAIMIgFFDQAgASAAKAIINgIAC0EBIQEgACAAKAIAIAJBAXRqIgI2AgAgAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAygCACECIAMgAEEIaiIDNgIAIAAgAjYCDCAAQQA2AgggAkUNACACIAM2AgALIAELtwIBA38CQAJAIABBASAAGyICEDgiAA0AAkACQEGEICgCACIARQ0AIAAoAgAiA0EBcQ0AIAAgA0EBcjYCACADQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgAgAEEIakYEQCABIAAoAgw2AgALIAAoAggiAQRAIAEgACgCDDYCBAsgACgCDCIBBEAgASAAKAIINgIACyACECchAkEAIQFBhCAoAgAhACACDQEgACAAKAIAQX5xNgIAQQAPCyACQQ9qQXhxIgMQHSICQX9GDQIgAkEHakF4cSIAIAJHBEAgACACaxAdQX9GDQMLAkBBhCAoAgAiAUUEQEGAICAANgIADAELIAAgATYCBAtBhCAgADYCACAAIANBAXRBAXI2AgAMAQsgAEUNAQsgAEEIaiEBCyABC7kDAQJ/IAAgA2ohBQJAIANBB0wEQANAIAAgBU8NAiAAIAItAAA6AAAgAEEBaiEAIAJBAWohAgwAAAsACyAEQQFGBEACQCAAIAJrIgZBB00EQCAAIAItAAA6AAAgACACLQABOgABIAAgAi0AAjoAAiAAIAItAAM6AAMgAEEEaiACIAZBAnQiBkHAHmooAgBqIgIQFyACIAZB4B5qKAIAayECDAELIAAgAhAMCyACQQhqIQIgAEEIaiEACwJAAkACQAJAIAUgAU0EQCAAIANqIQEgBEEBRyAAIAJrQQ9Kcg0BA0AgACACEAwgAkEIaiECIABBCGoiACABSQ0ACwwFCyAAIAFLBEAgACEBDAQLIARBAUcgACACa0EPSnINASAAIQMgAiEEA0AgAyAEEAwgBEEIaiEEIANBCGoiAyABSQ0ACwwCCwNAIAAgAhAHIAJBEGohAiAAQRBqIgAgAUkNAAsMAwsgACEDIAIhBANAIAMgBBAHIARBEGohBCADQRBqIgMgAUkNAAsLIAIgASAAa2ohAgsDQCABIAVPDQEgASACLQAAOgAAIAFBAWohASACQQFqIQIMAAALAAsLQQECfyAAIAAoArjgASIDNgLE4AEgACgCvOABIQQgACABNgK84AEgACABIAJqNgK44AEgACABIAQgA2tqNgLA4AELpgEBAX8gACAAKALs4QEQFjYCyOABIABCADcD+OABIABCADcDuOABIABBwOABakIANwMAIABBqNAAaiIBQYyAgOAANgIAIABBADYCmOIBIABCADcDiOEBIABCAzcDgOEBIABBrNABakHgEikCADcCACAAQbTQAWpB6BIoAgA2AgAgACABNgIMIAAgAEGYIGo2AgggACAAQaAwajYCBCAAIABBEGo2AgALYQEBf0G4fyEDAkAgAUEDSQ0AIAIgABAhIgFBA3YiADYCCCACIAFBAXE2AgQgAiABQQF2QQNxIgM2AgACQCADQX9qIgFBAksNAAJAIAFBAWsOAgEAAgtBbA8LIAAhAwsgAwsMACAAIAEgAkEAEC4LiAQCA38CfiADEBYhBCAAQQBBKBAQIQAgBCACSwRAIAQPCyABRQRAQX8PCwJAAkAgA0EBRg0AIAEoAAAiBkGo6r5pRg0AQXYhAyAGQXBxQdDUtMIBRw0BQQghAyACQQhJDQEgAEEAQSgQECEAIAEoAAQhASAAQQE2AhQgACABrTcDAEEADwsgASACIAMQLyIDIAJLDQAgACADNgIYQXIhAyABIARqIgVBf2otAAAiAkEIcQ0AIAJBIHEiBkUEQEFwIQMgBS0AACIFQacBSw0BIAVBB3GtQgEgBUEDdkEKaq2GIgdCA4h+IAd8IQggBEEBaiEECyACQQZ2IQMgAkECdiEFAkAgAkEDcUF/aiICQQJLBEBBACECDAELAkACQAJAIAJBAWsOAgECAAsgASAEai0AACECIARBAWohBAwCCyABIARqLwAAIQIgBEECaiEEDAELIAEgBGooAAAhAiAEQQRqIQQLIAVBAXEhBQJ+AkACQAJAIANBf2oiA0ECTQRAIANBAWsOAgIDAQtCfyAGRQ0DGiABIARqMQAADAMLIAEgBGovAACtQoACfAwCCyABIARqKAAArQwBCyABIARqKQAACyEHIAAgBTYCICAAIAI2AhwgACAHNwMAQQAhAyAAQQA2AhQgACAHIAggBhsiBzcDCCAAIAdCgIAIIAdCgIAIVBs+AhALIAMLWwEBf0G4fyEDIAIQFiICIAFNBH8gACACakF/ai0AACIAQQNxQQJ0QaAeaigCACACaiAAQQZ2IgFBAnRBsB5qKAIAaiAAQSBxIgBFaiABRSAAQQV2cWoFQbh/CwsdACAAKAKQ4gEQWiAAQQA2AqDiASAAQgA3A5DiAQu1AwEFfyMAQZACayIKJABBuH8hBgJAIAVFDQAgBCwAACIIQf8BcSEHAkAgCEF/TARAIAdBgn9qQQF2IgggBU8NAkFsIQYgB0GBf2oiBUGAAk8NAiAEQQFqIQdBACEGA0AgBiAFTwRAIAUhBiAIIQcMAwUgACAGaiAHIAZBAXZqIgQtAABBBHY6AAAgACAGQQFyaiAELQAAQQ9xOgAAIAZBAmohBgwBCwAACwALIAcgBU8NASAAIARBAWogByAKEFMiBhADDQELIAYhBEEAIQYgAUEAQTQQECEJQQAhBQNAIAQgBkcEQCAAIAZqIggtAAAiAUELSwRAQWwhBgwDBSAJIAFBAnRqIgEgASgCAEEBajYCACAGQQFqIQZBASAILQAAdEEBdSAFaiEFDAILAAsLQWwhBiAFRQ0AIAUQFEEBaiIBQQxLDQAgAyABNgIAQQFBASABdCAFayIDEBQiAXQgA0cNACAAIARqIAFBAWoiADoAACAJIABBAnRqIgAgACgCAEEBajYCACAJKAIEIgBBAkkgAEEBcXINACACIARBAWo2AgAgB0EBaiEGCyAKQZACaiQAIAYLxhEBDH8jAEHwAGsiBSQAQWwhCwJAIANBCkkNACACLwAAIQogAi8AAiEJIAIvAAQhByAFQQhqIAQQDgJAIAMgByAJIApqakEGaiIMSQ0AIAUtAAohCCAFQdgAaiACQQZqIgIgChAGIgsQAw0BIAVBQGsgAiAKaiICIAkQBiILEAMNASAFQShqIAIgCWoiAiAHEAYiCxADDQEgBUEQaiACIAdqIAMgDGsQBiILEAMNASAAIAFqIg9BfWohECAEQQRqIQZBASELIAAgAUEDakECdiIDaiIMIANqIgIgA2oiDiEDIAIhBCAMIQcDQCALIAMgEElxBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgCS0AAyELIAcgBiAFQUBrIAgQAkECdGoiCS8BADsAACAFQUBrIAktAAIQASAJLQADIQogBCAGIAVBKGogCBACQQJ0aiIJLwEAOwAAIAVBKGogCS0AAhABIAktAAMhCSADIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgDS0AAyENIAAgC2oiCyAGIAVB2ABqIAgQAkECdGoiAC8BADsAACAFQdgAaiAALQACEAEgAC0AAyEAIAcgCmoiCiAGIAVBQGsgCBACQQJ0aiIHLwEAOwAAIAVBQGsgBy0AAhABIActAAMhByAEIAlqIgkgBiAFQShqIAgQAkECdGoiBC8BADsAACAFQShqIAQtAAIQASAELQADIQQgAyANaiIDIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgACALaiEAIAcgCmohByAEIAlqIQQgAyANLQADaiEDIAVB2ABqEA0gBUFAaxANciAFQShqEA1yIAVBEGoQDXJFIQsMAQsLIAQgDksgByACS3INAEFsIQsgACAMSw0BIAxBfWohCQNAQQAgACAJSSAFQdgAahAEGwRAIAAgBiAFQdgAaiAIEAJBAnRqIgovAQA7AAAgBUHYAGogCi0AAhABIAAgCi0AA2oiACAGIAVB2ABqIAgQAkECdGoiCi8BADsAACAFQdgAaiAKLQACEAEgACAKLQADaiEADAEFIAxBfmohCgNAIAVB2ABqEAQgACAKS3JFBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgACAJLQADaiEADAELCwNAIAAgCk0EQCAAIAYgBUHYAGogCBACQQJ0aiIJLwEAOwAAIAVB2ABqIAktAAIQASAAIAktAANqIQAMAQsLAkAgACAMTw0AIAAgBiAFQdgAaiAIEAIiAEECdGoiDC0AADoAACAMLQADQQFGBEAgBUHYAGogDC0AAhABDAELIAUoAlxBH0sNACAFQdgAaiAGIABBAnRqLQACEAEgBSgCXEEhSQ0AIAVBIDYCXAsgAkF9aiEMA0BBACAHIAxJIAVBQGsQBBsEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiIAIAYgBUFAayAIEAJBAnRqIgcvAQA7AAAgBUFAayAHLQACEAEgACAHLQADaiEHDAEFIAJBfmohDANAIAVBQGsQBCAHIAxLckUEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwNAIAcgDE0EQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwJAIAcgAk8NACAHIAYgBUFAayAIEAIiAEECdGoiAi0AADoAACACLQADQQFGBEAgBUFAayACLQACEAEMAQsgBSgCREEfSw0AIAVBQGsgBiAAQQJ0ai0AAhABIAUoAkRBIUkNACAFQSA2AkQLIA5BfWohAgNAQQAgBCACSSAFQShqEAQbBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2oiACAGIAVBKGogCBACQQJ0aiIELwEAOwAAIAVBKGogBC0AAhABIAAgBC0AA2ohBAwBBSAOQX5qIQIDQCAFQShqEAQgBCACS3JFBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsDQCAEIAJNBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsCQCAEIA5PDQAgBCAGIAVBKGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBKGogAi0AAhABDAELIAUoAixBH0sNACAFQShqIAYgAEECdGotAAIQASAFKAIsQSFJDQAgBUEgNgIsCwNAQQAgAyAQSSAFQRBqEAQbBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2oiACAGIAVBEGogCBACQQJ0aiICLwEAOwAAIAVBEGogAi0AAhABIAAgAi0AA2ohAwwBBSAPQX5qIQIDQCAFQRBqEAQgAyACS3JFBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsDQCADIAJNBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsCQCADIA9PDQAgAyAGIAVBEGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBEGogAi0AAhABDAELIAUoAhRBH0sNACAFQRBqIAYgAEECdGotAAIQASAFKAIUQSFJDQAgBUEgNgIUCyABQWwgBUHYAGoQCiAFQUBrEApxIAVBKGoQCnEgBUEQahAKcRshCwwJCwAACwALAAALAAsAAAsACwAACwALQWwhCwsgBUHwAGokACALC7UEAQ5/IwBBEGsiBiQAIAZBBGogABAOQVQhBQJAIARB3AtJDQAgBi0ABCEHIANB8ARqQQBB7AAQECEIIAdBDEsNACADQdwJaiIJIAggBkEIaiAGQQxqIAEgAhAxIhAQA0UEQCAGKAIMIgQgB0sNASADQdwFaiEPIANBpAVqIREgAEEEaiESIANBqAVqIQEgBCEFA0AgBSICQX9qIQUgCCACQQJ0aigCAEUNAAsgAkEBaiEOQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgASALaiAKNgIAIAVBAWohBSAKIAxqIQoMAQsLIAEgCjYCAEEAIQUgBigCCCELA0AgBSALRkUEQCABIAUgCWotAAAiDEECdGoiDSANKAIAIg1BAWo2AgAgDyANQQF0aiINIAw6AAEgDSAFOgAAIAVBAWohBQwBCwtBACEBIANBADYCqAUgBEF/cyAHaiEJQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgAyALaiABNgIAIAwgBSAJanQgAWohASAFQQFqIQUMAQsLIAcgBEEBaiIBIAJrIgRrQQFqIQgDQEEBIQUgBCAIT0UEQANAIAUgDk9FBEAgBUECdCIJIAMgBEE0bGpqIAMgCWooAgAgBHY2AgAgBUEBaiEFDAELCyAEQQFqIQQMAQsLIBIgByAPIAogESADIAIgARBkIAZBAToABSAGIAc6AAYgACAGKAIENgIACyAQIQULIAZBEGokACAFC8ENAQt/IwBB8ABrIgUkAEFsIQkCQCADQQpJDQAgAi8AACEKIAIvAAIhDCACLwAEIQYgBUEIaiAEEA4CQCADIAYgCiAMampBBmoiDUkNACAFLQAKIQcgBUHYAGogAkEGaiICIAoQBiIJEAMNASAFQUBrIAIgCmoiAiAMEAYiCRADDQEgBUEoaiACIAxqIgIgBhAGIgkQAw0BIAVBEGogAiAGaiADIA1rEAYiCRADDQEgACABaiIOQX1qIQ8gBEEEaiEGQQEhCSAAIAFBA2pBAnYiAmoiCiACaiIMIAJqIg0hAyAMIQQgCiECA0AgCSADIA9JcQRAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAACAGIAVBQGsgBxACQQF0aiIILQAAIQsgBUFAayAILQABEAEgAiALOgAAIAYgBUEoaiAHEAJBAXRqIggtAAAhCyAFQShqIAgtAAEQASAEIAs6AAAgBiAFQRBqIAcQAkEBdGoiCC0AACELIAVBEGogCC0AARABIAMgCzoAACAGIAVB2ABqIAcQAkEBdGoiCC0AACELIAVB2ABqIAgtAAEQASAAIAs6AAEgBiAFQUBrIAcQAkEBdGoiCC0AACELIAVBQGsgCC0AARABIAIgCzoAASAGIAVBKGogBxACQQF0aiIILQAAIQsgBUEoaiAILQABEAEgBCALOgABIAYgBUEQaiAHEAJBAXRqIggtAAAhCyAFQRBqIAgtAAEQASADIAs6AAEgA0ECaiEDIARBAmohBCACQQJqIQIgAEECaiEAIAkgBUHYAGoQDUVxIAVBQGsQDUVxIAVBKGoQDUVxIAVBEGoQDUVxIQkMAQsLIAQgDUsgAiAMS3INAEFsIQkgACAKSw0BIApBfWohCQNAIAVB2ABqEAQgACAJT3JFBEAgBiAFQdgAaiAHEAJBAXRqIggtAAAhCyAFQdgAaiAILQABEAEgACALOgAAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAASAAQQJqIQAMAQsLA0AgBUHYAGoQBCAAIApPckUEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCwNAIAAgCkkEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCyAMQX1qIQADQCAFQUBrEAQgAiAAT3JFBEAgBiAFQUBrIAcQAkEBdGoiCi0AACEJIAVBQGsgCi0AARABIAIgCToAACAGIAVBQGsgBxACQQF0aiIKLQAAIQkgBUFAayAKLQABEAEgAiAJOgABIAJBAmohAgwBCwsDQCAFQUBrEAQgAiAMT3JFBEAgBiAFQUBrIAcQAkEBdGoiAC0AACEKIAVBQGsgAC0AARABIAIgCjoAACACQQFqIQIMAQsLA0AgAiAMSQRAIAYgBUFAayAHEAJBAXRqIgAtAAAhCiAFQUBrIAAtAAEQASACIAo6AAAgAkEBaiECDAELCyANQX1qIQADQCAFQShqEAQgBCAAT3JFBEAgBiAFQShqIAcQAkEBdGoiAi0AACEKIAVBKGogAi0AARABIAQgCjoAACAGIAVBKGogBxACQQF0aiICLQAAIQogBUEoaiACLQABEAEgBCAKOgABIARBAmohBAwBCwsDQCAFQShqEAQgBCANT3JFBEAgBiAFQShqIAcQAkEBdGoiAC0AACECIAVBKGogAC0AARABIAQgAjoAACAEQQFqIQQMAQsLA0AgBCANSQRAIAYgBUEoaiAHEAJBAXRqIgAtAAAhAiAFQShqIAAtAAEQASAEIAI6AAAgBEEBaiEEDAELCwNAIAVBEGoQBCADIA9PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIAYgBUEQaiAHEAJBAXRqIgAtAAAhAiAFQRBqIAAtAAEQASADIAI6AAEgA0ECaiEDDAELCwNAIAVBEGoQBCADIA5PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIANBAWohAwwBCwsDQCADIA5JBEAgBiAFQRBqIAcQAkEBdGoiAC0AACECIAVBEGogAC0AARABIAMgAjoAACADQQFqIQMMAQsLIAFBbCAFQdgAahAKIAVBQGsQCnEgBUEoahAKcSAFQRBqEApxGyEJDAELQWwhCQsgBUHwAGokACAJC8oCAQR/IwBBIGsiBSQAIAUgBBAOIAUtAAIhByAFQQhqIAIgAxAGIgIQA0UEQCAEQQRqIQIgACABaiIDQX1qIQQDQCAFQQhqEAQgACAET3JFBEAgAiAFQQhqIAcQAkEBdGoiBi0AACEIIAVBCGogBi0AARABIAAgCDoAACACIAVBCGogBxACQQF0aiIGLQAAIQggBUEIaiAGLQABEAEgACAIOgABIABBAmohAAwBCwsDQCAFQQhqEAQgACADT3JFBEAgAiAFQQhqIAcQAkEBdGoiBC0AACEGIAVBCGogBC0AARABIAAgBjoAACAAQQFqIQAMAQsLA0AgACADT0UEQCACIAVBCGogBxACQQF0aiIELQAAIQYgBUEIaiAELQABEAEgACAGOgAAIABBAWohAAwBCwsgAUFsIAVBCGoQChshAgsgBUEgaiQAIAILtgMBCX8jAEEQayIGJAAgBkEANgIMIAZBADYCCEFUIQQCQAJAIANBQGsiDCADIAZBCGogBkEMaiABIAIQMSICEAMNACAGQQRqIAAQDiAGKAIMIgcgBi0ABEEBaksNASAAQQRqIQogBkEAOgAFIAYgBzoABiAAIAYoAgQ2AgAgB0EBaiEJQQEhBANAIAQgCUkEQCADIARBAnRqIgEoAgAhACABIAU2AgAgACAEQX9qdCAFaiEFIARBAWohBAwBCwsgB0EBaiEHQQAhBSAGKAIIIQkDQCAFIAlGDQEgAyAFIAxqLQAAIgRBAnRqIgBBASAEdEEBdSILIAAoAgAiAWoiADYCACAHIARrIQhBACEEAkAgC0EDTQRAA0AgBCALRg0CIAogASAEakEBdGoiACAIOgABIAAgBToAACAEQQFqIQQMAAALAAsDQCABIABPDQEgCiABQQF0aiIEIAg6AAEgBCAFOgAAIAQgCDoAAyAEIAU6AAIgBCAIOgAFIAQgBToABCAEIAg6AAcgBCAFOgAGIAFBBGohAQwAAAsACyAFQQFqIQUMAAALAAsgAiEECyAGQRBqJAAgBAutAQECfwJAQYQgKAIAIABHIAAoAgBBAXYiAyABa0F4aiICQXhxQQhHcgR/IAIFIAMQJ0UNASACQQhqC0EQSQ0AIAAgACgCACICQQFxIAAgAWpBD2pBeHEiASAAa0EBdHI2AgAgASAANgIEIAEgASgCAEEBcSAAIAJBAXZqIAFrIgJBAXRyNgIAQYQgIAEgAkH/////B3FqQQRqQYQgKAIAIABGGyABNgIAIAEQJQsLygIBBX8CQAJAAkAgAEEIIABBCEsbZ0EfcyAAaUEBR2oiAUEESSAAIAF2cg0AIAFBAnRB/B5qKAIAIgJFDQADQCACQXhqIgMoAgBBAXZBeGoiBSAATwRAIAIgBUEIIAVBCEsbZ0Efc0ECdEGAH2oiASgCAEYEQCABIAIoAgQ2AgALDAMLIARBHksNASAEQQFqIQQgAigCBCICDQALC0EAIQMgAUEgTw0BA0AgAUECdEGAH2ooAgAiAkUEQCABQR5LIQIgAUEBaiEBIAJFDQEMAwsLIAIgAkF4aiIDKAIAQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgBGBEAgASACKAIENgIACwsgAigCACIBBEAgASACKAIENgIECyACKAIEIgEEQCABIAIoAgA2AgALIAMgAygCAEEBcjYCACADIAAQNwsgAwvhCwINfwV+IwBB8ABrIgckACAHIAAoAvDhASIINgJcIAEgAmohDSAIIAAoAoDiAWohDwJAAkAgBUUEQCABIQQMAQsgACgCxOABIRAgACgCwOABIREgACgCvOABIQ4gAEEBNgKM4QFBACEIA0AgCEEDRwRAIAcgCEECdCICaiAAIAJqQazQAWooAgA2AkQgCEEBaiEIDAELC0FsIQwgB0EYaiADIAQQBhADDQEgB0EsaiAHQRhqIAAoAgAQEyAHQTRqIAdBGGogACgCCBATIAdBPGogB0EYaiAAKAIEEBMgDUFgaiESIAEhBEEAIQwDQCAHKAIwIAcoAixBA3RqKQIAIhRCEIinQf8BcSEIIAcoAkAgBygCPEEDdGopAgAiFUIQiKdB/wFxIQsgBygCOCAHKAI0QQN0aikCACIWQiCIpyEJIBVCIIghFyAUQiCIpyECAkAgFkIQiKdB/wFxIgNBAk8EQAJAIAZFIANBGUlyRQRAIAkgB0EYaiADQSAgBygCHGsiCiAKIANLGyIKEAUgAyAKayIDdGohCSAHQRhqEAQaIANFDQEgB0EYaiADEAUgCWohCQwBCyAHQRhqIAMQBSAJaiEJIAdBGGoQBBoLIAcpAkQhGCAHIAk2AkQgByAYNwNIDAELAkAgA0UEQCACBEAgBygCRCEJDAMLIAcoAkghCQwBCwJAAkAgB0EYakEBEAUgCSACRWpqIgNBA0YEQCAHKAJEQX9qIgMgA0VqIQkMAQsgA0ECdCAHaigCRCIJIAlFaiEJIANBAUYNAQsgByAHKAJINgJMCwsgByAHKAJENgJIIAcgCTYCRAsgF6chAyALBEAgB0EYaiALEAUgA2ohAwsgCCALakEUTwRAIAdBGGoQBBoLIAgEQCAHQRhqIAgQBSACaiECCyAHQRhqEAQaIAcgB0EYaiAUQhiIp0H/AXEQCCAUp0H//wNxajYCLCAHIAdBGGogFUIYiKdB/wFxEAggFadB//8DcWo2AjwgB0EYahAEGiAHIAdBGGogFkIYiKdB/wFxEAggFqdB//8DcWo2AjQgByACNgJgIAcoAlwhCiAHIAk2AmggByADNgJkAkACQAJAIAQgAiADaiILaiASSw0AIAIgCmoiEyAPSw0AIA0gBGsgC0Egak8NAQsgByAHKQNoNwMQIAcgBykDYDcDCCAEIA0gB0EIaiAHQdwAaiAPIA4gESAQEB4hCwwBCyACIARqIQggBCAKEAcgAkERTwRAIARBEGohAgNAIAIgCkEQaiIKEAcgAkEQaiICIAhJDQALCyAIIAlrIQIgByATNgJcIAkgCCAOa0sEQCAJIAggEWtLBEBBbCELDAILIBAgAiAOayICaiIKIANqIBBNBEAgCCAKIAMQDxoMAgsgCCAKQQAgAmsQDyEIIAcgAiADaiIDNgJkIAggAmshCCAOIQILIAlBEE8EQCADIAhqIQMDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALDAELAkAgCUEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgCUECdCIDQcAeaigCAGoiAhAXIAIgA0HgHmooAgBrIQIgBygCZCEDDAELIAggAhAMCyADQQlJDQAgAyAIaiEDIAhBCGoiCCACQQhqIgJrQQ9MBEADQCAIIAIQDCACQQhqIQIgCEEIaiIIIANJDQAMAgALAAsDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALCyAHQRhqEAQaIAsgDCALEAMiAhshDCAEIAQgC2ogAhshBCAFQX9qIgUNAAsgDBADDQFBbCEMIAdBGGoQBEECSQ0BQQAhCANAIAhBA0cEQCAAIAhBAnQiAmpBrNABaiACIAdqKAJENgIAIAhBAWohCAwBCwsgBygCXCEIC0G6fyEMIA8gCGsiACANIARrSw0AIAQEfyAEIAggABALIABqBUEACyABayEMCyAHQfAAaiQAIAwLkRcCFn8FfiMAQdABayIHJAAgByAAKALw4QEiCDYCvAEgASACaiESIAggACgCgOIBaiETAkACQCAFRQRAIAEhAwwBCyAAKALE4AEhESAAKALA4AEhFSAAKAK84AEhDyAAQQE2AozhAUEAIQgDQCAIQQNHBEAgByAIQQJ0IgJqIAAgAmpBrNABaigCADYCVCAIQQFqIQgMAQsLIAcgETYCZCAHIA82AmAgByABIA9rNgJoQWwhECAHQShqIAMgBBAGEAMNASAFQQQgBUEESBshFyAHQTxqIAdBKGogACgCABATIAdBxABqIAdBKGogACgCCBATIAdBzABqIAdBKGogACgCBBATQQAhBCAHQeAAaiEMIAdB5ABqIQoDQCAHQShqEARBAksgBCAXTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEJIAcoAkggBygCREEDdGopAgAiH0IgiKchCCAeQiCIISAgHUIgiKchAgJAIB9CEIinQf8BcSIDQQJPBEACQCAGRSADQRlJckUEQCAIIAdBKGogA0EgIAcoAixrIg0gDSADSxsiDRAFIAMgDWsiA3RqIQggB0EoahAEGiADRQ0BIAdBKGogAxAFIAhqIQgMAQsgB0EoaiADEAUgCGohCCAHQShqEAQaCyAHKQJUISEgByAINgJUIAcgITcDWAwBCwJAIANFBEAgAgRAIAcoAlQhCAwDCyAHKAJYIQgMAQsCQAJAIAdBKGpBARAFIAggAkVqaiIDQQNGBEAgBygCVEF/aiIDIANFaiEIDAELIANBAnQgB2ooAlQiCCAIRWohCCADQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAg2AlQLICCnIQMgCQRAIAdBKGogCRAFIANqIQMLIAkgC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgAmohAgsgB0EoahAEGiAHIAcoAmggAmoiCSADajYCaCAKIAwgCCAJSxsoAgAhDSAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogB0EoaiAfQhiIp0H/AXEQCCEOIAdB8ABqIARBBHRqIgsgCSANaiAIazYCDCALIAg2AgggCyADNgIEIAsgAjYCACAHIA4gH6dB//8DcWo2AkQgBEEBaiEEDAELCyAEIBdIDQEgEkFgaiEYIAdB4ABqIRogB0HkAGohGyABIQMDQCAHQShqEARBAksgBCAFTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEIIAcoAkggBygCREEDdGopAgAiH0IgiKchCSAeQiCIISAgHUIgiKchDAJAIB9CEIinQf8BcSICQQJPBEACQCAGRSACQRlJckUEQCAJIAdBKGogAkEgIAcoAixrIgogCiACSxsiChAFIAIgCmsiAnRqIQkgB0EoahAEGiACRQ0BIAdBKGogAhAFIAlqIQkMAQsgB0EoaiACEAUgCWohCSAHQShqEAQaCyAHKQJUISEgByAJNgJUIAcgITcDWAwBCwJAIAJFBEAgDARAIAcoAlQhCQwDCyAHKAJYIQkMAQsCQAJAIAdBKGpBARAFIAkgDEVqaiICQQNGBEAgBygCVEF/aiICIAJFaiEJDAELIAJBAnQgB2ooAlQiCSAJRWohCSACQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAk2AlQLICCnIRQgCARAIAdBKGogCBAFIBRqIRQLIAggC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgDGohDAsgB0EoahAEGiAHIAcoAmggDGoiGSAUajYCaCAbIBogCSAZSxsoAgAhHCAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogByAHQShqIB9CGIinQf8BcRAIIB+nQf//A3FqNgJEIAcgB0HwAGogBEEDcUEEdGoiDSkDCCIdNwPIASAHIA0pAwAiHjcDwAECQAJAAkAgBygCvAEiDiAepyICaiIWIBNLDQAgAyAHKALEASIKIAJqIgtqIBhLDQAgEiADayALQSBqTw0BCyAHIAcpA8gBNwMQIAcgBykDwAE3AwggAyASIAdBCGogB0G8AWogEyAPIBUgERAeIQsMAQsgAiADaiEIIAMgDhAHIAJBEU8EQCADQRBqIQIDQCACIA5BEGoiDhAHIAJBEGoiAiAISQ0ACwsgCCAdpyIOayECIAcgFjYCvAEgDiAIIA9rSwRAIA4gCCAVa0sEQEFsIQsMAgsgESACIA9rIgJqIhYgCmogEU0EQCAIIBYgChAPGgwCCyAIIBZBACACaxAPIQggByACIApqIgo2AsQBIAggAmshCCAPIQILIA5BEE8EQCAIIApqIQoDQCAIIAIQByACQRBqIQIgCEEQaiIIIApJDQALDAELAkAgDkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgDkECdCIKQcAeaigCAGoiAhAXIAIgCkHgHmooAgBrIQIgBygCxAEhCgwBCyAIIAIQDAsgCkEJSQ0AIAggCmohCiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAKSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAKSQ0ACwsgCxADBEAgCyEQDAQFIA0gDDYCACANIBkgHGogCWs2AgwgDSAJNgIIIA0gFDYCBCAEQQFqIQQgAyALaiEDDAILAAsLIAQgBUgNASAEIBdrIQtBACEEA0AgCyAFSARAIAcgB0HwAGogC0EDcUEEdGoiAikDCCIdNwPIASAHIAIpAwAiHjcDwAECQAJAAkAgBygCvAEiDCAepyICaiIKIBNLDQAgAyAHKALEASIJIAJqIhBqIBhLDQAgEiADayAQQSBqTw0BCyAHIAcpA8gBNwMgIAcgBykDwAE3AxggAyASIAdBGGogB0G8AWogEyAPIBUgERAeIRAMAQsgAiADaiEIIAMgDBAHIAJBEU8EQCADQRBqIQIDQCACIAxBEGoiDBAHIAJBEGoiAiAISQ0ACwsgCCAdpyIGayECIAcgCjYCvAEgBiAIIA9rSwRAIAYgCCAVa0sEQEFsIRAMAgsgESACIA9rIgJqIgwgCWogEU0EQCAIIAwgCRAPGgwCCyAIIAxBACACaxAPIQggByACIAlqIgk2AsQBIAggAmshCCAPIQILIAZBEE8EQCAIIAlqIQYDQCAIIAIQByACQRBqIQIgCEEQaiIIIAZJDQALDAELAkAgBkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgBkECdCIGQcAeaigCAGoiAhAXIAIgBkHgHmooAgBrIQIgBygCxAEhCQwBCyAIIAIQDAsgCUEJSQ0AIAggCWohBiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAGSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAGSQ0ACwsgEBADDQMgC0EBaiELIAMgEGohAwwBCwsDQCAEQQNHBEAgACAEQQJ0IgJqQazQAWogAiAHaigCVDYCACAEQQFqIQQMAQsLIAcoArwBIQgLQbp/IRAgEyAIayIAIBIgA2tLDQAgAwR/IAMgCCAAEAsgAGoFQQALIAFrIRALIAdB0AFqJAAgEAslACAAQgA3AgAgAEEAOwEIIABBADoACyAAIAE2AgwgACACOgAKC7QFAQN/IwBBMGsiBCQAIABB/wFqIgVBfWohBgJAIAMvAQIEQCAEQRhqIAEgAhAGIgIQAw0BIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahASOgAAIAMgBEEIaiAEQRhqEBI6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0FIAEgBEEQaiAEQRhqEBI6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBSABIARBCGogBEEYahASOgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEjoAACABIAJqIABrIQIMAwsgAyAEQRBqIARBGGoQEjoAAiADIARBCGogBEEYahASOgADIANBBGohAwwAAAsACyAEQRhqIAEgAhAGIgIQAw0AIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahAROgAAIAMgBEEIaiAEQRhqEBE6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0EIAEgBEEQaiAEQRhqEBE6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBCABIARBCGogBEEYahAROgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEToAACABIAJqIABrIQIMAgsgAyAEQRBqIARBGGoQEToAAiADIARBCGogBEEYahAROgADIANBBGohAwwAAAsACyAEQTBqJAAgAgtpAQF/An8CQAJAIAJBB00NACABKAAAQbfIwuF+Rw0AIAAgASgABDYCmOIBQWIgAEEQaiABIAIQPiIDEAMNAhogAEKBgICAEDcDiOEBIAAgASADaiACIANrECoMAQsgACABIAIQKgtBAAsLrQMBBn8jAEGAAWsiAyQAQWIhCAJAIAJBCUkNACAAQZjQAGogAUEIaiIEIAJBeGogAEGY0AAQMyIFEAMiBg0AIANBHzYCfCADIANB/ABqIANB+ABqIAQgBCAFaiAGGyIEIAEgAmoiAiAEaxAVIgUQAw0AIAMoAnwiBkEfSw0AIAMoAngiB0EJTw0AIABBiCBqIAMgBkGAC0GADCAHEBggA0E0NgJ8IAMgA0H8AGogA0H4AGogBCAFaiIEIAIgBGsQFSIFEAMNACADKAJ8IgZBNEsNACADKAJ4IgdBCk8NACAAQZAwaiADIAZBgA1B4A4gBxAYIANBIzYCfCADIANB/ABqIANB+ABqIAQgBWoiBCACIARrEBUiBRADDQAgAygCfCIGQSNLDQAgAygCeCIHQQpPDQAgACADIAZBwBBB0BEgBxAYIAQgBWoiBEEMaiIFIAJLDQAgAiAFayEFQQAhAgNAIAJBA0cEQCAEKAAAIgZBf2ogBU8NAiAAIAJBAnRqQZzQAWogBjYCACACQQFqIQIgBEEEaiEEDAELCyAEIAFrIQgLIANBgAFqJAAgCAtGAQN/IABBCGohAyAAKAIEIQJBACEAA0AgACACdkUEQCABIAMgAEEDdGotAAJBFktqIQEgAEEBaiEADAELCyABQQggAmt0C4YDAQV/Qbh/IQcCQCADRQ0AIAItAAAiBEUEQCABQQA2AgBBAUG4fyADQQFGGw8LAn8gAkEBaiIFIARBGHRBGHUiBkF/Sg0AGiAGQX9GBEAgA0EDSA0CIAUvAABBgP4BaiEEIAJBA2oMAQsgA0ECSA0BIAItAAEgBEEIdHJBgIB+aiEEIAJBAmoLIQUgASAENgIAIAVBAWoiASACIANqIgNLDQBBbCEHIABBEGogACAFLQAAIgVBBnZBI0EJIAEgAyABa0HAEEHQEUHwEiAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBmCBqIABBCGogBUEEdkEDcUEfQQggASABIAZqIAgbIgEgAyABa0GAC0GADEGAFyAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBoDBqIABBBGogBUECdkEDcUE0QQkgASABIAZqIAgbIgEgAyABa0GADUHgDkGQGSAAKAKM4QEgACgCnOIBIAQQHyIAEAMNACAAIAFqIAJrIQcLIAcLrQMBCn8jAEGABGsiCCQAAn9BUiACQf8BSw0AGkFUIANBDEsNABogAkEBaiELIABBBGohCUGAgAQgA0F/anRBEHUhCkEAIQJBASEEQQEgA3QiB0F/aiIMIQUDQCACIAtGRQRAAkAgASACQQF0Ig1qLwEAIgZB//8DRgRAIAkgBUECdGogAjoAAiAFQX9qIQVBASEGDAELIARBACAKIAZBEHRBEHVKGyEECyAIIA1qIAY7AQAgAkEBaiECDAELCyAAIAQ7AQIgACADOwEAIAdBA3YgB0EBdmpBA2ohBkEAIQRBACECA0AgBCALRkUEQCABIARBAXRqLgEAIQpBACEAA0AgACAKTkUEQCAJIAJBAnRqIAQ6AAIDQCACIAZqIAxxIgIgBUsNAAsgAEEBaiEADAELCyAEQQFqIQQMAQsLQX8gAg0AGkEAIQIDfyACIAdGBH9BAAUgCCAJIAJBAnRqIgAtAAJBAXRqIgEgAS8BACIBQQFqOwEAIAAgAyABEBRrIgU6AAMgACABIAVB/wFxdCAHazsBACACQQFqIQIMAQsLCyEFIAhBgARqJAAgBQvjBgEIf0FsIQcCQCACQQNJDQACQAJAAkACQCABLQAAIgNBA3EiCUEBaw4DAwEAAgsgACgCiOEBDQBBYg8LIAJBBUkNAkEDIQYgASgAACEFAn8CQAJAIANBAnZBA3EiCEF+aiIEQQFNBEAgBEEBaw0BDAILIAVBDnZB/wdxIQQgBUEEdkH/B3EhAyAIRQwCCyAFQRJ2IQRBBCEGIAVBBHZB//8AcSEDQQAMAQsgBUEEdkH//w9xIgNBgIAISw0DIAEtAARBCnQgBUEWdnIhBEEFIQZBAAshBSAEIAZqIgogAksNAgJAIANBgQZJDQAgACgCnOIBRQ0AQQAhAgNAIAJBg4ABSw0BIAJBQGshAgwAAAsACwJ/IAlBA0YEQCABIAZqIQEgAEHw4gFqIQIgACgCDCEGIAUEQCACIAMgASAEIAYQXwwCCyACIAMgASAEIAYQXQwBCyAAQbjQAWohAiABIAZqIQEgAEHw4gFqIQYgAEGo0ABqIQggBQRAIAggBiADIAEgBCACEF4MAQsgCCAGIAMgASAEIAIQXAsQAw0CIAAgAzYCgOIBIABBATYCiOEBIAAgAEHw4gFqNgLw4QEgCUECRgRAIAAgAEGo0ABqNgIMCyAAIANqIgBBiOMBakIANwAAIABBgOMBakIANwAAIABB+OIBakIANwAAIABB8OIBakIANwAAIAoPCwJ/AkACQAJAIANBAnZBA3FBf2oiBEECSw0AIARBAWsOAgACAQtBASEEIANBA3YMAgtBAiEEIAEvAABBBHYMAQtBAyEEIAEQIUEEdgsiAyAEaiIFQSBqIAJLBEAgBSACSw0CIABB8OIBaiABIARqIAMQCyEBIAAgAzYCgOIBIAAgATYC8OEBIAEgA2oiAEIANwAYIABCADcAECAAQgA3AAggAEIANwAAIAUPCyAAIAM2AoDiASAAIAEgBGo2AvDhASAFDwsCfwJAAkACQCADQQJ2QQNxQX9qIgRBAksNACAEQQFrDgIAAgELQQEhByADQQN2DAILQQIhByABLwAAQQR2DAELIAJBBEkgARAhIgJBj4CAAUtyDQFBAyEHIAJBBHYLIQIgAEHw4gFqIAEgB2otAAAgAkEgahAQIQEgACACNgKA4gEgACABNgLw4QEgB0EBaiEHCyAHC0sAIABC+erQ0OfJoeThADcDICAAQgA3AxggAELP1tO+0ser2UI3AxAgAELW64Lu6v2J9eAANwMIIABCADcDACAAQShqQQBBKBAQGgviAgICfwV+IABBKGoiASAAKAJIaiECAn4gACkDACIDQiBaBEAgACkDECIEQgeJIAApAwgiBUIBiXwgACkDGCIGQgyJfCAAKQMgIgdCEol8IAUQGSAEEBkgBhAZIAcQGQwBCyAAKQMYQsXP2bLx5brqJ3wLIAN8IQMDQCABQQhqIgAgAk0EQEIAIAEpAAAQCSADhUIbiUKHla+vmLbem55/fkLj3MqV/M7y9YV/fCEDIAAhAQwBCwsCQCABQQRqIgAgAksEQCABIQAMAQsgASgAAK1Ch5Wvr5i23puef34gA4VCF4lCz9bTvtLHq9lCfkL5893xmfaZqxZ8IQMLA0AgACACSQRAIAAxAABCxc/ZsvHluuonfiADhUILiUKHla+vmLbem55/fiEDIABBAWohAAwBCwsgA0IhiCADhULP1tO+0ser2UJ+IgNCHYggA4VC+fPd8Zn2masWfiIDQiCIIAOFC+8CAgJ/BH4gACAAKQMAIAKtfDcDAAJAAkAgACgCSCIDIAJqIgRBH00EQCABRQ0BIAAgA2pBKGogASACECAgACgCSCACaiEEDAELIAEgAmohAgJ/IAMEQCAAQShqIgQgA2ogAUEgIANrECAgACAAKQMIIAQpAAAQCTcDCCAAIAApAxAgACkAMBAJNwMQIAAgACkDGCAAKQA4EAk3AxggACAAKQMgIABBQGspAAAQCTcDICAAKAJIIQMgAEEANgJIIAEgA2tBIGohAQsgAUEgaiACTQsEQCACQWBqIQMgACkDICEFIAApAxghBiAAKQMQIQcgACkDCCEIA0AgCCABKQAAEAkhCCAHIAEpAAgQCSEHIAYgASkAEBAJIQYgBSABKQAYEAkhBSABQSBqIgEgA00NAAsgACAFNwMgIAAgBjcDGCAAIAc3AxAgACAINwMICyABIAJPDQEgAEEoaiABIAIgAWsiBBAgCyAAIAQ2AkgLCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQEBogAwVBun8LCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQCxogAwVBun8LC6gCAQZ/IwBBEGsiByQAIABB2OABaikDAEKAgIAQViEIQbh/IQUCQCAEQf//B0sNACAAIAMgBBBCIgUQAyIGDQAgACgCnOIBIQkgACAHQQxqIAMgAyAFaiAGGyIKIARBACAFIAYbayIGEEAiAxADBEAgAyEFDAELIAcoAgwhBCABRQRAQbp/IQUgBEEASg0BCyAGIANrIQUgAyAKaiEDAkAgCQRAIABBADYCnOIBDAELAkACQAJAIARBBUgNACAAQdjgAWopAwBCgICACFgNAAwBCyAAQQA2ApziAQwBCyAAKAIIED8hBiAAQQA2ApziASAGQRRPDQELIAAgASACIAMgBSAEIAgQOSEFDAELIAAgASACIAMgBSAEIAgQOiEFCyAHQRBqJAAgBQtnACAAQdDgAWogASACIAAoAuzhARAuIgEQAwRAIAEPC0G4fyECAkAgAQ0AIABB7OABaigCACIBBEBBYCECIAAoApjiASABRw0BC0EAIQIgAEHw4AFqKAIARQ0AIABBkOEBahBDCyACCycBAX8QVyIERQRAQUAPCyAEIAAgASACIAMgBBBLEE8hACAEEFYgAAs/AQF/AkACQAJAIAAoAqDiAUEBaiIBQQJLDQAgAUEBaw4CAAECCyAAEDBBAA8LIABBADYCoOIBCyAAKAKU4gELvAMCB38BfiMAQRBrIgkkAEG4fyEGAkAgBCgCACIIQQVBCSAAKALs4QEiBRtJDQAgAygCACIHQQFBBSAFGyAFEC8iBRADBEAgBSEGDAELIAggBUEDakkNACAAIAcgBRBJIgYQAw0AIAEgAmohCiAAQZDhAWohCyAIIAVrIQIgBSAHaiEHIAEhBQNAIAcgAiAJECwiBhADDQEgAkF9aiICIAZJBEBBuH8hBgwCCyAJKAIAIghBAksEQEFsIQYMAgsgB0EDaiEHAn8CQAJAAkAgCEEBaw4CAgABCyAAIAUgCiAFayAHIAYQSAwCCyAFIAogBWsgByAGEEcMAQsgBSAKIAVrIActAAAgCSgCCBBGCyIIEAMEQCAIIQYMAgsgACgC8OABBEAgCyAFIAgQRQsgAiAGayECIAYgB2ohByAFIAhqIQUgCSgCBEUNAAsgACkD0OABIgxCf1IEQEFsIQYgDCAFIAFrrFINAQsgACgC8OABBEBBaiEGIAJBBEkNASALEEQhDCAHKAAAIAynRw0BIAdBBGohByACQXxqIQILIAMgBzYCACAEIAI2AgAgBSABayEGCyAJQRBqJAAgBgsuACAAECsCf0EAQQAQAw0AGiABRSACRXJFBEBBYiAAIAEgAhA9EAMNARoLQQALCzcAIAEEQCAAIAAoAsTgASABKAIEIAEoAghqRzYCnOIBCyAAECtBABADIAFFckUEQCAAIAEQWwsL0QIBB38jAEEQayIGJAAgBiAENgIIIAYgAzYCDCAFBEAgBSgCBCEKIAUoAgghCQsgASEIAkACQANAIAAoAuzhARAWIQsCQANAIAQgC0kNASADKAAAQXBxQdDUtMIBRgRAIAMgBBAiIgcQAw0EIAQgB2shBCADIAdqIQMMAQsLIAYgAzYCDCAGIAQ2AggCQCAFBEAgACAFEE5BACEHQQAQA0UNAQwFCyAAIAogCRBNIgcQAw0ECyAAIAgQUCAMQQFHQQAgACAIIAIgBkEMaiAGQQhqEEwiByIDa0EAIAMQAxtBCkdyRQRAQbh/IQcMBAsgBxADDQMgAiAHayECIAcgCGohCEEBIQwgBigCDCEDIAYoAgghBAwBCwsgBiADNgIMIAYgBDYCCEG4fyEHIAQNASAIIAFrIQcMAQsgBiADNgIMIAYgBDYCCAsgBkEQaiQAIAcLRgECfyABIAAoArjgASICRwRAIAAgAjYCxOABIAAgATYCuOABIAAoArzgASEDIAAgATYCvOABIAAgASADIAJrajYCwOABCwutAgIEfwF+IwBBQGoiBCQAAkACQCACQQhJDQAgASgAAEFwcUHQ1LTCAUcNACABIAIQIiEBIABCADcDCCAAQQA2AgQgACABNgIADAELIARBGGogASACEC0iAxADBEAgACADEBoMAQsgAwRAIABBuH8QGgwBCyACIAQoAjAiA2shAiABIANqIQMDQAJAIAAgAyACIARBCGoQLCIFEAMEfyAFBSACIAVBA2oiBU8NAUG4fwsQGgwCCyAGQQFqIQYgAiAFayECIAMgBWohAyAEKAIMRQ0ACyAEKAI4BEAgAkEDTQRAIABBuH8QGgwCCyADQQRqIQMLIAQoAighAiAEKQMYIQcgAEEANgIEIAAgAyABazYCACAAIAIgBmytIAcgB0J/URs3AwgLIARBQGskAAslAQF/IwBBEGsiAiQAIAIgACABEFEgAigCACEAIAJBEGokACAAC30BBH8jAEGQBGsiBCQAIARB/wE2AggCQCAEQRBqIARBCGogBEEMaiABIAIQFSIGEAMEQCAGIQUMAQtBVCEFIAQoAgwiB0EGSw0AIAMgBEEQaiAEKAIIIAcQQSIFEAMNACAAIAEgBmogAiAGayADEDwhBQsgBEGQBGokACAFC4cBAgJ/An5BABAWIQMCQANAIAEgA08EQAJAIAAoAABBcHFB0NS0wgFGBEAgACABECIiAhADRQ0BQn4PCyAAIAEQVSIEQn1WDQMgBCAFfCIFIARUIQJCfiEEIAINAyAAIAEQUiICEAMNAwsgASACayEBIAAgAmohAAwBCwtCfiAFIAEbIQQLIAQLPwIBfwF+IwBBMGsiAiQAAn5CfiACQQhqIAAgARAtDQAaQgAgAigCHEEBRg0AGiACKQMICyEDIAJBMGokACADC40BAQJ/IwBBMGsiASQAAkAgAEUNACAAKAKI4gENACABIABB/OEBaigCADYCKCABIAApAvThATcDICAAEDAgACgCqOIBIQIgASABKAIoNgIYIAEgASkDIDcDECACIAFBEGoQGyAAQQA2AqjiASABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALKgECfyMAQRBrIgAkACAAQQA2AgggAEIANwMAIAAQWCEBIABBEGokACABC4cBAQN/IwBBEGsiAiQAAkAgACgCAEUgACgCBEVzDQAgAiAAKAIINgIIIAIgACkCADcDAAJ/IAIoAgAiAQRAIAIoAghBqOMJIAERBQAMAQtBqOMJECgLIgFFDQAgASAAKQIANwL04QEgAUH84QFqIAAoAgg2AgAgARBZIAEhAwsgAkEQaiQAIAMLywEBAn8jAEEgayIBJAAgAEGBgIDAADYCtOIBIABBADYCiOIBIABBADYC7OEBIABCADcDkOIBIABBADYCpOMJIABBADYC3OIBIABCADcCzOIBIABBADYCvOIBIABBADYCxOABIABCADcCnOIBIABBpOIBakIANwIAIABBrOIBakEANgIAIAFCADcCECABQgA3AhggASABKQMYNwMIIAEgASkDEDcDACABKAIIQQh2QQFxIQIgAEEANgLg4gEgACACNgKM4gEgAUEgaiQAC3YBA38jAEEwayIBJAAgAARAIAEgAEHE0AFqIgIoAgA2AiggASAAKQK80AE3AyAgACgCACEDIAEgAigCADYCGCABIAApArzQATcDECADIAFBEGoQGyABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALzAEBAX8gACABKAK00AE2ApjiASAAIAEoAgQiAjYCwOABIAAgAjYCvOABIAAgAiABKAIIaiICNgK44AEgACACNgLE4AEgASgCuNABBEAgAEKBgICAEDcDiOEBIAAgAUGk0ABqNgIMIAAgAUGUIGo2AgggACABQZwwajYCBCAAIAFBDGo2AgAgAEGs0AFqIAFBqNABaigCADYCACAAQbDQAWogAUGs0AFqKAIANgIAIABBtNABaiABQbDQAWooAgA2AgAPCyAAQgA3A4jhAQs7ACACRQRAQbp/DwsgBEUEQEFsDwsgAiAEEGAEQCAAIAEgAiADIAQgBRBhDwsgACABIAIgAyAEIAUQZQtGAQF/IwBBEGsiBSQAIAVBCGogBBAOAn8gBS0ACQRAIAAgASACIAMgBBAyDAELIAAgASACIAMgBBA0CyEAIAVBEGokACAACzQAIAAgAyAEIAUQNiIFEAMEQCAFDwsgBSAESQR/IAEgAiADIAVqIAQgBWsgABA1BUG4fwsLRgEBfyMAQRBrIgUkACAFQQhqIAQQDgJ/IAUtAAkEQCAAIAEgAiADIAQQYgwBCyAAIAEgAiADIAQQNQshACAFQRBqJAAgAAtZAQF/QQ8hAiABIABJBEAgAUEEdCAAbiECCyAAQQh2IgEgAkEYbCIAQYwIaigCAGwgAEGICGooAgBqIgJBA3YgAmogAEGACGooAgAgAEGECGooAgAgAWxqSQs3ACAAIAMgBCAFQYAQEDMiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQMgVBuH8LC78DAQN/IwBBIGsiBSQAIAVBCGogAiADEAYiAhADRQRAIAAgAWoiB0F9aiEGIAUgBBAOIARBBGohAiAFLQACIQMDQEEAIAAgBkkgBUEIahAEGwRAIAAgAiAFQQhqIAMQAkECdGoiBC8BADsAACAFQQhqIAQtAAIQASAAIAQtAANqIgQgAiAFQQhqIAMQAkECdGoiAC8BADsAACAFQQhqIAAtAAIQASAEIAAtAANqIQAMAQUgB0F+aiEEA0AgBUEIahAEIAAgBEtyRQRAIAAgAiAFQQhqIAMQAkECdGoiBi8BADsAACAFQQhqIAYtAAIQASAAIAYtAANqIQAMAQsLA0AgACAES0UEQCAAIAIgBUEIaiADEAJBAnRqIgYvAQA7AAAgBUEIaiAGLQACEAEgACAGLQADaiEADAELCwJAIAAgB08NACAAIAIgBUEIaiADEAIiA0ECdGoiAC0AADoAACAALQADQQFGBEAgBUEIaiAALQACEAEMAQsgBSgCDEEfSw0AIAVBCGogAiADQQJ0ai0AAhABIAUoAgxBIUkNACAFQSA2AgwLIAFBbCAFQQhqEAobIQILCwsgBUEgaiQAIAILkgIBBH8jAEFAaiIJJAAgCSADQTQQCyEDAkAgBEECSA0AIAMgBEECdGooAgAhCSADQTxqIAgQIyADQQE6AD8gAyACOgA+QQAhBCADKAI8IQoDQCAEIAlGDQEgACAEQQJ0aiAKNgEAIARBAWohBAwAAAsAC0EAIQkDQCAGIAlGRQRAIAMgBSAJQQF0aiIKLQABIgtBAnRqIgwoAgAhBCADQTxqIAotAABBCHQgCGpB//8DcRAjIANBAjoAPyADIAcgC2siCiACajoAPiAEQQEgASAKa3RqIQogAygCPCELA0AgACAEQQJ0aiALNgEAIARBAWoiBCAKSQ0ACyAMIAo2AgAgCUEBaiEJDAELCyADQUBrJAALowIBCX8jAEHQAGsiCSQAIAlBEGogBUE0EAsaIAcgBmshDyAHIAFrIRADQAJAIAMgCkcEQEEBIAEgByACIApBAXRqIgYtAAEiDGsiCGsiC3QhDSAGLQAAIQ4gCUEQaiAMQQJ0aiIMKAIAIQYgCyAPTwRAIAAgBkECdGogCyAIIAUgCEE0bGogCCAQaiIIQQEgCEEBShsiCCACIAQgCEECdGooAgAiCEEBdGogAyAIayAHIA4QYyAGIA1qIQgMAgsgCUEMaiAOECMgCUEBOgAPIAkgCDoADiAGIA1qIQggCSgCDCELA0AgBiAITw0CIAAgBkECdGogCzYBACAGQQFqIQYMAAALAAsgCUHQAGokAA8LIAwgCDYCACAKQQFqIQoMAAALAAs0ACAAIAMgBCAFEDYiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQNAVBuH8LCyMAIAA/AEEQdGtB//8DakEQdkAAQX9GBEBBAA8LQQAQAEEBCzsBAX8gAgRAA0AgACABIAJBgCAgAkGAIEkbIgMQCyEAIAFBgCBqIQEgAEGAIGohACACIANrIgINAAsLCwYAIAAQAwsLqBUJAEGICAsNAQAAAAEAAAACAAAAAgBBoAgLswYBAAAAAQAAAAIAAAACAAAAJgAAAIIAAAAhBQAASgAAAGcIAAAmAAAAwAEAAIAAAABJBQAASgAAAL4IAAApAAAALAIAAIAAAABJBQAASgAAAL4IAAAvAAAAygIAAIAAAACKBQAASgAAAIQJAAA1AAAAcwMAAIAAAACdBQAASgAAAKAJAAA9AAAAgQMAAIAAAADrBQAASwAAAD4KAABEAAAAngMAAIAAAABNBgAASwAAAKoKAABLAAAAswMAAIAAAADBBgAATQAAAB8NAABNAAAAUwQAAIAAAAAjCAAAUQAAAKYPAABUAAAAmQQAAIAAAABLCQAAVwAAALESAABYAAAA2gQAAIAAAABvCQAAXQAAACMUAABUAAAARQUAAIAAAABUCgAAagAAAIwUAABqAAAArwUAAIAAAAB2CQAAfAAAAE4QAAB8AAAA0gIAAIAAAABjBwAAkQAAAJAHAACSAAAAAAAAAAEAAAABAAAABQAAAA0AAAAdAAAAPQAAAH0AAAD9AAAA/QEAAP0DAAD9BwAA/Q8AAP0fAAD9PwAA/X8AAP3/AAD9/wEA/f8DAP3/BwD9/w8A/f8fAP3/PwD9/38A/f//AP3//wH9//8D/f//B/3//w/9//8f/f//P/3//38AAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABEAAAASAAAAEwAAABQAAAAVAAAAFgAAABcAAAAYAAAAGQAAABoAAAAbAAAAHAAAAB0AAAAeAAAAHwAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAkAAAAKAAAACwAAAAwAAAANAAAADgAAAA8AAAAQAAAAEQAAABIAAAATAAAAFAAAABUAAAAWAAAAFwAAABgAAAAZAAAAGgAAABsAAAAcAAAAHQAAAB4AAAAfAAAAIAAAACEAAAAiAAAAIwAAACUAAAAnAAAAKQAAACsAAAAvAAAAMwAAADsAAABDAAAAUwAAAGMAAACDAAAAAwEAAAMCAAADBAAAAwgAAAMQAAADIAAAA0AAAAOAAAADAAEAQeAPC1EBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAEAAAABQAAAAcAAAAIAAAACQAAAAoAAAALAAAADAAAAA0AAAAOAAAADwAAABAAQcQQC4sBAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABIAAAAUAAAAFgAAABgAAAAcAAAAIAAAACgAAAAwAAAAQAAAAIAAAAAAAQAAAAIAAAAEAAAACAAAABAAAAAgAAAAQAAAAIAAAAAAAQBBkBIL5gQBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAAAEAAAAEAAAACAAAAAAAAAABAAEBBgAAAAAAAAQAAAAAEAAABAAAAAAgAAAFAQAAAAAAAAUDAAAAAAAABQQAAAAAAAAFBgAAAAAAAAUHAAAAAAAABQkAAAAAAAAFCgAAAAAAAAUMAAAAAAAABg4AAAAAAAEFEAAAAAAAAQUUAAAAAAABBRYAAAAAAAIFHAAAAAAAAwUgAAAAAAAEBTAAAAAgAAYFQAAAAAAABwWAAAAAAAAIBgABAAAAAAoGAAQAAAAADAYAEAAAIAAABAAAAAAAAAAEAQAAAAAAAAUCAAAAIAAABQQAAAAAAAAFBQAAACAAAAUHAAAAAAAABQgAAAAgAAAFCgAAAAAAAAULAAAAAAAABg0AAAAgAAEFEAAAAAAAAQUSAAAAIAABBRYAAAAAAAIFGAAAACAAAwUgAAAAAAADBSgAAAAAAAYEQAAAABAABgRAAAAAIAAHBYAAAAAAAAkGAAIAAAAACwYACAAAMAAABAAAAAAQAAAEAQAAACAAAAUCAAAAIAAABQMAAAAgAAAFBQAAACAAAAUGAAAAIAAABQgAAAAgAAAFCQAAACAAAAULAAAAIAAABQwAAAAAAAAGDwAAACAAAQUSAAAAIAABBRQAAAAgAAIFGAAAACAAAgUcAAAAIAADBSgAAAAgAAQFMAAAAAAAEAYAAAEAAAAPBgCAAAAAAA4GAEAAAAAADQYAIABBgBcLhwIBAAEBBQAAAAAAAAUAAAAAAAAGBD0AAAAAAAkF/QEAAAAADwX9fwAAAAAVBf3/HwAAAAMFBQAAAAAABwR9AAAAAAAMBf0PAAAAABIF/f8DAAAAFwX9/38AAAAFBR0AAAAAAAgE/QAAAAAADgX9PwAAAAAUBf3/DwAAAAIFAQAAABAABwR9AAAAAAALBf0HAAAAABEF/f8BAAAAFgX9/z8AAAAEBQ0AAAAQAAgE/QAAAAAADQX9HwAAAAATBf3/BwAAAAEFAQAAABAABgQ9AAAAAAAKBf0DAAAAABAF/f8AAAAAHAX9//8PAAAbBf3//wcAABoF/f//AwAAGQX9//8BAAAYBf3//wBBkBkLhgQBAAEBBgAAAAAAAAYDAAAAAAAABAQAAAAgAAAFBQAAAAAAAAUGAAAAAAAABQgAAAAAAAAFCQAAAAAAAAULAAAAAAAABg0AAAAAAAAGEAAAAAAAAAYTAAAAAAAABhYAAAAAAAAGGQAAAAAAAAYcAAAAAAAABh8AAAAAAAAGIgAAAAAAAQYlAAAAAAABBikAAAAAAAIGLwAAAAAAAwY7AAAAAAAEBlMAAAAAAAcGgwAAAAAACQYDAgAAEAAABAQAAAAAAAAEBQAAACAAAAUGAAAAAAAABQcAAAAgAAAFCQAAAAAAAAUKAAAAAAAABgwAAAAAAAAGDwAAAAAAAAYSAAAAAAAABhUAAAAAAAAGGAAAAAAAAAYbAAAAAAAABh4AAAAAAAAGIQAAAAAAAQYjAAAAAAABBicAAAAAAAIGKwAAAAAAAwYzAAAAAAAEBkMAAAAAAAUGYwAAAAAACAYDAQAAIAAABAQAAAAwAAAEBAAAABAAAAQFAAAAIAAABQcAAAAgAAAFCAAAACAAAAUKAAAAIAAABQsAAAAAAAAGDgAAAAAAAAYRAAAAAAAABhQAAAAAAAAGFwAAAAAAAAYaAAAAAAAABh0AAAAAAAAGIAAAAAAAEAYDAAEAAAAPBgOAAAAAAA4GA0AAAAAADQYDIAAAAAAMBgMQAAAAAAsGAwgAAAAACgYDBABBpB0L2QEBAAAAAwAAAAcAAAAPAAAAHwAAAD8AAAB/AAAA/wAAAP8BAAD/AwAA/wcAAP8PAAD/HwAA/z8AAP9/AAD//wAA//8BAP//AwD//wcA//8PAP//HwD//z8A//9/AP///wD///8B////A////wf///8P////H////z////9/AAAAAAEAAAACAAAABAAAAAAAAAACAAAABAAAAAgAAAAAAAAAAQAAAAIAAAABAAAABAAAAAQAAAAEAAAABAAAAAgAAAAIAAAACAAAAAcAAAAIAAAACQAAAAoAAAALAEGgIAsDwBBQ";class dE extends eQ.CompressedTexture{constructor(e,t,r){super(void 0,e[0].width,e[0].height,t,r,eQ.CubeReflectionMapping),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class d_ extends eQ.CompressedTexture{constructor(e,t,r,n,i,a){super(e,t,r,i,a),this.isCompressedArrayTexture=!0,this.image.depth=n,this.wrapR=eQ.ClampToEdgeWrapping}}class dC extends eQ.Texture{constructor(e=null,t=1,r=1,n=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:r,depth:n},this.magFilter=eQ.NearestFilter,this.minFilter=eQ.NearestFilter,this.wrapR=eQ.ClampToEdgeWrapping,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}var db=Object.defineProperty,dw=(e,t,r)=>t in e?db(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,dB=(e,t,r)=>(dw(e,"symbol"!=typeof t?t+"":t,r),r);let dI="srgb",dM=new WeakMap,dS=0,dT=class extends eQ.Loader{constructor(e){super(e),this.transcoderPath="",this.transcoderBinary=null,this.transcoderPending=null,this.workerPool=new dh,this.workerSourceURL="",this.workerConfig=null,"undefined"!=typeof MSC_TRANSCODER&&console.warn('THREE.KTX2Loader: Please update to latest "basis_transcoder". "msc_basis_transcoder" is no longer supported in three.js r125+.')}setTranscoderPath(e){return this.transcoderPath=e,this}setWorkerLimit(e){return this.workerPool.setWorkerLimit(e),this}detectSupport(e){return this.workerConfig={astcSupported:e.extensions.has("WEBGL_compressed_texture_astc"),etc1Supported:e.extensions.has("WEBGL_compressed_texture_etc1"),etc2Supported:e.extensions.has("WEBGL_compressed_texture_etc"),dxtSupported:e.extensions.has("WEBGL_compressed_texture_s3tc"),bptcSupported:e.extensions.has("EXT_texture_compression_bptc"),pvrtcSupported:e.extensions.has("WEBGL_compressed_texture_pvrtc")||e.extensions.has("WEBKIT_WEBGL_compressed_texture_pvrtc")},e.capabilities.isWebGL2&&(this.workerConfig.etc1Supported=!1),this}init(){if(!this.transcoderPending){let e=new eQ.FileLoader(this.manager);e.setPath(this.transcoderPath),e.setWithCredentials(this.withCredentials);let t=e.loadAsync("basis_transcoder.js"),r=new eQ.FileLoader(this.manager);r.setPath(this.transcoderPath),r.setResponseType("arraybuffer"),r.setWithCredentials(this.withCredentials);let n=r.loadAsync("basis_transcoder.wasm");this.transcoderPending=Promise.all([t,n]).then(([e,t])=>{let r=dT.BasisWorker.toString(),n=["/* constants */","let _EngineFormat = "+JSON.stringify(dT.EngineFormat),"let _TranscoderFormat = "+JSON.stringify(dT.TranscoderFormat),"let _BasisFormat = "+JSON.stringify(dT.BasisFormat),"/* basis_transcoder.js */",e,"/* worker */",r.substring(r.indexOf("{")+1,r.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([n])),this.transcoderBinary=t,this.workerPool.setWorkerCreator(()=>{let e=new Worker(this.workerSourceURL),t=this.transcoderBinary.slice(0);return e.postMessage({type:"init",config:this.workerConfig,transcoderBinary:t},[t]),e})}),dS>0&&console.warn("THREE.KTX2Loader: Multiple active KTX2 loaders may cause performance issues. Use a single KTX2Loader instance, or call .dispose() on old instances."),dS++}return this.transcoderPending}load(e,t,r,n){if(null===this.workerConfig)throw Error("THREE.KTX2Loader: Missing initialization with `.detectSupport( renderer )`.");let i=new eQ.FileLoader(this.manager);i.setResponseType("arraybuffer"),i.setWithCredentials(this.withCredentials),i.load(e,e=>{if(dM.has(e))return dM.get(e).promise.then(t).catch(n);this._createTexture(e).then(e=>t?t(e):null).catch(n)},r,n)}_createTextureFrom(e,t){let r;let{faces:n,width:i,height:a,format:o,type:s,error:l,dfdFlags:c}=e;if("error"===s)return Promise.reject(l);if(6===t.faceCount)r=new dE(n,o,eQ.UnsignedByteType);else{let e=n[0].mipmaps;r=t.layerCount>1?new d_(e,i,a,t.layerCount,o,eQ.UnsignedByteType):new eQ.CompressedTexture(e,i,a,o,eQ.UnsignedByteType)}r.minFilter=1===n[0].mipmaps.length?eQ.LinearFilter:eQ.LinearMipmapLinearFilter,r.magFilter=eQ.LinearFilter,r.generateMipmaps=!1,r.needsUpdate=!0;let u=dz(t);return"colorSpace"in r?r.colorSpace=u:r.encoding=u===dI?3001:3e3,r.premultiplyAlpha=!!(1&c),r}async _createTexture(e,t={}){let r=function(e){let t=new Uint8Array(e.buffer,e.byteOffset,dm.length);if(t[0]!==dm[0]||t[1]!==dm[1]||t[2]!==dm[2]||t[3]!==dm[3]||t[4]!==dm[4]||t[5]!==dm[5]||t[6]!==dm[6]||t[7]!==dm[7]||t[8]!==dm[8]||t[9]!==dm[9]||t[10]!==dm[10]||t[11]!==dm[11])throw Error("Missing KTX 2.0 identifier.");let r=new df,n=17*Uint32Array.BYTES_PER_ELEMENT,i=new dp(e,dm.length,n,!0);r.vkFormat=i._nextUint32(),r.typeSize=i._nextUint32(),r.pixelWidth=i._nextUint32(),r.pixelHeight=i._nextUint32(),r.pixelDepth=i._nextUint32(),r.layerCount=i._nextUint32(),r.faceCount=i._nextUint32();let a=i._nextUint32();r.supercompressionScheme=i._nextUint32();let o=i._nextUint32(),s=i._nextUint32(),l=i._nextUint32(),c=i._nextUint32(),u=i._nextUint64(),h=i._nextUint64(),d=new dp(e,dm.length+n,24*a,!0);for(let t=0;t<a;t++)r.levels.push({levelData:new Uint8Array(e.buffer,e.byteOffset+d._nextUint64(),d._nextUint64()),uncompressedByteLength:d._nextUint64()});let f=new dp(e,o,s,!0),p={vendorId:f._skip(4)._nextUint16(),descriptorType:f._nextUint16(),versionNumber:f._nextUint16(),descriptorBlockSize:f._nextUint16(),colorModel:f._nextUint8(),colorPrimaries:f._nextUint8(),transferFunction:f._nextUint8(),flags:f._nextUint8(),texelBlockDimension:[f._nextUint8(),f._nextUint8(),f._nextUint8(),f._nextUint8()],bytesPlane:[f._nextUint8(),f._nextUint8(),f._nextUint8(),f._nextUint8(),f._nextUint8(),f._nextUint8(),f._nextUint8(),f._nextUint8()],samples:[]},m=(p.descriptorBlockSize/4-6)/4;for(let e=0;e<m;e++){let t={bitOffset:f._nextUint16(),bitLength:f._nextUint8(),channelType:f._nextUint8(),samplePosition:[f._nextUint8(),f._nextUint8(),f._nextUint8(),f._nextUint8()],sampleLower:-1/0,sampleUpper:1/0};64&t.channelType?(t.sampleLower=f._nextInt32(),t.sampleUpper=f._nextInt32()):(t.sampleLower=f._nextUint32(),t.sampleUpper=f._nextUint32()),p.samples[e]=t}r.dataFormatDescriptor.length=0,r.dataFormatDescriptor.push(p);let A=new dp(e,l,c,!0);for(;A._offset<c;){let e=A._nextUint32(),t=A._scan(e),n=dA(t);if(r.keyValue[n]=A._nextUint8Array(e-t.byteLength-1),n.match(/^ktx/i)){let e=dA(r.keyValue[n]);r.keyValue[n]=e.substring(0,e.lastIndexOf("\0"))}let i=e%4?4-e%4:0;A._skip(i)}if(h<=0)return r;let g=new dp(e,u,h,!0),v=g._nextUint16(),y=g._nextUint16(),x=g._nextUint32(),E=g._nextUint32(),_=g._nextUint32(),C=g._nextUint32(),b=[];for(let e=0;e<a;e++)b.push({imageFlags:g._nextUint32(),rgbSliceByteOffset:g._nextUint32(),rgbSliceByteLength:g._nextUint32(),alphaSliceByteOffset:g._nextUint32(),alphaSliceByteLength:g._nextUint32()});let w=u+g._offset,B=w+x,I=B+E,M=I+_,S=new Uint8Array(e.buffer,e.byteOffset+w,x),T=new Uint8Array(e.buffer,e.byteOffset+B,E),P=new Uint8Array(e.buffer,e.byteOffset+I,_),D=new Uint8Array(e.buffer,e.byteOffset+M,C);return r.globalData={endpointCount:v,selectorCount:y,imageDescs:b,endpointsData:S,selectorsData:T,tablesData:P,extendedData:D},r}(new Uint8Array(e));if(0!==r.vkFormat)return dF(r);let n=this.init().then(()=>this.workerPool.postMessage({type:"transcode",buffer:e,taskConfig:t},[e])).then(e=>this._createTextureFrom(e.data,r));return dM.set(e,{promise:n}),n}dispose(){return this.workerPool.dispose(),this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),dS--,this}};dB(dT,"BasisFormat",{ETC1S:0,UASTC_4x4:1}),dB(dT,"TranscoderFormat",{ETC1:0,ETC2:1,BC1:2,BC3:3,BC4:4,BC5:5,BC7_M6_OPAQUE_ONLY:6,BC7_M5:7,PVRTC1_4_RGB:8,PVRTC1_4_RGBA:9,ASTC_4x4:10,ATC_RGB:11,ATC_RGBA_INTERPOLATED_ALPHA:12,RGBA32:13,RGB565:14,BGR565:15,RGBA4444:16}),dB(dT,"EngineFormat",{RGBAFormat:eQ.RGBAFormat,RGBA_ASTC_4x4_Format:eQ.RGBA_ASTC_4x4_Format,RGBA_BPTC_Format:eQ.RGBA_BPTC_Format,RGBA_ETC2_EAC_Format:eQ.RGBA_ETC2_EAC_Format,RGBA_PVRTC_4BPPV1_Format:eQ.RGBA_PVRTC_4BPPV1_Format,RGBA_S3TC_DXT5_Format:eQ.RGBA_S3TC_DXT5_Format,RGB_ETC1_Format:eQ.RGB_ETC1_Format,RGB_ETC2_Format:eQ.RGB_ETC2_Format,RGB_PVRTC_4BPPV1_Format:eQ.RGB_PVRTC_4BPPV1_Format,RGB_S3TC_DXT1_Format:eQ.RGB_S3TC_DXT1_Format}),dB(dT,"BasisWorker",function(){let e,t,r;let n=_EngineFormat,i=_TranscoderFormat,a=_BasisFormat;self.addEventListener("message",function(o){let u=o.data;switch(u.type){case"init":var h;e=u.config,h=u.transcoderBinary,t=new Promise(e=>{BASIS(r={wasmBinary:h,onRuntimeInitialized:e})}).then(()=>{r.initializeBasis(),void 0===r.KTX2File&&console.warn("THREE.KTX2Loader: Please update Basis Universal transcoder.")});break;case"transcode":t.then(()=>{try{let{faces:t,buffers:o,width:h,height:d,hasAlpha:f,format:p,dfdFlags:m}=function(t){let o=new r.KTX2File(new Uint8Array(t));function u(){o.close(),o.delete()}if(!o.isValid())throw u(),Error("THREE.KTX2Loader:	Invalid or unsupported .ktx2 file");let h=o.isUASTC()?a.UASTC_4x4:a.ETC1S,d=o.getWidth(),f=o.getHeight(),p=o.getLayers()||1,m=o.getLevels(),A=o.getFaces(),g=o.getHasAlpha(),v=o.getDFDFlags(),{transcoderFormat:y,engineFormat:x}=function(t,r,o,u){let h;let d=t===a.ETC1S?s:l;for(let n=0;n<d.length;n++){let i=d[n];if(e[i.if]&&i.basisFormat.includes(t)&&(!u||!(i.transcoderFormat.length<2))&&(!i.needsPowerOfTwo||c(r)&&c(o)))return{transcoderFormat:i.transcoderFormat[u?1:0],engineFormat:i.engineFormat[u?1:0]}}return console.warn("THREE.KTX2Loader: No suitable compressed texture format found. Decoding to RGBA32."),{transcoderFormat:i.RGBA32,engineFormat:n.RGBAFormat}}(h,d,f,g);if(!d||!f||!m)throw u(),Error("THREE.KTX2Loader:	Invalid texture");if(!o.startTranscoding())throw u(),Error("THREE.KTX2Loader: .startTranscoding failed");let E=[],_=[];for(let e=0;e<A;e++){let t=[];for(let r=0;r<m;r++){let n,i;let a=[];for(let t=0;t<p;t++){let s=o.getImageLevelInfo(r,t,e);0===e&&0===r&&0===t&&(s.origWidth%4!=0||s.origHeight%4!=0)&&console.warn("THREE.KTX2Loader: ETC1S and UASTC textures should use multiple-of-four dimensions."),m>1?(n=s.origWidth,i=s.origHeight):(n=s.width,i=s.height);let l=new Uint8Array(o.getImageTranscodedSizeInBytes(r,t,0,y));if(!o.transcodeImage(l,r,t,e,y,0,-1,-1))throw u(),Error("THREE.KTX2Loader: .transcodeImage failed.");a.push(l)}let s=function(e){if(1===e.length)return e[0];let t=0;for(let r=0;r<e.length;r++)t+=e[r].byteLength;let r=new Uint8Array(t),n=0;for(let t=0;t<e.length;t++){let i=e[t];r.set(i,n),n+=i.byteLength}return r}(a);t.push({data:s,width:n,height:i}),_.push(s.buffer)}E.push({mipmaps:t,width:d,height:f,format:x})}return u(),{faces:E,buffers:_,width:d,height:f,hasAlpha:g,format:x,dfdFlags:v}}(u.buffer);self.postMessage({type:"transcode",id:u.id,faces:t,width:h,height:d,hasAlpha:f,format:p,dfdFlags:m},o)}catch(e){console.error(e),self.postMessage({type:"error",id:u.id,error:e.message})}})}});let o=[{if:"astcSupported",basisFormat:[a.UASTC_4x4],transcoderFormat:[i.ASTC_4x4,i.ASTC_4x4],engineFormat:[n.RGBA_ASTC_4x4_Format,n.RGBA_ASTC_4x4_Format],priorityETC1S:1/0,priorityUASTC:1,needsPowerOfTwo:!1},{if:"bptcSupported",basisFormat:[a.ETC1S,a.UASTC_4x4],transcoderFormat:[i.BC7_M5,i.BC7_M5],engineFormat:[n.RGBA_BPTC_Format,n.RGBA_BPTC_Format],priorityETC1S:3,priorityUASTC:2,needsPowerOfTwo:!1},{if:"dxtSupported",basisFormat:[a.ETC1S,a.UASTC_4x4],transcoderFormat:[i.BC1,i.BC3],engineFormat:[n.RGB_S3TC_DXT1_Format,n.RGBA_S3TC_DXT5_Format],priorityETC1S:4,priorityUASTC:5,needsPowerOfTwo:!1},{if:"etc2Supported",basisFormat:[a.ETC1S,a.UASTC_4x4],transcoderFormat:[i.ETC1,i.ETC2],engineFormat:[n.RGB_ETC2_Format,n.RGBA_ETC2_EAC_Format],priorityETC1S:1,priorityUASTC:3,needsPowerOfTwo:!1},{if:"etc1Supported",basisFormat:[a.ETC1S,a.UASTC_4x4],transcoderFormat:[i.ETC1],engineFormat:[n.RGB_ETC1_Format],priorityETC1S:2,priorityUASTC:4,needsPowerOfTwo:!1},{if:"pvrtcSupported",basisFormat:[a.ETC1S,a.UASTC_4x4],transcoderFormat:[i.PVRTC1_4_RGB,i.PVRTC1_4_RGBA],engineFormat:[n.RGB_PVRTC_4BPPV1_Format,n.RGBA_PVRTC_4BPPV1_Format],priorityETC1S:5,priorityUASTC:6,needsPowerOfTwo:!0}],s=o.sort(function(e,t){return e.priorityETC1S-t.priorityETC1S}),l=o.sort(function(e,t){return e.priorityUASTC-t.priorityUASTC});function c(e){return e<=2||(e&e-1)==0&&0!==e}});let dP=new Set([eQ.RGBAFormat,eQ.RGFormat,eQ.RedFormat]),dD={109:eQ.RGBAFormat,97:eQ.RGBAFormat,37:eQ.RGBAFormat,43:eQ.RGBAFormat,103:eQ.RGFormat,83:eQ.RGFormat,16:eQ.RGFormat,22:eQ.RGFormat,100:eQ.RedFormat,76:eQ.RedFormat,15:eQ.RedFormat,9:eQ.RedFormat,166:eQ.RGBA_ASTC_6x6_Format,165:eQ.RGBA_ASTC_6x6_Format},dR={109:eQ.FloatType,97:eQ.HalfFloatType,37:eQ.UnsignedByteType,43:eQ.UnsignedByteType,103:eQ.FloatType,83:eQ.HalfFloatType,16:eQ.UnsignedByteType,22:eQ.UnsignedByteType,100:eQ.FloatType,76:eQ.HalfFloatType,15:eQ.UnsignedByteType,9:eQ.UnsignedByteType,166:eQ.UnsignedByteType,165:eQ.UnsignedByteType};async function dF(e){let t,r;let{vkFormat:n}=e;if(void 0===dD[n])throw Error("THREE.KTX2Loader: Unsupported vkFormat.");2===e.supercompressionScheme&&(N||(N=new Promise(async e=>{let t=new dy;await t.init(),e(t)})),t=await N);let i=[];for(let r=0;r<e.levels.length;r++){let a,o;let s=Math.max(1,e.pixelWidth>>r),l=Math.max(1,e.pixelHeight>>r),c=e.pixelDepth?Math.max(1,e.pixelDepth>>r):0,u=e.levels[r];if(0===e.supercompressionScheme)a=u.levelData;else if(2===e.supercompressionScheme)a=t.decode(u.levelData,u.uncompressedByteLength);else throw Error("THREE.KTX2Loader: Unsupported supercompressionScheme.");o=dR[n]===eQ.FloatType?new Float32Array(a.buffer,a.byteOffset,a.byteLength/Float32Array.BYTES_PER_ELEMENT):dR[n]===eQ.HalfFloatType?new Uint16Array(a.buffer,a.byteOffset,a.byteLength/Uint16Array.BYTES_PER_ELEMENT):a,i.push({data:o,width:s,height:l,depth:c})}if(dP.has(dD[n]))r=0===e.pixelDepth?new eQ.DataTexture(i[0].data,e.pixelWidth,e.pixelHeight):new dC(i[0].data,e.pixelWidth,e.pixelHeight,e.pixelDepth);else{if(e.pixelDepth>0)throw Error("THREE.KTX2Loader: Unsupported pixelDepth.");r=new eQ.CompressedTexture(i,e.pixelWidth,e.pixelHeight)}r.mipmaps=i,r.type=dR[n],r.format=dD[n],r.needsUpdate=!0;let a=dz(e);return"colorSpace"in r?r.colorSpace=a:r.encoding=a===dI?3001:3e3,Promise.resolve(r)}function dz(e){let t=e.dataFormatDescriptor[0];return 1===t.colorPrimaries?2===t.transferFunction?dI:"srgb-linear":10===t.colorPrimaries?2===t.transferFunction?"display-p3":"display-p3-linear":(0===t.colorPrimaries||console.warn(`THREE.KTX2Loader: Unsupported color primaries, "${t.colorPrimaries}"`),"")}let dO="https://cdn.jsdelivr.net/gh/pmndrs/drei-assets@master";function dQ(e,t=`${dO}/basis/`){let r=(0,eL.A)(e=>e.gl),n=(0,eL.F)(dT,sy(e)?Object.values(e):e,e=>{e.detectSupport(r),e.setTranscoderPath(t)});if((0,ez.useEffect)(()=>{(Array.isArray(n)?n:[n]).forEach(r.initTexture)},[r,n]),!sy(e))return n;{let t=Object.keys(e),r={};return t.forEach(e=>Object.assign(r,{[e]:n[t.indexOf(e)]})),r}}dQ.preload=(e,t=`${dO}/basis/`)=>eL.F.preload(dT,e,e=>{e.setTranscoderPath(t)}),dQ.clear=e=>eL.F.clear(dT,e);let dL=({children:e,input:t,basisPath:r})=>{let n=dQ(t,r);return ez.createElement(ez.Fragment,null,null==e?void 0:e(n))},dk="undefined"!=typeof window&&"function"==typeof(null==(eP=window.document)?void 0:eP.createElement)&&"string"==typeof(null==(eD=window.navigator)?void 0:eD.userAgent),dU=null;async function dN(e,t){if(dk&&e.pathname.endsWith(".m3u8")){var n;if(null!==(n=dU)&&void 0!==n||(dU=await r.e(350).then(r.t.bind(r,5351,23))),dU.default.isSupported())return new dU.default({...t})}return null}function dG(e,{unsuspend:t="loadedmetadata",start:r=!0,crossOrigin:n="anonymous",muted:i=!0,loop:a=!0,hls:o={},...s}={}){let l=new URL("string"==typeof e?e:"",window.location.href),c=(0,ez.useRef)(null),u=(0,ez.useRef)(null),h=(0,eL.A)(e=>e.gl),d=(0,oQ.Rq)(()=>new Promise(async r=>{let d=Object.assign(document.createElement("video"),{src:"string"==typeof e&&e||void 0,srcObject:e instanceof MediaStream&&e||void 0,crossOrigin:n,loop:a,muted:i,...s});if(u.current=d,"string"==typeof e){let t=c.current=await dN(l,o);t?(t.attachMedia(d),t.on("hlsMediaAttached",()=>{t.loadSource(e)})):d.src=e}else e instanceof MediaStream&&(d.srcObject=e);let f=new eQ.VideoTexture(d);"colorSpace"in f?f.colorSpace=h.outputColorSpace:f.encoding=h.outputEncoding,d.addEventListener(t,()=>r(f))}),[e]);return(0,ez.useEffect)(()=>(r&&d.image.play(),()=>{c.current&&(c.current.destroy(),c.current=null)}),[d,r]),d}let dH=({children:e,src:t,...r})=>{let n=dG(t,r);return ez.createElement(ez.Fragment,null,null==e?void 0:e(n))},dV=e=>{if(Array.isArray(e))return e[0];if("object"!=typeof e||null===e)return{w:0,h:0};{let t=Object.keys(e);return e[t[0]][0]}},dj=e=>{for(let t=3;t<e.length;t+=4)if(0!==e[t])return!1;return!0},dY=(e,t,r,n)=>{let i=t*(n.aspect>e/t?n.width/e:n.height/t),a=e*(n.aspect>e/t?n.width/e:n.height/t)*r,o=i*r,s=Math.min(1,a),l=Math.min(1,o);return a>1&&(s=1,l=o/a*1),new eQ.Vector3(s,l,1)};function dJ(e,t,r,n,i){let a=(0,eL.A)(e=>e.viewport),o=ez.useRef(null),s=ez.useRef(0),[l,c]=(0,ez.useState)(null),[u,h]=ez.useState(new eQ.Texture),d=new eQ.TextureLoader,[f,p]=(0,ez.useState)(null);function m(t){(t||e)&&new Promise(r=>{d.load(null!=t?t:e,r)}).then(e=>{g(null,e)})}function A(e,t,r){Promise.all([fetch(e).then(e=>e.json()),new Promise(e=>{d.load(t,e)})]).then(e=>{r(e[0],e[1])})}ez.useLayoutEffect(()=>(t&&e?A(t,e,g):e&&m(),()=>{e&&eL.F.clear(eQ.TextureLoader,e)}),[]);let g=(e,t)=>{let r=new eQ.Vector3(1,1,1);if(null===e){if(t&&n){let e=t.image.width,i=t.image.height;s.current=n;let{rows:l,columns:c,frameWidth:u,frameHeight:h,emptyFrames:d}=v(t,n);o.current={frames:[],meta:{version:"1.0",size:{w:e,h:i},rows:l,columns:c,frameWidth:u,frameHeight:h,scale:"1"}};for(let e=0;e<l;e++)for(let t=0;t<c;t++)(null!=d?d:[]).some(r=>r.row===e&&r.col===t)||o.current.frames.push({frame:{x:t*u,y:e*h,w:u,h:h},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:u,h:h},sourceSize:{w:u,h:h}});r=dY(u,h,.1,a)}o.current.frames=x(o.current.frames)}else if(t){o.current=e,o.current.frames=y(),s.current=Array.isArray(e.frames)?e.frames.length:Object.keys(e.frames).length;let{w:t,h:n}=dV(e.frames).sourceSize;r=dY(t,n,.1,a)}c(o.current),"encoding"in t?t.encoding=3001:t.colorSpace=eQ.SRGBColorSpace,h(t),p({spriteTexture:t,spriteData:o.current,aspect:r})},v=(e,t)=>{if(!e.image)return{rows:0,columns:0,frameWidth:0,frameHeight:0,emptyFrames:[]};{let r=document.createElement("canvas"),n=r.getContext("2d");r.width=e.image.width,r.height=e.image.height,n.drawImage(e.image,0,0);let i=e.image.width,a=e.image.height,o=Math.round(Math.sqrt(i/a*t)),s=Math.round(t/o),l=i/o,c=a/s,u=[];for(let e=0;e<s;e++)for(let r=0;r<o;r++){if(e*o+r>=t){u.push({row:e,col:r});continue}dj(n.getImageData(r*l,e*c,l,c).data)&&u.push({row:e,col:r})}return{rows:s,columns:o,frameWidth:l,frameHeight:c,emptyFrames:u}}},y=()=>{let e={},t=o.current;if(r&&Array.isArray(t.frames)){for(let n=0;n<r.length;n++)for(let i of(e[r[n]]=[],t.frames)){let t=i.frame,a=t.x,o=t.y,s=t.w,l=t.h,c=i.sourceSize.w,u=i.sourceSize.h;"string"==typeof i.filename&&-1!==i.filename.toLowerCase().indexOf(r[n].toLowerCase())&&e[r[n]].push({x:a,y:o,w:s,h:l,frame:t,sourceSize:{w:c,h:u}})}for(let t in e)e[t].frame=x(e[t]);return e}if(r&&"object"==typeof t.frames){for(let n=0;n<r.length;n++)for(let i in e[r[n]]=[],t.frames){let a=t.frames[i],o=a.frame,s=o.x,l=o.y,c=o.w,u=o.h,h=a.sourceSize.w,d=a.sourceSize.h;"string"==typeof i&&-1!==i.toLowerCase().indexOf(r[n].toLowerCase())&&e[r[n]].push({x:s,y:l,w:c,h:u,frame:o,sourceSize:{w:h,h:d}})}for(let t in e)e[t].frame=x(e[t]);return e}{let e=[];for(let r in t.frames)e.push(t.frames[r]);return x(e)}},x=e=>{let t=null;for(let r of e){let{w:e,h:n}=r.frame,i=e*n;(!t||i>t.area)&&(t={...r.frame,area:i})}for(let i of e){var r,n;let{w:e,h:a}=i.frame,o=e*a;o===(null==(r=t)?void 0:r.area)?i.scaleRatio=1:i.scaleRatio=Math.sqrt(o/(null==(n=t)?void 0:n.area))}return e};return ez.useLayoutEffect(()=>{null==i||i(u,l)},[u,l]),{spriteObj:f,loadJsonAndTexture:function(e,t){t&&e?A(t,e,g):m(e)}}}function dW(e,t,...r){let n=ez.useRef(),i=(0,eL.A)(e=>e.scene);return ez.useLayoutEffect(()=>{let a;if(e&&null!=e&&e.current&&t&&(n.current=a=new t(e.current,...r)),a)return a.traverse(e=>e.raycast=()=>null),i.add(a),()=>{n.current=void 0,i.remove(a),null==a.dispose||a.dispose()}},[i,t,e,...r]),(0,eL.C)(()=>{var e;null==(e=n.current)||null==e.update||e.update()}),n}dJ.preload=e=>eL.F.preload(eQ.TextureLoader,e),dJ.clear=e=>eL.F.clear(eQ.TextureLoader,e);let dq=({type:e,args:t=[]})=>{let r=ez.useRef(null),n=ez.useRef(null);return ez.useLayoutEffect(()=>{n.current=r.current.parent}),dW(n,e,...t),ez.createElement("object3D",{ref:r})};var dK=r(3728),dX=r.n(dK);function dZ(e,t){"function"==typeof e?e(t):null!=e&&(e.current=t)}function d$({showPanel:e=0,className:t,parent:r}){let n=function(e,t=[],r){let[n,i]=ez.useState();return ez.useLayoutEffect(()=>{let t=e();return i(t),dZ(void 0,t),()=>dZ(void 0,null)},t),n}(()=>new(dX()),[]);return ez.useEffect(()=>{if(n){let i=r&&r.current||document.body;n.showPanel(e),null==i||i.appendChild(n.dom);let a=(null!=t?t:"").split(" ").filter(e=>e);a.length&&n.dom.classList.add(...a);let o=(0,eL.n)(()=>n.begin()),s=(0,eL.o)(()=>n.end());return()=>{a.length&&n.dom.classList.remove(...a),null==i||i.removeChild(n.dom),o(),s()}}},[r,n,t,e]),null}class d0{constructor(e,t,r){this.name=e,this.fg=t,this.bg=r,this.PR=Math.round(window.devicePixelRatio||1),this.WIDTH=90*this.PR,this.HEIGHT=48*this.PR,this.TEXT_X=3*this.PR,this.TEXT_Y=2*this.PR,this.GRAPH_X=3*this.PR,this.GRAPH_Y=15*this.PR,this.GRAPH_WIDTH=84*this.PR,this.GRAPH_HEIGHT=30*this.PR,this.canvas=document.createElement("canvas"),this.canvas.width=90*this.PR,this.canvas.height=48*this.PR,this.canvas.style.width="90px",this.canvas.style.position="absolute",this.canvas.style.height="48px",this.canvas.style.cssText="width:90px;height:48px",this.context=this.canvas.getContext("2d"),this.context&&(this.context.font="bold "+9*this.PR+"px Helvetica,Arial,sans-serif",this.context.textBaseline="top",this.context.fillStyle=this.bg,this.context.fillRect(0,0,this.WIDTH,this.HEIGHT),this.context.fillStyle=this.fg,this.context.fillText(this.name,this.TEXT_X,this.TEXT_Y),this.context.fillRect(this.GRAPH_X,this.GRAPH_Y,this.GRAPH_WIDTH,this.GRAPH_HEIGHT),this.context.fillStyle=this.bg,this.context.globalAlpha=.9,this.context.fillRect(this.GRAPH_X,this.GRAPH_Y,this.GRAPH_WIDTH,this.GRAPH_HEIGHT))}update(e,t,r,n,i=0){let a=1/0,o=0;this.context&&(a=Math.min(a,e),o=Math.max(r,e),n=Math.max(n,t),this.context.fillStyle=this.bg,this.context.globalAlpha=1,this.context.fillRect(0,0,this.WIDTH,this.GRAPH_Y),this.context.fillStyle=this.fg,this.context.fillText(e.toFixed(i)+" "+this.name+" ("+a.toFixed(i)+"-"+parseFloat(o.toFixed(i))+")",this.TEXT_X,this.TEXT_Y),this.context.drawImage(this.canvas,this.GRAPH_X+this.PR,this.GRAPH_Y,this.GRAPH_WIDTH-this.PR,this.GRAPH_HEIGHT,this.GRAPH_X,this.GRAPH_Y,this.GRAPH_WIDTH-this.PR,this.GRAPH_HEIGHT),this.context.fillRect(this.GRAPH_X+this.GRAPH_WIDTH-this.PR,this.GRAPH_Y,this.PR,this.GRAPH_HEIGHT),this.context.fillStyle=this.bg,this.context.globalAlpha=.9,this.context.fillRect(this.GRAPH_X+this.GRAPH_WIDTH-this.PR,this.GRAPH_Y,this.PR,(1-t/n)*this.GRAPH_HEIGHT))}}let d1=class e{constructor({logsPerSecond:t=20,samplesLog:r=100,samplesGraph:n=10,precision:i=2,minimal:a=!1,horizontal:o=!0,mode:s=0}={}){this.totalCpuDuration=0,this.totalGpuDuration=0,this.totalGpuDurationCompute=0,this.totalFps=0,this.activeQuery=null,this.gpuQueries=[],this.renderCount=0,this.mode=s,this.horizontal=o,this.dom=document.createElement("div"),this.dom.style.cssText="position:fixed;top:0;left:0;opacity:0.9;z-index:10000;",a&&(this.dom.style.cssText+="cursor:pointer"),this.gl=null,this.query=null,this.isRunningCPUProfiling=!1,this.minimal=a,this.beginTime=(performance||Date).now(),this.prevTime=this.beginTime,this.prevCpuTime=this.beginTime,this.frames=0,this.renderCount=0,this.threeRendererPatched=!1,this.averageCpu={logs:[],graph:[]},this.averageGpu={logs:[],graph:[]},this.averageGpuCompute={logs:[],graph:[]},this.queryCreated=!1,this.fpsPanel=this.addPanel(new e.Panel("FPS","#0ff","#002"),0),this.msPanel=this.addPanel(new e.Panel("CPU","#0f0","#020"),1),this.gpuPanel=null,this.gpuPanelCompute=null,this.samplesLog=r,this.samplesGraph=n,this.precision=i,this.logsPerSecond=t,this.minimal?(this.dom.addEventListener("click",e=>{e.preventDefault(),this.showPanel(++this.mode%this.dom.children.length)},!1),this.mode=s,this.showPanel(this.mode)):window.addEventListener("resize",()=>{this.resizePanel(this.fpsPanel,0),this.resizePanel(this.msPanel,1),this.gpuPanel&&this.resizePanel(this.gpuPanel,2),this.gpuPanelCompute&&this.resizePanel(this.gpuPanelCompute,3)})}patchThreeRenderer(e){let t=e.render,r=this;e.render=function(e,n){r.begin(),t.call(this,e,n),r.end()},this.threeRendererPatched=!0}resizePanel(e,t){e.canvas.style.position="absolute",this.minimal?e.canvas.style.display="none":(e.canvas.style.display="block",this.horizontal?(e.canvas.style.top="0px",e.canvas.style.left=t*e.WIDTH/e.PR+"px"):(e.canvas.style.left="0px",e.canvas.style.top=t*e.HEIGHT/e.PR+"px"))}addPanel(e,t){return e.canvas&&(this.dom.appendChild(e.canvas),this.resizePanel(e,t)),e}showPanel(e){for(let t=0;t<this.dom.children.length;t++)this.dom.children[t].style.display=t===e?"block":"none";this.mode=e}async init(t){if(!t){console.error('Stats: The "canvas" parameter is undefined.');return}if(t.isWebGLRenderer&&!this.threeRendererPatched?(this.patchThreeRenderer(t),this.gl=t.getContext()):!this.gl&&t instanceof WebGL2RenderingContext&&(this.gl=t),t.isWebGPURenderer){t.backend.trackTimestamp=!0,await t.hasFeatureAsync("timestamp-query")&&(this.gpuPanel=this.addPanel(new e.Panel("GPU","#ff0","#220"),2),this.gpuPanelCompute=this.addPanel(new e.Panel("CPT","#e1e1e1","#212121"),3),this.info=t.info);return}if(!this.gl&&t instanceof HTMLCanvasElement||t instanceof OffscreenCanvas){if(this.gl=t.getContext("webgl2"),!this.gl){console.error("Stats: Unable to obtain WebGL2 context.");return}}else if(!this.gl){console.error("Stats: Invalid input type. Expected WebGL2RenderingContext, HTMLCanvasElement, or OffscreenCanvas.");return}this.ext=this.gl.getExtension("EXT_disjoint_timer_query_webgl2"),this.ext&&(this.gpuPanel=this.addPanel(new e.Panel("GPU","#ff0","#220"),2))}begin(){this.isRunningCPUProfiling||this.beginProfiling("cpu-started"),this.gl&&this.ext&&this.gl&&this.ext&&(this.activeQuery&&this.gl.endQuery(this.ext.TIME_ELAPSED_EXT),this.activeQuery=this.gl.createQuery(),null!==this.activeQuery&&this.gl.beginQuery(this.ext.TIME_ELAPSED_EXT,this.activeQuery))}end(){this.renderCount++,this.gl&&this.ext&&this.activeQuery&&(this.gl.endQuery(this.ext.TIME_ELAPSED_EXT),this.gpuQueries.push({query:this.activeQuery}),this.activeQuery=null)}processGpuQueries(){this.gl&&this.ext&&(this.totalGpuDuration=0,this.gpuQueries.forEach((e,t)=>{if(this.gl){let r=this.gl.getQueryParameter(e.query,this.gl.QUERY_RESULT_AVAILABLE),n=this.gl.getParameter(this.ext.GPU_DISJOINT_EXT);if(r&&!n){let r=this.gl.getQueryParameter(e.query,this.gl.QUERY_RESULT);this.totalGpuDuration+=1e-6*r,this.gl.deleteQuery(e.query),this.gpuQueries.splice(t,1)}}}))}update(){void 0===this.info?this.processGpuQueries():(this.totalGpuDuration=this.info.render.timestamp,this.totalGpuDurationCompute=this.info.compute.timestamp,this.addToAverage(this.totalGpuDurationCompute,this.averageGpuCompute)),this.endProfiling("cpu-started","cpu-finished","cpu-duration"),this.addToAverage(this.totalCpuDuration,this.averageCpu),this.addToAverage(this.totalGpuDuration,this.averageGpu),this.renderCount=0,0===this.totalCpuDuration&&this.beginProfiling("cpu-started"),this.totalCpuDuration=0,this.totalFps=0,this.beginTime=this.endInternal()}endInternal(){this.frames++;let e=(performance||Date).now();if(e>=this.prevCpuTime+1e3/this.logsPerSecond&&(this.updatePanel(this.msPanel,this.averageCpu),this.updatePanel(this.gpuPanel,this.averageGpu),this.gpuPanelCompute&&this.updatePanel(this.gpuPanelCompute,this.averageGpuCompute),this.prevCpuTime=e),e>=this.prevTime+1e3){let t=1e3*this.frames/(e-this.prevTime);this.fpsPanel.update(t,t,100,100,0),this.prevTime=e,this.frames=0}return e}addToAverage(e,t){t.logs.push(e),t.logs.length>this.samplesLog&&t.logs.shift(),t.graph.push(e),t.graph.length>this.samplesGraph&&t.graph.shift()}beginProfiling(e){window.performance&&(window.performance.mark(e),this.isRunningCPUProfiling=!0)}endProfiling(e,t,r){if(window.performance&&t&&this.isRunningCPUProfiling){window.performance.mark(t);let n=performance.measure(r,e,t);this.totalCpuDuration+=n.duration,this.isRunningCPUProfiling=!1}}updatePanel(e,t){if(t.logs.length>0){let r=0,n=.01;for(let e=0;e<t.logs.length;e++)r+=t.logs[e],t.logs[e]>n&&(n=t.logs[e]);let i=0,a=.01;for(let e=0;e<t.graph.length;e++)i+=t.graph[e],t.graph[e]>a&&(a=t.graph[e]);e&&e.update(r/Math.min(t.logs.length,this.samplesLog),i/Math.min(t.graph.length,this.samplesGraph),n,a,this.precision)}}get domElement(){return this.dom}get container(){return console.warn("Stats: Deprecated! this.container as been replaced to this.dom "),this.dom}};function d2({className:e,parent:t,...r}){let n=(0,eL.A)(e=>e.gl),i=ez.useMemo(()=>{let e=new d1({...r});return e.init(n),e},[n]);return ez.useEffect(()=>{if(i){let r=t&&t.current||document.body;null==r||r.appendChild(i.dom);let n=(null!=e?e:"").split(" ").filter(e=>e);n.length&&i.dom.classList.add(...n);let a=(0,eL.o)(()=>i.update());return()=>{n.length&&i.dom.classList.remove(...n),null==r||r.removeChild(i.dom),a()}}},[t,i,e]),null}function d3({size:e=256,frames:t=1/0}={}){let r=(0,eL.A)(e=>e.viewport.dpr),{width:n,height:i}=(0,eL.A)(e=>e.size),a=e||n*r,o=e||i*r,s=ez.useMemo(()=>{let e=new eQ.DepthTexture(a,o);return e.format=eQ.DepthFormat,e.type=eQ.UnsignedShortType,{depthTexture:e}},[a,o]),l=0,c=ca(a,o,s);return(0,eL.C)(e=>{(t===1/0||l<t)&&(e.gl.setRenderTarget(c),e.gl.render(e.scene,e.camera),e.gl.setRenderTarget(null),l++)}),c.depthTexture}function d4(e,t,r=1){let n=(0,eL.A)(e=>e.viewport),i=t*(n.aspect>e/t?n.width/e:n.height/t);return[e*(n.aspect>e/t?n.width/e:n.height/t)*r,i*r,1]}function d5(e,t){let r=(0,eL.A)(e=>e.pointer),[n]=ez.useState(()=>{let n=new eQ.Raycaster;return t&&(0,eL.j)(n,t,{}),function(t,i){n.setFromCamera(r,e instanceof eQ.Camera?e:e.current);let a=this.constructor.prototype.raycast.bind(this);a&&a(n,i)}});return n}function d6(e,t,r,n){return new(r||(r=Promise))(function(i,a){function o(e){try{l(n.next(e))}catch(e){a(e)}}function s(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(o,s)}l((n=n.apply(e,t||[])).next())})}d1.Panel=d0,"function"==typeof SuppressedError&&SuppressedError;let d8=["geforce 320m","geforce 8600","geforce 8600m gt","geforce 8800 gs","geforce 8800 gt","geforce 9400","geforce 9400m g","geforce 9400m","geforce 9600m gt","geforce 9600m","geforce fx go5200","geforce gt 120","geforce gt 130","geforce gt 330m","geforce gtx 285","google swiftshader","intel g41","intel g45","intel gma 4500mhd","intel gma x3100","intel hd 3000","intel q45","legacy","mali-2","mali-3","mali-4","quadro fx 1500","quadro fx 4","quadro fx 5","radeon hd 2400","radeon hd 2600","radeon hd 4670","radeon hd 4850","radeon hd 4870","radeon hd 5670","radeon hd 5750","radeon hd 6290","radeon hd 6300","radeon hd 6310","radeon hd 6320","radeon hd 6490m","radeon hd 6630m","radeon hd 6750m","radeon hd 6770m","radeon hd 6970m","sgx 543","sgx543"];function d9(e){return e=e.toLowerCase().replace(/.*angle ?\((.+)\)(?: on vulkan [0-9.]+)?$/i,"$1").replace(/\s(\d{1,2}gb|direct3d.+$)|\(r\)| \([^)]+\)$/g,"").replace(/(?:vulkan|opengl) \d+\.\d+(?:\.\d+)?(?: \((.*)\))?/,"$1")}let d7="undefined"==typeof window,fe=(()=>{if(d7)return;let{userAgent:e,platform:t,maxTouchPoints:r}=window.navigator,n=/(iphone|ipod|ipad)/i.test(e),i="iPad"===t||"MacIntel"===t&&r>0&&!window.MSStream;return{isIpad:i,isMobile:/android/i.test(e)||n||i,isSafari12:/Version\/12.+Safari/.test(e),isFirefox:/Firefox/.test(e)}})();class ft extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}let fr=[],fn=[];function fi(e){return null!=e}let fa=({mobileTiers:e=[0,15,30,60],desktopTiers:t=[0,15,30,60],override:r={},glContext:n,failIfMajorPerformanceCaveat:i=!1,benchmarksURL:a="https://unpkg.com/detect-gpu@5.0.38/dist/benchmarks"}={})=>d6(void 0,void 0,void 0,function*(){let o={};if(d7)return{tier:0,type:"SSR"};let{isIpad:s=!!(null==fe?void 0:fe.isIpad),isMobile:l=!!(null==fe?void 0:fe.isMobile),screenSize:c=window.screen,loadBenchmarks:u=e=>d6(void 0,void 0,void 0,function*(){let t=yield fetch(`${a}/${e}`).then(e=>e.json());if(4>parseInt(t.shift().split(".")[0],10))throw new ft("Detect GPU benchmark data is out of date. Please update to version 4x");return t})}=r,{renderer:h}=r,d=(e,t,r,n,i)=>({device:i,fps:n,gpu:r,isMobile:l,tier:e,type:t}),f,p="";if(h)f=[h=d9(h)];else{var m;let e=n||function(e,t=!1){let r={alpha:!1,antialias:!1,depth:!1,failIfMajorPerformanceCaveat:t,powerPreference:"high-performance",stencil:!1};e&&delete r.powerPreference;let n=window.document.createElement("canvas"),i=n.getContext("webgl",r)||n.getContext("experimental-webgl",r);return null!=i?i:void 0}(null==fe?void 0:fe.isSafari12,i);if(!e)return d(0,"WEBGL_UNSUPPORTED");let t=(null==fe?void 0:fe.isFirefox)?null:e.getExtension("WEBGL_debug_renderer_info");if(!(h=t?e.getParameter(t.UNMASKED_RENDERER_WEBGL):e.getParameter(e.RENDERER)))return d(1,"FALLBACK");p=h,f="apple gpu"===(m=h=d9(h))?function(e,t,r){let n;if(!r)return[t];let i=function(e){let t=e.createShader(35633),r=e.createShader(35632),n=e.createProgram();if(!(r&&t&&n))return;e.shaderSource(t,"\n    precision highp float;\n    attribute vec3 aPosition;\n    varying float vvv;\n    void main() {\n      vvv = 0.31622776601683794;\n      gl_Position = vec4(aPosition, 1.0);\n    }\n  "),e.shaderSource(r,"\n    precision highp float;\n    varying float vvv;\n    void main() {\n      vec4 enc = vec4(1.0, 255.0, 65025.0, 16581375.0) * vvv;\n      enc = fract(enc);\n      enc -= enc.yzww * vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 0.0);\n      gl_FragColor = enc;\n    }\n  "),e.compileShader(t),e.compileShader(r),e.attachShader(n,t),e.attachShader(n,r),e.linkProgram(n),e.detachShader(n,t),e.detachShader(n,r),e.deleteShader(t),e.deleteShader(r),e.useProgram(n);let i=e.createBuffer();e.bindBuffer(34962,i),e.bufferData(34962,new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),35044);let a=e.getAttribLocation(n,"aPosition");e.vertexAttribPointer(a,3,5126,!1,0,0),e.enableVertexAttribArray(a),e.clearColor(1,1,1,1),e.clear(16384),e.viewport(0,0,1,1),e.drawArrays(4,0,3);let o=new Uint8Array(4);return e.readPixels(0,0,1,1,6408,5121,o),e.deleteProgram(n),e.deleteBuffer(i),o.join("")}(e),a="801621810",o="8016218135",s="80162181161",l=(null==fe?void 0:fe.isIpad)?[["a7",s,12],["a8",o,15],["a8x",o,15],["a9",o,15],["a9x",o,15],["a10",o,15],["a10x",o,15],["a12",a,15],["a12x",a,15],["a12z",a,15],["a14",a,15],["m1",a,15]]:[["a7",s,12],["a8",o,12],["a9",o,15],["a10",o,15],["a11",a,15],["a12",a,15],["a13",a,15],["a14",a,15],["a15",a,15],["a16",a,15],["a17",a,15]];return"80162181255"===i?n=l.filter(([,,e])=>e>=14):(n=l.filter(([,e])=>e===i)).length||(n=l),n.map(([e])=>`apple ${e} gpu`)}(e,m,l):[m]}let A=(yield Promise.all(f.map(function(e){var t;return d6(this,void 0,void 0,function*(){let r;let n=(e=>{for(let t of l?["adreno","apple","mali-t","mali","nvidia","powervr","samsung"]:["intel","apple","amd","radeon","nvidia","geforce","adreno"])if(e.includes(t))return t})(e);if(!n)return;let i=`${l?"m":"d"}-${n}${s?"-ipad":""}.json`,a=o[i]=null!==(t=o[i])&&void 0!==t?t:u(i);try{r=yield a}catch(e){if(e instanceof ft)throw e;return}let h=function(e){var t;let r=(e=e.replace(/\([^)]+\)/,"")).match(/\d+/)||e.match(/(\W|^)([A-Za-z]{1,3})(\W|$)/g);return null!==(t=null==r?void 0:r.join("").replace(/\W|amd/g,""))&&void 0!==t?t:""}(e),d=r.filter(([,e])=>e===h);d.length||(d=r.filter(([t])=>t.includes(e)));let f=d.length;if(0===f)return;let p=e.split(/[.,()\[\]/\s]/g).sort().filter((e,t,r)=>0===t||e!==r[t-1]).join(" "),m,[A,,,,g]=f>1?d.map(e=>[e,function(e,t){if(e===t)return 0;let r=e;e.length>t.length&&(e=t,t=r);let n=e.length,i=t.length;for(;n>0&&e.charCodeAt(~-n)===t.charCodeAt(~-i);)n--,i--;let a,o=0;for(;o<n&&e.charCodeAt(o)===t.charCodeAt(o);)o++;if(n-=o,i-=o,0===n)return i;let s,l,c=0,u=0,h=0;for(;u<n;)fn[u]=e.charCodeAt(o+u),fr[u]=++u;for(;h<i;)for(a=t.charCodeAt(o+h),s=h++,c=h,u=0;u<n;u++)l=a===fn[u]?s:s+1,s=fr[u],c=fr[u]=s>c?l>c?c+1:l:l>s?s+1:l;return c}(p,e[2])]).sort(([,e],[,t])=>e-t)[0][0]:d[0],v=Number.MAX_VALUE,{devicePixelRatio:y}=window,x=c.width*y*c.height*y;for(let e of g){let[t,r]=e,n=Math.abs(x-t*r);n<v&&(v=n,m=e)}if(!m)return;let[,,E,_]=m;return[v,E,A,_]})}))).filter(fi).sort(([e=Number.MAX_VALUE,t],[r=Number.MAX_VALUE,n])=>e===r?t-n:e-r);if(!A.length){let e=d8.find(e=>h.includes(e));return e?d(0,"BLOCKLISTED",e):d(1,"FALLBACK",`${h} (${p})`)}let[,g,v,y]=A[0];if(-1===g)return d(0,"BLOCKLISTED",v,g,y);let x=l?e:t,E=0;for(let e=0;e<x.length;e++)g>=x[e]&&(E=e);return d(E,"BENCHMARK",v,g,y)}),fo=e=>(0,oQ.Rq)(()=>fa(e),["useDetectGPU"]);function fs({children:e,...t}){let r=fo(t);return ez.createElement(ez.Fragment,null,null==e?void 0:e(r))}let fl=2,fc=Symbol("SKIP_GENERATION");function fu(e,t,r){return null===e?null:(e.point.applyMatrix4(t.matrixWorld),e.distance=e.point.distanceTo(r.ray.origin),e.object=t,e)}function fh(e){return e.index?e.index.count:e.attributes.position.count}function fd(e){return fh(e)/3}function ff(e,t=ArrayBuffer){return e>65535?new Uint32Array(new t(4*e)):new Uint16Array(new t(2*e))}function fp(e){let t=fd(e),r=e.drawRange,n=r.start/3,i=(r.start+r.count)/3,a=Math.max(0,n),o=Math.min(t,i)-a;return[{offset:Math.floor(a),count:Math.floor(o)}]}function fm(e){if(!e.groups||!e.groups.length)return fp(e);let t=[],r=new Set,n=e.drawRange,i=n.start/3,a=(n.start+n.count)/3;for(let t of e.groups){let e=t.start/3,n=(t.start+t.count)/3;r.add(Math.max(i,e)),r.add(Math.min(a,n))}let o=Array.from(r.values()).sort((e,t)=>e-t);for(let e=0;e<o.length-1;e++){let r=o[e],n=o[e+1];t.push({offset:Math.floor(r),count:Math.floor(n-r)})}return t}function fA(e,t,r,n,i){let a=1/0,o=1/0,s=1/0,l=-1/0,c=-1/0,u=-1/0,h=1/0,d=1/0,f=1/0,p=-1/0,m=-1/0,A=-1/0;for(let n=6*t,i=(t+r)*6;n<i;n+=6){let t=e[n+0],r=e[n+1],i=t-r,g=t+r;i<a&&(a=i),g>l&&(l=g),t<h&&(h=t),t>p&&(p=t);let v=e[n+2],y=e[n+3],x=v-y,E=v+y;x<o&&(o=x),E>c&&(c=E),v<d&&(d=v),v>m&&(m=v);let _=e[n+4],C=e[n+5],b=_-C,w=_+C;b<s&&(s=b),w>u&&(u=w),_<f&&(f=_),_>A&&(A=_)}n[0]=a,n[1]=o,n[2]=s,n[3]=l,n[4]=c,n[5]=u,i[0]=h,i[1]=d,i[2]=f,i[3]=p,i[4]=m,i[5]=A}function fg(e,t,r){return r.min.x=t[e],r.min.y=t[e+1],r.min.z=t[e+2],r.max.x=t[e+3],r.max.y=t[e+4],r.max.z=t[e+5],r}function fv(e){let t=-1,r=-1/0;for(let n=0;n<3;n++){let i=e[n+3]-e[n];i>r&&(r=i,t=n)}return t}function fy(e,t,r){let n,i;for(let a=0;a<3;a++){let o=a+3;n=e[a],i=t[a],r[a]=n<i?n:i,n=e[o],i=t[o],r[o]=n>i?n:i}}function fx(e,t,r){for(let n=0;n<3;n++){let i=t[e+2*n],a=t[e+2*n+1],o=i-a,s=i+a;o<r[n]&&(r[n]=o),s>r[n+3]&&(r[n+3]=s)}}function fE(e){let t=e[3]-e[0],r=e[4]-e[1],n=e[5]-e[2];return 2*(t*r+r*n+n*t)}let f_=(e,t)=>e.candidate-t.candidate,fC=Array(32).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0})),fb=new Float32Array(6);class fw{constructor(){this.boundingData=new Float32Array(6)}}function fB(e,t,r,n,i,a){let o=n,s=n+i-1,l=a.pos,c=2*a.axis;for(;;){for(;o<=s&&r[6*o+c]<l;)o++;for(;o<=s&&r[6*s+c]>=l;)s--;if(!(o<s))return o;for(let e=0;e<3;e++){let r=t[3*o+e];t[3*o+e]=t[3*s+e],t[3*s+e]=r}for(let e=0;e<6;e++){let t=r[6*o+e];r[6*o+e]=r[6*s+e],r[6*s+e]=t}o++,s--}}function fI(e,t,r,n,i,a){let o=n,s=n+i-1,l=a.pos,c=2*a.axis;for(;;){for(;o<=s&&r[6*o+c]<l;)o++;for(;o<=s&&r[6*s+c]>=l;)s--;if(!(o<s))return o;{let t=e[o];e[o]=e[s],e[s]=t;for(let e=0;e<6;e++){let t=r[6*o+e];r[6*o+e]=r[6*s+e],r[6*s+e]=t}o++,s--}}}function fM(e,t){return 65535===t[e+15]}function fS(e,t){return t[e+14]}class fT{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(e,t){let r=1/0,n=-1/0;for(let i=0,a=e.length;i<a;i++){let a=e[i][t];r=a<r?a:r,n=a>n?a:n}this.min=r,this.max=n}setFromPoints(e,t){let r=1/0,n=-1/0;for(let i=0,a=t.length;i<a;i++){let a=t[i],o=e.dot(a);r=o<r?o:r,n=o>n?o:n}this.min=r,this.max=n}isSeparated(e){return this.min>e.max||e.min>this.max}}fT.prototype.setFromBox=function(){let e=new eQ.Vector3;return function(t,r){let n=r.min,i=r.max,a=1/0,o=-1/0;for(let r=0;r<=1;r++)for(let s=0;s<=1;s++)for(let l=0;l<=1;l++){e.x=n.x*r+i.x*(1-r),e.y=n.y*s+i.y*(1-s),e.z=n.z*l+i.z*(1-l);let c=t.dot(e);a=Math.min(c,a),o=Math.max(c,o)}this.min=a,this.max=o}}(),new fT;let fP=function(){let e=new eQ.Vector3,t=new eQ.Vector3,r=new eQ.Vector3;return function(n,i,a){let o,s;let l=n.start,c=i.start;r.subVectors(l,c),e.subVectors(n.end,n.start),t.subVectors(i.end,i.start);let u=r.dot(t),h=t.dot(e),d=t.dot(t),f=r.dot(e),p=e.dot(e)*d-h*h;o=0!==p?(u*h-f*d)/p:0,s=(u+o*h)/d,a.x=o,a.y=s}}(),fD=function(){let e=new eQ.Vector2,t=new eQ.Vector3,r=new eQ.Vector3;return function(n,i,a,o){fP(n,i,e);let s=e.x,l=e.y;if(s>=0&&s<=1&&l>=0&&l<=1){n.at(s,a),i.at(l,o);return}if(s>=0&&s<=1){l<0?i.at(0,o):i.at(1,o),n.closestPointToPoint(o,!0,a);return}if(l>=0&&l<=1){s<0?n.at(0,a):n.at(1,a),i.closestPointToPoint(a,!0,o);return}{let e,c;if(e=s<0?n.start:n.end,c=l<0?i.start:i.end,n.closestPointToPoint(c,!0,t),i.closestPointToPoint(e,!0,r),t.distanceToSquared(c)<=r.distanceToSquared(e)){a.copy(t),o.copy(c);return}a.copy(e),o.copy(r);return}}}(),fR=function(){let e=new eQ.Vector3,t=new eQ.Vector3,r=new eQ.Plane,n=new eQ.Line3;return function(i,a){let{radius:o,center:s}=i,{a:l,b:c,c:u}=a;if(n.start=l,n.end=c,n.closestPointToPoint(s,!0,e).distanceTo(s)<=o||(n.start=l,n.end=u,n.closestPointToPoint(s,!0,e).distanceTo(s)<=o)||(n.start=c,n.end=u,n.closestPointToPoint(s,!0,e).distanceTo(s)<=o))return!0;let h=a.getPlane(r);if(Math.abs(h.distanceToPoint(s))<=o){let e=h.projectPoint(s,t);if(a.containsPoint(e))return!0}return!1}}();function fF(e){return 1e-15>Math.abs(e)}class fz extends eQ.Triangle{constructor(...e){super(...e),this.isExtendedTriangle=!0,this.satAxes=[,,,,].fill().map(()=>new eQ.Vector3),this.satBounds=[,,,,].fill().map(()=>new fT),this.points=[this.a,this.b,this.c],this.sphere=new eQ.Sphere,this.plane=new eQ.Plane,this.needsUpdate=!0}intersectsSphere(e){return fR(e,this)}update(){let e=this.a,t=this.b,r=this.c,n=this.points,i=this.satAxes,a=this.satBounds,o=i[0],s=a[0];this.getNormal(o),s.setFromPoints(o,n);let l=i[1],c=a[1];l.subVectors(e,t),c.setFromPoints(l,n);let u=i[2],h=a[2];u.subVectors(t,r),h.setFromPoints(u,n);let d=i[3],f=a[3];d.subVectors(r,e),f.setFromPoints(d,n),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(o,e),this.needsUpdate=!1}}fz.prototype.closestPointToSegment=function(){let e=new eQ.Vector3,t=new eQ.Vector3,r=new eQ.Line3;return function(n,i=null,a=null){let o;let{start:s,end:l}=n,c=this.points,u=1/0;for(let s=0;s<3;s++){let l=(s+1)%3;r.start.copy(c[s]),r.end.copy(c[l]),fD(r,n,e,t),(o=e.distanceToSquared(t))<u&&(u=o,i&&i.copy(e),a&&a.copy(t))}return this.closestPointToPoint(s,e),(o=s.distanceToSquared(e))<u&&(u=o,i&&i.copy(e),a&&a.copy(s)),this.closestPointToPoint(l,e),(o=l.distanceToSquared(e))<u&&(u=o,i&&i.copy(e),a&&a.copy(l)),Math.sqrt(u)}}(),fz.prototype.intersectsTriangle=function(){let e=new fz,t=[,,,],r=[,,,],n=new fT,i=new fT,a=new eQ.Vector3,o=new eQ.Vector3,s=new eQ.Vector3,l=new eQ.Vector3,c=new eQ.Vector3,u=new eQ.Line3,h=new eQ.Line3,d=new eQ.Line3,f=new eQ.Vector3;function p(e,t,r){let n=e.points,i=0,a=-1;for(let e=0;e<3;e++){let{start:s,end:l}=u;s.copy(n[e]),l.copy(n[(e+1)%3]),u.delta(o);let c=fF(t.distanceToPoint(s));if(fF(t.normal.dot(o))&&c){r.copy(u),i=2;break}let h=t.intersectLine(u,f);if(!h&&c&&f.copy(s),(h||c)&&!fF(f.distanceTo(l))){if(i<=1)(1===i?r.start:r.end).copy(f),c&&(a=i);else if(i>=2){(1===a?r.start:r.end).copy(f),i=2;break}if(2==++i&&-1===a)break}}return i}return function(o,u=null,f=!1){this.needsUpdate&&this.update(),o.isExtendedTriangle?o.needsUpdate&&o.update():(e.copy(o),e.update(),o=e);let m=this.plane,A=o.plane;if(Math.abs(m.normal.dot(A.normal))>1-1e-10){let e=this.satBounds,s=this.satAxes;r[0]=o.a,r[1]=o.b,r[2]=o.c;for(let t=0;t<4;t++){let i=e[t],a=s[t];if(n.setFromPoints(a,r),i.isSeparated(n))return!1}let l=o.satBounds,c=o.satAxes;t[0]=this.a,t[1]=this.b,t[2]=this.c;for(let e=0;e<4;e++){let r=l[e],i=c[e];if(n.setFromPoints(i,t),r.isSeparated(n))return!1}for(let e=0;e<4;e++){let o=s[e];for(let e=0;e<4;e++){let s=c[e];if(a.crossVectors(o,s),n.setFromPoints(a,t),i.setFromPoints(a,r),n.isSeparated(i))return!1}}return u&&(f||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),u.start.set(0,0,0),u.end.set(0,0,0)),!0}{let e=p(this,A,h);if(1===e&&o.containsPoint(h.end))return u&&(u.start.copy(h.end),u.end.copy(h.end)),!0;if(2!==e)return!1;let t=p(o,m,d);if(1===t&&this.containsPoint(d.end))return u&&(u.start.copy(d.end),u.end.copy(d.end)),!0;if(2!==t)return!1;if(h.delta(s),d.delta(l),0>s.dot(l)){let e=d.start;d.start=d.end,d.end=e}let r=h.start.dot(s),n=h.end.dot(s),i=d.start.dot(s),a=d.end.dot(s);return(r===a||i===n||n<i!=r<a)&&(u&&(c.subVectors(h.start,d.start),c.dot(s)>0?u.start.copy(h.start):u.start.copy(d.start),c.subVectors(h.end,d.end),0>c.dot(s)?u.end.copy(h.end):u.end.copy(d.end)),!0)}}}(),fz.prototype.distanceToPoint=function(){let e=new eQ.Vector3;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}(),fz.prototype.distanceToTriangle=function(){let e=new eQ.Vector3,t=new eQ.Vector3,r=["a","b","c"],n=new eQ.Line3,i=new eQ.Line3;return function(a,o=null,s=null){let l=o||s?n:null;if(this.intersectsTriangle(a,l))return(o||s)&&(o&&l.getCenter(o),s&&l.getCenter(s)),0;let c=1/0;for(let t=0;t<3;t++){let n;let i=r[t],l=a[i];this.closestPointToPoint(l,e),(n=l.distanceToSquared(e))<c&&(c=n,o&&o.copy(e),s&&s.copy(l));let u=this[i];a.closestPointToPoint(u,e),(n=u.distanceToSquared(e))<c&&(c=n,o&&o.copy(u),s&&s.copy(e))}for(let l=0;l<3;l++){let u=r[l],h=r[(l+1)%3];n.set(this[u],this[h]);for(let l=0;l<3;l++){let u=r[l],h=r[(l+1)%3];i.set(a[u],a[h]),fD(n,i,e,t);let d=e.distanceToSquared(t);d<c&&(c=d,o&&o.copy(e),s&&s.copy(t))}}return Math.sqrt(c)}}();class fO{constructor(e,t,r){this.isOrientedBox=!0,this.min=new eQ.Vector3,this.max=new eQ.Vector3,this.matrix=new eQ.Matrix4,this.invMatrix=new eQ.Matrix4,this.points=Array(8).fill().map(()=>new eQ.Vector3),this.satAxes=[,,,].fill().map(()=>new eQ.Vector3),this.satBounds=[,,,].fill().map(()=>new fT),this.alignedSatBounds=[,,,].fill().map(()=>new fT),this.needsUpdate=!1,e&&this.min.copy(e),t&&this.max.copy(t),r&&this.matrix.copy(r)}set(e,t,r){this.min.copy(e),this.max.copy(t),this.matrix.copy(r),this.needsUpdate=!0}copy(e){this.min.copy(e.min),this.max.copy(e.max),this.matrix.copy(e.matrix),this.needsUpdate=!0}}fO.prototype.update=function(){let e=this.matrix,t=this.min,r=this.max,n=this.points;for(let i=0;i<=1;i++)for(let a=0;a<=1;a++)for(let o=0;o<=1;o++){let s=n[1*i|2*a|4*o];s.x=i?r.x:t.x,s.y=a?r.y:t.y,s.z=o?r.z:t.z,s.applyMatrix4(e)}let i=this.satBounds,a=this.satAxes,o=n[0];for(let e=0;e<3;e++){let t=a[e],r=i[e],s=n[1<<e];t.subVectors(o,s),r.setFromPoints(t,n)}let s=this.alignedSatBounds;s[0].setFromPointsField(n,"x"),s[1].setFromPointsField(n,"y"),s[2].setFromPointsField(n,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1},fO.prototype.intersectsBox=function(){let e=new fT;return function(t){this.needsUpdate&&this.update();let r=t.min,n=t.max,i=this.satBounds,a=this.satAxes,o=this.alignedSatBounds;if(e.min=r.x,e.max=n.x,o[0].isSeparated(e)||(e.min=r.y,e.max=n.y,o[1].isSeparated(e))||(e.min=r.z,e.max=n.z,o[2].isSeparated(e)))return!1;for(let r=0;r<3;r++){let n=a[r],o=i[r];if(e.setFromBox(n,t),o.isSeparated(e))return!1}return!0}}(),fO.prototype.intersectsTriangle=function(){let e=new fz,t=[,,,],r=new fT,n=new fT,i=new eQ.Vector3;return function(a){this.needsUpdate&&this.update(),a.isExtendedTriangle?a.needsUpdate&&a.update():(e.copy(a),e.update(),a=e);let o=this.satBounds,s=this.satAxes;t[0]=a.a,t[1]=a.b,t[2]=a.c;for(let e=0;e<3;e++){let n=o[e],i=s[e];if(r.setFromPoints(i,t),n.isSeparated(r))return!1}let l=a.satBounds,c=a.satAxes,u=this.points;for(let e=0;e<3;e++){let t=l[e],n=c[e];if(r.setFromPoints(n,u),t.isSeparated(r))return!1}for(let e=0;e<3;e++){let a=s[e];for(let e=0;e<4;e++){let o=c[e];if(i.crossVectors(a,o),r.setFromPoints(i,t),n.setFromPoints(i,u),r.isSeparated(n))return!1}}return!0}}(),fO.prototype.closestPointToPoint=function(e,t){return this.needsUpdate&&this.update(),t.copy(e).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),t},fO.prototype.distanceToPoint=function(){let e=new eQ.Vector3;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}(),fO.prototype.distanceToBox=function(){let e=["x","y","z"],t=Array(12).fill().map(()=>new eQ.Line3),r=Array(12).fill().map(()=>new eQ.Line3),n=new eQ.Vector3,i=new eQ.Vector3;return function(a,o=0,s=null,l=null){if(this.needsUpdate&&this.update(),this.intersectsBox(a))return(s||l)&&(a.getCenter(i),this.closestPointToPoint(i,n),a.closestPointToPoint(n,i),s&&s.copy(n),l&&l.copy(i)),0;let c=o*o,u=a.min,h=a.max,d=this.points,f=1/0;for(let e=0;e<8;e++){let t=d[e];i.copy(t).clamp(u,h);let r=t.distanceToSquared(i);if(r<f&&(f=r,s&&s.copy(t),l&&l.copy(i),r<c))return Math.sqrt(r)}let p=0;for(let n=0;n<3;n++)for(let i=0;i<=1;i++)for(let a=0;a<=1;a++){let o=(n+1)%3,s=(n+2)%3,l=i<<o|a<<s,c=1<<n|i<<o|a<<s,f=d[l],m=d[c];t[p].set(f,m);let A=e[n],g=e[o],v=e[s],y=r[p],x=y.start,E=y.end;x[A]=u[A],x[g]=i?u[g]:h[g],x[v]=a?u[v]:h[g],E[A]=h[A],E[g]=i?u[g]:h[g],E[v]=a?u[v]:h[g],p++}for(let e=0;e<=1;e++)for(let t=0;t<=1;t++)for(let r=0;r<=1;r++){i.x=e?h.x:u.x,i.y=t?h.y:u.y,i.z=r?h.z:u.z,this.closestPointToPoint(i,n);let a=i.distanceToSquared(n);if(a<f&&(f=a,s&&s.copy(n),l&&l.copy(i),a<c))return Math.sqrt(a)}for(let e=0;e<12;e++){let a=t[e];for(let e=0;e<12;e++){fD(a,r[e],n,i);let t=n.distanceToSquared(i);if(t<f&&(f=t,s&&s.copy(n),l&&l.copy(i),t<c))return Math.sqrt(t)}}return Math.sqrt(f)}}();class fQ{constructor(e){this._getNewPrimitive=e,this._primitives=[]}getPrimitive(){let e=this._primitives;return 0===e.length?this._getNewPrimitive():e.pop()}releasePrimitive(e){this._primitives.push(e)}}class fL extends fQ{constructor(){super(()=>new fz)}}let fk=new fL;class fU{constructor(){this.float32Array=null,this.uint16Array=null,this.uint32Array=null;let e=[],t=null;this.setBuffer=r=>{t&&e.push(t),t=r,this.float32Array=new Float32Array(r),this.uint16Array=new Uint16Array(r),this.uint32Array=new Uint32Array(r)},this.clearBuffer=()=>{t=null,this.float32Array=null,this.uint16Array=null,this.uint32Array=null,0!==e.length&&this.setBuffer(e.pop())}}}let fN=new fU,fG=[],fH=new fQ(()=>new eQ.Box3),fV=new eQ.Vector3,fj=new eQ.Vector3,fY=new eQ.Vector3,fJ=new eQ.Vector3,fW=new eQ.Vector3,fq=new eQ.Vector2,fK=new eQ.Vector2,fX=new eQ.Vector2,fZ=new eQ.Vector3,f$=new eQ.Vector3,f0=new eQ.Vector3,f1=new eQ.Vector3;function f2(e,t,r,n,i,a,o){let s=3*n,l=s+0,c=s+1,u=s+2,h=e.index;e.index&&(l=h.getX(l),c=h.getX(c),u=h.getX(u));let{position:d,normal:f,uv:p,uv1:m}=e.attributes,A=function(e,t,r,n,i,a,o,s,l,c,u){fY.fromBufferAttribute(t,a),fJ.fromBufferAttribute(t,o),fW.fromBufferAttribute(t,s);let h=function(e,t,r,n,i,a,o,s){if(null===(a===eQ.BackSide?e.intersectTriangle(n,r,t,!0,i):e.intersectTriangle(t,r,n,a!==eQ.DoubleSide,i)))return null;let l=e.origin.distanceTo(i);return l<o||l>s?null:{distance:l,point:i.clone()}}(e,fY,fJ,fW,f1,l,c,u);if(h){n&&(fq.fromBufferAttribute(n,a),fK.fromBufferAttribute(n,o),fX.fromBufferAttribute(n,s),h.uv=eQ.Triangle.getInterpolation(f1,fY,fJ,fW,fq,fK,fX,new eQ.Vector2)),i&&(fq.fromBufferAttribute(i,a),fK.fromBufferAttribute(i,o),fX.fromBufferAttribute(i,s),h.uv1=eQ.Triangle.getInterpolation(f1,fY,fJ,fW,fq,fK,fX,new eQ.Vector2)),r&&(fZ.fromBufferAttribute(r,a),f$.fromBufferAttribute(r,o),f0.fromBufferAttribute(r,s),h.normal=eQ.Triangle.getInterpolation(f1,fY,fJ,fW,fZ,f$,f0,new eQ.Vector3),h.normal.dot(e.direction)>0&&h.normal.multiplyScalar(-1));let t={a:a,b:o,c:s,normal:new eQ.Vector3,materialIndex:0};eQ.Triangle.getNormal(fY,fJ,fW,t.normal),h.face=t,h.faceIndex=a}return h}(r,d,f,p,m,l,c,u,t,a,o);return A?(A.faceIndex=n,i&&i.push(A),A):null}function f3(e,t,r,n){let i=e.a,a=e.b,o=e.c,s=t,l=t+1,c=t+2;r&&(s=r.getX(s),l=r.getX(l),c=r.getX(c)),i.x=n.getX(s),i.y=n.getY(s),i.z=n.getZ(s),a.x=n.getX(l),a.y=n.getY(l),a.z=n.getZ(l),o.x=n.getX(c),o.y=n.getY(c),o.z=n.getZ(c)}function f4(e,t,r,n,i,a,o){let{geometry:s}=r,{index:l}=s,c=s.attributes.position;for(let r=e,s=t+e;r<s;r++){let e;if(f3(o,3*(e=r),l,c),o.needsUpdate=!0,n(o,e,i,a))return!0}return!1}function f5(e,t,r,n,i){let a,o,s,l,c,u;let h=1/r.direction.x,d=1/r.direction.y,f=1/r.direction.z,p=r.origin.x,m=r.origin.y,A=r.origin.z,g=t[e],v=t[e+3],y=t[e+1],x=t[e+3+1],E=t[e+2],_=t[e+3+2];return h>=0?(a=(g-p)*h,o=(v-p)*h):(a=(v-p)*h,o=(g-p)*h),d>=0?(s=(y-m)*d,l=(x-m)*d):(s=(x-m)*d,l=(y-m)*d),!(a>l)&&!(s>o)&&((s>a||isNaN(a))&&(a=s),(l<o||isNaN(o))&&(o=l),f>=0?(c=(E-A)*f,u=(_-A)*f):(c=(_-A)*f,u=(E-A)*f),!(a>u)&&!(c>o)&&((c>a||a!=a)&&(a=c),(u<o||o!=o)&&(o=u),a<=i&&o>=n))}function f6(e,t,r,n,i,a,o){fN.setBuffer(e._roots[t]),function e(t,r,n,i,a,o,s){let{float32Array:l,uint16Array:c,uint32Array:u}=fN,h=2*t;if(fM(h,c))!function(e,t,r,n,i,a,o,s){let{geometry:l,_indirectBuffer:c}=e;for(let e=n,c=n+i;e<c;e++)f2(l,t,r,e,a,o,s)}(r,n,i,u[t+6],fS(h,c),a,o,s);else{let c=t+8;f5(c,l,i,o,s)&&e(c,r,n,i,a,o,s);let h=u[t+6];f5(h,l,i,o,s)&&e(h,r,n,i,a,o,s)}}(0,e,r,n,i,a,o),fN.clearBuffer()}let f8=["x","y","z"];function f9(e,t,r,n,i,a){fN.setBuffer(e._roots[t]);let o=function e(t,r,n,i,a,o){let{float32Array:s,uint16Array:l,uint32Array:c}=fN,u=2*t;if(fM(u,l))return function(e,t,r,n,i,a,o){let{geometry:s,_indirectBuffer:l}=e,c=1/0,u=null;for(let e=n,l=n+i;e<l;e++){let n;(n=f2(s,t,r,e,null,a,o))&&n.distance<c&&(u=n,c=n.distance)}return u}(r,n,i,c[t+6],fS(u,l),a,o);{let l,u;let h=c[t+7],d=f8[h],f=i.direction[d]>=0;f?(l=t+8,u=c[t+6]):(l=c[t+6],u=t+8);let p=f5(l,s,i,a,o)?e(l,r,n,i,a,o):null;if(p){let e=p.point[d];if(f?e<=s[u+h]:e>=s[u+h+3])return p}let m=f5(u,s,i,a,o)?e(u,r,n,i,a,o):null;return p&&m?p.distance<=m.distance?p:m:p||m||null}}(0,e,r,n,i,a);return fN.clearBuffer(),o}let f7=new eQ.Box3,pe=new fz,pt=new fz,pr=new eQ.Matrix4,pn=new fO,pi=new fO;function pa(e,t,r,n){fN.setBuffer(e._roots[t]);let i=function e(t,r,n,i,a=null){let{float32Array:o,uint16Array:s,uint32Array:l}=fN,c=2*t;if(null===a&&(n.boundingBox||n.computeBoundingBox(),pn.set(n.boundingBox.min,n.boundingBox.max,i),a=pn),fM(c,s)){let e=r.geometry,a=e.index,u=e.attributes.position,h=n.index,d=n.attributes.position,f=l[t+6],p=fS(c,s);if(pr.copy(i).invert(),n.boundsTree)return fg(t,o,pi),pi.matrix.copy(pr),pi.needsUpdate=!0,n.boundsTree.shapecast({intersectsBounds:e=>pi.intersectsBox(e),intersectsTriangle:e=>{e.a.applyMatrix4(i),e.b.applyMatrix4(i),e.c.applyMatrix4(i),e.needsUpdate=!0;for(let t=3*f,r=(p+f)*3;t<r;t+=3)if(f3(pt,t,a,u),pt.needsUpdate=!0,e.intersectsTriangle(pt))return!0;return!1}});for(let e=3*f,t=(p+f)*3;e<t;e+=3){f3(pe,e,a,u),pe.a.applyMatrix4(pr),pe.b.applyMatrix4(pr),pe.c.applyMatrix4(pr),pe.needsUpdate=!0;for(let e=0,t=h.count;e<t;e+=3)if(f3(pt,e,h,d),pt.needsUpdate=!0,pe.intersectsTriangle(pt))return!0}}else{let s=t+8,c=l[t+6];return fg(s,o,f7),!!(a.intersectsBox(f7)&&e(s,r,n,i,a))||(fg(c,o,f7),!!(a.intersectsBox(f7)&&e(c,r,n,i,a)))}}(0,e,r,n);return fN.clearBuffer(),i}let po=new eQ.Matrix4,ps=new fO,pl=new fO,pc=new eQ.Vector3,pu=new eQ.Vector3,ph=new eQ.Vector3,pd=new eQ.Vector3;function pf(e,t,r,n,i,a,o){let{geometry:s}=r,{index:l}=s,c=s.attributes.position;for(let s=e,u=t+e;s<u;s++){let e;if(f3(o,3*(e=r.resolveTriangleIndex(s)),l,c),o.needsUpdate=!0,n(o,e,i,a))return!0}return!1}function pp(e,t,r,n,i,a,o){fN.setBuffer(e._roots[t]),function e(t,r,n,i,a,o,s){let{float32Array:l,uint16Array:c,uint32Array:u}=fN,h=2*t;if(fM(h,c))!function(e,t,r,n,i,a,o,s){let{geometry:l,_indirectBuffer:c}=e;for(let e=n,u=n+i;e<u;e++)f2(l,t,r,c?c[e]:e,a,o,s)}(r,n,i,u[t+6],fS(h,c),a,o,s);else{let c=t+8;f5(c,l,i,o,s)&&e(c,r,n,i,a,o,s);let h=u[t+6];f5(h,l,i,o,s)&&e(h,r,n,i,a,o,s)}}(0,e,r,n,i,a,o),fN.clearBuffer()}let pm=["x","y","z"];function pA(e,t,r,n,i,a){fN.setBuffer(e._roots[t]);let o=function e(t,r,n,i,a,o){let{float32Array:s,uint16Array:l,uint32Array:c}=fN,u=2*t;if(fM(u,l))return function(e,t,r,n,i,a,o){let{geometry:s,_indirectBuffer:l}=e,c=1/0,u=null;for(let e=n,h=n+i;e<h;e++){let n;(n=f2(s,t,r,l?l[e]:e,null,a,o))&&n.distance<c&&(u=n,c=n.distance)}return u}(r,n,i,c[t+6],fS(u,l),a,o);{let l,u;let h=c[t+7],d=pm[h],f=i.direction[d]>=0;f?(l=t+8,u=c[t+6]):(l=c[t+6],u=t+8);let p=f5(l,s,i,a,o)?e(l,r,n,i,a,o):null;if(p){let e=p.point[d];if(f?e<=s[u+h]:e>=s[u+h+3])return p}let m=f5(u,s,i,a,o)?e(u,r,n,i,a,o):null;return p&&m?p.distance<=m.distance?p:m:p||m||null}}(0,e,r,n,i,a);return fN.clearBuffer(),o}let pg=new eQ.Box3,pv=new fz,py=new fz,px=new eQ.Matrix4,pE=new fO,p_=new fO;function pC(e,t,r,n){fN.setBuffer(e._roots[t]);let i=function e(t,r,n,i,a=null){let{float32Array:o,uint16Array:s,uint32Array:l}=fN,c=2*t;if(null===a&&(n.boundingBox||n.computeBoundingBox(),pE.set(n.boundingBox.min,n.boundingBox.max,i),a=pE),fM(c,s)){let e=r.geometry,a=e.index,u=e.attributes.position,h=n.index,d=n.attributes.position,f=l[t+6],p=fS(c,s);if(px.copy(i).invert(),n.boundsTree)return fg(t,o,p_),p_.matrix.copy(px),p_.needsUpdate=!0,n.boundsTree.shapecast({intersectsBounds:e=>p_.intersectsBox(e),intersectsTriangle:e=>{e.a.applyMatrix4(i),e.b.applyMatrix4(i),e.c.applyMatrix4(i),e.needsUpdate=!0;for(let t=f,n=p+f;t<n;t++)if(f3(py,3*r.resolveTriangleIndex(t),a,u),py.needsUpdate=!0,e.intersectsTriangle(py))return!0;return!1}});for(let e=f,t=p+f;e<t;e++){f3(pv,3*r.resolveTriangleIndex(e),a,u),pv.a.applyMatrix4(px),pv.b.applyMatrix4(px),pv.c.applyMatrix4(px),pv.needsUpdate=!0;for(let e=0,t=h.count;e<t;e+=3)if(f3(py,e,h,d),py.needsUpdate=!0,pv.intersectsTriangle(py))return!0}}else{let s=t+8,c=l[t+6];return fg(s,o,pg),!!(a.intersectsBox(pg)&&e(s,r,n,i,a))||(fg(c,o,pg),!!(a.intersectsBox(pg)&&e(c,r,n,i,a)))}}(0,e,r,n);return fN.clearBuffer(),i}let pb=new eQ.Matrix4,pw=new fO,pB=new fO,pI=new eQ.Vector3,pM=new eQ.Vector3,pS=new eQ.Vector3,pT=new eQ.Vector3,pP=new fN.constructor,pD=new fN.constructor,pR=new fQ(()=>new eQ.Box3),pF=new eQ.Box3,pz=new eQ.Box3,pO=new eQ.Box3,pQ=new eQ.Box3,pL=!1,pk=new fO,pU=new eQ.Box3,pN={strategy:0,maxDepth:40,maxLeafTris:10,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,indirect:!1,verbose:!0};class pG{static serialize(e,t={}){t={cloneBuffers:!0,...t};let r=e.geometry,n=e._roots,i=e._indirectBuffer,a=r.getIndex();return t.cloneBuffers?{roots:n.map(e=>e.slice()),index:a?a.array.slice():null,indirectBuffer:i?i.slice():null}:{roots:n,index:a?a.array:null,indirectBuffer:i}}static deserialize(e,t,r={}){r={setIndex:!0,indirect:!!e.indirectBuffer,...r};let{index:n,roots:i,indirectBuffer:a}=e,o=new pG(t,{...r,[fc]:!0});if(o._roots=i,o._indirectBuffer=a||null,r.setIndex){let r=t.getIndex();if(null===r){let r=new eQ.BufferAttribute(e.index,1,!1);t.setIndex(r)}else r.array!==n&&(r.array.set(n),r.needsUpdate=!0)}return o}get indirect(){return!!this._indirectBuffer}constructor(e,t={}){if(e.isBufferGeometry){if(e.index&&e.index.isInterleavedBufferAttribute)throw Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.")}else throw Error("MeshBVH: Only BufferGeometries are supported.");if((t=Object.assign({...pN,[fc]:!1},t)).useSharedArrayBuffer&&!("undefined"!=typeof SharedArrayBuffer))throw Error("MeshBVH: SharedArrayBuffer is not available.");this.geometry=e,this._roots=null,this._indirectBuffer=null,t[fc]||(function(e,t){let r=e.geometry;t.indirect&&(e._indirectBuffer=function(e,t){let r=(e.index?e.index.count:e.attributes.position.count)/3,n=r>65536,i=n?4:2,a=t?new SharedArrayBuffer(r*i):new ArrayBuffer(r*i),o=n?new Uint32Array(a):new Uint16Array(a);for(let e=0,t=o.length;e<t;e++)o[e]=e;return o}(r,t.useSharedArrayBuffer),function(e){if(0===e.groups.length)return!1;let t=fd(e),r=fm(e).sort((e,t)=>e.offset-t.offset),n=r[r.length-1];n.count=Math.min(t-n.offset,n.count);let i=0;return r.forEach(({count:e})=>i+=e),t!==i}(r)&&!t.verbose&&console.warn('MeshBVH: Provided geometry contains groups that do not fully span the vertex contents while using the "indirect" option. BVH may incorrectly report intersections on unrendered portions of the geometry.')),e._indirectBuffer||function(e,t){if(!e.index){let r=e.attributes.position.count,n=ff(r,t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer);e.setIndex(new eQ.BufferAttribute(n,1));for(let e=0;e<r;e++)n[e]=e}}(r,t);let n=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,i=function(e,t=null,r=null,n=null){let i;let a=e.attributes.position,o=e.index?e.index.array:null,s=fd(e),l=a.normalized;null===t?(i=new Float32Array(24*s),r=0,n=s):(i=t,r=r||0,n=n||s);let c=a.array,u=a.offset||0,h=3;a.isInterleavedBufferAttribute&&(h=a.data.stride);let d=["getX","getY","getZ"];for(let e=r;e<r+n;e++){let t=3*e,r=6*e,n=t+0,s=t+1,f=t+2;o&&(n=o[n],s=o[s],f=o[f]),l||(n=n*h+u,s=s*h+u,f=f*h+u);for(let e=0;e<3;e++){let t,o,u;l?(t=a[d[e]](n),o=a[d[e]](s),u=a[d[e]](f)):(t=c[n+e],o=c[s+e],u=c[f+e]);let h=t;o<h&&(h=o),u<h&&(h=u);let p=t;o>p&&(p=o),u>p&&(p=u);let m=(p-h)/2,A=2*e;i[r+A+0]=h+m,i[r+A+1]=m+(Math.abs(h)+m)*5960464477539063e-23}}return i}(r),a=t.indirect?fp(r):fm(r);e._roots=a.map(r=>{let a=function(e,t,r,n,i){let{maxDepth:a,verbose:o,maxLeafTris:s,strategy:l,onProgress:c,indirect:u}=i,h=e._indirectBuffer,d=e.geometry,f=d.index?d.index.array:null,p=u?fI:fB,m=fd(d),A=new Float32Array(6),g=!1,v=new fw;return fA(t,r,n,v.boundingData,A),function e(r,n,i,c=null,u=0){if(!g&&u>=a&&(g=!0,o&&(console.warn(`MeshBVH: Max depth of ${a} reached when generating BVH. Consider increasing maxDepth.`),console.warn(d))),i<=s||u>=a)return y(n+i),r.offset=n,r.count=i,r;let m=function(e,t,r,n,i,a){let o=-1,s=0;if(0===a)-1!==(o=fv(t))&&(s=(t[o]+t[o+3])/2);else if(1===a)-1!==(o=fv(e))&&(s=function(e,t,r,n){let i=0;for(let a=t,o=t+r;a<o;a++)i+=e[6*a+2*n];return i/r}(r,n,i,o));else if(a===fl){let a=fE(e),l=1.25*i,c=6*n,u=(n+i)*6;for(let e=0;e<3;e++){let n=t[e],h=(t[e+3]-n)/32;if(i<8){let t=[...fC];t.length=i;let n=0;for(let i=c;i<u;i+=6,n++){let a=t[n];a.candidate=r[i+2*e],a.count=0;let{bounds:o,leftCacheBounds:s,rightCacheBounds:l}=a;for(let e=0;e<3;e++)l[e]=1/0,l[e+3]=-1/0,s[e]=1/0,s[e+3]=-1/0,o[e]=1/0,o[e+3]=-1/0;fx(i,r,o)}t.sort(f_);let h=i;for(let e=0;e<h;e++){let r=t[e];for(;e+1<h&&t[e+1].candidate===r.candidate;)t.splice(e+1,1),h--}for(let n=c;n<u;n+=6){let i=r[n+2*e];for(let e=0;e<h;e++){let a=t[e];i>=a.candidate?fx(n,r,a.rightCacheBounds):(fx(n,r,a.leftCacheBounds),a.count++)}}for(let r=0;r<h;r++){let n=t[r],c=n.count,u=i-n.count,h=n.leftCacheBounds,d=n.rightCacheBounds,f=0;0!==c&&(f=fE(h)/a);let p=0;0!==u&&(p=fE(d)/a);let m=1+1.25*(f*c+p*u);m<l&&(o=e,l=m,s=n.candidate)}}else{for(let e=0;e<32;e++){let t=fC[e];t.count=0,t.candidate=n+h+e*h;let r=t.bounds;for(let e=0;e<3;e++)r[e]=1/0,r[e+3]=-1/0}for(let t=c;t<u;t+=6){let i=~~((r[t+2*e]-n)/h);i>=32&&(i=31);let a=fC[i];a.count++,fx(t,r,a.bounds)}let t=fC[31];!function(e,t){t.set(e)}(t.bounds,t.rightCacheBounds);for(let e=30;e>=0;e--){let t=fC[e],r=fC[e+1];fy(t.bounds,r.rightCacheBounds,t.rightCacheBounds)}let d=0;for(let t=0;t<31;t++){let r=fC[t],n=r.count,c=r.bounds,u=fC[t+1].rightCacheBounds;0!==n&&(0===d?function(e,t){t.set(e)}(c,fb):fy(c,fb,fb));let h=0,f=0;0!==(d+=n)&&(h=fE(fb)/a);let p=i-d;0!==p&&(f=fE(u)/a);let m=1+1.25*(h*d+f*p);m<l&&(o=e,l=m,s=r.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${a} used.`);return{axis:o,pos:s}}(r.boundingData,c,t,n,i,l);if(-1===m.axis)return y(n+i),r.offset=n,r.count=i,r;let v=p(h,f,t,n,i,m);if(v===n||v===n+i)y(n+i),r.offset=n,r.count=i;else{r.splitAxis=m.axis;let a=new fw,o=v-n;r.left=a,fA(t,n,o,a.boundingData,A),e(a,n,o,A,u+1);let s=new fw,l=i-o;r.right=s,fA(t,v,l,s.boundingData,A),e(s,v,l,A,u+1)}return r}(v,r,n,A),v;function y(e){c&&c(e/m)}}(e,i,r.offset,r.count,t),o=new n(32*function e(t){return"count"in t?1:1+e(t.left)+e(t.right)}(a));return G=new Float32Array(o),H=new Uint32Array(o),V=new Uint16Array(o),j=new Uint8Array(o),function e(t,r){let n=t/4,i=t/2,a=r.boundingData;for(let e=0;e<6;e++)G[n+e]=a[e];if("count"in r){if(r.buffer){let e=r.buffer;j.set(new Uint8Array(e),t);for(let r=t,i=t+e.byteLength;r<i;r+=32)fM(r/2,V)||(H[r/4+6]+=n);return t+e.byteLength}{let e=r.offset,a=r.count;return H[n+6]=e,V[i+14]=a,V[i+15]=65535,t+32}}{let i;let a=r.left,o=r.right,s=r.splitAxis;if((i=e(t+32,a))/4>4294967296)throw Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return H[n+6]=i/4,i=e(i,o),H[n+7]=s,i}}(0,a),o})}(this,t),!e.boundingBox&&t.setBoundingBox&&(e.boundingBox=this.getBoundingBox(new eQ.Box3))),this.resolveTriangleIndex=t.indirect?e=>this._indirectBuffer[e]:e=>e}refit(e=null){return(this.indirect?function(e,t=null){let r,n,i,a;t&&Array.isArray(t)&&(t=new Set(t));let o=e.geometry,s=o.index?o.index.array:null,l=o.attributes.position,c=0,u=e._roots;for(let o=0,h=u.length;o<h;o++)n=new Uint32Array(r=u[o]),i=new Uint16Array(r),a=new Float32Array(r),function r(o,c,u=!1){let h=2*o;if(65535===i[h+15]){let t=n[o+6],r=i[h+14],c=1/0,u=1/0,d=1/0,f=-1/0,p=-1/0,m=-1/0;for(let n=t,i=t+r;n<i;n++){let t=3*e.resolveTriangleIndex(n);for(let e=0;e<3;e++){let r=t+e;r=s?s[r]:r;let n=l.getX(r),i=l.getY(r),a=l.getZ(r);n<c&&(c=n),n>f&&(f=n),i<u&&(u=i),i>p&&(p=i),a<d&&(d=a),a>m&&(m=a)}}return(a[o+0]!==c||a[o+1]!==u||a[o+2]!==d||a[o+3]!==f||a[o+4]!==p||a[o+5]!==m)&&(a[o+0]=c,a[o+1]=u,a[o+2]=d,a[o+3]=f,a[o+4]=p,a[o+5]=m,!0)}{let e=o+8,i=n[o+6],s=u,l=!1,h=!1;t?s||(l=t.has(e+c),h=t.has(i+c),s=!l&&!h):(l=!0,h=!0);let d=s||l,f=s||h,p=!1;d&&(p=r(e,c,s));let m=!1;f&&(m=r(i,c,s));let A=p||m;if(A)for(let t=0;t<3;t++){let r=e+t,n=i+t,s=a[r],l=a[r+3],c=a[n],u=a[n+3];a[o+t]=s<c?s:c,a[o+t+3]=l>u?l:u}return A}}(0,c),c+=r.byteLength}:function(e,t=null){let r,n,i,a;t&&Array.isArray(t)&&(t=new Set(t));let o=e.geometry,s=o.index?o.index.array:null,l=o.attributes.position,c=0,u=e._roots;for(let e=0,o=u.length;e<o;e++)n=new Uint32Array(r=u[e]),i=new Uint16Array(r),a=new Float32Array(r),function e(r,o,c=!1){let u=2*r;if(65535===i[u+15]){let e=n[r+6],t=i[u+14],o=1/0,c=1/0,h=1/0,d=-1/0,f=-1/0,p=-1/0;for(let r=3*e,n=3*(e+t);r<n;r++){let e=s[r],t=l.getX(e),n=l.getY(e),i=l.getZ(e);t<o&&(o=t),t>d&&(d=t),n<c&&(c=n),n>f&&(f=n),i<h&&(h=i),i>p&&(p=i)}return(a[r+0]!==o||a[r+1]!==c||a[r+2]!==h||a[r+3]!==d||a[r+4]!==f||a[r+5]!==p)&&(a[r+0]=o,a[r+1]=c,a[r+2]=h,a[r+3]=d,a[r+4]=f,a[r+5]=p,!0)}{let i=r+8,s=n[r+6],l=c,u=!1,h=!1;t?l||(u=t.has(i+o),h=t.has(s+o),l=!u&&!h):(u=!0,h=!0);let d=l||u,f=l||h,p=!1;d&&(p=e(i,o,l));let m=!1;f&&(m=e(s,o,l));let A=p||m;if(A)for(let e=0;e<3;e++){let t=i+e,n=s+e,o=a[t],l=a[t+3],c=a[n],u=a[n+3];a[r+e]=o<c?o:c,a[r+e+3]=l>u?l:u}return A}}(0,c),c+=r.byteLength})(this,e)}traverse(e,t=0){let r=this._roots[t],n=new Uint32Array(r),i=new Uint16Array(r);!function t(a,o=0){let s=2*a,l=65535===i[s+15];if(l){let t=n[a+6],c=i[s+14];e(o,l,new Float32Array(r,4*a,6),t,c)}else{let i=n[a+6],s=n[a+7];e(o,l,new Float32Array(r,4*a,6),s)||(t(a+8,o+1),t(i,o+1))}}(0)}raycast(e,t=eQ.FrontSide,r=0,n=1/0){let i=this._roots,a=this.geometry,o=[],s=t.isMaterial,l=Array.isArray(t),c=a.groups,u=s?t.side:t,h=this.indirect?pp:f6;for(let a=0,s=i.length;a<s;a++){let i=l?t[c[a].materialIndex].side:u,s=o.length;if(h(this,a,i,e,o,r,n),l){let e=c[a].materialIndex;for(let t=s,r=o.length;t<r;t++)o[t].face.materialIndex=e}}return o}raycastFirst(e,t=eQ.FrontSide,r=0,n=1/0){let i=this._roots,a=this.geometry,o=t.isMaterial,s=Array.isArray(t),l=null,c=a.groups,u=o?t.side:t,h=this.indirect?pA:f9;for(let a=0,o=i.length;a<o;a++){let i=s?t[c[a].materialIndex].side:u,o=h(this,a,i,e,r,n);null!=o&&(null==l||o.distance<l.distance)&&(l=o,s&&(o.face.materialIndex=c[a].materialIndex))}return l}intersectsGeometry(e,t){let r=!1,n=this._roots,i=this.indirect?pC:pa;for(let a=0,o=n.length;a<o&&!(r=i(this,a,e,t));a++);return r}shapecast(e){let t=fk.getPrimitive(),r=this.indirect?pf:f4,{boundsTraverseOrder:n,intersectsBounds:i,intersectsRange:a,intersectsTriangle:o}=e;if(a&&o){let e=a;a=(n,i,a,s,l)=>!!e(n,i,a,s,l)||r(n,i,this,o,a,s,t)}else a||(a=o?(e,n,i,a)=>r(e,n,this,o,i,a,t):(e,t,r)=>r);let s=!1,l=0,c=this._roots;for(let e=0,t=c.length;e<t;e++){let t=c[e];if(s=function(e,t,r,n,i,a){Y=fH.getPrimitive(),J=fH.getPrimitive(),fG.push(Y,J),fN.setBuffer(e._roots[t]);let o=function e(t,r,n,i,a=null,o=0,s=0){let{float32Array:l,uint16Array:c,uint32Array:u}=fN,h=2*t;if(fM(h,c)){let e=u[t+6],r=fS(h,c);return fg(t,l,Y),i(e,r,!1,s,o+t,Y)}{let h,p,m,A,g,v;let y=t+8,x=u[t+6],E=y,_=x;if(a&&(m=Y,A=J,fg(E,l,m),fg(_,l,A),h=a(m),(p=a(A))<h)){E=x,_=y;let e=h;h=p,p=e,m=A}m||fg(E,l,m=Y);let C=n(m,fM(2*E,c),h,s+1,o+E);if(2===C){let e=d(E);g=i(e,f(E)-e,!0,s+1,o+E,m)}else g=C&&e(E,r,n,i,a,o,s+1);if(g)return!0;fg(_,l,A=J);let b=n(A,fM(2*_,c),p,s+1,o+_);if(2===b){let e=d(_);v=i(e,f(_)-e,!0,s+1,o+_,A)}else v=b&&e(_,r,n,i,a,o,s+1);if(v)return!0;return!1;function d(e){let{uint16Array:t,uint32Array:r}=fN,n=2*e;for(;!fM(n,t);)e+=8,n=2*e;return r[e+6]}function f(e){let{uint16Array:t,uint32Array:r}=fN,n=2*e;for(;!fM(n,t);)n=2*(e=r[e+6]);return r[e+6]+fS(n,t)}}}(0,e.geometry,r,n,i,a);fN.clearBuffer(),fH.releasePrimitive(Y),fH.releasePrimitive(J),fG.pop(),fG.pop();let s=fG.length;return s>0&&(J=fG[s-1],Y=fG[s-2]),o}(this,e,i,a,n,l))break;l+=t.byteLength}return fk.releasePrimitive(t),s}bvhcast(e,t,r){let{intersectsRanges:n,intersectsTriangles:i}=r,a=fk.getPrimitive(),o=this.geometry.index,s=this.geometry.attributes.position,l=this.indirect?e=>{f3(a,3*this.resolveTriangleIndex(e),o,s)}:e=>{f3(a,3*e,o,s)},c=fk.getPrimitive(),u=e.geometry.index,h=e.geometry.attributes.position,d=e.indirect?t=>{f3(c,3*e.resolveTriangleIndex(t),u,h)}:e=>{f3(c,3*e,u,h)};if(i){let e=(e,r,n,o,s,u,h,f)=>{for(let p=n,m=n+o;p<m;p++){d(p),c.a.applyMatrix4(t),c.b.applyMatrix4(t),c.c.applyMatrix4(t),c.needsUpdate=!0;for(let t=e,n=e+r;t<n;t++)if(l(t),a.needsUpdate=!0,i(a,c,t,p,s,u,h,f))return!0}return!1};if(n){let t=n;n=function(r,n,i,a,o,s,l,c){return!!t(r,n,i,a,o,s,l,c)||e(r,n,i,a,o,s,l,c)}}else n=e}return function(e,t,r,n){let i;if(pL)throw Error("MeshBVH: Recursive calls to bvhcast not supported.");pL=!0;let a=e._roots,o=t._roots,s=0,l=0,c=new eQ.Matrix4().copy(r).invert();for(let e=0,t=a.length;e<t;e++){pP.setBuffer(a[e]),l=0;let t=pR.getPrimitive();fg(0,pP.float32Array,t),t.applyMatrix4(c);for(let a=0,u=o.length;a<u&&(pD.setBuffer(o[e]),i=function e(t,r,n,i,a,o=0,s=0,l=0,c=0,u=null,h=!1){let d,f;h?(d=pD,f=pP):(d=pP,f=pD);let p=d.float32Array,m=d.uint32Array,A=d.uint16Array,g=f.float32Array,v=f.uint32Array,y=f.uint16Array,x=2*r,E=fM(2*t,A),_=fM(x,y),C=!1;if(_&&E)C=h?a(v[r+6],fS(2*r,y),m[t+6],fS(2*t,A),c,s+r,l,o+t):a(m[t+6],fS(2*t,A),v[r+6],fS(2*r,y),l,o+t,c,s+r);else if(_){let u=pR.getPrimitive();fg(r,g,u),u.applyMatrix4(n);let d=t+8,f=m[t+6];fg(d,p,pF),fg(f,p,pz);let A=u.intersectsBox(pF),v=u.intersectsBox(pz);C=A&&e(r,d,i,n,a,s,o,c,l+1,u,!h)||v&&e(r,f,i,n,a,s,o,c,l+1,u,!h),pR.releasePrimitive(u)}else{let d=r+8,f=v[r+6];fg(d,g,pO),fg(f,g,pQ);let A=u.intersectsBox(pO),y=u.intersectsBox(pQ);if(A&&y)C=e(t,d,n,i,a,o,s,l,c+1,u,h)||e(t,f,n,i,a,o,s,l,c+1,u,h);else if(A){if(E)C=e(t,d,n,i,a,o,s,l,c+1,u,h);else{let r=pR.getPrimitive();r.copy(pO).applyMatrix4(n);let u=t+8,f=m[t+6];fg(u,p,pF),fg(f,p,pz);let A=r.intersectsBox(pF),g=r.intersectsBox(pz);C=A&&e(d,u,i,n,a,s,o,c,l+1,r,!h)||g&&e(d,f,i,n,a,s,o,c,l+1,r,!h),pR.releasePrimitive(r)}}else if(y){if(E)C=e(t,f,n,i,a,o,s,l,c+1,u,h);else{let r=pR.getPrimitive();r.copy(pQ).applyMatrix4(n);let u=t+8,d=m[t+6];fg(u,p,pF),fg(d,p,pz);let A=r.intersectsBox(pF),g=r.intersectsBox(pz);C=A&&e(f,u,i,n,a,s,o,c,l+1,r,!h)||g&&e(f,d,i,n,a,s,o,c,l+1,r,!h),pR.releasePrimitive(r)}}}return C}(0,0,r,c,n,s,l,0,0,t),pD.clearBuffer(),l+=o[a].length,!i);a++);if(pR.releasePrimitive(t),pP.clearBuffer(),s+=a[e].length,i)break}return pL=!1,i}(this,e,t,n)}intersectsBox(e,t){return pk.set(e.min,e.max,t),pk.needsUpdate=!0,this.shapecast({intersectsBounds:e=>pk.intersectsBox(e),intersectsTriangle:e=>pk.intersectsTriangle(e)})}intersectsSphere(e){return this.shapecast({intersectsBounds:t=>e.intersectsBox(t),intersectsTriangle:t=>t.intersectsSphere(e)})}closestPointToGeometry(e,t,r={},n={},i=0,a=1/0){return(this.indirect?function(e,t,r,n={},i={},a=0,o=1/0){t.boundingBox||t.computeBoundingBox(),pw.set(t.boundingBox.min,t.boundingBox.max,r),pw.needsUpdate=!0;let s=e.geometry,l=s.attributes.position,c=s.index,u=t.attributes.position,h=t.index,d=fk.getPrimitive(),f=fk.getPrimitive(),p=null,m=null;i&&(p=pS,m=pT);let A=1/0,g=null,v=null;return(pb.copy(r).invert(),pB.matrix.copy(pb),e.shapecast({boundsTraverseOrder:e=>pw.distanceToBox(e),intersectsBounds:(e,t,r)=>r<A&&r<o&&(t&&(pB.min.copy(e.min),pB.max.copy(e.max),pB.needsUpdate=!0),!0),intersectsRange:(n,i)=>{if(t.boundsTree){let s=t.boundsTree;return s.shapecast({boundsTraverseOrder:e=>pB.distanceToBox(e),intersectsBounds:(e,t,r)=>r<A&&r<o,intersectsRange:(t,o)=>{for(let y=t,x=t+o;y<x;y++){f3(f,3*s.resolveTriangleIndex(y),h,u),f.a.applyMatrix4(r),f.b.applyMatrix4(r),f.c.applyMatrix4(r),f.needsUpdate=!0;for(let t=n,r=n+i;t<r;t++){f3(d,3*e.resolveTriangleIndex(t),c,l),d.needsUpdate=!0;let r=d.distanceToTriangle(f,pI,p);if(r<A&&(pM.copy(pI),m&&m.copy(p),A=r,g=t,v=y),r<a)return!0}}}})}{let o=fd(t);for(let t=0;t<o;t++){f3(f,3*t,h,u),f.a.applyMatrix4(r),f.b.applyMatrix4(r),f.c.applyMatrix4(r),f.needsUpdate=!0;for(let r=n,o=n+i;r<o;r++){f3(d,3*e.resolveTriangleIndex(r),c,l),d.needsUpdate=!0;let n=d.distanceToTriangle(f,pI,p);if(n<A&&(pM.copy(pI),m&&m.copy(p),A=n,g=r,v=t),n<a)return!0}}}}}),fk.releasePrimitive(d),fk.releasePrimitive(f),A===1/0)?null:(n.point?n.point.copy(pM):n.point=pM.clone(),n.distance=A,n.faceIndex=g,i&&(i.point?i.point.copy(m):i.point=m.clone(),i.point.applyMatrix4(pb),pM.applyMatrix4(pb),i.distance=pM.sub(i.point).length(),i.faceIndex=v),n)}:function(e,t,r,n={},i={},a=0,o=1/0){t.boundingBox||t.computeBoundingBox(),ps.set(t.boundingBox.min,t.boundingBox.max,r),ps.needsUpdate=!0;let s=e.geometry,l=s.attributes.position,c=s.index,u=t.attributes.position,h=t.index,d=fk.getPrimitive(),f=fk.getPrimitive(),p=null,m=null;i&&(p=ph,m=pd);let A=1/0,g=null,v=null;return(po.copy(r).invert(),pl.matrix.copy(po),e.shapecast({boundsTraverseOrder:e=>ps.distanceToBox(e),intersectsBounds:(e,t,r)=>r<A&&r<o&&(t&&(pl.min.copy(e.min),pl.max.copy(e.max),pl.needsUpdate=!0),!0),intersectsRange:(e,n)=>{if(t.boundsTree)return t.boundsTree.shapecast({boundsTraverseOrder:e=>pl.distanceToBox(e),intersectsBounds:(e,t,r)=>r<A&&r<o,intersectsRange:(t,i)=>{for(let o=t,s=t+i;o<s;o++){f3(f,3*o,h,u),f.a.applyMatrix4(r),f.b.applyMatrix4(r),f.c.applyMatrix4(r),f.needsUpdate=!0;for(let t=e,r=e+n;t<r;t++){f3(d,3*t,c,l),d.needsUpdate=!0;let e=d.distanceToTriangle(f,pc,p);if(e<A&&(pu.copy(pc),m&&m.copy(p),A=e,g=t,v=o),e<a)return!0}}}});{let i=fd(t);for(let t=0;t<i;t++){f3(f,3*t,h,u),f.a.applyMatrix4(r),f.b.applyMatrix4(r),f.c.applyMatrix4(r),f.needsUpdate=!0;for(let r=e,i=e+n;r<i;r++){f3(d,3*r,c,l),d.needsUpdate=!0;let e=d.distanceToTriangle(f,pc,p);if(e<A&&(pu.copy(pc),m&&m.copy(p),A=e,g=r,v=t),e<a)return!0}}}}}),fk.releasePrimitive(d),fk.releasePrimitive(f),A===1/0)?null:(n.point?n.point.copy(pu):n.point=pu.clone(),n.distance=A,n.faceIndex=g,i&&(i.point?i.point.copy(m):i.point=m.clone(),i.point.applyMatrix4(po),pu.applyMatrix4(po),i.distance=pu.sub(i.point).length(),i.faceIndex=v),n)})(this,e,t,r,n,i,a)}closestPointToPoint(e,t={},r=0,n=1/0){return function(e,t,r={},n=0,i=1/0){let a=n*n,o=i*i,s=1/0,l=null;if(e.shapecast({boundsTraverseOrder:e=>(fV.copy(t).clamp(e.min,e.max),fV.distanceToSquared(t)),intersectsBounds:(e,t,r)=>r<s&&r<o,intersectsTriangle:(e,r)=>{e.closestPointToPoint(t,fV);let n=t.distanceToSquared(fV);return n<s&&(fj.copy(fV),s=n,l=r),n<a}}),s===1/0)return null;let c=Math.sqrt(s);return r.point?r.point.copy(fj):r.point=fj.clone(),r.distance=c,r.faceIndex=l,r}(this,e,t,r,n)}getBoundingBox(e){return e.makeEmpty(),this._roots.forEach(t=>{fg(0,new Float32Array(t),pU),e.union(pU)}),e}}let pH=new eQ.Ray,pV=new eQ.Vector3,pj=new eQ.Matrix4,pY=eQ.Mesh.prototype.raycast,pJ=new eQ.Vector3;function pW(e,t){if(this.geometry.boundsTree){if(void 0===this.material)return;pj.copy(this.matrixWorld).invert(),pH.copy(e.ray).applyMatrix4(pj),function(e,t){let r=e.elements,n=t.set(r[0],r[1],r[2]).length(),i=t.set(r[4],r[5],r[6]).length(),a=t.set(r[8],r[9],r[10]).length();t.set(n,i,a)}(this.matrixWorld,pJ),pV.copy(pH.direction).multiply(pJ);let r=pV.length(),n=e.near/r,i=e.far/r,a=this.geometry.boundsTree;if(!0===e.firstHitOnly){let r=fu(a.raycastFirst(pH,this.material,n,i),this,e);r&&t.push(r)}else{let r=a.raycast(pH,this.material,n,i);for(let n=0,i=r.length;n<i;n++){let i=fu(r[n],this,e);i&&t.push(i)}}}else pY.call(this,e,t)}function pq(e){return this.boundsTree=new pG(this,e),this.boundsTree}function pK(){this.boundsTree=null}let pX=e=>e.isMesh;function pZ(e,t){t={strategy:fl,verbose:!1,setBoundingBox:!0,maxDepth:40,maxLeafTris:10,indirect:!1,...t},ez.useEffect(()=>{if(e.current){e.current.raycast=pW;let r=e.current.geometry;return r.computeBoundsTree=pq,r.disposeBoundsTree=pK,r.computeBoundsTree(t),()=>{r.boundsTree&&r.disposeBoundsTree()}}},[e,JSON.stringify(t)])}let p$=ez.forwardRef(({enabled:e=!0,firstHitOnly:t=!1,children:r,strategy:n=fl,verbose:i=!1,setBoundingBox:a=!0,maxDepth:o=40,maxLeafTris:s=10,indirect:l=!1,...c},u)=>{let h=ez.useRef(null),d=(0,eL.A)(e=>e.raycaster);return ez.useImperativeHandle(u,()=>h.current,[]),ez.useEffect(()=>{if(e){let e={strategy:n,verbose:i,setBoundingBox:a,maxDepth:o,maxLeafTris:s,indirect:l},r=h.current;return d.firstHitOnly=t,r.traverse(t=>{pX(t)&&!t.geometry.boundsTree&&t.raycast===eQ.Mesh.prototype.raycast&&(t.raycast=pW,t.geometry.computeBoundsTree=pq,t.geometry.disposeBoundsTree=pK,t.geometry.computeBoundsTree(e))}),()=>{delete d.firstHitOnly,r.traverse(e=>{pX(e)&&e.geometry.boundsTree&&(e.geometry.disposeBoundsTree(),e.raycast=eQ.Mesh.prototype.raycast)})}}},[]),ez.createElement("group",ee({ref:h},c),r)});function p0(...e){let t=ez.useRef([]);return t.current=e.map(e=>ez.useContext(e)),ez.useMemo(()=>({children:r})=>e.reduceRight((e,r,n)=>ez.createElement(r.Provider,{value:t.current[n],children:e}),r),[])}function p1(e,t){let r=ez.useRef(),[n]=ez.useState(()=>t?t instanceof eQ.Object3D?{current:t}:t:r),[i]=ez.useState(()=>new eQ.AnimationMixer(void 0));ez.useLayoutEffect(()=>{t&&(n.current=t instanceof eQ.Object3D?t:t.current),i._root=n.current});let a=ez.useRef({}),o=ez.useMemo(()=>{let t={};return e.forEach(e=>Object.defineProperty(t,e.name,{enumerable:!0,get(){if(n.current)return a.current[e.name]||(a.current[e.name]=i.clipAction(e,n.current))},configurable:!0})),{ref:n,clips:e,actions:t,names:e.map(e=>e.name),mixer:i}},[e]);return(0,eL.C)((e,t)=>i.update(t)),ez.useEffect(()=>{let e=n.current;return()=>{a.current={},i.stopAllAction(),Object.values(o.actions).forEach(t=>{e&&i.uncacheAction(t,e)})}},[e]),o}function p2(e){let t=ez.useRef(null),r=ez.useRef(!1),n=ez.useRef(!1),i=ez.useRef(e);return ez.useLayoutEffect(()=>void(i.current=e),[e]),ez.useEffect(()=>{let e=t.current;if(e){let t=(0,eL.n)(()=>(r.current=!1,!0)),a=e.onBeforeRender;e.onBeforeRender=()=>r.current=!0;let o=(0,eL.o)(()=>(r.current!==n.current&&(null==i.current||i.current(n.current=r.current)),!0));return()=>{e.onBeforeRender=a,t(),o()}}},[]),t}let p3=`
#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )
  vec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );
  #ifdef BOX_PROJECTED_ENV_MAP
    vWorldPosition = worldPosition.xyz;
  #endif
#endif
`,p4=`
#ifdef BOX_PROJECTED_ENV_MAP
  uniform vec3 envMapSize;
  uniform vec3 envMapPosition;
  varying vec3 vWorldPosition;
    
  vec3 parallaxCorrectNormal( vec3 v, vec3 cubeSize, vec3 cubePos ) {
    vec3 nDir = normalize( v );
    vec3 rbmax = ( .5 * cubeSize + cubePos - vWorldPosition ) / nDir;
    vec3 rbmin = ( -.5 * cubeSize + cubePos - vWorldPosition ) / nDir;
    vec3 rbminmax;
    rbminmax.x = ( nDir.x > 0. ) ? rbmax.x : rbmin.x;
    rbminmax.y = ( nDir.y > 0. ) ? rbmax.y : rbmin.y;
    rbminmax.z = ( nDir.z > 0. ) ? rbmax.z : rbmin.z;
    float correction = min( min( rbminmax.x, rbminmax.y ), rbminmax.z );
    vec3 boxIntersection = vWorldPosition + nDir * correction;    
    return boxIntersection - cubePos;
  }
#endif
`,p5=`
#ifdef BOX_PROJECTED_ENV_MAP
  worldNormal = parallaxCorrectNormal( worldNormal, envMapSize, envMapPosition );
#endif
`,p6=`
#ifdef BOX_PROJECTED_ENV_MAP
  reflectVec = parallaxCorrectNormal( reflectVec, envMapSize, envMapPosition );
#endif
`;function p8(e=new eQ.Vector3,t=new eQ.Vector3){let[r]=ez.useState(()=>({position:new eQ.Vector3,size:new eQ.Vector3}));(0,eL.j)(r,{position:e,size:t});let n=ez.useRef(null),i=ez.useMemo(()=>({ref:n,onBeforeCompile:e=>{var t,n;return t=r.position,n=r.size,void(e.defines.BOX_PROJECTED_ENV_MAP=!0,e.uniforms.envMapPosition={value:t},e.uniforms.envMapSize={value:n},e.vertexShader=`
  varying vec3 vWorldPosition;
  ${e.vertexShader.replace("#include <worldpos_vertex>",p3)}`,e.fragmentShader=`
    ${p4}
    ${e.fragmentShader.replace("#include <envmap_physical_pars_fragment>",eQ.ShaderChunk.envmap_physical_pars_fragment).replace("vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );",`vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
         ${p5}
         `).replace("reflectVec = inverseTransformDirection( reflectVec, viewMatrix );",`reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
         ${p6}
        `)}`)},customProgramCacheKey:()=>JSON.stringify(r.position.toArray())+JSON.stringify(r.size.toArray())}),[...r.position.toArray(),...r.size.toArray()]);return ez.useLayoutEffect(()=>void(n.current.needsUpdate=!0),[r]),i}let p9=new eQ.Box3,p7=new eQ.Vector3,me=({anchor:e,...t})=>{let r=ez.useRef(null),n=ez.useRef(null);return ez.useEffect(()=>{var e;null!=(e=r.current)&&null!=(e=e.parent)&&e.parent&&(n.current=r.current.parent,r.current.parent.parent.add(r.current))},[]),(0,eL.C)(()=>{n.current&&(p9.setFromObject(n.current),p9.getSize(p7),r.current.position.set(n.current.position.x+p7.x*(Array.isArray(e)?e[0]:e.x)/2,n.current.position.y+p7.y*(Array.isArray(e)?e[1]:e.y)/2,n.current.position.z+p7.z*(Array.isArray(e)?e[2]:e.z)/2))}),ez.createElement("group",ee({ref:r},t))},mt=e=>Math.sqrt(1-Math.pow(e-1,2));class mr{constructor({size:e=256,maxAge:t=750,radius:r=.3,intensity:n=.2,interpolate:i=0,smoothing:a=0,minForce:o=.3,blend:s="screen",ease:l=mt}={}){this.size=e,this.maxAge=t,this.radius=r,this.intensity=n,this.ease=l,this.interpolate=i,this.smoothing=a,this.minForce=o,this.blend=s,this.trail=[],this.force=0,this.initTexture()}initTexture(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=this.size;let e=this.canvas.getContext("2d");if(null===e)throw Error("2D not available");this.ctx=e,this.ctx.fillStyle="black",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.texture=new eQ.Texture(this.canvas),this.canvas.id="touchTexture",this.canvas.style.width=this.canvas.style.height=`${this.canvas.width}px`}update(e){this.clear(),this.trail.forEach((t,r)=>{t.age+=1e3*e,t.age>this.maxAge&&this.trail.splice(r,1)}),this.trail.length||(this.force=0),this.trail.forEach(e=>{this.drawTouch(e)}),this.texture.needsUpdate=!0}clear(){this.ctx.globalCompositeOperation="source-over",this.ctx.fillStyle="black",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height)}addTouch(e){let t=this.trail[this.trail.length-1];if(t){let r=t.x-e.x,n=t.y-e.y,i=r*r+n*n,a=Math.max(this.minForce,Math.min(1e4*i,1));if(this.force=function(e,t,r=.9){return t*r+e*(1-r)}(a,this.force,this.smoothing),this.interpolate){let e=Math.ceil(i/Math.pow(.5*this.radius/this.interpolate,2));if(e>1)for(let i=1;i<e;i++)this.trail.push({x:t.x-r/e*i,y:t.y-n/e*i,age:0,force:a})}}this.trail.push({x:e.x,y:e.y,age:0,force:this.force})}drawTouch(e){let t={x:e.x*this.size,y:(1-e.y)*this.size},r=1;r=(e.age<.3*this.maxAge?this.ease(e.age/(.3*this.maxAge)):this.ease(1-(e.age-.3*this.maxAge)/(.7*this.maxAge)))*e.force,this.ctx.globalCompositeOperation=this.blend;let n=this.size*this.radius*r,i=this.ctx.createRadialGradient(t.x,t.y,Math.max(0,.25*n),t.x,t.y,Math.max(0,n));i.addColorStop(0,`rgba(255, 255, 255, ${this.intensity})`),i.addColorStop(1,"rgba(0, 0, 0, 0.0)"),this.ctx.beginPath(),this.ctx.fillStyle=i,this.ctx.arc(t.x,t.y,Math.max(0,n),0,2*Math.PI),this.ctx.fill()}}function mn(e={}){let{size:t,maxAge:r,radius:n,intensity:i,interpolate:a,smoothing:o,minForce:s,blend:l,ease:c}=e,u=(0,ez.useMemo)(()=>new mr(e),[t,r,n,i,a,o,s,l,c]);(0,eL.C)((e,t)=>void u.update(t));let h=(0,ez.useCallback)(e=>u.addTouch(e.uv),[u]);return[u.texture,h]}let mi=({children:e,...t})=>{let r=mn(t);return ez.createElement(ez.Fragment,null,null==e?void 0:e(r))},ma=ez.forwardRef(function({children:e,disable:t,disableX:r,disableY:n,disableZ:i,left:a,right:o,top:s,bottom:l,front:c,back:u,onCentered:h,precise:d=!0,cacheKey:f=0,...p},m){let A=ez.useRef(null),g=ez.useRef(null),v=ez.useRef(null);return ez.useLayoutEffect(()=>{g.current.matrixWorld.identity();let e=new eQ.Box3().setFromObject(v.current,d),f=new eQ.Vector3,p=new eQ.Sphere,m=e.max.x-e.min.x,y=e.max.y-e.min.y,x=e.max.z-e.min.z;e.getCenter(f),e.getBoundingSphere(p);let E=s?y/2:l?-y/2:0,_=a?-m/2:o?m/2:0,C=c?x/2:u?-x/2:0;g.current.position.set(t||r?0:-f.x+_,t||n?0:-f.y+E,t||i?0:-f.z+C),void 0!==h&&h({parent:A.current.parent,container:A.current,width:m,height:y,depth:x,boundingBox:e,boundingSphere:p,center:f,verticalAlignment:E,horizontalAlignment:_,depthAlignment:C})},[f,h,s,a,c,t,r,n,i,d,o,l,u]),ez.useImperativeHandle(m,()=>A.current,[]),ez.createElement("group",ee({ref:A},p),ez.createElement("group",{ref:g},ez.createElement("group",{ref:v},e)))}),mo=ez.forwardRef(({font:e,color:t="#cbcbcb",bevelSize:r=.04,debug:n=!1,children:i,...a},o)=>{let[s,l]=ez.useState(0),c=ez.useCallback((e=1)=>l(s+e),[s]),u=ez.useCallback((e=1)=>l(s-e),[s]),h=ez.useMemo(()=>({incr:c,decr:u}),[c,u]);return ez.useImperativeHandle(o,()=>h,[h]),ez.createElement("group",a,ez.createElement(ez.Suspense,{fallback:null},ez.createElement(ma,{top:!0,cacheKey:JSON.stringify({counter:s,font:e})},ez.createElement(o$,{bevelEnabled:!0,bevelSize:r,font:e},n?ez.createElement("meshNormalMaterial",{wireframe:!0}):ez.createElement("meshStandardMaterial",{color:t}),s))),i)});var ms=r(1448),ml=r.n(ms);function mc(e){return function e(t,r,n){if(n=n||[],!r[0])return t(n);function i(i){return e(t,r.slice(1),n.concat([i]))}return"function"==typeof r[0]?r[0]({results:n,render:i}):(0,ez.cloneElement)(r[0],{children:i})}(e.children,e.components)}mc.propTypes={children:ml().func.isRequired,components:ml().arrayOf(ml().oneOfType([ml().element,ml().func])).isRequired};let mu=(e,t)=>{"updateRanges"in e?e.updateRanges[0]=t:e.updateRange=t},mh=new eQ.Matrix4,md=new eQ.Matrix4,mf=[],mp=new eQ.Mesh;class mm extends eQ.Group{constructor(){super(),this.color=new eQ.Color("white"),this.instance={current:void 0},this.instanceKey={current:void 0}}get geometry(){var e;return null==(e=this.instance.current)?void 0:e.geometry}raycast(e,t){let r=this.instance.current;if(!r||!r.geometry||!r.material)return;mp.geometry=r.geometry;let n=r.matrixWorld,i=r.userData.instances.indexOf(this.instanceKey);if(-1!==i&&!(i>r.count)){r.getMatrixAt(i,mh),md.multiplyMatrices(n,mh),mp.matrixWorld=md,r.material instanceof eQ.Material?mp.material.side=r.material.side:mp.material.side=r.material[0].side,mp.raycast(e,mf);for(let e=0,r=mf.length;e<r;e++){let r=mf[e];r.instanceId=i,r.object=this,t.push(r)}mf.length=0}}}let mA=ez.createContext(null),mg=new eQ.Matrix4,mv=new eQ.Matrix4,my=new eQ.Matrix4,mx=new eQ.Vector3,mE=new eQ.Quaternion,m_=new eQ.Vector3,mC=ez.forwardRef(({context:e,children:t,...r},n)=>{ez.useMemo(()=>(0,eL.e)({PositionMesh:mm}),[]);let i=ez.useRef();ez.useImperativeHandle(n,()=>i.current,[]);let{subscribe:a,getParent:o}=ez.useContext(e||mA);return ez.useLayoutEffect(()=>a(i),[]),ez.createElement("positionMesh",ee({instance:o(),instanceKey:i,ref:i},r),t)}),mb=ez.forwardRef(({children:e,range:t,limit:r=1e3,frames:n=1/0,...i},a)=>{let[{context:o,instance:s}]=ez.useState(()=>{let e=ez.createContext(null);return{context:e,instance:ez.forwardRef((t,r)=>ez.createElement(mC,ee({context:e},t,{ref:r})))}}),l=ez.useRef(null);ez.useImperativeHandle(a,()=>l.current,[]);let[c,u]=ez.useState([]),[[h,d]]=ez.useState(()=>{let e=new Float32Array(16*r);for(let t=0;t<r;t++)my.identity().toArray(e,16*t);return[e,new Float32Array([...Array(3*r)].map(()=>1))]});ez.useEffect(()=>{l.current.instanceMatrix.needsUpdate=!0});let f=0,p=0;(0,eL.C)(()=>{if(n===1/0||f<n){l.current.updateMatrix(),l.current.updateMatrixWorld(),mg.copy(l.current.matrixWorld).invert(),p=Math.min(r,void 0!==t?t:r,c.length),l.current.count=p,mu(l.current.instanceMatrix,{offset:0,count:16*p}),mu(l.current.instanceColor,{offset:0,count:3*p});for(let e=0;e<c.length;e++){let t=c[e].current;t.matrixWorld.decompose(mx,mE,m_),mv.compose(mx,mE,m_).premultiply(mg),mv.toArray(h,16*e),l.current.instanceMatrix.needsUpdate=!0,t.color.toArray(d,3*e),l.current.instanceColor.needsUpdate=!0}f++}});let m=ez.useMemo(()=>({getParent:()=>l,subscribe:e=>(u(t=>[...t,e]),()=>u(t=>t.filter(t=>t.current!==e.current)))}),[]);return ez.createElement("instancedMesh",ee({userData:{instances:c},matrixAutoUpdate:!1,ref:l,args:[null,null,0],raycast:()=>null},i),ez.createElement("instancedBufferAttribute",{attach:"instanceMatrix",count:h.length/16,array:h,itemSize:16,usage:eQ.DynamicDrawUsage}),ez.createElement("instancedBufferAttribute",{attach:"instanceColor",count:d.length/3,array:d,itemSize:3,usage:eQ.DynamicDrawUsage}),"function"==typeof e?ez.createElement(o.Provider,{value:m},e(s)):ez.createElement(mA.Provider,{value:m},e))}),mw=ez.forwardRef(function({meshes:e,children:t,...r},n){let i=Array.isArray(e);if(!i)for(let t of Object.keys(e))e[t].isMesh||delete e[t];return ez.createElement("group",{ref:n},ez.createElement(mc,{components:(i?e:Object.values(e)).map(({geometry:e,material:t})=>ez.createElement(mb,ee({key:e.uuid,geometry:e,material:t},r)))},r=>i?t(...r):t(Object.keys(e).filter(t=>e[t].isMesh).reduce((e,t,n)=>({...e,[t]:r[n]}),{}))))}),mB=ez.createContext(null);function mI(){return ez.useContext(mB)}let mM=ez.forwardRef(({startFrame:e,endFrame:t,fps:r,frameName:n,textureDataURL:i,textureImageURL:a,loop:o,numberOfFrames:s,autoPlay:l,animationNames:c,onStart:u,onEnd:h,onLoopEnd:d,onFrame:f,play:p,pause:m,flipX:A,alphaTest:g,children:v,asSprite:y,offset:x,playBackwards:E,resetOnEnd:_,maxItems:C,instanceItems:b,spriteDataset:w,...B},I)=>{var M,S,T;let P;let D=ez.useRef(),R=ez.useRef(null),F=ez.useRef(),z=ez.useRef(),O=ez.useRef(window.performance.now()),Q=ez.useRef(e||0),L=ez.useRef(n||""),k=1e3/(r||30),[U,N]=ez.useState(new eQ.Texture),G=ez.useRef(0),[H,V]=ez.useState([1,1,1]),j=A?-1:1,[Y,J]=ez.useState(null==y||y),W=ez.useRef(m),q=ez.useRef(x),K=ez.useRef(!1),X=ez.useRef([]),{spriteObj:Z,loadJsonAndTexture:$}=dJ(null,null,c,s);function et(){}let er=ez.useMemo(()=>({current:q.current,offset:q.current,imageUrl:a,reset:et,hasEnded:!1,ref:I}),[a,w]);ez.useImperativeHandle(I,()=>D.current,[]),ez.useLayoutEffect(()=>{q.current=x},[x]);let en=(e,t)=>{let r=t/e;return z.current&&z.current.scale.set(1,r,1),[1,r,1]};ez.useEffect(()=>{if(w){var e;ei(null==w||null==(e=w.spriteTexture)?void 0:e.clone(),w.spriteData)}else $(a,i)},[w]),ez.useEffect(()=>{if(Z){var e;ei(null==Z||null==(e=Z.spriteTexture)?void 0:e.clone(),null==Z?void 0:Z.spriteData)}},[Z]),ez.useEffect(()=>{J(null==y||y)},[y]),ez.useEffect(()=>{er.hasEnded=!1,R.current&&!0===E?Q.current=R.current.frames.length-1:Q.current=0},[E]),ez.useLayoutEffect(()=>{ea()},[U,A]),ez.useEffect(()=>{l&&(W.current=!1)},[l]),ez.useLayoutEffect(()=>{if(L.current!==n&&n&&(Q.current=0,L.current=n,er.hasEnded=!1,R.current)){let{w:e,h:t}=el(R.current.frames).sourceSize;V(en(e,t))}},[n]);let ei=(e,t=null)=>{if(null===t){if(s){let r=e.image.width,n=e.image.height;G.current=s,E&&(Q.current=s-1),R.current={frames:[],meta:{version:"1.0",size:{w:r,h:n},scale:"1"}},R.current.frames=t}}else{R.current=t,G.current=R.current.frames.length,E&&(Q.current=G.current-1);let{w:r,h:n}=el(R.current.frames).sourceSize;V(en(r,n)),F.current&&(F.current.map=e)}if(b)for(var r=0;r<b.length;r++){let e=Object.keys(R.current.frames),t=e[Math.floor(Math.random()*e.length)];X.current.push({key:r,frames:R.current.frames,selectedFrame:t,offset:{x:0,y:0}})}N(e)},ea=()=>{if(!R.current)return;let{meta:{size:e},frames:t}=R.current,{w:r,h:i}=Array.isArray(t)?t[0].sourceSize:n&&t[n]?t[n][0].sourceSize:{w:0,h:0};F.current.map.wrapS=F.current.map.wrapT=eQ.RepeatWrapping,F.current.map.center.set(0,0),F.current.map.repeat.set(1*j/(e.w/r),1/(e.h/i));let a=(e.h-1)/i;F.current.map.offset.x=0,F.current.map.offset.y=1-1/a,u&&u({currentFrameName:n,currentFrame:Q.current})},eo=()=>{let r=window.performance.now(),i=r-O.current,{meta:{size:a},frames:s}=R.current,{w:l,h:c}=el(s).sourceSize,f=Array.isArray(s)?s:n?s[n]:[],p=t||f.length-1;var m=void 0===x?er.current:x,A=E?Q.current<0:Q.current>p,g=E?Q.current===p:0===Q.current,v=E?Q.current<0:Q.current>=p;if(A){if(Q.current=o&&null!=e?e:0,E&&(Q.current=p),o?null==d||d({currentFrameName:n,currentFrame:Q.current}):(null==h||h({currentFrameName:n,currentFrame:Q.current}),er.hasEnded=!_,_&&(W.current=!0)),!o)return}else g&&(null==u||u({currentFrameName:n,currentFrame:Q.current}));void 0!==m&&v?!1===K.current&&(null==h||h({currentFrameName:n,currentFrame:Q.current}),K.current=!0):K.current=!1,i<=k||(O.current=r-i%k,es(l,c,a,f))},es=(e,t,r,n)=>{var i=void 0===x?er.current:x;let a=Q.current,o=0,s=0;en(e,t);let l=Math.round((r.w-1)/e),c=Math.round((r.h-1)/t);if(!n[a])return;let{frame:{x:u,y:h},sourceSize:{w:d,h:f}}=n[a],p=1/l,m=1/c;if(o=j>0?u/d*p:u/d*p-F.current.map.repeat.x,s=Math.abs(1-m)-h/f*m,F.current.map.offset.x=o,F.current.map.offset.y=s,null!=i){let e=Math.floor(i*n.length);isNaN(e=Math.max(0,Math.min(e,n.length-1)))&&(e=0),Q.current=e}else E?Q.current-=1:Q.current+=1};(0,eL.C)((e,t)=>{var r,n;null!=(r=R.current)&&r.frames&&null!=(n=F.current)&&n.map&&!W.current&&!er.hasEnded&&(l||p)&&(eo(),f&&f({currentFrameName:L.current,currentFrame:Q.current}))});let el=e=>{if(Array.isArray(e))return e[0];if("object"!=typeof e||null===e)return{w:0,h:0};{let t=Object.keys(e);return n?e[n][0]:e[t[0]][0]}};return ez.createElement("group",ee({},B,{ref:D,scale:(S=null!=H?H:[1,1,1],T=null!==(M=B.scale)&&void 0!==M?M:1,P=[],"number"==typeof T?P=[T,T,T]:Array.isArray(T)?P=T:T instanceof eQ.Vector3&&(P=[T.x,T.y,T.z]),S.map((e,t)=>e*P[t]))}),ez.createElement(mB.Provider,{value:er},ez.createElement(ez.Suspense,{fallback:null},Y&&ez.createElement("sprite",{ref:z,scale:1},ez.createElement("spriteMaterial",{premultipliedAlpha:!1,toneMapped:!1,ref:F,map:U,transparent:!0,alphaTest:null!=g?g:0})),!Y&&ez.createElement(mb,{limit:null!=C?C:1},ez.createElement("planeGeometry",{args:[1,1]}),ez.createElement("meshBasicMaterial",{premultipliedAlpha:!1,toneMapped:!1,side:eQ.DoubleSide,ref:F,map:U,transparent:!0,alphaTest:null!=g?g:0}),(null!=b?b:[0]).map((e,t)=>ez.createElement(mC,{key:t,ref:(null==b?void 0:b.length)===1?z:null,position:e,scale:1})))),v))});var mS=Object.defineProperty,mT=(e,t,r)=>t in e?mS(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,mP=(e,t,r)=>(mT(e,"symbol"!=typeof t?t+"":t,r),r);let mD=(e=1)=>{let t=new Float32Array(4096*e*4),r=new eQ.DataTexture(t,1024,4*e,eQ.RGBAFormat,eQ.FloatType);return r.wrapS=eQ.RepeatWrapping,r.wrapT=eQ.RepeatWrapping,r.magFilter=eQ.NearestFilter,r.needsUpdate=!0,r},mR=(e,t,r=0)=>{let n=Math.floor(1024);t.arcLengthDivisions=n/2,t.updateArcLengths();let i=t.getSpacedPoints(n),a=t.computeFrenetFrames(n,!0);for(let t=0;t<n;t++){let n=Math.floor(t/1024),o=t%1024,s=i[t];mF(e,o,s.x,s.y,s.z,0+n+4*r),mF(e,o,(s=a.tangents[t]).x,s.y,s.z,1+n+4*r),mF(e,o,(s=a.normals[t]).x,s.y,s.z,2+n+4*r),mF(e,o,(s=a.binormals[t]).x,s.y,s.z,3+n+4*r)}e.needsUpdate=!0},mF=(e,t,r,n,i,a)=>{let{data:o}=e.image,s=4096*a;o[4*t+s+0]=r,o[4*t+s+1]=n,o[4*t+s+2]=i,o[4*t+s+3]=1},mz=e=>({spineTexture:{value:e},pathOffset:{type:"f",value:0},pathSegment:{type:"f",value:1},spineOffset:{type:"f",value:161},spineLength:{type:"f",value:400},flow:{type:"i",value:1}});class mO{constructor(e,t=1){mP(this,"curveArray"),mP(this,"curveLengthArray"),mP(this,"object3D"),mP(this,"splineTexure"),mP(this,"uniforms");let r=e.clone(),n=mD(t),i=mz(n);r.traverse(e=>{(e instanceof eQ.Mesh||e instanceof eQ.InstancedMesh)&&(e.material=e.material.clone(),function(e,t,r=1){e.__ok||(e.__ok=!0,e.onBeforeCompile=e=>{if(e.__modified)return;e.__modified=!0,Object.assign(e.uniforms,t);let n=`
		uniform sampler2D spineTexture;
		uniform float pathOffset;
		uniform float pathSegment;
		uniform float spineOffset;
		uniform float spineLength;
		uniform int flow;

		float textureLayers = ${4*r}.;
		float textureStacks = 1.;

		${e.vertexShader}
		`.replace("#include <beginnormal_vertex>","").replace("#include <defaultnormal_vertex>","").replace("#include <begin_vertex>","").replace(/void\s*main\s*\(\)\s*\{/,`
        void main() {
        #include <beginnormal_vertex>

        vec4 worldPos = modelMatrix * vec4(position, 1.);

        bool bend = flow > 0;
        float xWeight = bend ? 0. : 1.;

        #ifdef USE_INSTANCING
        float pathOffsetFromInstanceMatrix = instanceMatrix[3][2];
        float spineLengthFromInstanceMatrix = instanceMatrix[3][0];
        float spinePortion = bend ? (worldPos.x + spineOffset) / spineLengthFromInstanceMatrix : 0.;
        float mt = (spinePortion * pathSegment + pathOffset + pathOffsetFromInstanceMatrix)*textureStacks;
        #else
        float spinePortion = bend ? (worldPos.x + spineOffset) / spineLength : 0.;
        float mt = (spinePortion * pathSegment + pathOffset)*textureStacks;
        #endif

        mt = mod(mt, textureStacks);
        float rowOffset = floor(mt);

        #ifdef USE_INSTANCING
        rowOffset += instanceMatrix[3][1] * 4.;
        #endif

        vec3 spinePos = texture2D(spineTexture, vec2(mt, (0. + rowOffset + 0.5) / textureLayers)).xyz;
        vec3 a =        texture2D(spineTexture, vec2(mt, (1. + rowOffset + 0.5) / textureLayers)).xyz;
        vec3 b =        texture2D(spineTexture, vec2(mt, (2. + rowOffset + 0.5) / textureLayers)).xyz;
        vec3 c =        texture2D(spineTexture, vec2(mt, (3. + rowOffset + 0.5) / textureLayers)).xyz;
        mat3 basis = mat3(a, b, c);

        vec3 transformed = basis
          * vec3(worldPos.x * xWeight, worldPos.y * 1., worldPos.z * 1.)
          + spinePos;

        vec3 transformedNormal = normalMatrix * (basis * objectNormal);
			`).replace("#include <project_vertex>",`vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );
				gl_Position = projectionMatrix * mvPosition;`);e.vertexShader=n})}(e.material,i,t))}),this.curveArray=Array(t),this.curveLengthArray=Array(t),this.object3D=r,this.splineTexure=n,this.uniforms=i}updateCurve(e,t){if(e>=this.curveArray.length)throw Error("Index out of range for Flow");let r=t.getLength();this.uniforms.spineLength.value=r,this.curveLengthArray[e]=r,this.curveArray[e]=t,mR(this.splineTexure,t,e)}moveAlongCurve(e){this.uniforms.pathOffset.value+=e}}new eQ.Matrix4;let mQ=ez.forwardRef(({children:e,curve:t},r)=>{let[n]=ez.useState(()=>new eQ.Scene),[i,a]=ez.useState(),o=ez.useRef();return ez.useEffect(()=>{o.current=new mO(n.children[0]),a(o.current.object3D)},[e]),ez.useEffect(()=>{var e;t&&(null==(e=o.current)||e.updateCurve(0,t))},[t]),ez.useImperativeHandle(r,()=>({moveAlongCurve:e=>{var t;null==(t=o.current)||t.moveAlongCurve(e)}})),ez.createElement(ez.Fragment,null,(0,eL.g)(e,n),i&&ez.createElement("primitive",{object:i}))});class mL extends eQ.MeshPhysicalMaterial{constructor(e={}){super(e),this.setValues(e),this._time={value:0},this._distort={value:.4},this._radius={value:1}}onBeforeCompile(e){e.uniforms.time=this._time,e.uniforms.radius=this._radius,e.uniforms.distort=this._distort,e.vertexShader=`
      uniform float time;
      uniform float radius;
      uniform float distort;
      #define GLSLIFY 1
vec3 mod289(vec3 x){return x-floor(x*(1.0/289.0))*289.0;}vec4 mod289(vec4 x){return x-floor(x*(1.0/289.0))*289.0;}vec4 permute(vec4 x){return mod289(((x*34.0)+1.0)*x);}vec4 taylorInvSqrt(vec4 r){return 1.79284291400159-0.85373472095314*r;}float snoise(vec3 v){const vec2 C=vec2(1.0/6.0,1.0/3.0);const vec4 D=vec4(0.0,0.5,1.0,2.0);vec3 i=floor(v+dot(v,C.yyy));vec3 x0=v-i+dot(i,C.xxx);vec3 g=step(x0.yzx,x0.xyz);vec3 l=1.0-g;vec3 i1=min(g.xyz,l.zxy);vec3 i2=max(g.xyz,l.zxy);vec3 x1=x0-i1+C.xxx;vec3 x2=x0-i2+C.yyy;vec3 x3=x0-D.yyy;i=mod289(i);vec4 p=permute(permute(permute(i.z+vec4(0.0,i1.z,i2.z,1.0))+i.y+vec4(0.0,i1.y,i2.y,1.0))+i.x+vec4(0.0,i1.x,i2.x,1.0));float n_=0.142857142857;vec3 ns=n_*D.wyz-D.xzx;vec4 j=p-49.0*floor(p*ns.z*ns.z);vec4 x_=floor(j*ns.z);vec4 y_=floor(j-7.0*x_);vec4 x=x_*ns.x+ns.yyyy;vec4 y=y_*ns.x+ns.yyyy;vec4 h=1.0-abs(x)-abs(y);vec4 b0=vec4(x.xy,y.xy);vec4 b1=vec4(x.zw,y.zw);vec4 s0=floor(b0)*2.0+1.0;vec4 s1=floor(b1)*2.0+1.0;vec4 sh=-step(h,vec4(0.0));vec4 a0=b0.xzyw+s0.xzyw*sh.xxyy;vec4 a1=b1.xzyw+s1.xzyw*sh.zzww;vec3 p0=vec3(a0.xy,h.x);vec3 p1=vec3(a0.zw,h.y);vec3 p2=vec3(a1.xy,h.z);vec3 p3=vec3(a1.zw,h.w);vec4 norm=taylorInvSqrt(vec4(dot(p0,p0),dot(p1,p1),dot(p2,p2),dot(p3,p3)));p0*=norm.x;p1*=norm.y;p2*=norm.z;p3*=norm.w;vec4 m=max(0.6-vec4(dot(x0,x0),dot(x1,x1),dot(x2,x2),dot(x3,x3)),0.0);m=m*m;return 42.0*dot(m*m,vec4(dot(p0,x0),dot(p1,x1),dot(p2,x2),dot(p3,x3)));}
      ${e.vertexShader}
    `,e.vertexShader=e.vertexShader.replace("#include <begin_vertex>",`
        float updateTime = time / 50.0;
        float noise = snoise(vec3(position / 2.0 + updateTime * 5.0));
        vec3 transformed = vec3(position * (noise * pow(distort, 2.0) + radius));
        `)}get time(){return this._time.value}set time(e){this._time.value=e}get distort(){return this._distort.value}set distort(e){this._distort.value=e}get radius(){return this._radius.value}set radius(e){this._radius.value=e}}let mk=ez.forwardRef(({speed:e=1,...t},r)=>{let[n]=ez.useState(()=>new mL);return(0,eL.C)(t=>n&&(n.time=t.clock.getElapsedTime()*e)),ez.createElement("primitive",ee({object:n,ref:r,attach:"material"},t))});class mU extends eQ.MeshStandardMaterial{constructor(e={}){super(e),this.setValues(e),this._time={value:0},this._factor={value:1}}onBeforeCompile(e){e.uniforms.time=this._time,e.uniforms.factor=this._factor,e.vertexShader=`
      uniform float time;
      uniform float factor;
      ${e.vertexShader}
    `,e.vertexShader=e.vertexShader.replace("#include <begin_vertex>",`float theta = sin( time + position.y ) / 2.0 * factor;
        float c = cos( theta );
        float s = sin( theta );
        mat3 m = mat3( c, 0, s, 0, 1, 0, -s, 0, c );
        vec3 transformed = vec3( position ) * m;
        vNormal = vNormal * m;`)}get time(){return this._time.value}set time(e){this._time.value=e}get factor(){return this._factor.value}set factor(e){this._factor.value=e}}let mN=ez.forwardRef(({speed:e=1,...t},r)=>{let[n]=ez.useState(()=>new mU);return(0,eL.C)(t=>n&&(n.time=t.clock.getElapsedTime()*e)),ez.createElement("primitive",ee({object:n,ref:r,attach:"material"},t))});class mG extends eQ.ShaderMaterial{constructor(e=new eQ.Vector2){super({uniforms:{inputBuffer:new eQ.Uniform(null),depthBuffer:new eQ.Uniform(null),resolution:new eQ.Uniform(new eQ.Vector2),texelSize:new eQ.Uniform(new eQ.Vector2),halfTexelSize:new eQ.Uniform(new eQ.Vector2),kernel:new eQ.Uniform(0),scale:new eQ.Uniform(1),cameraNear:new eQ.Uniform(0),cameraFar:new eQ.Uniform(1),minDepthThreshold:new eQ.Uniform(0),maxDepthThreshold:new eQ.Uniform(1),depthScale:new eQ.Uniform(0),depthToBlurRatioBias:new eQ.Uniform(.25)},fragmentShader:`#include <common>
        #include <dithering_pars_fragment>      
        uniform sampler2D inputBuffer;
        uniform sampler2D depthBuffer;
        uniform float cameraNear;
        uniform float cameraFar;
        uniform float minDepthThreshold;
        uniform float maxDepthThreshold;
        uniform float depthScale;
        uniform float depthToBlurRatioBias;
        varying vec2 vUv;
        varying vec2 vUv0;
        varying vec2 vUv1;
        varying vec2 vUv2;
        varying vec2 vUv3;

        void main() {
          float depthFactor = 0.0;
          
          #ifdef USE_DEPTH
            vec4 depth = texture2D(depthBuffer, vUv);
            depthFactor = smoothstep(minDepthThreshold, maxDepthThreshold, 1.0-(depth.r * depth.a));
            depthFactor *= depthScale;
            depthFactor = max(0.0, min(1.0, depthFactor + 0.25));
          #endif
          
          vec4 sum = texture2D(inputBuffer, mix(vUv0, vUv, depthFactor));
          sum += texture2D(inputBuffer, mix(vUv1, vUv, depthFactor));
          sum += texture2D(inputBuffer, mix(vUv2, vUv, depthFactor));
          sum += texture2D(inputBuffer, mix(vUv3, vUv, depthFactor));
          gl_FragColor = sum * 0.25 ;

          #include <dithering_fragment>
          #include <tonemapping_fragment>
          #include <${s_>=154?"colorspace_fragment":"encodings_fragment"}>
        }`,vertexShader:`uniform vec2 texelSize;
        uniform vec2 halfTexelSize;
        uniform float kernel;
        uniform float scale;
        varying vec2 vUv;
        varying vec2 vUv0;
        varying vec2 vUv1;
        varying vec2 vUv2;
        varying vec2 vUv3;

        void main() {
          vec2 uv = position.xy * 0.5 + 0.5;
          vUv = uv;

          vec2 dUv = (texelSize * vec2(kernel) + halfTexelSize) * scale;
          vUv0 = vec2(uv.x - dUv.x, uv.y + dUv.y);
          vUv1 = vec2(uv.x + dUv.x, uv.y + dUv.y);
          vUv2 = vec2(uv.x + dUv.x, uv.y - dUv.y);
          vUv3 = vec2(uv.x - dUv.x, uv.y - dUv.y);

          gl_Position = vec4(position.xy, 1.0, 1.0);
        }`,blending:eQ.NoBlending,depthWrite:!1,depthTest:!1}),this.toneMapped=!1,this.setTexelSize(e.x,e.y),this.kernel=new Float32Array([0,1,2,2,3])}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t),this.uniforms.halfTexelSize.value.set(e,t).multiplyScalar(.5)}setResolution(e){this.uniforms.resolution.value.copy(e)}}class mH{constructor({gl:e,resolution:t,width:r=500,height:n=500,minDepthThreshold:i=0,maxDepthThreshold:a=1,depthScale:o=0,depthToBlurRatioBias:s=.25}){this.renderToScreen=!1,this.renderTargetA=new eQ.WebGLRenderTarget(t,t,{minFilter:eQ.LinearFilter,magFilter:eQ.LinearFilter,stencilBuffer:!1,depthBuffer:!1,type:eQ.HalfFloatType}),this.renderTargetB=this.renderTargetA.clone(),this.convolutionMaterial=new mG,this.convolutionMaterial.setTexelSize(1/r,1/n),this.convolutionMaterial.setResolution(new eQ.Vector2(r,n)),this.scene=new eQ.Scene,this.camera=new eQ.Camera,this.convolutionMaterial.uniforms.minDepthThreshold.value=i,this.convolutionMaterial.uniforms.maxDepthThreshold.value=a,this.convolutionMaterial.uniforms.depthScale.value=o,this.convolutionMaterial.uniforms.depthToBlurRatioBias.value=s,this.convolutionMaterial.defines.USE_DEPTH=o>0;let l=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),c=new Float32Array([0,0,2,0,0,2]),u=new eQ.BufferGeometry;u.setAttribute("position",new eQ.BufferAttribute(l,3)),u.setAttribute("uv",new eQ.BufferAttribute(c,2)),this.screen=new eQ.Mesh(u,this.convolutionMaterial),this.screen.frustumCulled=!1,this.scene.add(this.screen)}render(e,t,r){let n,i,a;let o=this.scene,s=this.camera,l=this.renderTargetA,c=this.renderTargetB,u=this.convolutionMaterial,h=u.uniforms;h.depthBuffer.value=t.depthTexture;let d=u.kernel,f=t;for(i=0,a=d.length-1;i<a;++i)n=(1&i)==0?l:c,h.kernel.value=d[i],h.inputBuffer.value=f.texture,e.setRenderTarget(n),e.render(o,s),f=n;h.kernel.value=d[i],h.inputBuffer.value=f.texture,e.setRenderTarget(this.renderToScreen?null:r),e.render(o,s)}}class mV extends eQ.MeshStandardMaterial{constructor(e={}){super(e),this._tDepth={value:null},this._distortionMap={value:null},this._tDiffuse={value:null},this._tDiffuseBlur={value:null},this._textureMatrix={value:null},this._hasBlur={value:!1},this._mirror={value:0},this._mixBlur={value:0},this._blurStrength={value:.5},this._minDepthThreshold={value:.9},this._maxDepthThreshold={value:1},this._depthScale={value:0},this._depthToBlurRatioBias={value:.25},this._distortion={value:1},this._mixContrast={value:1},this.setValues(e)}onBeforeCompile(e){var t;null!=(t=e.defines)&&t.USE_UV||(e.defines.USE_UV=""),e.uniforms.hasBlur=this._hasBlur,e.uniforms.tDiffuse=this._tDiffuse,e.uniforms.tDepth=this._tDepth,e.uniforms.distortionMap=this._distortionMap,e.uniforms.tDiffuseBlur=this._tDiffuseBlur,e.uniforms.textureMatrix=this._textureMatrix,e.uniforms.mirror=this._mirror,e.uniforms.mixBlur=this._mixBlur,e.uniforms.mixStrength=this._blurStrength,e.uniforms.minDepthThreshold=this._minDepthThreshold,e.uniforms.maxDepthThreshold=this._maxDepthThreshold,e.uniforms.depthScale=this._depthScale,e.uniforms.depthToBlurRatioBias=this._depthToBlurRatioBias,e.uniforms.distortion=this._distortion,e.uniforms.mixContrast=this._mixContrast,e.vertexShader=`
        uniform mat4 textureMatrix;
        varying vec4 my_vUv;
      ${e.vertexShader}`,e.vertexShader=e.vertexShader.replace("#include <project_vertex>",`#include <project_vertex>
        my_vUv = textureMatrix * vec4( position, 1.0 );
        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );`),e.fragmentShader=`
        uniform sampler2D tDiffuse;
        uniform sampler2D tDiffuseBlur;
        uniform sampler2D tDepth;
        uniform sampler2D distortionMap;
        uniform float distortion;
        uniform float cameraNear;
			  uniform float cameraFar;
        uniform bool hasBlur;
        uniform float mixBlur;
        uniform float mirror;
        uniform float mixStrength;
        uniform float minDepthThreshold;
        uniform float maxDepthThreshold;
        uniform float mixContrast;
        uniform float depthScale;
        uniform float depthToBlurRatioBias;
        varying vec4 my_vUv;
        ${e.fragmentShader}`,e.fragmentShader=e.fragmentShader.replace("#include <emissivemap_fragment>",`#include <emissivemap_fragment>

      float distortionFactor = 0.0;
      #ifdef USE_DISTORTION
        distortionFactor = texture2D(distortionMap, vUv).r * distortion;
      #endif

      vec4 new_vUv = my_vUv;
      new_vUv.x += distortionFactor;
      new_vUv.y += distortionFactor;

      vec4 base = texture2DProj(tDiffuse, new_vUv);
      vec4 blur = texture2DProj(tDiffuseBlur, new_vUv);

      vec4 merge = base;

      #ifdef USE_NORMALMAP
        vec2 normal_uv = vec2(0.0);
        vec4 normalColor = texture2D(normalMap, vUv * normalScale);
        vec3 my_normal = normalize( vec3( normalColor.r * 2.0 - 1.0, normalColor.b,  normalColor.g * 2.0 - 1.0 ) );
        vec3 coord = new_vUv.xyz / new_vUv.w;
        normal_uv = coord.xy + coord.z * my_normal.xz * 0.05;
        vec4 base_normal = texture2D(tDiffuse, normal_uv);
        vec4 blur_normal = texture2D(tDiffuseBlur, normal_uv);
        merge = base_normal;
        blur = blur_normal;
      #endif

      float depthFactor = 0.0001;
      float blurFactor = 0.0;

      #ifdef USE_DEPTH
        vec4 depth = texture2DProj(tDepth, new_vUv);
        depthFactor = smoothstep(minDepthThreshold, maxDepthThreshold, 1.0-(depth.r * depth.a));
        depthFactor *= depthScale;
        depthFactor = max(0.0001, min(1.0, depthFactor));

        #ifdef USE_BLUR
          blur = blur * min(1.0, depthFactor + depthToBlurRatioBias);
          merge = merge * min(1.0, depthFactor + 0.5);
        #else
          merge = merge * depthFactor;
        #endif

      #endif

      float reflectorRoughnessFactor = roughness;
      #ifdef USE_ROUGHNESSMAP
        vec4 reflectorTexelRoughness = texture2D( roughnessMap, vUv );
        reflectorRoughnessFactor *= reflectorTexelRoughness.g;
      #endif

      #ifdef USE_BLUR
        blurFactor = min(1.0, mixBlur * reflectorRoughnessFactor);
        merge = mix(merge, blur, blurFactor);
      #endif

      vec4 newMerge = vec4(0.0, 0.0, 0.0, 1.0);
      newMerge.r = (merge.r - 0.5) * mixContrast + 0.5;
      newMerge.g = (merge.g - 0.5) * mixContrast + 0.5;
      newMerge.b = (merge.b - 0.5) * mixContrast + 0.5;

      diffuseColor.rgb = diffuseColor.rgb * ((1.0 - min(1.0, mirror)) + newMerge.rgb * mixStrength);
      `)}get tDiffuse(){return this._tDiffuse.value}set tDiffuse(e){this._tDiffuse.value=e}get tDepth(){return this._tDepth.value}set tDepth(e){this._tDepth.value=e}get distortionMap(){return this._distortionMap.value}set distortionMap(e){this._distortionMap.value=e}get tDiffuseBlur(){return this._tDiffuseBlur.value}set tDiffuseBlur(e){this._tDiffuseBlur.value=e}get textureMatrix(){return this._textureMatrix.value}set textureMatrix(e){this._textureMatrix.value=e}get hasBlur(){return this._hasBlur.value}set hasBlur(e){this._hasBlur.value=e}get mirror(){return this._mirror.value}set mirror(e){this._mirror.value=e}get mixBlur(){return this._mixBlur.value}set mixBlur(e){this._mixBlur.value=e}get mixStrength(){return this._blurStrength.value}set mixStrength(e){this._blurStrength.value=e}get minDepthThreshold(){return this._minDepthThreshold.value}set minDepthThreshold(e){this._minDepthThreshold.value=e}get maxDepthThreshold(){return this._maxDepthThreshold.value}set maxDepthThreshold(e){this._maxDepthThreshold.value=e}get depthScale(){return this._depthScale.value}set depthScale(e){this._depthScale.value=e}get depthToBlurRatioBias(){return this._depthToBlurRatioBias.value}set depthToBlurRatioBias(e){this._depthToBlurRatioBias.value=e}get distortion(){return this._distortion.value}set distortion(e){this._distortion.value=e}get mixContrast(){return this._mixContrast.value}set mixContrast(e){this._mixContrast.value=e}}let mj=ez.forwardRef(({mixBlur:e=0,mixStrength:t=1,resolution:r=256,blur:n=[0,0],minDepthThreshold:i=.9,maxDepthThreshold:a=1,depthScale:o=0,depthToBlurRatioBias:s=.25,mirror:l=0,distortion:c=1,mixContrast:u=1,distortionMap:h,reflectorOffset:d=0,...f},p)=>{(0,eL.e)({MeshReflectorMaterialImpl:mV});let m=(0,eL.A)(({gl:e})=>e),A=(0,eL.A)(({camera:e})=>e),g=(0,eL.A)(({scene:e})=>e),v=(n=Array.isArray(n)?n:[n,n])[0]+n[1]>0,y=ez.useRef(null);ez.useImperativeHandle(p,()=>y.current,[]);let[x]=ez.useState(()=>new eQ.Plane),[E]=ez.useState(()=>new eQ.Vector3),[_]=ez.useState(()=>new eQ.Vector3),[C]=ez.useState(()=>new eQ.Vector3),[b]=ez.useState(()=>new eQ.Matrix4),[w]=ez.useState(()=>new eQ.Vector3(0,0,-1)),[B]=ez.useState(()=>new eQ.Vector4),[I]=ez.useState(()=>new eQ.Vector3),[M]=ez.useState(()=>new eQ.Vector3),[S]=ez.useState(()=>new eQ.Vector4),[T]=ez.useState(()=>new eQ.Matrix4),[P]=ez.useState(()=>new eQ.PerspectiveCamera),D=ez.useCallback(()=>{var e;let t=y.current.parent||(null==(e=y.current)?void 0:e.__r3f.parent);if(!t||(_.setFromMatrixPosition(t.matrixWorld),C.setFromMatrixPosition(A.matrixWorld),b.extractRotation(t.matrixWorld),E.set(0,0,1),E.applyMatrix4(b),_.addScaledVector(E,d),I.subVectors(_,C),I.dot(E)>0))return;I.reflect(E).negate(),I.add(_),b.extractRotation(A.matrixWorld),w.set(0,0,-1),w.applyMatrix4(b),w.add(C),M.subVectors(_,w),M.reflect(E).negate(),M.add(_),P.position.copy(I),P.up.set(0,1,0),P.up.applyMatrix4(b),P.up.reflect(E),P.lookAt(M),P.far=A.far,P.updateMatrixWorld(),P.projectionMatrix.copy(A.projectionMatrix),T.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),T.multiply(P.projectionMatrix),T.multiply(P.matrixWorldInverse),T.multiply(t.matrixWorld),x.setFromNormalAndCoplanarPoint(E,_),x.applyMatrix4(P.matrixWorldInverse),B.set(x.normal.x,x.normal.y,x.normal.z,x.constant);let r=P.projectionMatrix;S.x=(Math.sign(B.x)+r.elements[8])/r.elements[0],S.y=(Math.sign(B.y)+r.elements[9])/r.elements[5],S.z=-1,S.w=(1+r.elements[10])/r.elements[14],B.multiplyScalar(2/B.dot(S)),r.elements[2]=B.x,r.elements[6]=B.y,r.elements[10]=B.z+1,r.elements[14]=B.w},[A,d]),[R,F,z,O]=ez.useMemo(()=>{let d={minFilter:eQ.LinearFilter,magFilter:eQ.LinearFilter,type:eQ.HalfFloatType},f=new eQ.WebGLRenderTarget(r,r,d);f.depthBuffer=!0,f.depthTexture=new eQ.DepthTexture(r,r),f.depthTexture.format=eQ.DepthFormat,f.depthTexture.type=eQ.UnsignedShortType;let p=new eQ.WebGLRenderTarget(r,r,d),A=new mH({gl:m,resolution:r,width:n[0],height:n[1],minDepthThreshold:i,maxDepthThreshold:a,depthScale:o,depthToBlurRatioBias:s}),g={mirror:l,textureMatrix:T,mixBlur:e,tDiffuse:f.texture,tDepth:f.depthTexture,tDiffuseBlur:p.texture,hasBlur:v,mixStrength:t,minDepthThreshold:i,maxDepthThreshold:a,depthScale:o,depthToBlurRatioBias:s,distortion:c,distortionMap:h,mixContrast:u,"defines-USE_BLUR":v?"":void 0,"defines-USE_DEPTH":o>0?"":void 0,"defines-USE_DISTORTION":h?"":void 0};return[f,p,A,g]},[m,n,T,r,l,v,e,t,i,a,o,s,c,h,u]);return(0,eL.C)(()=>{var e;let t=y.current.parent||(null==(e=y.current)?void 0:e.__r3f.parent);if(!t)return;t.visible=!1;let r=m.xr.enabled,n=m.shadowMap.autoUpdate;D(),m.xr.enabled=!1,m.shadowMap.autoUpdate=!1,m.setRenderTarget(R),m.state.buffers.depth.setMask(!0),m.autoClear||m.clear(),m.render(g,P),v&&z.render(m,R,F),m.xr.enabled=r,m.shadowMap.autoUpdate=n,t.visible=!0,m.setRenderTarget(null)}),ez.createElement("meshReflectorMaterialImpl",ee({attach:"material",key:"key"+O["defines-USE_BLUR"]+O["defines-USE_DEPTH"]+O["defines-USE_DISTORTION"],ref:y},O,f))});function mY(e){switch(e){case 1:return eQ.RedIntegerFormat;case 2:return eQ.RGIntegerFormat;case 3:case 4:return eQ.RGBAIntegerFormat}}class mJ extends eQ.DataTexture{constructor(){super(),this.minFilter=eQ.NearestFilter,this.magFilter=eQ.NearestFilter,this.generateMipmaps=!1,this.overrideItemSize=null,this._forcedType=null}updateFrom(e){let t,r,n,i;let a=this.overrideItemSize,o=e.itemSize,s=e.count;if(null!==a){if(o*s%a!=0)throw Error("VertexAttributeTexture: overrideItemSize must divide evenly into buffer length.");e.itemSize=a,e.count=s*o/a}let l=e.itemSize,c=e.count,u=e.normalized,h=e.array.constructor,d=h.BYTES_PER_ELEMENT,f=this._forcedType,p=l;if(null===f)switch(h){case Float32Array:f=eQ.FloatType;break;case Uint8Array:case Uint16Array:case Uint32Array:f=eQ.UnsignedIntType;break;case Int8Array:case Int16Array:case Int32Array:f=eQ.IntType}let m=function(e){switch(e){case 1:return"R";case 2:return"RG";case 3:case 4:return"RGBA"}throw Error()}(l);switch(f){case eQ.FloatType:n=1,r=function(e){switch(e){case 1:return eQ.RedFormat;case 2:return eQ.RGFormat;case 3:case 4:return eQ.RGBAFormat}}(l),u&&1===d?(i=h,m+="8",h===Uint8Array?t=eQ.UnsignedByteType:(t=eQ.ByteType,m+="_SNORM")):(i=Float32Array,m+="32F",t=eQ.FloatType);break;case eQ.IntType:m+=8*d+"I",n=u?Math.pow(2,8*h.BYTES_PER_ELEMENT-1):1,r=mY(l),1===d?(i=Int8Array,t=eQ.ByteType):2===d?(i=Int16Array,t=eQ.ShortType):(i=Int32Array,t=eQ.IntType);break;case eQ.UnsignedIntType:m+=8*d+"UI",n=u?Math.pow(2,8*h.BYTES_PER_ELEMENT-1):1,r=mY(l),1===d?(i=Uint8Array,t=eQ.UnsignedByteType):2===d?(i=Uint16Array,t=eQ.UnsignedShortType):(i=Uint32Array,t=eQ.UnsignedIntType)}3===p&&(r===eQ.RGBAFormat||r===eQ.RGBAIntegerFormat)&&(p=4);let A=Math.ceil(Math.sqrt(c))||1,g=new i(p*A*A),v=e.normalized;e.normalized=!1;for(let t=0;t<c;t++){let r=p*t;g[r]=e.getX(t)/n,l>=2&&(g[r+1]=e.getY(t)/n),l>=3&&(g[r+2]=e.getZ(t)/n,4===p&&(g[r+3]=1)),l>=4&&(g[r+3]=e.getW(t)/n)}e.normalized=v,this.internalFormat=m,this.format=r,this.type=t,this.image.width=A,this.image.height=A,this.image.data=g,this.needsUpdate=!0,this.dispose(),e.itemSize=o,e.count=s}}class mW extends mJ{constructor(){super(),this._forcedType=eQ.UnsignedIntType}}class mq extends mJ{constructor(){super(),this._forcedType=eQ.FloatType}}class mK{constructor(){this.index=new mW,this.position=new mq,this.bvhBounds=new eQ.DataTexture,this.bvhContents=new eQ.DataTexture,this._cachedIndexAttr=null,this.index.overrideItemSize=3}updateFrom(e){let{geometry:t}=e;if(function(e,t,r){let n=e._roots;if(1!==n.length)throw Error("MeshBVHUniformStruct: Multi-root BVHs not supported.");let i=n[0],a=new Uint16Array(i),o=new Uint32Array(i),s=new Float32Array(i),l=i.byteLength/32,c=2*Math.ceil(Math.sqrt(l/2)),u=new Float32Array(4*c*c),h=Math.ceil(Math.sqrt(l)),d=new Uint32Array(2*h*h);for(let e=0;e<l;e++){let t=32*e/4,r=2*t;for(let r=0;r<3;r++)u[8*e+0+r]=s[t+0+r],u[8*e+4+r]=s[t+3+r];if(fM(r,a)){let n=fS(r,a),i=o[t+6],s=4294901760|n;d[2*e+0]=s,d[2*e+1]=i}else{let r=4*o[t+6]/32,n=o[t+7];d[2*e+0]=n,d[2*e+1]=r}}t.image.data=u,t.image.width=c,t.image.height=c,t.format=eQ.RGBAFormat,t.type=eQ.FloatType,t.internalFormat="RGBA32F",t.minFilter=eQ.NearestFilter,t.magFilter=eQ.NearestFilter,t.generateMipmaps=!1,t.needsUpdate=!0,t.dispose(),r.image.data=d,r.image.width=h,r.image.height=h,r.format=eQ.RGIntegerFormat,r.type=eQ.UnsignedIntType,r.internalFormat="RG32UI",r.minFilter=eQ.NearestFilter,r.magFilter=eQ.NearestFilter,r.generateMipmaps=!1,r.needsUpdate=!0,r.dispose()}(e,this.bvhBounds,this.bvhContents),this.position.updateFrom(t.attributes.position),e.indirect){let r=e._indirectBuffer;if(null===this._cachedIndexAttr||this._cachedIndexAttr.count!==r.length){if(t.index)this._cachedIndexAttr=t.index.clone();else{let e=ff(fh(t));this._cachedIndexAttr=new eQ.BufferAttribute(e,1,!1)}}(function(e,t,r){let n=r.array,i=e.index?e.index.array:null;for(let e=0,r=t.length;e<r;e++){let r=3*e,a=3*t[e];for(let e=0;e<3;e++)n[r+e]=i?i[a+e]:a+e}})(t,r,this._cachedIndexAttr),this.index.updateFrom(this._cachedIndexAttr)}else this.index.updateFrom(t.index)}dispose(){let{index:e,position:t,bvhBounds:r,bvhContents:n}=this;e&&e.dispose(),t&&t.dispose(),r&&r.dispose(),n&&n.dispose()}}let mX=`
struct BVH {

	usampler2D index;
	sampler2D position;

	sampler2D bvhBounds;
	usampler2D bvhContents;

};
`,mZ=`

// A stack of uint32 indices can can store the indices for
// a perfectly balanced tree with a depth up to 31. Lower stack
// depth gets higher performance.
//
// However not all trees are balanced. Best value to set this to
// is the trees max depth.
#ifndef BVH_STACK_DEPTH
#define BVH_STACK_DEPTH 60
#endif

#ifndef INFINITY
#define INFINITY 1e20
#endif

// Utilities
uvec4 uTexelFetch1D( usampler2D tex, uint index ) {

	uint width = uint( textureSize( tex, 0 ).x );
	uvec2 uv;
	uv.x = index % width;
	uv.y = index / width;

	return texelFetch( tex, ivec2( uv ), 0 );

}

ivec4 iTexelFetch1D( isampler2D tex, uint index ) {

	uint width = uint( textureSize( tex, 0 ).x );
	uvec2 uv;
	uv.x = index % width;
	uv.y = index / width;

	return texelFetch( tex, ivec2( uv ), 0 );

}

vec4 texelFetch1D( sampler2D tex, uint index ) {

	uint width = uint( textureSize( tex, 0 ).x );
	uvec2 uv;
	uv.x = index % width;
	uv.y = index / width;

	return texelFetch( tex, ivec2( uv ), 0 );

}

vec4 textureSampleBarycoord( sampler2D tex, vec3 barycoord, uvec3 faceIndices ) {

	return
		barycoord.x * texelFetch1D( tex, faceIndices.x ) +
		barycoord.y * texelFetch1D( tex, faceIndices.y ) +
		barycoord.z * texelFetch1D( tex, faceIndices.z );

}

void ndcToCameraRay(
	vec2 coord, mat4 cameraWorld, mat4 invProjectionMatrix,
	out vec3 rayOrigin, out vec3 rayDirection
) {

	// get camera look direction and near plane for camera clipping
	vec4 lookDirection = cameraWorld * vec4( 0.0, 0.0, - 1.0, 0.0 );
	vec4 nearVector = invProjectionMatrix * vec4( 0.0, 0.0, - 1.0, 1.0 );
	float near = abs( nearVector.z / nearVector.w );

	// get the camera direction and position from camera matrices
	vec4 origin = cameraWorld * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec4 direction = invProjectionMatrix * vec4( coord, 0.5, 1.0 );
	direction /= direction.w;
	direction = cameraWorld * direction - origin;

	// slide the origin along the ray until it sits at the near clip plane position
	origin.xyz += direction.xyz * near / dot( direction, lookDirection );

	rayOrigin = origin.xyz;
	rayDirection = direction.xyz;

}
`,m$=`

#ifndef TRI_INTERSECT_EPSILON
#define TRI_INTERSECT_EPSILON 1e-5
#endif

// Raycasting
bool intersectsBounds( vec3 rayOrigin, vec3 rayDirection, vec3 boundsMin, vec3 boundsMax, out float dist ) {

	// https://www.reddit.com/r/opengl/comments/8ntzz5/fast_glsl_ray_box_intersection/
	// https://tavianator.com/2011/ray_box.html
	vec3 invDir = 1.0 / rayDirection;

	// find intersection distances for each plane
	vec3 tMinPlane = invDir * ( boundsMin - rayOrigin );
	vec3 tMaxPlane = invDir * ( boundsMax - rayOrigin );

	// get the min and max distances from each intersection
	vec3 tMinHit = min( tMaxPlane, tMinPlane );
	vec3 tMaxHit = max( tMaxPlane, tMinPlane );

	// get the furthest hit distance
	vec2 t = max( tMinHit.xx, tMinHit.yz );
	float t0 = max( t.x, t.y );

	// get the minimum hit distance
	t = min( tMaxHit.xx, tMaxHit.yz );
	float t1 = min( t.x, t.y );

	// set distance to 0.0 if the ray starts inside the box
	dist = max( t0, 0.0 );

	return t1 >= dist;

}

bool intersectsTriangle(
	vec3 rayOrigin, vec3 rayDirection, vec3 a, vec3 b, vec3 c,
	out vec3 barycoord, out vec3 norm, out float dist, out float side
) {

	// https://stackoverflow.com/questions/42740765/intersection-between-line-and-triangle-in-3d
	vec3 edge1 = b - a;
	vec3 edge2 = c - a;
	norm = cross( edge1, edge2 );

	float det = - dot( rayDirection, norm );
	float invdet = 1.0 / det;

	vec3 AO = rayOrigin - a;
	vec3 DAO = cross( AO, rayDirection );

	vec4 uvt;
	uvt.x = dot( edge2, DAO ) * invdet;
	uvt.y = - dot( edge1, DAO ) * invdet;
	uvt.z = dot( AO, norm ) * invdet;
	uvt.w = 1.0 - uvt.x - uvt.y;

	// set the hit information
	barycoord = uvt.wxy; // arranged in A, B, C order
	dist = uvt.z;
	side = sign( det );
	norm = side * normalize( norm );

	// add an epsilon to avoid misses between triangles
	uvt += vec4( TRI_INTERSECT_EPSILON );

	return all( greaterThanEqual( uvt, vec4( 0.0 ) ) );

}

bool intersectTriangles(
	// geometry info and triangle range
	sampler2D positionAttr, usampler2D indexAttr, uint offset, uint count,

	// ray
	vec3 rayOrigin, vec3 rayDirection,

	// outputs
	inout float minDistance, inout uvec4 faceIndices, inout vec3 faceNormal, inout vec3 barycoord,
	inout float side, inout float dist
) {

	bool found = false;
	vec3 localBarycoord, localNormal;
	float localDist, localSide;
	for ( uint i = offset, l = offset + count; i < l; i ++ ) {

		uvec3 indices = uTexelFetch1D( indexAttr, i ).xyz;
		vec3 a = texelFetch1D( positionAttr, indices.x ).rgb;
		vec3 b = texelFetch1D( positionAttr, indices.y ).rgb;
		vec3 c = texelFetch1D( positionAttr, indices.z ).rgb;

		if (
			intersectsTriangle( rayOrigin, rayDirection, a, b, c, localBarycoord, localNormal, localDist, localSide )
			&& localDist < minDistance
		) {

			found = true;
			minDistance = localDist;

			faceIndices = uvec4( indices.xyz, i );
			faceNormal = localNormal;

			side = localSide;
			barycoord = localBarycoord;
			dist = localDist;

		}

	}

	return found;

}

bool intersectsBVHNodeBounds( vec3 rayOrigin, vec3 rayDirection, sampler2D bvhBounds, uint currNodeIndex, out float dist ) {

	uint cni2 = currNodeIndex * 2u;
	vec3 boundsMin = texelFetch1D( bvhBounds, cni2 ).xyz;
	vec3 boundsMax = texelFetch1D( bvhBounds, cni2 + 1u ).xyz;
	return intersectsBounds( rayOrigin, rayDirection, boundsMin, boundsMax, dist );

}

// use a macro to hide the fact that we need to expand the struct into separate fields
#define\
	bvhIntersectFirstHit(\
		bvh,\
		rayOrigin, rayDirection, faceIndices, faceNormal, barycoord, side, dist\
	)\
	_bvhIntersectFirstHit(\
		bvh.position, bvh.index, bvh.bvhBounds, bvh.bvhContents,\
		rayOrigin, rayDirection, faceIndices, faceNormal, barycoord, side, dist\
	)

bool _bvhIntersectFirstHit(
	// bvh info
	sampler2D bvh_position, usampler2D bvh_index, sampler2D bvh_bvhBounds, usampler2D bvh_bvhContents,

	// ray
	vec3 rayOrigin, vec3 rayDirection,

	// output variables split into separate variables due to output precision
	inout uvec4 faceIndices, inout vec3 faceNormal, inout vec3 barycoord,
	inout float side, inout float dist
) {

	// stack needs to be twice as long as the deepest tree we expect because
	// we push both the left and right child onto the stack every traversal
	int ptr = 0;
	uint stack[ BVH_STACK_DEPTH ];
	stack[ 0 ] = 0u;

	float triangleDistance = INFINITY;
	bool found = false;
	while ( ptr > - 1 && ptr < BVH_STACK_DEPTH ) {

		uint currNodeIndex = stack[ ptr ];
		ptr --;

		// check if we intersect the current bounds
		float boundsHitDistance;
		if (
			! intersectsBVHNodeBounds( rayOrigin, rayDirection, bvh_bvhBounds, currNodeIndex, boundsHitDistance )
			|| boundsHitDistance > triangleDistance
		) {

			continue;

		}

		uvec2 boundsInfo = uTexelFetch1D( bvh_bvhContents, currNodeIndex ).xy;
		bool isLeaf = bool( boundsInfo.x & 0xffff0000u );

		if ( isLeaf ) {

			uint count = boundsInfo.x & 0x0000ffffu;
			uint offset = boundsInfo.y;

			found = intersectTriangles(
				bvh_position, bvh_index, offset, count,
				rayOrigin, rayDirection, triangleDistance,
				faceIndices, faceNormal, barycoord, side, dist
			) || found;

		} else {

			uint leftIndex = currNodeIndex + 1u;
			uint splitAxis = boundsInfo.x & 0x0000ffffu;
			uint rightIndex = boundsInfo.y;

			bool leftToRight = rayDirection[ splitAxis ] >= 0.0;
			uint c1 = leftToRight ? leftIndex : rightIndex;
			uint c2 = leftToRight ? rightIndex : leftIndex;

			// set c2 in the stack so we traverse it later. We need to keep track of a pointer in
			// the stack while we traverse. The second pointer added is the one that will be
			// traversed first
			ptr ++;
			stack[ ptr ] = c2;

			ptr ++;
			stack[ ptr ] = c1;

		}

	}

	return found;

}
`,m0=`
	${mZ}
	${m$}
`,m1=sv({envMap:null,bounces:3,ior:2.4,correctMips:!0,aberrationStrength:.01,fresnel:0,bvh:new mK,color:new eQ.Color("white"),opacity:1,resolution:new eQ.Vector2,viewMatrixInverse:new eQ.Matrix4,projectionMatrixInverse:new eQ.Matrix4},`
  uniform mat4 viewMatrixInverse;

  varying vec3 vWorldPosition;
  varying vec3 vNormal;
  varying mat4 vModelMatrixInverse;

  #include <color_pars_vertex>

  void main() {
    #include <color_vertex>

    vec4 transformedNormal = vec4(normal, 0.0);
    vec4 transformedPosition = vec4(position, 1.0);
    #ifdef USE_INSTANCING
      transformedNormal = instanceMatrix * transformedNormal;
      transformedPosition = instanceMatrix * transformedPosition;
    #endif

    #ifdef USE_INSTANCING
      vModelMatrixInverse = inverse(modelMatrix * instanceMatrix);
    #else
      vModelMatrixInverse = inverse(modelMatrix);
    #endif

    vWorldPosition = (modelMatrix * transformedPosition).xyz;
    vNormal = normalize((viewMatrixInverse * vec4(normalMatrix * transformedNormal.xyz, 0.0)).xyz);
    gl_Position = projectionMatrix * viewMatrix * modelMatrix * transformedPosition;
  }`,`
  #define ENVMAP_TYPE_CUBE_UV
  precision highp isampler2D;
  precision highp usampler2D;
  varying vec3 vWorldPosition;
  varying vec3 vNormal;
  varying mat4 vModelMatrixInverse;

  #include <color_pars_fragment>

  #ifdef ENVMAP_TYPE_CUBEM
    uniform samplerCube envMap;
  #else
    uniform sampler2D envMap;
  #endif

  uniform float bounces;
  ${mX}
  ${m0}
  uniform BVH bvh;
  uniform float ior;
  uniform bool correctMips;
  uniform vec2 resolution;
  uniform float fresnel;
  uniform mat4 modelMatrix;
  uniform mat4 projectionMatrixInverse;
  uniform mat4 viewMatrixInverse;
  uniform float aberrationStrength;
  uniform vec3 color;
  uniform float opacity;

  float fresnelFunc(vec3 viewDirection, vec3 worldNormal) {
    return pow( 1.0 + dot( viewDirection, worldNormal), 10.0 );
  }

  vec3 totalInternalReflection(vec3 ro, vec3 rd, vec3 normal, float ior, mat4 modelMatrixInverse) {
    vec3 rayOrigin = ro;
    vec3 rayDirection = rd;
    rayDirection = refract(rayDirection, normal, 1.0 / ior);
    rayOrigin = vWorldPosition + rayDirection * 0.001;
    rayOrigin = (modelMatrixInverse * vec4(rayOrigin, 1.0)).xyz;
    rayDirection = normalize((modelMatrixInverse * vec4(rayDirection, 0.0)).xyz);
    for(float i = 0.0; i < bounces; i++) {
      uvec4 faceIndices = uvec4( 0u );
      vec3 faceNormal = vec3( 0.0, 0.0, 1.0 );
      vec3 barycoord = vec3( 0.0 );
      float side = 1.0;
      float dist = 0.0;
      bvhIntersectFirstHit( bvh, rayOrigin, rayDirection, faceIndices, faceNormal, barycoord, side, dist );
      vec3 hitPos = rayOrigin + rayDirection * max(dist - 0.001, 0.0);
      vec3 tempDir = refract(rayDirection, faceNormal, ior);
      if (length(tempDir) != 0.0) {
        rayDirection = tempDir;
        break;
      }
      rayDirection = reflect(rayDirection, faceNormal);
      rayOrigin = hitPos + rayDirection * 0.01;
    }
    rayDirection = normalize((modelMatrix * vec4(rayDirection, 0.0)).xyz);
    return rayDirection;
  }

  #include <common>
  #include <cube_uv_reflection_fragment>

  #ifdef ENVMAP_TYPE_CUBEM
    vec4 textureGradient(samplerCube envMap, vec3 rayDirection, vec3 directionCamPerfect) {
      return textureGrad(envMap, rayDirection, dFdx(correctMips ? directionCamPerfect: rayDirection), dFdy(correctMips ? directionCamPerfect: rayDirection));
    }
  #else
    vec4 textureGradient(sampler2D envMap, vec3 rayDirection, vec3 directionCamPerfect) {
      vec2 uvv = equirectUv( rayDirection );
      vec2 smoothUv = equirectUv( directionCamPerfect );
      return textureGrad(envMap, uvv, dFdx(correctMips ? smoothUv : uvv), dFdy(correctMips ? smoothUv : uvv));
    }
  #endif

  void main() {
    vec2 uv = gl_FragCoord.xy / resolution;
    vec3 directionCamPerfect = (projectionMatrixInverse * vec4(uv * 2.0 - 1.0, 0.0, 1.0)).xyz;
    directionCamPerfect = (viewMatrixInverse * vec4(directionCamPerfect, 0.0)).xyz;
    directionCamPerfect = normalize(directionCamPerfect);
    vec3 normal = vNormal;
    vec3 rayOrigin = cameraPosition;
    vec3 rayDirection = normalize(vWorldPosition - cameraPosition);

    vec4 diffuseColor = vec4(color, opacity);
    #include <color_fragment>

    #ifdef CHROMATIC_ABERRATIONS
      vec3 rayDirectionG = totalInternalReflection(rayOrigin, rayDirection, normal, max(ior, 1.0), vModelMatrixInverse);
      #ifdef FAST_CHROMA
        vec3 rayDirectionR = normalize(rayDirectionG + 1.0 * vec3(aberrationStrength / 2.0));
        vec3 rayDirectionB = normalize(rayDirectionG - 1.0 * vec3(aberrationStrength / 2.0));
      #else
        vec3 rayDirectionR = totalInternalReflection(rayOrigin, rayDirection, normal, max(ior * (1.0 - aberrationStrength), 1.0), vModelMatrixInverse);
        vec3 rayDirectionB = totalInternalReflection(rayOrigin, rayDirection, normal, max(ior * (1.0 + aberrationStrength), 1.0), vModelMatrixInverse);
      #endif
      float finalColorR = textureGradient(envMap, rayDirectionR, directionCamPerfect).r;
      float finalColorG = textureGradient(envMap, rayDirectionG, directionCamPerfect).g;
      float finalColorB = textureGradient(envMap, rayDirectionB, directionCamPerfect).b;
      diffuseColor.rgb *= vec3(finalColorR, finalColorG, finalColorB);
    #else
      rayDirection = totalInternalReflection(rayOrigin, rayDirection, normal, max(ior, 1.0), vModelMatrixInverse);
      diffuseColor.rgb *= textureGradient(envMap, rayDirection, directionCamPerfect).rgb;
    #endif

    vec3 viewDirection = normalize(vWorldPosition - cameraPosition);
    float nFresnel = fresnelFunc(viewDirection, normal) * fresnel;
    gl_FragColor = vec4(mix(diffuseColor.rgb, vec3(1.0), nFresnel), diffuseColor.a);

    #include <tonemapping_fragment>
    #include <${s_>=154?"colorspace_fragment":"encodings_fragment"}>
  }`),m2=e=>e&&e.isCubeTexture;function m3({aberrationStrength:e=0,fastChroma:t=!0,envMap:r,...n}){(0,eL.e)({MeshRefractionMaterial:m1});let i=(0,ez.useRef)(),{size:a}=(0,eL.A)(),o=(0,ez.useMemo)(()=>{var n,i;let a={},o=m2(r),s=Math.floor(Math.log2((null!==(n=o?null==(i=r.image[0])?void 0:i.width:r.image.width)&&void 0!==n?n:1024)/4)),l=Math.pow(2,s),c=3*Math.max(l,112);return o&&(a.ENVMAP_TYPE_CUBEM=""),a.CUBEUV_TEXEL_WIDTH=`${1/c}`,a.CUBEUV_TEXEL_HEIGHT=`${1/(4*l)}`,a.CUBEUV_MAX_MIP=`${s}.0`,e>0&&(a.CHROMATIC_ABERRATIONS=""),t&&(a.FAST_CHROMA=""),a},[e,t]);return(0,ez.useLayoutEffect)(()=>{var e;let t=null==(e=i.current)||null==(e=e.__r3f)||null==(e=e.parent)?void 0:e.geometry;t&&(i.current.bvh=new mK,i.current.bvh.updateFrom(new pG(t.clone().toNonIndexed(),{strategy:fl})))},[]),(0,eL.C)(({camera:e})=>{i.current.viewMatrixInverse=e.matrixWorld,i.current.projectionMatrixInverse=e.projectionMatrixInverse}),ez.createElement("meshRefractionMaterial",ee({key:JSON.stringify(o),defines:o,ref:i,resolution:[a.width,a.height],aberrationStrength:e,envMap:r},n))}let m4=sv({},"void main() { }","void main() { gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0); discard;  }");class m5 extends eQ.MeshPhysicalMaterial{constructor(e=6,t=!1){super(),this.uniforms={chromaticAberration:{value:.05},transmission:{value:0},_transmission:{value:1},transmissionMap:{value:null},roughness:{value:0},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:1/0},attenuationColor:{value:new eQ.Color("white")},anisotropicBlur:{value:.1},time:{value:0},distortion:{value:0},distortionScale:{value:.5},temporalDistortion:{value:0},buffer:{value:null}},this.onBeforeCompile=r=>{r.uniforms={...r.uniforms,...this.uniforms},this.anisotropy>0&&(r.defines.USE_ANISOTROPY=""),t?r.defines.USE_SAMPLER="":r.defines.USE_TRANSMISSION="",r.fragmentShader=`
      uniform float chromaticAberration;         
      uniform float anisotropicBlur;      
      uniform float time;
      uniform float distortion;
      uniform float distortionScale;
      uniform float temporalDistortion;
      uniform sampler2D buffer;

      vec3 random3(vec3 c) {
        float j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));
        vec3 r;
        r.z = fract(512.0*j);
        j *= .125;
        r.x = fract(512.0*j);
        j *= .125;
        r.y = fract(512.0*j);
        return r-0.5;
      }

      uint hash( uint x ) {
        x += ( x << 10u );
        x ^= ( x >>  6u );
        x += ( x <<  3u );
        x ^= ( x >> 11u );
        x += ( x << 15u );
        return x;
      }

      // Compound versions of the hashing algorithm I whipped together.
      uint hash( uvec2 v ) { return hash( v.x ^ hash(v.y)                         ); }
      uint hash( uvec3 v ) { return hash( v.x ^ hash(v.y) ^ hash(v.z)             ); }
      uint hash( uvec4 v ) { return hash( v.x ^ hash(v.y) ^ hash(v.z) ^ hash(v.w) ); }

      // Construct a float with half-open range [0:1] using low 23 bits.
      // All zeroes yields 0.0, all ones yields the next smallest representable value below 1.0.
      float floatConstruct( uint m ) {
        const uint ieeeMantissa = 0x007FFFFFu; // binary32 mantissa bitmask
        const uint ieeeOne      = 0x3F800000u; // 1.0 in IEEE binary32
        m &= ieeeMantissa;                     // Keep only mantissa bits (fractional part)
        m |= ieeeOne;                          // Add fractional part to 1.0
        float  f = uintBitsToFloat( m );       // Range [1:2]
        return f - 1.0;                        // Range [0:1]
      }

      // Pseudo-random value in half-open range [0:1].
      float randomBase( float x ) { return floatConstruct(hash(floatBitsToUint(x))); }
      float randomBase( vec2  v ) { return floatConstruct(hash(floatBitsToUint(v))); }
      float randomBase( vec3  v ) { return floatConstruct(hash(floatBitsToUint(v))); }
      float randomBase( vec4  v ) { return floatConstruct(hash(floatBitsToUint(v))); }
      float rand(float seed) {
        float result = randomBase(vec3(gl_FragCoord.xy, seed));
        return result;
      }

      const float F3 =  0.3333333;
      const float G3 =  0.1666667;

      float snoise(vec3 p) {
        vec3 s = floor(p + dot(p, vec3(F3)));
        vec3 x = p - s + dot(s, vec3(G3));
        vec3 e = step(vec3(0.0), x - x.yzx);
        vec3 i1 = e*(1.0 - e.zxy);
        vec3 i2 = 1.0 - e.zxy*(1.0 - e);
        vec3 x1 = x - i1 + G3;
        vec3 x2 = x - i2 + 2.0*G3;
        vec3 x3 = x - 1.0 + 3.0*G3;
        vec4 w, d;
        w.x = dot(x, x);
        w.y = dot(x1, x1);
        w.z = dot(x2, x2);
        w.w = dot(x3, x3);
        w = max(0.6 - w, 0.0);
        d.x = dot(random3(s), x);
        d.y = dot(random3(s + i1), x1);
        d.z = dot(random3(s + i2), x2);
        d.w = dot(random3(s + 1.0), x3);
        w *= w;
        w *= w;
        d *= w;
        return dot(d, vec4(52.0));
      }

      float snoiseFractal(vec3 m) {
        return 0.5333333* snoise(m)
              +0.2666667* snoise(2.0*m)
              +0.1333333* snoise(4.0*m)
              +0.0666667* snoise(8.0*m);
      }
`+r.fragmentShader,r.fragmentShader=r.fragmentShader.replace("#include <transmission_pars_fragment>",`
        #ifdef USE_TRANSMISSION
          // Transmission code is based on glTF-Sampler-Viewer
          // https://github.com/KhronosGroup/glTF-Sample-Viewer
          uniform float _transmission;
          uniform float thickness;
          uniform float attenuationDistance;
          uniform vec3 attenuationColor;
          #ifdef USE_TRANSMISSIONMAP
            uniform sampler2D transmissionMap;
          #endif
          #ifdef USE_THICKNESSMAP
            uniform sampler2D thicknessMap;
          #endif
          uniform vec2 transmissionSamplerSize;
          uniform sampler2D transmissionSamplerMap;
          uniform mat4 modelMatrix;
          uniform mat4 projectionMatrix;
          varying vec3 vWorldPosition;
          vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
            // Direction of refracted light.
            vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
            // Compute rotation-independant scaling of the model matrix.
            vec3 modelScale;
            modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
            modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
            modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
            // The thickness is specified in local space.
            return normalize( refractionVector ) * thickness * modelScale;
          }
          float applyIorToRoughness( const in float roughness, const in float ior ) {
            // Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and
            // an IOR of 1.5 results in the default amount of microfacet refraction.
            return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
          }
          vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
            float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );            
            #ifdef USE_SAMPLER
              #ifdef texture2DLodEXT
                return texture2DLodEXT(transmissionSamplerMap, fragCoord.xy, framebufferLod);
              #else
                return texture2D(transmissionSamplerMap, fragCoord.xy, framebufferLod);
              #endif
            #else
              return texture2D(buffer, fragCoord.xy);
            #endif
          }
          vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
            if ( isinf( attenuationDistance ) ) {
              // Attenuation distance is +∞, i.e. the transmitted color is not attenuated at all.
              return radiance;
            } else {
              // Compute light attenuation using Beer's law.
              vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
              vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance ); // Beer's law
              return transmittance * radiance;
            }
          }
          vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
            const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
            const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
            const in vec3 attenuationColor, const in float attenuationDistance ) {
            vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
            vec3 refractedRayExit = position + transmissionRay;
            // Project refracted vector on the framebuffer, while mapping to normalized device coordinates.
            vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
            vec2 refractionCoords = ndcPos.xy / ndcPos.w;
            refractionCoords += 1.0;
            refractionCoords /= 2.0;
            // Sample framebuffer to get pixel the refracted ray hits.
            vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
            vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
            // Get the specular component.
            vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
            return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
          }
        #endif
`),r.fragmentShader=r.fragmentShader.replace("#include <transmission_fragment>",`  
        // Improve the refraction to use the world pos
        material.transmission = _transmission;
        material.transmissionAlpha = 1.0;
        material.thickness = thickness;
        material.attenuationDistance = attenuationDistance;
        material.attenuationColor = attenuationColor;
        #ifdef USE_TRANSMISSIONMAP
          material.transmission *= texture2D( transmissionMap, vUv ).r;
        #endif
        #ifdef USE_THICKNESSMAP
          material.thickness *= texture2D( thicknessMap, vUv ).g;
        #endif
        
        vec3 pos = vWorldPosition;
        float runningSeed = 0.0;
        vec3 v = normalize( cameraPosition - pos );
        vec3 n = inverseTransformDirection( normal, viewMatrix );
        vec3 transmission = vec3(0.0);
        float transmissionR, transmissionB, transmissionG;
        float randomCoords = rand(runningSeed++);
        float thickness_smear = thickness * max(pow(roughnessFactor, 0.33), anisotropicBlur);
        vec3 distortionNormal = vec3(0.0);
        vec3 temporalOffset = vec3(time, -time, -time) * temporalDistortion;
        if (distortion > 0.0) {
          distortionNormal = distortion * vec3(snoiseFractal(vec3((pos * distortionScale + temporalOffset))), snoiseFractal(vec3(pos.zxy * distortionScale - temporalOffset)), snoiseFractal(vec3(pos.yxz * distortionScale + temporalOffset)));
        }
        for (float i = 0.0; i < ${e}.0; i ++) {
          vec3 sampleNorm = normalize(n + roughnessFactor * roughnessFactor * 2.0 * normalize(vec3(rand(runningSeed++) - 0.5, rand(runningSeed++) - 0.5, rand(runningSeed++) - 0.5)) * pow(rand(runningSeed++), 0.33) + distortionNormal);
          transmissionR = getIBLVolumeRefraction(
            sampleNorm, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
            pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness  + thickness_smear * (i + randomCoords) / float(${e}),
            material.attenuationColor, material.attenuationDistance
          ).r;
          transmissionG = getIBLVolumeRefraction(
            sampleNorm, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
            pos, modelMatrix, viewMatrix, projectionMatrix, material.ior  * (1.0 + chromaticAberration * (i + randomCoords) / float(${e})) , material.thickness + thickness_smear * (i + randomCoords) / float(${e}),
            material.attenuationColor, material.attenuationDistance
          ).g;
          transmissionB = getIBLVolumeRefraction(
            sampleNorm, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
            pos, modelMatrix, viewMatrix, projectionMatrix, material.ior * (1.0 + 2.0 * chromaticAberration * (i + randomCoords) / float(${e})), material.thickness + thickness_smear * (i + randomCoords) / float(${e}),
            material.attenuationColor, material.attenuationDistance
          ).b;
          transmission.r += transmissionR;
          transmission.g += transmissionG;
          transmission.b += transmissionB;
        }
        transmission /= ${e}.0;
        totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );
`)},Object.keys(this.uniforms).forEach(e=>Object.defineProperty(this,e,{get:()=>this.uniforms[e].value,set:t=>this.uniforms[e].value=t}))}}let m6=ez.forwardRef(({buffer:e,transmissionSampler:t=!1,backside:r=!1,side:n=eQ.FrontSide,transmission:i=1,thickness:a=0,backsideThickness:o=0,backsideEnvMapIntensity:s=1,samples:l=10,resolution:c,backsideResolution:u,background:h,anisotropy:d,anisotropicBlur:f,...p},m)=>{let A,g,v,y;(0,eL.e)({MeshTransmissionMaterial:m5});let x=ez.useRef(null),[E]=ez.useState(()=>new m4),_=ca(u||c),C=ca(c);return(0,eL.C)(e=>{x.current.time=e.clock.getElapsedTime(),x.current.buffer===C.texture&&!t&&(y=x.current.__r3f.parent)&&(v=e.gl.toneMapping,A=e.scene.background,g=x.current.envMapIntensity,e.gl.toneMapping=eQ.NoToneMapping,h&&(e.scene.background=h),y.material=E,r&&(e.gl.setRenderTarget(_),e.gl.render(e.scene,e.camera),y.material=x.current,y.material.buffer=_.texture,y.material.thickness=o,y.material.side=eQ.BackSide,y.material.envMapIntensity=s),e.gl.setRenderTarget(C),e.gl.render(e.scene,e.camera),y.material=x.current,y.material.thickness=a,y.material.side=n,y.material.buffer=C.texture,y.material.envMapIntensity=g,e.scene.background=A,e.gl.setRenderTarget(null),e.gl.toneMapping=v)}),ez.useImperativeHandle(m,()=>x.current,[]),ez.createElement("meshTransmissionMaterial",ee({args:[l,t],ref:x},p,{buffer:e||C.texture,_transmission:i,anisotropicBlur:null!=f?f:d,transmission:t?i:0,thickness:a,side:n}))}),m8=ez.forwardRef((e,t)=>((0,eL.e)({DiscardMaterialImpl:m4}),ez.createElement("discardMaterialImpl",ee({ref:t},e)))),m9=s_>=154?"opaque_fragment":"output_fragment";class m7 extends eQ.PointsMaterial{constructor(e){super(e),this.onBeforeCompile=(e,t)=>{let{isWebGL2:r}=t.capabilities;e.fragmentShader=e.fragmentShader.replace(`#include <${m9}>`,`
        ${r?`#include <${m9}>`:`#extension GL_OES_standard_derivatives : enable
#include <${m9}>`}
      vec2 cxy = 2.0 * gl_PointCoord - 1.0;
      float r = dot(cxy, cxy);
      float delta = fwidth(r);     
      float mask = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);
      gl_FragColor = vec4(gl_FragColor.rgb, mask * gl_FragColor.a );
      #include <tonemapping_fragment>
      #include <${s_>=154?"colorspace_fragment":"encodings_fragment"}>
      `)}}}let Ae=ez.forwardRef((e,t)=>{let[r]=ez.useState(()=>new m7(null));return ez.createElement("primitive",ee({},e,{object:r,ref:t,attach:"material"}))}),At=({focus:e=0,size:t=25,samples:r=10}={})=>`
#define PENUMBRA_FILTER_SIZE float(${t})
#define RGB_NOISE_FUNCTION(uv) (randRGB(uv))
vec3 randRGB(vec2 uv) {
  return vec3(
    fract(sin(dot(uv, vec2(12.75613, 38.12123))) * 13234.76575),
    fract(sin(dot(uv, vec2(19.45531, 58.46547))) * 43678.23431),
    fract(sin(dot(uv, vec2(23.67817, 78.23121))) * 93567.23423)
  );
}

vec3 lowPassRandRGB(vec2 uv) {
  // 3x3 convolution (average)
  // can be implemented as separable with an extra buffer for a total of 6 samples instead of 9
  vec3 result = vec3(0);
  result += RGB_NOISE_FUNCTION(uv + vec2(-1.0, -1.0));
  result += RGB_NOISE_FUNCTION(uv + vec2(-1.0,  0.0));
  result += RGB_NOISE_FUNCTION(uv + vec2(-1.0, +1.0));
  result += RGB_NOISE_FUNCTION(uv + vec2( 0.0, -1.0));
  result += RGB_NOISE_FUNCTION(uv + vec2( 0.0,  0.0));
  result += RGB_NOISE_FUNCTION(uv + vec2( 0.0, +1.0));
  result += RGB_NOISE_FUNCTION(uv + vec2(+1.0, -1.0));
  result += RGB_NOISE_FUNCTION(uv + vec2(+1.0,  0.0));
  result += RGB_NOISE_FUNCTION(uv + vec2(+1.0, +1.0));
  result *= 0.111111111; // 1.0 / 9.0
  return result;
}
vec3 highPassRandRGB(vec2 uv) {
  // by subtracting the low-pass signal from the original signal, we're being left with the high-pass signal
  // hp(x) = x - lp(x)
  return RGB_NOISE_FUNCTION(uv) - lowPassRandRGB(uv) + 0.5;
}


vec2 vogelDiskSample(int sampleIndex, int sampleCount, float angle) {
  const float goldenAngle = 2.399963f; // radians
  float r = sqrt(float(sampleIndex) + 0.5f) / sqrt(float(sampleCount));
  float theta = float(sampleIndex) * goldenAngle + angle;
  float sine = sin(theta);
  float cosine = cos(theta);
  return vec2(cosine, sine) * r;
}
float penumbraSize( const in float zReceiver, const in float zBlocker ) { // Parallel plane estimation
  return (zReceiver - zBlocker) / zBlocker;
}
float findBlocker(sampler2D shadowMap, vec2 uv, float compare, float angle) {
  float texelSize = 1.0 / float(textureSize(shadowMap, 0).x);
  float blockerDepthSum = float(${e});
  float blockers = 0.0;

  int j = 0;
  vec2 offset = vec2(0.);
  float depth = 0.;

  #pragma unroll_loop_start
  for(int i = 0; i < ${r}; i ++) {
    offset = (vogelDiskSample(j, ${r}, angle) * texelSize) * 2.0 * PENUMBRA_FILTER_SIZE;
    depth = unpackRGBAToDepth( texture2D( shadowMap, uv + offset));
    if (depth < compare) {
      blockerDepthSum += depth;
      blockers++;
    }
    j++;
  }
  #pragma unroll_loop_end

  if (blockers > 0.0) {
    return blockerDepthSum / blockers;
  }
  return -1.0;
}

        
float vogelFilter(sampler2D shadowMap, vec2 uv, float zReceiver, float filterRadius, float angle) {
  float texelSize = 1.0 / float(textureSize(shadowMap, 0).x);
  float shadow = 0.0f;
  int j = 0;
  vec2 vogelSample = vec2(0.0);
  vec2 offset = vec2(0.0);
  #pragma unroll_loop_start
  for (int i = 0; i < ${r}; i++) {
    vogelSample = vogelDiskSample(j, ${r}, angle) * texelSize;
    offset = vogelSample * (1.0 + filterRadius * float(${t}));
    shadow += step( zReceiver, unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) ) );
    j++;
  }
  #pragma unroll_loop_end
  return shadow * 1.0 / ${r}.0;
}

float PCSS (sampler2D shadowMap, vec4 coords) {
  vec2 uv = coords.xy;
  float zReceiver = coords.z; // Assumed to be eye-space z in this code
  float angle = highPassRandRGB(gl_FragCoord.xy).r * PI2;
  float avgBlockerDepth = findBlocker(shadowMap, uv, zReceiver, angle);
  if (avgBlockerDepth == -1.0) {
    return 1.0;
  }
  float penumbraRatio = penumbraSize(zReceiver, avgBlockerDepth);
  return vogelFilter(shadowMap, uv, zReceiver, 1.25 * penumbraRatio, angle);
}`;function Ar(e,t,r){t.traverse(t=>{t.material&&(e.properties.remove(t.material),null==t.material.dispose||t.material.dispose())}),e.info.programs.length=0,e.compile(t,r)}function An({focus:e=0,samples:t=10,size:r=25}){let n=(0,eL.A)(e=>e.gl),i=(0,eL.A)(e=>e.scene),a=(0,eL.A)(e=>e.camera);return ez.useEffect(()=>{let o=eQ.ShaderChunk.shadowmap_pars_fragment;return eQ.ShaderChunk.shadowmap_pars_fragment=eQ.ShaderChunk.shadowmap_pars_fragment.replace("#ifdef USE_SHADOWMAP","#ifdef USE_SHADOWMAP\n"+At({size:r,samples:t,focus:e})).replace("#if defined( SHADOWMAP_TYPE_PCF )","\nreturn PCSS(shadowMap, shadowCoord);\n#if defined( SHADOWMAP_TYPE_PCF )"),Ar(n,i,a),()=>{eQ.ShaderChunk.shadowmap_pars_fragment=o,Ar(n,i,a)}},[e,r,t]),null}function Ai(e,t){let r=e+"Geometry";return ez.forwardRef(({args:e,children:n,...i},a)=>{let o=ez.useRef(null);return ez.useImperativeHandle(a,()=>o.current),ez.useLayoutEffect(()=>void(null==t||t(o.current))),ez.createElement("mesh",ee({ref:o},i),ez.createElement(r,{attach:"geometry",args:e}),n)})}let Aa=Ai("box"),Ao=Ai("circle"),As=Ai("cone"),Al=Ai("cylinder"),Ac=Ai("sphere"),Au=Ai("plane"),Ah=Ai("tube"),Ad=Ai("torus"),Af=Ai("torusKnot"),Ap=Ai("tetrahedron"),Am=Ai("ring"),AA=Ai("polyhedron"),Ag=Ai("icosahedron"),Av=Ai("octahedron"),Ay=Ai("dodecahedron"),Ax=Ai("extrude"),AE=Ai("lathe"),A_=Ai("capsule"),AC=Ai("shape",({geometry:e})=>{let t=e.attributes.position,r=new eQ.Box3().setFromBufferAttribute(t),n=new eQ.Vector3;r.getSize(n);let i=[],a=0,o=0,s=0,l=0;for(let e=0;e<t.count;e++)a=t.getX(e),o=t.getY(e),s=(a-r.min.x)/n.x,l=(o-r.min.y)/n.y,i.push(s,l);e.setAttribute("uv",new eQ.Float32BufferAttribute(i,2))}),Ab=ez.forwardRef(function({args:[e=1,t=1,r=1]=[],radius:n=.05,steps:i=1,smoothness:a=4,bevelSegments:o=4,creaseAngle:s=.4,children:l,...c},u){let h=ez.useMemo(()=>(function(e,t,r){let n=new eQ.Shape,i=r-1e-5;return n.absarc(1e-5,1e-5,1e-5,-Math.PI/2,-Math.PI,!0),n.absarc(1e-5,t-2*i,1e-5,Math.PI,Math.PI/2,!0),n.absarc(e-2*i,t-2*i,1e-5,Math.PI/2,0,!0),n.absarc(e-2*i,1e-5,1e-5,0,-Math.PI/2,!0),n})(e,t,n),[e,t,n]),d=ez.useMemo(()=>({depth:r-2*n,bevelEnabled:!0,bevelSegments:2*o,steps:i,bevelSize:n-1e-5,bevelThickness:n,curveSegments:a}),[r,n,a]),f=ez.useRef(null);return ez.useLayoutEffect(()=>{f.current&&(f.current.center(),oN(f.current,s))},[h,d]),ez.createElement("mesh",ee({ref:u},c),ez.createElement("extrudeGeometry",{ref:f,args:[h,d]}),l)});function Aw(){let e=new eQ.BufferGeometry,t=new Float32Array([-1,-1,3,-1,-1,3]);return e.boundingSphere=new eQ.Sphere,e.boundingSphere.set(new eQ.Vector3,1/0),e.setAttribute("position",new eQ.BufferAttribute(t,2)),e}let AB=ez.forwardRef(function({children:e,...t},r){let n=ez.useMemo(Aw,[]);return ez.createElement("mesh",ee({ref:r,geometry:n,frustumCulled:!1},t),e)}),AI=ez.forwardRef(({children:e,width:t,height:r,depth:n,box3:i,precise:a=!0,...o},s)=>{let l=ez.useRef(null),c=ez.useRef(null),u=ez.useRef(null);return ez.useLayoutEffect(()=>{c.current.matrixWorld.identity();let e=i||new eQ.Box3().setFromObject(u.current,a),o=e.max.x-e.min.x,s=e.max.y-e.min.y,l=e.max.z-e.min.z,h=Math.max(o,s,l);t&&(h=o),r&&(h=s),n&&(h=l),c.current.scale.setScalar(1/h)},[t,r,n,i,a]),ez.useImperativeHandle(s,()=>l.current,[]),ez.createElement("group",ee({ref:l},o),ez.createElement("group",{ref:c},ez.createElement("group",{ref:u},e)))});var AM=((ei=AM||{})[ei.NONE=0]="NONE",ei[ei.START=1]="START",ei[ei.ACTIVE=2]="ACTIVE",ei);let AS=e=>e&&e.isOrthographicCamera,AT=e=>e&&e.isBox3,AP=e=>1-Math.exp(-5*e)+.007*e,AD=ez.createContext(null);function AR({children:e,maxDuration:t=1,margin:r=1.2,observe:n,fit:i,clip:a,interpolateFunc:o=AP,onFit:s}){let l=ez.useRef(null),{camera:c,size:u,invalidate:h}=(0,eL.A)(),d=(0,eL.A)(e=>e.controls),f=ez.useRef(s);f.current=s;let p=ez.useRef({camPos:new eQ.Vector3,camRot:new eQ.Quaternion,camZoom:1}),m=ez.useRef({camPos:void 0,camRot:void 0,camZoom:void 0,camUp:void 0,target:void 0}),A=ez.useRef(AM.NONE),g=ez.useRef(0),[v]=ez.useState(()=>new eQ.Box3),y=ez.useMemo(()=>{function e(){let e=v.getSize(new eQ.Vector3),t=v.getCenter(new eQ.Vector3),n=Math.max(e.x,e.y,e.z),i=AS(c)?4*n:n/(2*Math.atan(Math.PI*c.fov/360)),a=AS(c)?4*n:i/c.aspect;return{box:v,size:e,center:t,distance:r*Math.max(i,a)}}return{getSize:e,refresh(e){if(AT(e))v.copy(e);else{let t=e||l.current;if(!t)return this;t.updateWorldMatrix(!0,!0),v.setFromObject(t)}if(v.isEmpty()){let e=c.position.length()||10;v.setFromCenterAndSize(new eQ.Vector3,new eQ.Vector3(e,e,e))}return p.current.camPos.copy(c.position),p.current.camRot.copy(c.quaternion),AS(c)&&(p.current.camZoom=c.zoom),m.current.camPos=void 0,m.current.camRot=void 0,m.current.camZoom=void 0,m.current.camUp=void 0,m.current.target=void 0,this},reset(){let{center:t,distance:r}=e(),n=c.position.clone().sub(t).normalize();m.current.camPos=t.clone().addScaledVector(n,r),m.current.target=t.clone();let i=new eQ.Matrix4().lookAt(m.current.camPos,m.current.target,c.up);return m.current.camRot=new eQ.Quaternion().setFromRotationMatrix(i),A.current=AM.START,g.current=0,this},moveTo(e){return m.current.camPos=Array.isArray(e)?new eQ.Vector3(...e):e.clone(),A.current=AM.START,g.current=0,this},lookAt({target:e,up:t}){m.current.target=Array.isArray(e)?new eQ.Vector3(...e):e.clone(),t?m.current.camUp=Array.isArray(t)?new eQ.Vector3(...t):t.clone():m.current.camUp=c.up.clone();let r=new eQ.Matrix4().lookAt(m.current.camPos||c.position,m.current.target,m.current.camUp);return m.current.camRot=new eQ.Quaternion().setFromRotationMatrix(r),A.current=AM.START,g.current=0,this},to({position:e,target:t}){return this.moveTo(e).lookAt({target:t})},fit(){if(!AS(c))return this.reset();let e=0,t=0,n=[new eQ.Vector3(v.min.x,v.min.y,v.min.z),new eQ.Vector3(v.min.x,v.max.y,v.min.z),new eQ.Vector3(v.min.x,v.min.y,v.max.z),new eQ.Vector3(v.min.x,v.max.y,v.max.z),new eQ.Vector3(v.max.x,v.max.y,v.max.z),new eQ.Vector3(v.max.x,v.max.y,v.min.z),new eQ.Vector3(v.max.x,v.min.y,v.max.z),new eQ.Vector3(v.max.x,v.min.y,v.min.z)],i=m.current.camPos||c.position,a=m.current.target||(null==d?void 0:d.target),o=m.current.camUp||c.up,s=a?new eQ.Matrix4().lookAt(i,a,o).setPosition(i).invert():c.matrixWorldInverse;for(let r of n)r.applyMatrix4(s),e=Math.max(e,Math.abs(r.y)),t=Math.max(t,Math.abs(r.x));e*=2,t*=2;let l=(c.top-c.bottom)/e,u=(c.right-c.left)/t;return m.current.camZoom=Math.min(l,u)/r,A.current=AM.START,g.current=0,f.current&&f.current(this.getSize()),this},clip(){let{distance:t}=e();return c.near=t/100,c.far=100*t,c.updateProjectionMatrix(),d&&(d.maxDistance=10*t,d.update()),h(),this}}},[v,c,d,r,h]);ez.useLayoutEffect(()=>{if(d){let e=()=>{if(d&&m.current.target&&A.current!==AM.NONE){let e=new eQ.Vector3().setFromMatrixColumn(c.matrix,2),t=p.current.camPos.distanceTo(d.target),r=(m.current.camPos||p.current.camPos).distanceTo(m.current.target),n=(1-g.current)*t+g.current*r;d.target.copy(c.position).addScaledVector(e,-n),d.update()}A.current=AM.NONE};return d.addEventListener("start",e),()=>d.removeEventListener("start",e)}},[d]);let x=ez.useRef(0);return ez.useLayoutEffect(()=>{(n||0==x.current++)&&(y.refresh(),i&&y.reset().fit(),a&&y.clip())},[u,a,i,n,c,d]),(0,eL.C)((e,r)=>{if(A.current===AM.START)A.current=AM.ACTIVE,h();else if(A.current===AM.ACTIVE){if(g.current+=r/t,g.current>=1)m.current.camPos&&c.position.copy(m.current.camPos),m.current.camRot&&c.quaternion.copy(m.current.camRot),m.current.camUp&&c.up.copy(m.current.camUp),m.current.camZoom&&AS(c)&&(c.zoom=m.current.camZoom),c.updateMatrixWorld(),c.updateProjectionMatrix(),d&&m.current.target&&(d.target.copy(m.current.target),d.update()),A.current=AM.NONE;else{let e=o(g.current);m.current.camPos&&c.position.lerpVectors(p.current.camPos,m.current.camPos,e),m.current.camRot&&c.quaternion.slerpQuaternions(p.current.camRot,m.current.camRot,e),m.current.camUp&&c.up.set(0,1,0).applyQuaternion(c.quaternion),m.current.camZoom&&AS(c)&&(c.zoom=(1-e)*p.current.camZoom+e*m.current.camZoom),c.updateMatrixWorld(),c.updateProjectionMatrix()}h()}}),ez.createElement("group",{ref:l},ez.createElement(AD.Provider,{value:y},e))}function AF(){return ez.useContext(AD)}var Az=Object.defineProperty,AO=(e,t,r)=>t in e?Az(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,AQ=(e,t,r)=>(AO(e,"symbol"!=typeof t?t+"":t,r),r);class AL{constructor(e=Math){AQ(this,"grad3",[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]]),AQ(this,"grad4",[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]]),AQ(this,"p",[]),AQ(this,"perm",[]),AQ(this,"simplex",[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]),AQ(this,"dot",(e,t,r)=>e[0]*t+e[1]*r),AQ(this,"dot3",(e,t,r,n)=>e[0]*t+e[1]*r+e[2]*n),AQ(this,"dot4",(e,t,r,n,i)=>e[0]*t+e[1]*r+e[2]*n+e[3]*i),AQ(this,"noise",(e,t)=>{let r,n,i;let a=.5*(Math.sqrt(3)-1)*(e+t),o=Math.floor(e+a),s=Math.floor(t+a),l=(3-Math.sqrt(3))/6,c=(o+s)*l,u=e-(o-c),h=t-(s-c),d=0,f=1;u>h&&(d=1,f=0);let p=u-d+l,m=h-f+l,A=u-1+2*l,g=h-1+2*l,v=255&o,y=255&s,x=this.perm[v+this.perm[y]]%12,E=this.perm[v+d+this.perm[y+f]]%12,_=this.perm[v+1+this.perm[y+1]]%12,C=.5-u*u-h*h;C<0?r=0:(C*=C,r=C*C*this.dot(this.grad3[x],u,h));let b=.5-p*p-m*m;b<0?n=0:(b*=b,n=b*b*this.dot(this.grad3[E],p,m));let w=.5-A*A-g*g;return w<0?i=0:(w*=w,i=w*w*this.dot(this.grad3[_],A,g)),70*(r+n+i)}),AQ(this,"noise3d",(e,t,r)=>{let n,i,a,o,s,l,c,u,h,d;let f=1/3*(e+t+r),p=Math.floor(e+f),m=Math.floor(t+f),A=Math.floor(r+f),g=1/6*(p+m+A),v=e-(p-g),y=t-(m-g),x=r-(A-g);v>=y?y>=x?(s=1,l=0,c=0,u=1,h=1,d=0):(v>=x?(s=1,l=0,c=0):(s=0,l=0,c=1),u=1,h=0,d=1):y<x?(s=0,l=0,c=1,u=0,h=1,d=1):v<x?(s=0,l=1,c=0,u=0,h=1,d=1):(s=0,l=1,c=0,u=1,h=1,d=0);let E=v-s+1/6,_=y-l+1/6,C=x-c+1/6,b=v-u+1/6*2,w=y-h+1/6*2,B=x-d+1/6*2,I=v-1+1/6*3,M=y-1+1/6*3,S=x-1+1/6*3,T=255&p,P=255&m,D=255&A,R=this.perm[T+this.perm[P+this.perm[D]]]%12,F=this.perm[T+s+this.perm[P+l+this.perm[D+c]]]%12,z=this.perm[T+u+this.perm[P+h+this.perm[D+d]]]%12,O=this.perm[T+1+this.perm[P+1+this.perm[D+1]]]%12,Q=.6-v*v-y*y-x*x;Q<0?n=0:(Q*=Q,n=Q*Q*this.dot3(this.grad3[R],v,y,x));let L=.6-E*E-_*_-C*C;L<0?i=0:(L*=L,i=L*L*this.dot3(this.grad3[F],E,_,C));let k=.6-b*b-w*w-B*B;k<0?a=0:(k*=k,a=k*k*this.dot3(this.grad3[z],b,w,B));let U=.6-I*I-M*M-S*S;return U<0?o=0:(U*=U,o=U*U*this.dot3(this.grad3[O],I,M,S)),32*(n+i+a+o)}),AQ(this,"noise4d",(e,t,r,n)=>{let i,a,o,s,l,c,u,h,d,f,p,m,A,g,v,y,x;let E=this.grad4,_=this.simplex,C=this.perm,b=(5-Math.sqrt(5))/20,w=(Math.sqrt(5)-1)/4*(e+t+r+n),B=Math.floor(e+w),I=Math.floor(t+w),M=Math.floor(r+w),S=Math.floor(n+w),T=(B+I+M+S)*b,P=e-(B-T),D=t-(I-T),R=r-(M-T),F=n-(S-T),z=(P>D?32:0)+(P>R?16:0)+(D>R?8:0)+(P>F?4:0)+(D>F?2:0)+(R>F?1:0);c=_[z][0]>=3?1:0,u=_[z][1]>=3?1:0,h=_[z][2]>=3?1:0,d=_[z][3]>=3?1:0,f=_[z][0]>=2?1:0,p=_[z][1]>=2?1:0,m=_[z][2]>=2?1:0,A=_[z][3]>=2?1:0,g=_[z][0]>=1?1:0,v=_[z][1]>=1?1:0,y=_[z][2]>=1?1:0,x=_[z][3]>=1?1:0;let O=P-c+b,Q=D-u+b,L=R-h+b,k=F-d+b,U=P-f+2*b,N=D-p+2*b,G=R-m+2*b,H=F-A+2*b,V=P-g+3*b,j=D-v+3*b,Y=R-y+3*b,J=F-x+3*b,W=P-1+4*b,q=D-1+4*b,K=R-1+4*b,X=F-1+4*b,Z=255&B,$=255&I,ee=255&M,et=255&S,er=C[Z+C[$+C[ee+C[et]]]]%32,en=C[Z+c+C[$+u+C[ee+h+C[et+d]]]]%32,ei=C[Z+f+C[$+p+C[ee+m+C[et+A]]]]%32,ea=C[Z+g+C[$+v+C[ee+y+C[et+x]]]]%32,eo=C[Z+1+C[$+1+C[ee+1+C[et+1]]]]%32,es=.6-P*P-D*D-R*R-F*F;es<0?i=0:(es*=es,i=es*es*this.dot4(E[er],P,D,R,F));let el=.6-O*O-Q*Q-L*L-k*k;el<0?a=0:(el*=el,a=el*el*this.dot4(E[en],O,Q,L,k));let ec=.6-U*U-N*N-G*G-H*H;ec<0?o=0:(ec*=ec,o=ec*ec*this.dot4(E[ei],U,N,G,H));let eu=.6-V*V-j*j-Y*Y-J*J;eu<0?s=0:(eu*=eu,s=eu*eu*this.dot4(E[ea],V,j,Y,J));let eh=.6-W*W-q*q-K*K-X*X;return eh<0?l=0:(eh*=eh,l=eh*eh*this.dot4(E[eo],W,q,K,X)),27*(i+a+o+s+l)});for(let t=0;t<256;t++)this.p[t]=Math.floor(256*e.random());for(let e=0;e<512;e++)this.perm[e]=this.p[255&e]}}let Ak=ez.forwardRef(({intensity:e=1,decay:t,decayRate:r=.65,maxYaw:n=.1,maxPitch:i=.1,maxRoll:a=.1,yawFrequency:o=.1,pitchFrequency:s=.1,rollFrequency:l=.1},c)=>{let u=(0,eL.A)(e=>e.camera),h=(0,eL.A)(e=>e.controls),d=ez.useRef(e),f=ez.useRef(u.rotation.clone()),[p]=ez.useState(()=>new AL),[m]=ez.useState(()=>new AL),[A]=ez.useState(()=>new AL),g=()=>{(d.current<0||d.current>1)&&(d.current=d.current<0?0:1)};return ez.useImperativeHandle(c,()=>({getIntensity:()=>d.current,setIntensity:e=>{d.current=e,g()}}),[]),ez.useEffect(()=>{if(h){let e=()=>void(f.current=u.rotation.clone());return h.addEventListener("change",e),e(),()=>void h.removeEventListener("change",e)}},[u,h]),(0,eL.C)((e,c)=>{let h=Math.pow(d.current,2),v=n*h*p.noise(e.clock.elapsedTime*o,1),y=i*h*m.noise(e.clock.elapsedTime*s,1),x=a*h*A.noise(e.clock.elapsedTime*l,1);u.rotation.set(f.current.x+y,f.current.y+v,f.current.z+x),t&&d.current>0&&(d.current-=r*c,g())}),null}),AU=ez.forwardRef(({children:e,enabled:t=!0,speed:r=1,rotationIntensity:n=1,floatIntensity:i=1,floatingRange:a=[-.1,.1],...o},s)=>{let l=ez.useRef(null);ez.useImperativeHandle(s,()=>l.current,[]);let c=ez.useRef(1e4*Math.random());return(0,eL.C)(e=>{var o,s;if(!t||0===r)return;let u=c.current+e.clock.getElapsedTime();l.current.rotation.x=Math.cos(u/4*r)/8*n,l.current.rotation.y=Math.sin(u/4*r)/8*n,l.current.rotation.z=Math.sin(u/4*r)/20*n;let h=Math.sin(u/4*r)/10;h=eQ.MathUtils.mapLinear(h,-.1,.1,null!==(o=null==a?void 0:a[0])&&void 0!==o?o:-.1,null!==(s=null==a?void 0:a[1])&&void 0!==s?s:.1),l.current.position.y=h*i,l.current.updateMatrix()}),ez.createElement("group",o,ez.createElement("group",{ref:l,matrixAutoUpdate:!1},e))}),AN=e=>e&&e.isCubeTexture;class AG extends eQ.Mesh{constructor(e,t){var r,n;let i=AN(e),a=Math.floor(Math.log2((null!=(n=i?null==(r=e.image[0])?void 0:r.width:e.image.width)?n:1024)/4)),o=Math.pow(2,a),s=3*Math.max(o,112),l=`
        varying vec3 vWorldPosition;
        void main() 
        {
            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );
            vWorldPosition = worldPosition.xyz;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
        `,c=[i?"#define ENVMAP_TYPE_CUBE":"",`#define CUBEUV_TEXEL_WIDTH ${1/s}`,`#define CUBEUV_TEXEL_HEIGHT ${1/(4*o)}`,`#define CUBEUV_MAX_MIP ${a}.0`].join("\n")+`
        #define ENVMAP_TYPE_CUBE_UV
        varying vec3 vWorldPosition;
        uniform float radius;
        uniform float height;
        uniform float angle;
        #ifdef ENVMAP_TYPE_CUBE
            uniform samplerCube map;
        #else
            uniform sampler2D map;
        #endif
        // From: https://www.shadertoy.com/view/4tsBD7
        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) 
        {
            float d = dot ( rd, n );
            
            if( d > 0.0 ) { return 1e6; }
            
            vec3  o = ro - c;
            float t = - dot( n, o ) / d;
            vec3  q = o + rd * t;
            
            return ( dot( q, q ) < r * r ) ? t : 1e6;
        }
        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm
        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) 
        {
            vec3 oc = ro - ce;
            float b = dot( oc, rd );
            float c = dot( oc, oc ) - ra * ra;
            float h = b * b - c;
            
            if( h < 0.0 ) { return -1.0; }
            
            h = sqrt( h );
            
            return - b + h;
        }
        vec3 project() 
        {
            vec3 p = normalize( vWorldPosition );
            vec3 camPos = cameraPosition;
            camPos.y -= height;
            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );
            if( intersection > 0.0 ) {
                
                vec3 h = vec3( 0.0, - height, 0.0 );
                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );
                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;
            } else {
                p = vec3( 0.0, 1.0, 0.0 );
            }
            return p;
        }
        #include <common>
        #include <cube_uv_reflection_fragment>
        void main() 
        {
            vec3 projectedWorldPosition = project();
            
            #ifdef ENVMAP_TYPE_CUBE
                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;
            #else
                vec3 direction = normalize( projectedWorldPosition );
                vec2 uv = equirectUv( direction );
                vec3 outcolor = texture2D( map, uv ).rgb;
            #endif
            gl_FragColor = vec4( outcolor, 1.0 );
            #include <tonemapping_fragment>
            #include <${parseInt(eQ.REVISION.replace(/\D+/g,""))>=154?"colorspace_fragment":"encodings_fragment"}>
        }
        `;super(new eQ.IcosahedronGeometry(1,16),new eQ.ShaderMaterial({uniforms:{map:{value:e},height:{value:(null==t?void 0:t.height)||15},radius:{value:(null==t?void 0:t.radius)||100}},fragmentShader:c,vertexShader:l,side:eQ.DoubleSide}))}set radius(e){this.material.uniforms.radius.value=e}get radius(){return this.material.uniforms.radius.value}set height(e){this.material.uniforms.height.value=e}get height(){return this.material.uniforms.height.value}}class AH extends eQ.DataTextureLoader{constructor(e){super(e),this.type=eQ.HalfFloatType}parse(e){let t,r,n;let i=function(e,t){switch(e){case 1:throw Error("THREE.RGBELoader: Read Error: "+(t||""));case 2:throw Error("THREE.RGBELoader: Write Error: "+(t||""));case 3:throw Error("THREE.RGBELoader: Bad File Format: "+(t||""));default:throw Error("THREE.RGBELoader: Memory Error: "+(t||""))}},a=function(e,t,r){t=t||1024;let n=e.pos,i=-1,a=0,o="",s=String.fromCharCode.apply(null,new Uint16Array(e.subarray(n,n+128)));for(;0>(i=s.indexOf("\n"))&&a<t&&n<e.byteLength;)o+=s,a+=s.length,n+=128,s+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(n,n+128)));return -1<i&&(!1!==r&&(e.pos+=a+i+1),o+s.slice(0,i))},o=new Uint8Array(e);o.pos=0;let s=function(e){let t,r;let n=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,o=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,s=/^\s*FORMAT=(\S+)\s*$/,l=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,c={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};for(!(e.pos>=e.byteLength)&&(t=a(e))||i(1,"no header found"),(r=t.match(/^#\?(\S+)/))||i(3,"bad initial token"),c.valid|=1,c.programtype=r[1],c.string+=t+"\n";!1!==(t=a(e));){if(c.string+=t+"\n","#"===t.charAt(0)){c.comments+=t+"\n";continue}if((r=t.match(n))&&(c.gamma=parseFloat(r[1])),(r=t.match(o))&&(c.exposure=parseFloat(r[1])),(r=t.match(s))&&(c.valid|=2,c.format=r[1]),(r=t.match(l))&&(c.valid|=4,c.height=parseInt(r[1],10),c.width=parseInt(r[2],10)),2&c.valid&&4&c.valid)break}return 2&c.valid||i(3,"missing format specifier"),4&c.valid||i(3,"missing image size specifier"),c}(o),l=s.width,c=s.height,u=function(e,t,r){if(t<8||t>32767||2!==e[0]||2!==e[1]||128&e[2])return new Uint8Array(e);t!==(e[2]<<8|e[3])&&i(3,"wrong scanline width");let n=new Uint8Array(4*t*r);n.length||i(4,"unable to allocate buffer space");let a=0,o=0,s=4*t,l=new Uint8Array(4),c=new Uint8Array(s),u=r;for(;u>0&&o<e.byteLength;){o+4>e.byteLength&&i(1),l[0]=e[o++],l[1]=e[o++],l[2]=e[o++],l[3]=e[o++],(2!=l[0]||2!=l[1]||(l[2]<<8|l[3])!=t)&&i(3,"bad rgbe scanline format");let r=0,h;for(;r<s&&o<e.byteLength;){let t=(h=e[o++])>128;if(t&&(h-=128),(0===h||r+h>s)&&i(3,"bad scanline data"),t){let t=e[o++];for(let e=0;e<h;e++)c[r++]=t}else c.set(e.subarray(o,o+h),r),r+=h,o+=h}for(let e=0;e<t;e++){let r=0;n[a]=c[e+r],r+=t,n[a+1]=c[e+r],r+=t,n[a+2]=c[e+r],r+=t,n[a+3]=c[e+r],a+=4}u--}return n}(o.subarray(o.pos),l,c);switch(this.type){case eQ.FloatType:let h=new Float32Array(4*(n=u.length/4));for(let e=0;e<n;e++)!function(e,t,r,n){let i=Math.pow(2,e[t+3]-128)/255;r[n+0]=e[t+0]*i,r[n+1]=e[t+1]*i,r[n+2]=e[t+2]*i,r[n+3]=1}(u,4*e,h,4*e);t=h,r=eQ.FloatType;break;case eQ.HalfFloatType:let d=new Uint16Array(4*(n=u.length/4));for(let e=0;e<n;e++)!function(e,t,r,n){let i=Math.pow(2,e[t+3]-128)/255;r[n+0]=eQ.DataUtils.toHalfFloat(Math.min(e[t+0]*i,65504)),r[n+1]=eQ.DataUtils.toHalfFloat(Math.min(e[t+1]*i,65504)),r[n+2]=eQ.DataUtils.toHalfFloat(Math.min(e[t+2]*i,65504)),r[n+3]=eQ.DataUtils.toHalfFloat(1)}(u,4*e,d,4*e);t=d,r=eQ.HalfFloatType;break;default:throw Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:l,height:c,data:t,header:s.string,gamma:s.gamma,exposure:s.exposure,type:r}}setDataType(e){return this.type=e,this}load(e,t,r,n){return super.load(e,function(e,r){switch(e.type){case eQ.FloatType:case eQ.HalfFloatType:"colorSpace"in e?e.colorSpace="srgb-linear":e.encoding=3e3,e.minFilter=eQ.LinearFilter,e.magFilter=eQ.LinearFilter,e.generateMipmaps=!1,e.flipY=!0}t&&t(e,r)},r,n)}}let AV="colorSpace"in new eQ.Texture;class Aj extends eQ.DataTextureLoader{constructor(e){super(e),this.type=eQ.HalfFloatType}parse(e){let t={l:0,c:0,lc:0};function r(e,r,n,i,a){for(;n<e;)r=r<<8|w(i,a),n+=8;n-=e,t.l=r>>n&(1<<e)-1,t.c=r,t.lc=n}let n=Array(59),i={c:0,lc:0};function a(e,t,r,n){e=e<<8|w(r,n),t+=8,i.c=e,i.lc=t}let o={c:0,lc:0};function s(e,t,r,n,s,l,c,u,h,d){if(e==t){n<8&&(a(r,n,s,c),r=i.c,n=i.lc);var f=r>>(n-=8),f=new Uint8Array([f])[0];if(h.value+f>d)return!1;for(var p=u[h.value-1];f-- >0;)u[h.value++]=p}else{if(!(h.value<d))return!1;u[h.value++]=e}o.c=r,o.lc=n}function l(e){var t=65535&e;return t>32767?t-65536:t}let c={a:0,b:0};function u(e,t){var r=l(e),n=l(t),i=r+(1&n)+(n>>1),a=i-n;c.a=i,c.b=a}function h(e,t){var r=65535&t,n=(65535&e)-(r>>1)&65535;c.a=r+n-32768&65535,c.b=n}function d(e,l,c,u,h,d){var f=c.value,p=b(l,c),m=b(l,c);c.value+=4;var A=b(l,c);if(c.value+=4,p<0||p>=65537||m<0||m>=65537)throw"Something wrong with HUF_ENCSIZE";var g=Array(65537),v=Array(16384);!function(e){for(var t=0;t<16384;t++)e[t]={},e[t].len=0,e[t].lit=0,e[t].p=null}(v);var y=u-(c.value-f);if(!function(e,i,a,o,s,l,c){for(var u=0,h=0;s<=l;s++){if(a.value-a.value>o)return!1;r(6,u,h,e,a);var d=t.l;if(u=t.c,h=t.lc,c[s]=d,63==d){if(a.value-a.value>o)throw"Something wrong with hufUnpackEncTable";r(8,u,h,e,a);var f=t.l+6;if(u=t.c,h=t.lc,s+f>l+1)throw"Something wrong with hufUnpackEncTable";for(;f--;)c[s++]=0;s--}else if(d>=59){var f=d-59+2;if(s+f>l+1)throw"Something wrong with hufUnpackEncTable";for(;f--;)c[s++]=0;s--}}!function(e){for(var t=0;t<=58;++t)n[t]=0;for(var t=0;t<65537;++t)n[e[t]]+=1;for(var r=0,t=58;t>0;--t){var i=r+n[t]>>1;n[t]=r,r=i}for(var t=0;t<65537;++t){var a=e[t];a>0&&(e[t]=a|n[a]++<<6)}}(c)}(e,0,c,y,p,m,g),A>8*(u-(c.value-f)))throw"Something wrong with hufUncompress";!function(e,t,r,n){for(;t<=r;t++){var i=e[t]>>6,a=63&e[t];if(i>>a)throw"Invalid table entry";if(a>14){var o=n[i>>a-14];if(o.len)throw"Invalid table entry";if(o.lit++,o.p){var s=o.p;o.p=Array(o.lit);for(var l=0;l<o.lit-1;++l)o.p[l]=s[l]}else o.p=[,];o.p[o.lit-1]=t}else if(a)for(var c=0,l=1<<14-a;l>0;l--){var o=n[(i<<14-a)+c];if(o.len||o.p)throw"Invalid table entry";o.len=a,o.lit=t,c++}}}(g,p,m,v),function(e,t,r,n,l,c,u,h,d,f){for(var p=0,m=0,A=Math.trunc(l.value+(c+7)/8);l.value<A;)for(a(p,m,r,l),p=i.c,m=i.lc;m>=14;){var g=t[p>>m-14&16383];if(g.len)m-=g.len,s(g.lit,u,p,m,r,n,l,d,f,h),p=o.c,m=o.lc;else{if(!g.p)throw"hufDecode issues";for(v=0;v<g.lit;v++){for(var v,y=63&e[g.p[v]];m<y&&l.value<A;)a(p,m,r,l),p=i.c,m=i.lc;if(m>=y&&e[g.p[v]]>>6==(p>>m-y&(1<<y)-1)){m-=y,s(g.p[v],u,p,m,r,n,l,d,f,h),p=o.c,m=o.lc;break}}if(v==g.lit)throw"hufDecode issues"}}var x=8-c&7;for(p>>=x,m-=x;m>0;){var g=t[p<<14-m&16383];if(g.len)m-=g.len,s(g.lit,u,p,m,r,n,l,d,f,h),p=o.c,m=o.lc;else throw"hufDecode issues"}}(g,v,e,l,c,A,m,d,h,{value:0})}function f(e){for(var t=1;t<e.length;t++){var r=e[t-1]+e[t]-128;e[t]=r}}function p(e,t){for(var r=0,n=Math.floor((e.length+1)/2),i=0,a=e.length-1;!(i>a)&&(t[i++]=e[r++],!(i>a));)t[i++]=e[n++]}function m(e){for(var t=e.byteLength,r=[],n=0,i=new DataView(e);t>0;){var a=i.getInt8(n++);if(a<0){var o=-a;t-=o+1;for(var s=0;s<o;s++)r.push(i.getUint8(n++))}else{var o=a;t-=2;for(var l=i.getUint8(n++),s=0;s<o+1;s++)r.push(l)}}return r}function A(e){return new DataView(e.array.buffer,e.offset.value,e.size)}function g(e){var t=new Uint8Array(m(e.viewer.buffer.slice(e.offset.value,e.offset.value+e.size))),r=new Uint8Array(t.length);return f(t),p(t,r),new DataView(r.buffer)}function v(e){var t=hq(e.array.slice(e.offset.value,e.offset.value+e.size)),r=new Uint8Array(t.length);return f(t),p(t,r),new DataView(r.buffer)}function y(e){for(var t=e.viewer,r={value:e.offset.value},n=new Uint16Array(e.width*e.scanlineBlockSize*(e.channels*e.type)),i=new Uint8Array(8192),a=0,o=Array(e.channels),s=0;s<e.channels;s++)o[s]={},o[s].start=a,o[s].end=o[s].start,o[s].nx=e.width,o[s].ny=e.lines,o[s].size=e.type,a+=o[s].nx*o[s].ny*o[s].size;var l=P(t,r),f=P(t,r);if(f>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(l<=f)for(var s=0;s<f-l+1;s++)i[s+l]=B(t,r);var p=new Uint16Array(65536),m=function(e,t){for(var r=0,n=0;n<65536;++n)(0==n||e[n>>3]&1<<(7&n))&&(t[r++]=n);for(var i=r-1;r<65536;)t[r++]=0;return i}(i,p),A=b(t,r);d(e.array,t,r,A,n,a);for(var s=0;s<e.channels;++s)for(var g=o[s],v=0;v<o[s].size;++v)!function(e,t,r,n,i,a,o){for(var s=o<16384,l=r>i?i:r,d=1;d<=l;)d<<=1;for(d>>=1,f=d,d>>=1;d>=1;){for(var f,p,m,A,g,v=0,y=0+a*(i-f),x=a*d,E=a*f,_=n*d,C=n*f;v<=y;v+=E){for(var b=v,w=v+n*(r-f);b<=w;b+=C){var B=b+_,I=b+x,M=I+_;s?(u(e[b+t],e[I+t]),p=c.a,A=c.b,u(e[B+t],e[M+t]),m=c.a,g=c.b,u(p,m),e[b+t]=c.a,e[B+t]=c.b,u(A,g)):(h(e[b+t],e[I+t]),p=c.a,A=c.b,h(e[B+t],e[M+t]),m=c.a,g=c.b,h(p,m),e[b+t]=c.a,e[B+t]=c.b,h(A,g)),e[I+t]=c.a,e[M+t]=c.b}if(r&d){var I=b+x;s?u(e[b+t],e[I+t]):h(e[b+t],e[I+t]),p=c.a,e[I+t]=c.b,e[b+t]=p}}if(i&d)for(var b=v,w=v+n*(r-f);b<=w;b+=C){var B=b+_;s?u(e[b+t],e[B+t]):h(e[b+t],e[B+t]),p=c.a,e[B+t]=c.b,e[b+t]=p}f=d,d>>=1}}(n,g.start+v,g.nx,g.size,g.ny,g.nx*g.size,m);!function(e,t,r){for(var n=0;n<r;++n)t[n]=e[t[n]]}(p,n,a);for(var y=0,x=new Uint8Array(n.buffer.byteLength),E=0;E<e.lines;E++)for(var _=0;_<e.channels;_++){var g=o[_],C=g.nx*g.size,w=new Uint8Array(n.buffer,2*g.end,2*C);x.set(w,y),y+=2*C,g.end+=C}return new DataView(x.buffer)}function x(e){var t=hq(e.array.slice(e.offset.value,e.offset.value+e.size));let r=e.lines*e.channels*e.width,n=1==e.type?new Uint16Array(r):new Uint32Array(r),i=0,a=0,o=[,,,,];for(let r=0;r<e.lines;r++)for(let r=0;r<e.channels;r++){let r=0;switch(e.type){case 1:o[0]=i,o[1]=o[0]+e.width,i=o[1]+e.width;for(let i=0;i<e.width;++i)r+=t[o[0]++]<<8|t[o[1]++],n[a]=r,a++;break;case 2:o[0]=i,o[1]=o[0]+e.width,o[2]=o[1]+e.width,i=o[2]+e.width;for(let i=0;i<e.width;++i)r+=t[o[0]++]<<24|t[o[1]++]<<16|t[o[2]++]<<8,n[a]=r,a++}}return new DataView(n.buffer)}function E(e){var t=e.viewer,r={value:e.offset.value},n=new Uint8Array(e.width*e.lines*(e.channels*e.type*2)),i={version:I(t,r),unknownUncompressedSize:I(t,r),unknownCompressedSize:I(t,r),acCompressedSize:I(t,r),dcCompressedSize:I(t,r),rleCompressedSize:I(t,r),rleUncompressedSize:I(t,r),rleRawSize:I(t,r),totalAcUncompressedCount:I(t,r),totalDcUncompressedCount:I(t,r),acCompression:I(t,r)};if(i.version<2)throw"EXRLoader.parse: "+O.compression+" version "+i.version+" is unsupported";for(var a=[],o=P(t,r)-2;o>0;){var s=_(t.buffer,r),l=B(t,r),c=l>>2&3,u=new Int8Array([(l>>4)-1])[0],h=B(t,r);a.push({name:s,index:u,type:h,compression:c}),o-=s.length+3}for(var f=O.channels,p=Array(e.channels),A=0;A<e.channels;++A){var g=p[A]={},y=f[A];g.name=y.name,g.compression=0,g.decoded=!1,g.type=y.pixelType,g.pLinear=y.pLinear,g.width=e.width,g.height=e.lines}for(var x={idx:[,,,]},E=0;E<e.channels;++E)for(var g=p[E],A=0;A<a.length;++A){var C=a[A];g.name==C.name&&(g.compression=C.compression,C.index>=0&&(x.idx[C.index]=E),g.offset=E)}if(i.acCompressedSize>0)switch(i.acCompression){case 0:var b=new Uint16Array(i.totalAcUncompressedCount);d(e.array,t,r,i.acCompressedSize,b,i.totalAcUncompressedCount);break;case 1:var w=e.array.slice(r.value,r.value+i.totalAcUncompressedCount),M=hq(w),b=new Uint16Array(M.buffer);r.value+=i.totalAcUncompressedCount}if(i.dcCompressedSize>0){var S=new Uint16Array(v({array:e.array,offset:r,size:i.dcCompressedSize}).buffer);r.value+=i.dcCompressedSize}if(i.rleRawSize>0){var w=e.array.slice(r.value,r.value+i.rleCompressedSize),M=hq(w),D=m(M.buffer);r.value+=i.rleCompressedSize}for(var R=0,F=Array(p.length),A=0;A<F.length;++A)F[A]=[];for(var z=0;z<e.lines;++z)for(var Q=0;Q<p.length;++Q)F[Q].push(R),R+=p[Q].width*e.type*2;!function(e,t,r,n,i,a){var o=new DataView(a.buffer),s=r[e.idx[0]].width,l=r[e.idx[0]].height,c=Math.floor(s/8),u=Math.ceil(s/8),h=Math.ceil(l/8),d=s-(u-1)*8,f=l-(h-1)*8,p={value:0},m=[,,,],A=[,,,],g=[,,,],v=[,,,],y=[,,,];for(let r=0;r<3;++r)y[r]=t[e.idx[r]],m[r]=r<1?0:m[r-1]+u*h,A[r]=new Float32Array(64),g[r]=new Uint16Array(64),v[r]=new Uint16Array(64*u);for(let t=0;t<h;++t){var x,E,_=8;t==h-1&&(_=f);var C=8;for(let e=0;e<u;++e){e==u-1&&(C=d);for(let e=0;e<3;++e)g[e].fill(0),g[e][0]=i[m[e]++],function(e,t,r){for(var n,i=1;i<64;)65280==(n=t[e.value])?i=64:n>>8==255?i+=255&n:(r[i]=n,i++),e.value++}(p,n,g[e]),x=g[e],(E=A[e])[0]=T(x[0]),E[1]=T(x[1]),E[2]=T(x[5]),E[3]=T(x[6]),E[4]=T(x[14]),E[5]=T(x[15]),E[6]=T(x[27]),E[7]=T(x[28]),E[8]=T(x[2]),E[9]=T(x[4]),E[10]=T(x[7]),E[11]=T(x[13]),E[12]=T(x[16]),E[13]=T(x[26]),E[14]=T(x[29]),E[15]=T(x[42]),E[16]=T(x[3]),E[17]=T(x[8]),E[18]=T(x[12]),E[19]=T(x[17]),E[20]=T(x[25]),E[21]=T(x[30]),E[22]=T(x[41]),E[23]=T(x[43]),E[24]=T(x[9]),E[25]=T(x[11]),E[26]=T(x[18]),E[27]=T(x[24]),E[28]=T(x[31]),E[29]=T(x[40]),E[30]=T(x[44]),E[31]=T(x[53]),E[32]=T(x[10]),E[33]=T(x[19]),E[34]=T(x[23]),E[35]=T(x[32]),E[36]=T(x[39]),E[37]=T(x[45]),E[38]=T(x[52]),E[39]=T(x[54]),E[40]=T(x[20]),E[41]=T(x[22]),E[42]=T(x[33]),E[43]=T(x[38]),E[44]=T(x[46]),E[45]=T(x[51]),E[46]=T(x[55]),E[47]=T(x[60]),E[48]=T(x[21]),E[49]=T(x[34]),E[50]=T(x[37]),E[51]=T(x[47]),E[52]=T(x[50]),E[53]=T(x[56]),E[54]=T(x[59]),E[55]=T(x[61]),E[56]=T(x[35]),E[57]=T(x[36]),E[58]=T(x[48]),E[59]=T(x[49]),E[60]=T(x[57]),E[61]=T(x[58]),E[62]=T(x[62]),E[63]=T(x[63]),function(e){let t=.5*Math.cos(3.14159/16),r=.5*Math.cos(3.14159/8),n=.5*Math.cos(3*3.14159/16),i=.5*Math.cos(3*3.14159/8);for(var a=[,,,,],o=[,,,,],s=[,,,,],l=[,,,,],c=0;c<8;++c){var u=8*c;a[0]=r*e[u+2],a[1]=i*e[u+2],a[2]=r*e[u+6],a[3]=i*e[u+6],o[0]=t*e[u+1]+n*e[u+3]+.2777854612564676*e[u+5]+.09754573032714427*e[u+7],o[1]=n*e[u+1]-.09754573032714427*e[u+3]-t*e[u+5]-.2777854612564676*e[u+7],o[2]=.2777854612564676*e[u+1]-t*e[u+3]+.09754573032714427*e[u+5]+n*e[u+7],o[3]=.09754573032714427*e[u+1]-.2777854612564676*e[u+3]+n*e[u+5]-t*e[u+7],s[0]=.35355362513961314*(e[u+0]+e[u+4]),s[3]=.35355362513961314*(e[u+0]-e[u+4]),s[1]=a[0]+a[3],s[2]=a[1]-a[2],l[0]=s[0]+s[1],l[1]=s[3]+s[2],l[2]=s[3]-s[2],l[3]=s[0]-s[1],e[u+0]=l[0]+o[0],e[u+1]=l[1]+o[1],e[u+2]=l[2]+o[2],e[u+3]=l[3]+o[3],e[u+4]=l[3]-o[3],e[u+5]=l[2]-o[2],e[u+6]=l[1]-o[1],e[u+7]=l[0]-o[0]}for(var h=0;h<8;++h)a[0]=r*e[16+h],a[1]=i*e[16+h],a[2]=r*e[48+h],a[3]=i*e[48+h],o[0]=t*e[8+h]+n*e[24+h]+.2777854612564676*e[40+h]+.09754573032714427*e[56+h],o[1]=n*e[8+h]-.09754573032714427*e[24+h]-t*e[40+h]-.2777854612564676*e[56+h],o[2]=.2777854612564676*e[8+h]-t*e[24+h]+.09754573032714427*e[40+h]+n*e[56+h],o[3]=.09754573032714427*e[8+h]-.2777854612564676*e[24+h]+n*e[40+h]-t*e[56+h],s[0]=.35355362513961314*(e[h]+e[32+h]),s[3]=.35355362513961314*(e[h]-e[32+h]),s[1]=a[0]+a[3],s[2]=a[1]-a[2],l[0]=s[0]+s[1],l[1]=s[3]+s[2],l[2]=s[3]-s[2],l[3]=s[0]-s[1],e[0+h]=l[0]+o[0],e[8+h]=l[1]+o[1],e[16+h]=l[2]+o[2],e[24+h]=l[3]+o[3],e[32+h]=l[3]-o[3],e[40+h]=l[2]-o[2],e[48+h]=l[1]-o[1],e[56+h]=l[0]-o[0]}(A[e]);!function(e){for(var t=0;t<64;++t){var r=e[0][t],n=e[1][t],i=e[2][t];e[0][t]=r+1.5747*i,e[1][t]=r-.1873*n-.4682*i,e[2][t]=r+1.8556*n}}(A);for(let t=0;t<3;++t)!function(e,t,r){for(var n,i=0;i<64;++i)t[r+i]=eQ.DataUtils.toHalfFloat((n=e[i])<=1?Math.sign(n)*Math.pow(Math.abs(n),2.2):Math.sign(n)*Math.pow(9.025013291561939,Math.abs(n)-1))}(A[t],v[t],64*e)}let a=0;for(let n=0;n<3;++n){let i=r[e.idx[n]].type;for(let e=8*t;e<8*t+_;++e){a=y[n][e];for(let t=0;t<c;++t){let r=64*t+(7&e)*8;o.setUint16(a+0*i,v[n][r+0],!0),o.setUint16(a+2*i,v[n][r+1],!0),o.setUint16(a+4*i,v[n][r+2],!0),o.setUint16(a+6*i,v[n][r+3],!0),o.setUint16(a+8*i,v[n][r+4],!0),o.setUint16(a+10*i,v[n][r+5],!0),o.setUint16(a+12*i,v[n][r+6],!0),o.setUint16(a+14*i,v[n][r+7],!0),a+=16*i}}if(c!=u)for(let e=8*t;e<8*t+_;++e){let t=y[n][e]+8*c*2*i,r=64*c+(7&e)*8;for(let e=0;e<C;++e)o.setUint16(t+2*e*i,v[n][r+e],!0)}}}for(var b=new Uint16Array(s),o=new DataView(a.buffer),w=0;w<3;++w){r[e.idx[w]].decoded=!0;var B=r[e.idx[w]].type;if(2==r[w].type)for(var I=0;I<l;++I){let e=y[w][I];for(var M=0;M<s;++M)b[M]=o.getUint16(e+2*M*B,!0);for(var M=0;M<s;++M)o.setFloat32(e+2*M*B,T(b[M]),!0)}}}(x,F,p,b,S,n);for(var A=0;A<p.length;++A){var g=p[A];if(!g.decoded){if(2===g.compression)for(var L=0,k=0,z=0;z<e.lines;++z){for(var U=F[A][L],N=0;N<g.width;++N){for(var G=0;G<2*g.type;++G)n[U++]=D[k+G*g.width*g.height];k++}L++}else throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(n.buffer)}function _(e,t){for(var r=new Uint8Array(e),n=0;0!=r[t.value+n];)n+=1;var i=new TextDecoder().decode(r.slice(t.value,t.value+n));return t.value=t.value+n+1,i}function C(e,t){var r=e.getInt32(t.value,!0);return t.value=t.value+4,r}function b(e,t){var r=e.getUint32(t.value,!0);return t.value=t.value+4,r}function w(e,t){var r=e[t.value];return t.value=t.value+1,r}function B(e,t){var r=e.getUint8(t.value);return t.value=t.value+1,r}let I=function(e,t){let r;return"getBigInt64"in DataView.prototype?r=Number(e.getBigInt64(t.value,!0)):r=e.getUint32(t.value+4,!0)+Number(e.getUint32(t.value,!0)<<32),t.value+=8,r};function M(e,t){var r=e.getFloat32(t.value,!0);return t.value+=4,r}function S(e,t){return eQ.DataUtils.toHalfFloat(M(e,t))}function T(e){var t=(31744&e)>>10,r=1023&e;return(e>>15?-1:1)*(t?31===t?r?NaN:1/0:Math.pow(2,t-15)*(1+r/1024):r/1024*6103515625e-14)}function P(e,t){var r=e.getUint16(t.value,!0);return t.value+=2,r}function D(e,t){return T(P(e,t))}let R=new DataView(e),F=new Uint8Array(e),z={value:0},O=function(e,t,r){let n={};if(20000630!=e.getUint32(0,!0))throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";n.version=e.getUint8(4);let i=e.getUint8(5);n.spec={singleTile:!!(2&i),longName:!!(4&i),deepFormat:!!(8&i),multiPart:!!(16&i)},r.value=8;for(var a=!0;a;){var o=_(t,r);if(0==o)a=!1;else{var s=_(t,r),l=b(e,r),c=function(e,t,r,n,i){var a,o,s,l,c;if("string"===n||"stringvector"===n||"iccProfile"===n)return a=new TextDecoder().decode(new Uint8Array(t).slice(r.value,r.value+i)),r.value=r.value+i,a;if("chlist"===n)return function(e,t,r,n){for(var i=r.value,a=[];r.value<i+n-1;){var o=_(t,r),s=C(e,r),l=B(e,r);r.value+=3;var c=C(e,r),u=C(e,r);a.push({name:o,pixelType:s,pLinear:l,xSampling:c,ySampling:u})}return r.value+=1,a}(e,t,r,i);if("chromaticities"===n)return o=M(e,r),s=M(e,r),l=M(e,r),c=M(e,r),{redX:o,redY:s,greenX:l,greenY:c,blueX:M(e,r),blueY:M(e,r),whiteX:M(e,r),whiteY:M(e,r)};if("compression"===n)return["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"][B(e,r)];if("box2i"===n)return{xMin:b(e,r),yMin:b(e,r),xMax:b(e,r),yMax:b(e,r)};if("lineOrder"===n)return["INCREASING_Y"][B(e,r)];if("float"===n)return M(e,r);else if("v2f"===n)return[M(e,r),M(e,r)];else if("v3f"===n)return[M(e,r),M(e,r),M(e,r)];else if("int"===n)return C(e,r);else if("rational"===n)return[C(e,r),b(e,r)];else if("timecode"===n)return[b(e,r),b(e,r)];else return"preview"===n?(r.value+=i,"skipped"):void(r.value+=i)}(e,t,r,s,l);void 0===c?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${s}'.`):n[o]=c}}if((-5&i)!=0)throw console.error("EXRHeader:",n),"THREE.EXRLoader: provided file is currently unsupported.";return n}(R,e,z),Q=function(e,t,r,n,i){let a={size:0,viewer:t,array:r,offset:n,width:e.dataWindow.xMax-e.dataWindow.xMin+1,height:e.dataWindow.yMax-e.dataWindow.yMin+1,channels:e.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:e.channels[0].pixelType,uncompress:null,getter:null,format:null,[AV?"colorSpace":"encoding"]:null};switch(e.compression){case"NO_COMPRESSION":a.lines=1,a.uncompress=A;break;case"RLE_COMPRESSION":a.lines=1,a.uncompress=g;break;case"ZIPS_COMPRESSION":a.lines=1,a.uncompress=v;break;case"ZIP_COMPRESSION":a.lines=16,a.uncompress=v;break;case"PIZ_COMPRESSION":a.lines=32,a.uncompress=y;break;case"PXR24_COMPRESSION":a.lines=16,a.uncompress=x;break;case"DWAA_COMPRESSION":a.lines=32,a.uncompress=E;break;case"DWAB_COMPRESSION":a.lines=256,a.uncompress=E;break;default:throw"EXRLoader.parse: "+e.compression+" is unsupported"}if(a.scanlineBlockSize=a.lines,1==a.type)switch(i){case eQ.FloatType:a.getter=D,a.inputSize=2;break;case eQ.HalfFloatType:a.getter=P,a.inputSize=2}else if(2==a.type)switch(i){case eQ.FloatType:a.getter=M,a.inputSize=4;break;case eQ.HalfFloatType:a.getter=S,a.inputSize=4}else throw"EXRLoader.parse: unsupported pixelType "+a.type+" for "+e.compression+".";a.blockCount=(e.dataWindow.yMax+1)/a.scanlineBlockSize;for(var o=0;o<a.blockCount;o++)I(t,n);a.outputChannels=3==a.channels?4:a.channels;let s=a.width*a.height*a.outputChannels;switch(i){case eQ.FloatType:a.byteArray=new Float32Array(s),a.channels<a.outputChannels&&a.byteArray.fill(1,0,s);break;case eQ.HalfFloatType:a.byteArray=new Uint16Array(s),a.channels<a.outputChannels&&a.byteArray.fill(15360,0,s);break;default:console.error("THREE.EXRLoader: unsupported type: ",i)}return a.bytesPerLine=a.width*a.inputSize*a.channels,4==a.outputChannels?a.format=eQ.RGBAFormat:a.format=eQ.RedFormat,AV?a.colorSpace="srgb-linear":a.encoding=3e3,a}(O,R,F,z,this.type),L={value:0},k={R:0,G:1,B:2,A:3,Y:0};for(let e=0;e<Q.height/Q.scanlineBlockSize;e++){let t=b(R,z);Q.size=b(R,z),Q.lines=t+Q.scanlineBlockSize>Q.height?Q.height-t:Q.scanlineBlockSize;let r=Q.size<Q.lines*Q.bytesPerLine?Q.uncompress(Q):A(Q);z.value+=Q.size;for(let t=0;t<Q.scanlineBlockSize;t++){let n=t+e*Q.scanlineBlockSize;if(n>=Q.height)break;for(let e=0;e<Q.channels;e++){let i=k[O.channels[e].name];for(let a=0;a<Q.width;a++){L.value=(Q.channels*Q.width*t+e*Q.width+a)*Q.inputSize;let o=(Q.height-1-n)*(Q.width*Q.outputChannels)+a*Q.outputChannels+i;Q.byteArray[o]=Q.getter(r,L)}}}}return{header:O,width:Q.width,height:Q.height,data:Q.byteArray,format:Q.format,[AV?"colorSpace":"encoding"]:Q[AV?"colorSpace":"encoding"],type:this.type}}setDataType(e){return this.type=e,this}load(e,t,r,n){return super.load(e,function(e,r){AV?e.colorSpace=r.colorSpace:e.encoding=r.encoding,e.minFilter=eQ.LinearFilter,e.magFilter=eQ.LinearFilter,e.generateMipmaps=!1,e.flipY=!1,t&&t(e,r)},r,n)}}let AY=(e,t,r)=>{let n;switch(e){case eQ.UnsignedByteType:n=new Uint8ClampedArray(t*r*4);break;case eQ.HalfFloatType:n=new Uint16Array(t*r*4);break;case eQ.UnsignedIntType:n=new Uint32Array(t*r*4);break;case eQ.ByteType:n=new Int8Array(t*r*4);break;case eQ.ShortType:n=new Int16Array(t*r*4);break;case eQ.IntType:n=new Int32Array(t*r*4);break;case eQ.FloatType:n=new Float32Array(t*r*4);break;default:throw Error("Unsupported data type")}return n},AJ=(e,t,r,n)=>{if(void 0!==W)return W;let i=new eQ.WebGLRenderTarget(1,1,n);t.setRenderTarget(i);let a=new eQ.Mesh(new eQ.PlaneGeometry,new eQ.MeshBasicMaterial({color:16777215}));t.render(a,r),t.setRenderTarget(null);let o=AY(e,i.width,i.height);return t.readRenderTargetPixels(i,0,0,i.width,i.height,o),i.dispose(),a.geometry.dispose(),a.material.dispose(),W=0!==o[0]};class AW{constructor(e){var t,r,n,i,a,o,s,l,c,u,h,d,f,p,m,A;this._rendererIsDisposable=!1,this._supportsReadPixels=!0,this.render=()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(e){throw this._renderer.setRenderTarget(null),e}this._renderer.setRenderTarget(null)},this._width=e.width,this._height=e.height,this._type=e.type,this._colorSpace=e.colorSpace;let g={format:eQ.RGBAFormat,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:(null===(t=e.renderTargetOptions)||void 0===t?void 0:t.anisotropy)!==void 0?null===(r=e.renderTargetOptions)||void 0===r?void 0:r.anisotropy:1,generateMipmaps:(null===(n=e.renderTargetOptions)||void 0===n?void 0:n.generateMipmaps)!==void 0&&(null===(i=e.renderTargetOptions)||void 0===i?void 0:i.generateMipmaps),magFilter:(null===(a=e.renderTargetOptions)||void 0===a?void 0:a.magFilter)!==void 0?null===(o=e.renderTargetOptions)||void 0===o?void 0:o.magFilter:eQ.LinearFilter,minFilter:(null===(s=e.renderTargetOptions)||void 0===s?void 0:s.minFilter)!==void 0?null===(l=e.renderTargetOptions)||void 0===l?void 0:l.minFilter:eQ.LinearFilter,samples:(null===(c=e.renderTargetOptions)||void 0===c?void 0:c.samples)!==void 0?null===(u=e.renderTargetOptions)||void 0===u?void 0:u.samples:void 0,wrapS:(null===(h=e.renderTargetOptions)||void 0===h?void 0:h.wrapS)!==void 0?null===(d=e.renderTargetOptions)||void 0===d?void 0:d.wrapS:eQ.ClampToEdgeWrapping,wrapT:(null===(f=e.renderTargetOptions)||void 0===f?void 0:f.wrapT)!==void 0?null===(p=e.renderTargetOptions)||void 0===p?void 0:p.wrapT:eQ.ClampToEdgeWrapping};if(this._material=e.material,e.renderer?this._renderer=e.renderer:(this._renderer=AW.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new eQ.Scene,this._camera=new eQ.OrthographicCamera,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!AJ(this._type,this._renderer,this._camera,g)){let e;this._type===eQ.HalfFloatType&&(e=this._renderer.extensions.has("EXT_color_buffer_float")?eQ.FloatType:void 0),void 0!==e?(console.warn(`This browser does not support reading pixels from ${this._type} RenderTargets, switching to ${eQ.FloatType}`),this._type=e):(this._supportsReadPixels=!1,console.warn("This browser dos not support toArray or toDataTexture, calls to those methods will result in an error thrown"))}this._quad=new eQ.Mesh(new eQ.PlaneGeometry,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new eQ.WebGLRenderTarget(this.width,this.height,g),this._renderTarget.texture.mapping=(null===(m=e.renderTargetOptions)||void 0===m?void 0:m.mapping)!==void 0?null===(A=e.renderTargetOptions)||void 0===A?void 0:A.mapping:eQ.UVMapping}static instantiateRenderer(){let e=new eQ.WebGLRenderer;return e.setSize(128,128),e}toArray(){if(!this._supportsReadPixels)throw Error("Can't read pixels in this browser");let e=AY(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,e),e}toDataTexture(e){let t=new eQ.DataTexture(this.toArray(),this.width,this.height,eQ.RGBAFormat,this._type,(null==e?void 0:e.mapping)||eQ.UVMapping,(null==e?void 0:e.wrapS)||eQ.ClampToEdgeWrapping,(null==e?void 0:e.wrapT)||eQ.ClampToEdgeWrapping,(null==e?void 0:e.magFilter)||eQ.LinearFilter,(null==e?void 0:e.minFilter)||eQ.LinearFilter,(null==e?void 0:e.anisotropy)||1,eQ.LinearSRGBColorSpace);return t.generateMipmaps=(null==e?void 0:e.generateMipmaps)!==void 0&&(null==e?void 0:e.generateMipmaps),t}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(e){this.disposeOnDemandRenderer(),e&&this.renderTarget.dispose(),this.material instanceof eQ.ShaderMaterial&&Object.values(this.material.uniforms).forEach(e=>{e.value instanceof eQ.Texture&&e.value.dispose()}),Object.values(this.material).forEach(e=>{e instanceof eQ.Texture&&e.dispose()}),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(e){this._width=e,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(e){this._height=e,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(e){this._renderTarget=e,this._width=e.width,this._height=e.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}}let Aq=`
varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,AK=`
// min half float value
#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )
// max half float value
#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )

uniform sampler2D sdr;
uniform sampler2D gainMap;
uniform vec3 gamma;
uniform vec3 offsetHdr;
uniform vec3 offsetSdr;
uniform vec3 gainMapMin;
uniform vec3 gainMapMax;
uniform float weightFactor;

varying vec2 vUv;

void main() {
  vec3 rgb = texture2D( sdr, vUv ).rgb;
  vec3 recovery = texture2D( gainMap, vUv ).rgb;
  vec3 logRecovery = pow( recovery, gamma );
  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;
  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;
  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));
  gl_FragColor = vec4( clampedHdrColor , 1.0 );
}
`;class AX extends eQ.ShaderMaterial{constructor({gamma:e,offsetHdr:t,offsetSdr:r,gainMapMin:n,gainMapMax:i,maxDisplayBoost:a,hdrCapacityMin:o,hdrCapacityMax:s,sdr:l,gainMap:c}){super({name:"GainMapDecoderMaterial",vertexShader:Aq,fragmentShader:AK,uniforms:{sdr:{value:l},gainMap:{value:c},gamma:{value:new eQ.Vector3(1/e[0],1/e[1],1/e[2])},offsetHdr:{value:new eQ.Vector3().fromArray(t)},offsetSdr:{value:new eQ.Vector3().fromArray(r)},gainMapMin:{value:new eQ.Vector3().fromArray(n)},gainMapMax:{value:new eQ.Vector3().fromArray(i)},weightFactor:{value:(Math.log2(a)-o)/(s-o)}},blending:eQ.NoBlending,depthTest:!1,depthWrite:!1}),this._maxDisplayBoost=a,this._hdrCapacityMin=o,this._hdrCapacityMax=s,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}get sdr(){return this.uniforms.sdr.value}set sdr(e){this.uniforms.sdr.value=e}get gainMap(){return this.uniforms.gainMap.value}set gainMap(e){this.uniforms.gainMap.value=e}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(e){this.uniforms.offsetHdr.value.fromArray(e)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(e){this.uniforms.offsetSdr.value.fromArray(e)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(e){this.uniforms.gainMapMin.value.fromArray(e)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(e){this.uniforms.gainMapMax.value.fromArray(e)}get gamma(){let e=this.uniforms.gamma.value;return[1/e.x,1/e.y,1/e.z]}set gamma(e){let t=this.uniforms.gamma.value;t.x=1/e[0],t.y=1/e[1],t.z=1/e[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(e){this._hdrCapacityMin=e,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(e){this._hdrCapacityMax=e,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(e){this._maxDisplayBoost=Math.max(1,Math.min(65504,e)),this.calculateWeight()}calculateWeight(){let e=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,e))}}class AZ extends Error{}class A$ extends Error{}let A0=(e,t,r)=>{var n;let i;let a=null===(n=e.attributes.getNamedItem(t))||void 0===n?void 0:n.nodeValue;if(a)i=a;else{let n=e.getElementsByTagName(t)[0];if(n){let e=n.getElementsByTagName("rdf:li");if(3===e.length)i=Array.from(e).map(e=>e.innerHTML);else throw Error(`Gainmap metadata contains an array of items for ${t} but its length is not 3`)}else{if(r)return r;throw Error(`Can't find ${t} in gainmap metadata`)}}return i},A1=e=>{var t,r;let n;"undefined"!=typeof TextDecoder?n=new TextDecoder().decode(e):n=e.toString();let i=n.indexOf("<x:xmpmeta"),a=new DOMParser;for(;-1!==i;){let e=n.indexOf("x:xmpmeta>",i);n.slice(i,e+10);let o=n.slice(i,e+10);try{let e=a.parseFromString(o,"text/xml").getElementsByTagName("rdf:Description")[0],n=A0(e,"hdrgm:GainMapMin","0"),i=A0(e,"hdrgm:GainMapMax"),s=A0(e,"hdrgm:Gamma","1"),l=A0(e,"hdrgm:OffsetSDR","0.015625"),c=A0(e,"hdrgm:OffsetHDR","0.015625"),u=null===(t=e.attributes.getNamedItem("hdrgm:HDRCapacityMin"))||void 0===t?void 0:t.nodeValue;u||(u="0");let h=null===(r=e.attributes.getNamedItem("hdrgm:HDRCapacityMax"))||void 0===r?void 0:r.nodeValue;if(!h)throw Error("Incomplete gainmap metadata");return{gainMapMin:Array.isArray(n)?n.map(e=>parseFloat(e)):[parseFloat(n),parseFloat(n),parseFloat(n)],gainMapMax:Array.isArray(i)?i.map(e=>parseFloat(e)):[parseFloat(i),parseFloat(i),parseFloat(i)],gamma:Array.isArray(s)?s.map(e=>parseFloat(e)):[parseFloat(s),parseFloat(s),parseFloat(s)],offsetSdr:Array.isArray(l)?l.map(e=>parseFloat(e)):[parseFloat(l),parseFloat(l),parseFloat(l)],offsetHdr:Array.isArray(c)?c.map(e=>parseFloat(e)):[parseFloat(c),parseFloat(c),parseFloat(c)],hdrCapacityMin:parseFloat(u),hdrCapacityMax:parseFloat(h)}}catch(e){}i=n.indexOf("<x:xmpmeta",e)}};class A2{constructor(e){this.options={debug:!!e&&void 0!==e.debug&&e.debug,extractFII:!e||void 0===e.extractFII||e.extractFII,extractNonFII:!e||void 0===e.extractNonFII||e.extractNonFII}}extract(e){return new Promise((t,r)=>{let n;let i=this.options.debug,a=new DataView(e.buffer);if(65496!==a.getUint16(0)){r(Error("Not a valid jpeg"));return}let o=a.byteLength,s=2,l=0;for(;s<o;){if(++l>250){r(Error(`Found no marker after ${l} loops 😵`));return}if(255!==a.getUint8(s)){r(Error(`Not a valid marker at offset 0x${s.toString(16)}, found: 0x${a.getUint8(s).toString(16)}`));return}if(n=a.getUint8(s+1),i&&console.log(`Marker: ${n.toString(16)}`),226===n){i&&console.log("Found APP2 marker (0xffe2)");let e=s+4;if(1297106432===a.getUint32(e)){let n;let i=e+4;if(18761===a.getUint16(i))n=!1;else if(19789===a.getUint16(i))n=!0;else{r(Error("No valid endianness marker found in TIFF header"));return}if(42!==a.getUint16(i+2,!n)){r(Error("Not valid TIFF data! (no 0x002A marker)"));return}let o=a.getUint32(i+4,!n);if(o<8){r(Error("Not valid TIFF data! (First offset less than 8)"));return}let s=i+o,l=a.getUint16(s,!n),c=s+2,u=0;for(let e=c;e<c+12*l;e+=12)45057===a.getUint16(e,!n)&&(u=a.getUint32(e+8,!n));let h=s+2+12*l+4,d=[];for(let e=h;e<h+16*u;e+=16){let t={MPType:a.getUint32(e,!n),size:a.getUint32(e+4,!n),dataOffset:a.getUint32(e+8,!n),dependantImages:a.getUint32(e+12,!n),start:-1,end:-1,isFII:!1};t.dataOffset?(t.start=i+t.dataOffset,t.isFII=!1):(t.start=0,t.isFII=!0),t.end=t.start+t.size,d.push(t)}if(this.options.extractNonFII&&d.length){let e=new Blob([a]),r=[];for(let t of d){if(t.isFII&&!this.options.extractFII)continue;let n=e.slice(t.start,t.end+1,"image/jpeg");r.push(n)}t(r)}}}s+=2+a.getUint16(s+2)}})}}let A3=async e=>{let t=A1(e);if(!t)throw new A$("Gain map XMP metadata not found");let r=new A2({extractFII:!0,extractNonFII:!0}),n=await r.extract(e);if(2!==n.length)throw new AZ("Gain map recovery image not found");return{sdr:new Uint8Array(await n[0].arrayBuffer()),gainMap:new Uint8Array(await n[1].arrayBuffer()),metadata:t}},A4=e=>new Promise((t,r)=>{let n=document.createElement("img");n.onload=()=>{t(n)},n.onerror=e=>{r(e)},n.src=URL.createObjectURL(e)});class A5 extends eQ.Loader{constructor(e,t){super(t),e&&(this._renderer=e),this._internalLoadingManager=new eQ.LoadingManager}setRenderer(e){return this._renderer=e,this}setRenderTargetOptions(e){return this._renderTargetOptions=e,this}prepareQuadRenderer(){this._renderer||console.warn("WARNING: An existing WebGL Renderer was not passed to this Loader constructor or in setRenderer, the result of this Loader will need to be converted to a Data Texture with toDataTexture() before you can use it in your renderer.");let e=new AX({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new eQ.Texture,sdr:new eQ.Texture});return new AW({width:16,height:16,type:eQ.HalfFloatType,colorSpace:eQ.LinearSRGBColorSpace,material:e,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}async render(e,t,r,n){let i,a;let o=n?new Blob([n],{type:"image/jpeg"}):void 0,s=new Blob([r],{type:"image/jpeg"}),l=!1;if("undefined"==typeof createImageBitmap){let e=await Promise.all([o?A4(o):Promise.resolve(void 0),A4(s)]);a=e[0],i=e[1],l=!0}else{let e=await Promise.all([o?createImageBitmap(o,{imageOrientation:"flipY"}):Promise.resolve(void 0),createImageBitmap(s,{imageOrientation:"flipY"})]);a=e[0],i=e[1]}let c=new eQ.Texture(a||new ImageData(2,2),eQ.UVMapping,eQ.ClampToEdgeWrapping,eQ.ClampToEdgeWrapping,eQ.LinearFilter,eQ.LinearMipMapLinearFilter,eQ.RGBAFormat,eQ.UnsignedByteType,1,eQ.LinearSRGBColorSpace);c.flipY=l,c.needsUpdate=!0;let u=new eQ.Texture(i,eQ.UVMapping,eQ.ClampToEdgeWrapping,eQ.ClampToEdgeWrapping,eQ.LinearFilter,eQ.LinearMipMapLinearFilter,eQ.RGBAFormat,eQ.UnsignedByteType,1,eQ.SRGBColorSpace);u.flipY=l,u.needsUpdate=!0,e.width=i.width,e.height=i.height,e.material.gainMap=c,e.material.sdr=u,e.material.gainMapMin=t.gainMapMin,e.material.gainMapMax=t.gainMapMax,e.material.offsetHdr=t.offsetHdr,e.material.offsetSdr=t.offsetSdr,e.material.gamma=t.gamma,e.material.hdrCapacityMin=t.hdrCapacityMin,e.material.hdrCapacityMax=t.hdrCapacityMax,e.material.maxDisplayBoost=Math.pow(2,t.hdrCapacityMax),e.material.needsUpdate=!0,e.render()}}class A6 extends A5{load([e,t,r],n,i,a){let o,s,l;let c=this.prepareQuadRenderer(),u=async()=>{if(o&&s&&l){try{await this.render(c,l,o,s)}catch(n){this.manager.itemError(e),this.manager.itemError(t),this.manager.itemError(r),"function"==typeof a&&a(n),c.disposeOnDemandRenderer();return}"function"==typeof n&&n(c),this.manager.itemEnd(e),this.manager.itemEnd(t),this.manager.itemEnd(r),c.disposeOnDemandRenderer()}},h=!0,d=0,f=0,p=!0,m=0,A=0,g=!0,v=0,y=0,x=()=>{"function"==typeof i&&i(new ProgressEvent("progress",{lengthComputable:h&&p&&g,loaded:f+A+y,total:d+m+v}))};this.manager.itemStart(e),this.manager.itemStart(t),this.manager.itemStart(r);let E=new eQ.FileLoader(this._internalLoadingManager);E.setResponseType("arraybuffer"),E.setRequestHeader(this.requestHeader),E.setPath(this.path),E.setWithCredentials(this.withCredentials),E.load(e,async e=>{if("string"==typeof e)throw Error("Invalid sdr buffer");o=e,await u()},e=>{h=e.lengthComputable,f=e.loaded,d=e.total,x()},t=>{this.manager.itemError(e),"function"==typeof a&&a(t)});let _=new eQ.FileLoader(this._internalLoadingManager);_.setResponseType("arraybuffer"),_.setRequestHeader(this.requestHeader),_.setPath(this.path),_.setWithCredentials(this.withCredentials),_.load(t,async e=>{if("string"==typeof e)throw Error("Invalid gainmap buffer");s=e,await u()},e=>{p=e.lengthComputable,A=e.loaded,m=e.total,x()},e=>{this.manager.itemError(t),"function"==typeof a&&a(e)});let C=new eQ.FileLoader(this._internalLoadingManager);return C.setRequestHeader(this.requestHeader),C.setPath(this.path),C.setWithCredentials(this.withCredentials),C.load(r,async e=>{if("string"!=typeof e)throw Error("Invalid metadata string");l=JSON.parse(e),await u()},e=>{g=e.lengthComputable,y=e.loaded,v=e.total,x()},e=>{this.manager.itemError(r),"function"==typeof a&&a(e)}),c}}class A8 extends A5{load(e,t,r,n){let i=this.prepareQuadRenderer(),a=new eQ.FileLoader(this._internalLoadingManager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(this.withCredentials),this.manager.itemStart(e),a.load(e,async r=>{let a,o,s;if("string"==typeof r)throw Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");let l=new Uint8Array(r);try{let e=await A3(l);a=e.sdr,o=e.gainMap,s=e.metadata}catch(t){if(t instanceof A$||t instanceof AZ)console.warn(`Failure to reconstruct an HDR image from ${e}: Gain map metadata not found in the file, HDRJPGLoader will render the SDR jpeg`),s={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},a=l;else throw t}try{await this.render(i,s,a,o)}catch(t){this.manager.itemError(e),"function"==typeof n&&n(t),i.disposeOnDemandRenderer();return}"function"==typeof t&&t(i),this.manager.itemEnd(e),i.disposeOnDemandRenderer()},r,t=>{this.manager.itemError(e),"function"==typeof n&&n(t)}),i}}let A9={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},A7=e=>Array.isArray(e);function ge({files:e=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"],path:t="",preset:r,encoding:n,extensions:i}={}){var a,o;let s;let l=null,c=!1;if(r){if(!(r in A9))throw Error("Preset must be one of: "+Object.keys(A9).join(", "));e=A9[r],t="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/"}let u=A7(e)&&6===e.length,h=A7(e)&&3===e.length&&e.some(e=>e.endsWith("json")),d=A7(e)?e[0]:e;if(c=A7(e),!(l="cube"===(s=u?"cube":h?"webp":d.startsWith("data:application/exr")?"exr":d.startsWith("data:application/hdr")?"hdr":d.startsWith("data:image/jpeg")?"jpg":null==(a=d.split(".").pop())||null==(a=a.split("?"))||null==(a=a.shift())?void 0:a.toLowerCase())?eQ.CubeTextureLoader:"hdr"===s?AH:"exr"===s?Aj:"jpg"===s||"jpeg"===s?A8:"webp"===s?A6:null))throw Error("useEnvironment: Unrecognized file extension: "+e);let f=(0,eL.A)(e=>e.gl),p=(0,eL.F)(l,c?[e]:e,e=>{("webp"===s||"jpg"===s||"jpeg"===s)&&e.setRenderer(f),null==e.setPath||e.setPath(t),i&&i(e)}),m=c?p[0]:p;return("jpg"===s||"jpeg"===s||"webp"===s)&&(m=null==(o=m.renderTarget)?void 0:o.texture),m.mapping=u?eQ.CubeReflectionMapping:eQ.EquirectangularReflectionMapping,"colorSpace"in m?m.colorSpace=(null!=n?n:u)?"srgb":"srgb-linear":m.encoding=(null!=n?n:u)?3001:3e3,m}let gt=e=>e.current&&e.current.isScene,gr=e=>gt(e)?e.current:e;function gn(e,t,r,n,i={}){var a,o,s,l,c;i={backgroundBlurriness:null!==(a=i.blur)&&void 0!==a?a:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0],...i};let u=gr(t||r),h=u.background,d=u.environment,f={backgroundBlurriness:u.backgroundBlurriness,backgroundIntensity:u.backgroundIntensity,backgroundRotation:null!==(o=null==(s=u.backgroundRotation)||null==s.clone?void 0:s.clone())&&void 0!==o?o:[0,0,0],environmentIntensity:u.environmentIntensity,environmentRotation:null!==(l=null==(c=u.environmentRotation)||null==c.clone?void 0:c.clone())&&void 0!==l?l:[0,0,0]};return"only"!==e&&(u.environment=n),e&&(u.background=n),(0,eL.j)(u,i),()=>{"only"!==e&&(u.environment=d),e&&(u.background=h),(0,eL.j)(u,f)}}function gi({scene:e,background:t=!1,map:r,...n}){let i=(0,eL.A)(e=>e.scene);return ez.useLayoutEffect(()=>{if(r)return gn(t,e,i,r,n)}),null}function ga({background:e=!1,scene:t,blur:r,backgroundBlurriness:n,backgroundIntensity:i,backgroundRotation:a,environmentIntensity:o,environmentRotation:s,...l}){let c=ge(l),u=(0,eL.A)(e=>e.scene);return ez.useLayoutEffect(()=>gn(e,t,u,c,{blur:r,backgroundBlurriness:n,backgroundIntensity:i,backgroundRotation:a,environmentIntensity:o,environmentRotation:s})),null}function go({children:e,near:t=1,far:r=1e3,resolution:n=256,frames:i=1,map:a,background:o=!1,blur:s,backgroundBlurriness:l,backgroundIntensity:c,backgroundRotation:u,environmentIntensity:h,environmentRotation:d,scene:f,files:p,path:m,preset:A,extensions:g}){let v=(0,eL.A)(e=>e.gl),y=(0,eL.A)(e=>e.scene),x=ez.useRef(null),[E]=ez.useState(()=>new eQ.Scene),_=ez.useMemo(()=>{let e=new eQ.WebGLCubeRenderTarget(n);return e.texture.type=eQ.HalfFloatType,e},[n]);ez.useLayoutEffect(()=>(1===i&&x.current.update(v,E),gn(o,f,y,_.texture,{blur:s,backgroundBlurriness:l,backgroundIntensity:c,backgroundRotation:u,environmentIntensity:h,environmentRotation:d})),[e,E,_.texture,f,y,o,i,v]);let C=1;return(0,eL.C)(()=>{(i===1/0||C<i)&&(x.current.update(v,E),C++)}),ez.createElement(ez.Fragment,null,(0,eL.g)(ez.createElement(ez.Fragment,null,e,ez.createElement("cubeCamera",{ref:x,args:[t,r,_]}),p||A?ez.createElement(ga,{background:!0,files:p,preset:A,path:m,extensions:g}):a?ez.createElement(gi,{background:!0,map:a,extensions:g}):null),E))}function gs(e){var t,r,n,i;let a=ge(e),o=e.map||a;ez.useMemo(()=>(0,eL.e)({GroundProjectedEnvImpl:AG}),[]);let s=ez.useMemo(()=>[o],[o]),l=null==(t=e.ground)?void 0:t.height,c=null==(r=e.ground)?void 0:r.radius,u=null!==(n=null==(i=e.ground)?void 0:i.scale)&&void 0!==n?n:1e3;return ez.createElement(ez.Fragment,null,ez.createElement(gi,ee({},e,{map:o})),ez.createElement("groundProjectedEnvImpl",{args:s,scale:u,height:l,radius:c}))}function gl(e){return e.ground?ez.createElement(gs,e):e.map?ez.createElement(gi,e):e.children?ez.createElement(go,e):ez.createElement(ga,e)}let gc={uniforms:{tDiffuse:{value:null},h:{value:1/512}},vertexShader:`
      varying vec2 vUv;

      void main() {

        vUv = uv;
        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

      }
  `,fragmentShader:`
    uniform sampler2D tDiffuse;
    uniform float h;

    varying vec2 vUv;

    void main() {

    	vec4 sum = vec4( 0.0 );

    	sum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;
    	sum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;
    	sum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;
    	sum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;
    	sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;

    	gl_FragColor = sum;

    }
  `},gu={uniforms:{tDiffuse:{value:null},v:{value:1/512}},vertexShader:`
    varying vec2 vUv;

    void main() {

      vUv = uv;
      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

    }
  `,fragmentShader:`

  uniform sampler2D tDiffuse;
  uniform float v;

  varying vec2 vUv;

  void main() {

    vec4 sum = vec4( 0.0 );

    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;

    gl_FragColor = sum;

  }
  `},gh=ez.forwardRef(({scale:e=10,frames:t=1/0,opacity:r=1,width:n=1,height:i=1,blur:a=1,near:o=0,far:s=10,resolution:l=512,smooth:c=!0,color:u="#000000",depthWrite:h=!1,renderOrder:d,...f},p)=>{let m,A;let g=ez.useRef(null),v=(0,eL.A)(e=>e.scene),y=(0,eL.A)(e=>e.gl),x=ez.useRef(null);n*=Array.isArray(e)?e[0]:e||1,i*=Array.isArray(e)?e[1]:e||1;let[E,_,C,b,w,B,I]=ez.useMemo(()=>{let e=new eQ.WebGLRenderTarget(l,l),t=new eQ.WebGLRenderTarget(l,l);t.texture.generateMipmaps=e.texture.generateMipmaps=!1;let r=new eQ.PlaneGeometry(n,i).rotateX(Math.PI/2),a=new eQ.Mesh(r),o=new eQ.MeshDepthMaterial;o.depthTest=o.depthWrite=!1,o.onBeforeCompile=e=>{e.uniforms={...e.uniforms,ucolor:{value:new eQ.Color(u)}},e.fragmentShader=e.fragmentShader.replace("void main() {",`uniform vec3 ucolor;
           void main() {
          `),e.fragmentShader=e.fragmentShader.replace("vec4( vec3( 1.0 - fragCoordZ ), opacity );","vec4( ucolor * fragCoordZ * 2.0, ( 1.0 - fragCoordZ ) * 1.0 );")};let s=new eQ.ShaderMaterial(gc),c=new eQ.ShaderMaterial(gu);return c.depthTest=s.depthTest=!1,[e,r,o,a,s,c,t]},[l,n,i,e,u]),M=e=>{b.visible=!0,b.material=w,w.uniforms.tDiffuse.value=E.texture,w.uniforms.h.value=1*e/256,y.setRenderTarget(I),y.render(b,x.current),b.material=B,B.uniforms.tDiffuse.value=I.texture,B.uniforms.v.value=1*e/256,y.setRenderTarget(E),y.render(b,x.current),b.visible=!1},S=0;return(0,eL.C)(()=>{x.current&&(t===1/0||S<t)&&(S++,m=v.background,A=v.overrideMaterial,g.current.visible=!1,v.background=null,v.overrideMaterial=C,y.setRenderTarget(E),y.render(v,x.current),M(a),c&&M(.4*a),y.setRenderTarget(null),g.current.visible=!0,v.overrideMaterial=A,v.background=m)}),ez.useImperativeHandle(p,()=>g.current,[]),ez.createElement("group",ee({"rotation-x":Math.PI/2},f,{ref:g}),ez.createElement("mesh",{renderOrder:d,geometry:_,scale:[1,-1,1],rotation:[-Math.PI/2,0,0]},ez.createElement("meshBasicMaterial",{transparent:!0,map:E.texture,opacity:r,depthWrite:h})),ez.createElement("orthographicCamera",{ref:x,args:[-n/2,n/2,i/2,-i/2,o,s]}))}),gd=ez.createContext(null),gf=sv({color:new eQ.Color,blend:2,alphaTest:.75,opacity:0,map:null},`varying vec2 vUv;
   void main() {
     gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.);
     vUv = uv;
   }`,`varying vec2 vUv;
   uniform sampler2D map;
   uniform vec3 color;
   uniform float opacity;
   uniform float alphaTest;
   uniform float blend;
   void main() {
     vec4 sampledDiffuseColor = texture2D(map, vUv);
     gl_FragColor = vec4(color * sampledDiffuseColor.r * blend, max(0.0, (1.0 - (sampledDiffuseColor.r + sampledDiffuseColor.g + sampledDiffuseColor.b) / alphaTest)) * opacity);
     #include <tonemapping_fragment>
     #include <${s_>=154?"colorspace_fragment":"encodings_fragment"}>
   }`),gp=ez.forwardRef(({children:e,temporal:t,frames:r=40,limit:n=1/0,blend:i=20,scale:a=10,opacity:o=1,alphaTest:s=.75,color:l="black",colorBlend:c=2,resolution:u=1024,toneMapped:h=!0,...d},f)=>{(0,eL.e)({SoftShadowMaterial:gf});let p=(0,eL.A)(e=>e.gl),m=(0,eL.A)(e=>e.scene),A=(0,eL.A)(e=>e.camera),g=(0,eL.A)(e=>e.invalidate),v=ez.useRef(null),y=ez.useRef(null),[x]=ez.useState(()=>new gA(p,m,u));ez.useLayoutEffect(()=>{x.configure(v.current)},[]);let E=ez.useMemo(()=>({lights:new Map,temporal:!!t,frames:Math.max(2,r),blend:Math.max(2,r===1/0?i:r),count:0,getMesh:()=>v.current,reset:()=>{x.clear();let e=v.current.material;e.opacity=0,e.alphaTest=0,E.count=0},update:(e=1)=>{let t=v.current.material;E.temporal?(t.opacity=Math.min(o,t.opacity+o/E.blend),t.alphaTest=Math.min(s,t.alphaTest+s/E.blend)):(t.opacity=o,t.alphaTest=s),y.current.visible=!0,x.prepare();for(let t=0;t<e;t++)E.lights.forEach(e=>e.update()),x.update(A,E.blend);y.current.visible=!1,x.finish()}}),[x,A,m,t,r,i,o,s]);return ez.useLayoutEffect(()=>{E.reset(),E.temporal||E.frames===1/0||E.update(E.blend)}),ez.useImperativeHandle(f,()=>E,[E]),(0,eL.C)(()=>{(E.temporal||E.frames===1/0)&&E.count<E.frames&&E.count<n&&(g(),E.update(),E.count++)}),ez.createElement("group",d,ez.createElement("group",{traverse:()=>null,ref:y},ez.createElement(gd.Provider,{value:E},e)),ez.createElement("mesh",{receiveShadow:!0,ref:v,scale:a,rotation:[-Math.PI/2,0,0]},ez.createElement("planeGeometry",null),ez.createElement("softShadowMaterial",{transparent:!0,depthWrite:!1,toneMapped:h,color:l,blend:c,map:x.progressiveLightMap2.texture})))}),gm=ez.forwardRef(({castShadow:e=!0,bias:t=.001,mapSize:r=512,size:n=5,near:i=.5,far:a=500,frames:o=1,position:s=[0,0,0],radius:l=1,amount:c=8,intensity:u=s_>=155?Math.PI:1,ambient:h=.5,...d},f)=>{let p=ez.useRef(null),m=new eQ.Vector3(...s).length(),A=ez.useContext(gd),g=ez.useCallback(()=>{let e;if(p.current)for(let t=0;t<p.current.children.length;t++)if(e=p.current.children[t],Math.random()>h)e.position.set(s[0]+eQ.MathUtils.randFloatSpread(l),s[1]+eQ.MathUtils.randFloatSpread(l),s[2]+eQ.MathUtils.randFloatSpread(l));else{let t=Math.acos(2*Math.random()-1)-Math.PI/2,r=2*Math.PI*Math.random();e.position.set(Math.cos(t)*Math.cos(r)*m,Math.abs(Math.cos(t)*Math.sin(r)*m),Math.sin(t)*m)}},[l,h,m,...s]),v=ez.useMemo(()=>({update:g}),[g]);return ez.useImperativeHandle(f,()=>v,[v]),ez.useLayoutEffect(()=>{var e;let t=p.current;return A&&(null==(e=A.lights)||e.set(t.uuid,v)),()=>{var e;null==A||null==(e=A.lights)||e.delete(t.uuid)}},[A,v]),ez.createElement("group",ee({ref:p},d),Array.from({length:c},(o,s)=>ez.createElement("directionalLight",{key:s,castShadow:e,"shadow-bias":t,"shadow-mapSize":[r,r],intensity:u/c},ez.createElement("orthographicCamera",{attach:"shadow-camera",args:[-n,n,n,-n,i,a]}))))});class gA{constructor(e,t,r=1024){this.renderer=e,this.res=r,this.scene=t,this.buffer1Active=!1,this.lights=[],this.meshes=[],this.object=null,this.clearColor=new eQ.Color,this.clearAlpha=0;let n={type:eQ.HalfFloatType,magFilter:eQ.NearestFilter,minFilter:eQ.NearestFilter};this.progressiveLightMap1=new eQ.WebGLRenderTarget(this.res,this.res,n),this.progressiveLightMap2=new eQ.WebGLRenderTarget(this.res,this.res,n),this.discardMat=new m4,this.targetMat=new eQ.MeshLambertMaterial({fog:!1}),this.previousShadowMap={value:this.progressiveLightMap1.texture},this.averagingWindow={value:100},this.targetMat.onBeforeCompile=e=>{e.vertexShader="varying vec2 vUv;\n"+e.vertexShader.slice(0,-1)+"vUv = uv; gl_Position = vec4((uv - 0.5) * 2.0, 1.0, 1.0); }";let t=e.fragmentShader.indexOf("void main() {");e.fragmentShader="varying vec2 vUv;\n"+e.fragmentShader.slice(0,t)+"uniform sampler2D previousShadowMap;\n	uniform float averagingWindow;\n"+e.fragmentShader.slice(t-1,-1)+`
vec3 texelOld = texture2D(previousShadowMap, vUv).rgb;
        gl_FragColor.rgb = mix(texelOld, gl_FragColor.rgb, 1.0/ averagingWindow);
      }`,e.uniforms.previousShadowMap=this.previousShadowMap,e.uniforms.averagingWindow=this.averagingWindow}}clear(){this.renderer.getClearColor(this.clearColor),this.clearAlpha=this.renderer.getClearAlpha(),this.renderer.setClearColor("black",1),this.renderer.setRenderTarget(this.progressiveLightMap1),this.renderer.clear(),this.renderer.setRenderTarget(this.progressiveLightMap2),this.renderer.clear(),this.renderer.setRenderTarget(null),this.renderer.setClearColor(this.clearColor,this.clearAlpha),this.lights=[],this.meshes=[],this.scene.traverse(e=>{e.geometry?this.meshes.push({object:e,material:e.material}):e.isLight&&this.lights.push({object:e,intensity:e.intensity})})}prepare(){this.lights.forEach(e=>e.object.intensity=0),this.meshes.forEach(e=>e.object.material=this.discardMat)}finish(){this.lights.forEach(e=>e.object.intensity=e.intensity),this.meshes.forEach(e=>e.object.material=e.material)}configure(e){this.object=e}update(e,t=100){if(!this.object)return;this.averagingWindow.value=t,this.object.material=this.targetMat;let r=this.buffer1Active?this.progressiveLightMap1:this.progressiveLightMap2,n=this.buffer1Active?this.progressiveLightMap2:this.progressiveLightMap1,i=this.scene.background;this.scene.background=null,this.renderer.setRenderTarget(r),this.previousShadowMap.value=n.texture,this.buffer1Active=!this.buffer1Active,this.renderer.render(this.scene,e),this.renderer.setRenderTarget(null),this.scene.background=i}}let gg={rembrandt:{main:[1,2,1],fill:[-2,-.5,-2]},portrait:{main:[-1,2,.5],fill:[-1,.5,-1.5]},upfront:{main:[0,2,1],fill:[-1,.5,-1.5]},soft:{main:[-2,4,4],fill:[-1,.5,-1.5]}};function gv({radius:e,adjustCamera:t}){let r=AF();return ez.useEffect(()=>{t&&r.refresh().clip().fit()},[e,t]),null}function gy({children:e,center:t,adjustCamera:r=!0,intensity:n=.5,shadows:i="contact",environment:a="city",preset:o="rembrandt",...s}){var l,c,u,h,d,f,p,m;let A="string"==typeof o?gg[o]:o,[{radius:g,height:v},y]=ez.useState({radius:0,width:0,height:0,depth:0}),x=null!==(l=null==i?void 0:i.bias)&&void 0!==l?l:-.0001,E=null!==(c=null==i?void 0:i.normalBias)&&void 0!==c?c:0,_=null!==(u=null==i?void 0:i.size)&&void 0!==u?u:1024,C=null!==(h=null==i?void 0:i.offset)&&void 0!==h?h:0,b="contact"===i||(null==i?void 0:i.type)==="contact",w="accumulative"===i||(null==i?void 0:i.type)==="accumulative",B={..."object"==typeof i?i:{}},I=a?"string"==typeof a?{preset:a}:a:null,M=ez.useCallback(e=>{let{width:r,height:n,depth:i,boundingSphere:a}=e;y({radius:a.radius,width:r,height:n,depth:i}),null!=t&&t.onCentered&&t.onCentered(e)},[]);return ez.createElement(ez.Fragment,null,ez.createElement("ambientLight",{intensity:n/3}),ez.createElement("spotLight",{penumbra:1,position:[A.main[0]*g,A.main[1]*g,A.main[2]*g],intensity:2*n,castShadow:!!i,"shadow-bias":x,"shadow-normalBias":E,"shadow-mapSize":_}),ez.createElement("pointLight",{position:[A.fill[0]*g,A.fill[1]*g,A.fill[2]*g],intensity:n}),ez.createElement(AR,ee({fit:!!r,clip:!!r,margin:Number(r),observe:!0},s),ez.createElement(gv,{radius:g,adjustCamera:r}),ez.createElement(ma,ee({},t,{position:[0,C/2,0],onCentered:M}),e)),ez.createElement("group",{position:[0,-v/2-C/2,0]},b&&ez.createElement(gh,ee({scale:4*g,far:g,blur:2},B)),w&&ez.createElement(gp,ee({temporal:!0,frames:100,alphaTest:.9,toneMapped:!0,scale:4*g},B),ez.createElement(gm,{amount:null!==(d=B.amount)&&void 0!==d?d:8,radius:null!==(f=B.radius)&&void 0!==f?f:g,ambient:null!==(p=B.ambient)&&void 0!==p?p:.5,intensity:null!==(m=B.intensity)&&void 0!==m?m:1,position:[A.main[0]*g,A.main[1]*g,A.main[2]*g],size:4*g,bias:-x,mapSize:_}))),a&&ez.createElement(gl,I))}let gx=e=>0===e?0:Math.pow(2,10*e-10);function gE({children:e,floor:t=.25,segments:r=20,receiveShadow:n,...i}){let a=ez.useRef(null);return ez.useLayoutEffect(()=>{let e=0,n=r/r/2,i=a.current.attributes.position;for(let a=0;a<r+1;a++)for(let o=0;o<r+1;o++)i.setXYZ(e++,a/r-n+(0===a?-t:0),o/r-n,gx(a/r));i.needsUpdate=!0,a.current.computeVertexNormals()},[r,t]),ez.createElement("group",i,ez.createElement("mesh",{receiveShadow:n,rotation:[-Math.PI/2,0,Math.PI/2]},ez.createElement("planeGeometry",{ref:a,args:[1,1,r,r]}),e))}let g_=ez.forwardRef(({fog:e=!1,renderOrder:t,depthWrite:r=!1,colorStop:n=0,color:i="black",opacity:a=.5,...o},s)=>{let l=ez.useMemo(()=>{let e=document.createElement("canvas");e.width=128,e.height=128;let t=e.getContext("2d"),r=t.createRadialGradient(e.width/2,e.height/2,0,e.width/2,e.height/2,e.width/2);return r.addColorStop(n,new eQ.Color(i).getStyle()),r.addColorStop(1,"rgba(0,0,0,0)"),t.fillStyle=r,t.fillRect(0,0,e.width,e.height),e},[i,n]);return ez.createElement("mesh",ee({renderOrder:t,ref:s,"rotation-x":-Math.PI/2},o),ez.createElement("planeGeometry",null),ez.createElement("meshBasicMaterial",{transparent:!0,opacity:a,fog:e,depthWrite:r,side:eQ.DoubleSide},ez.createElement("canvasTexture",{attach:"map",args:[l]})))});function gC(e=eQ.FrontSide){let t={value:new eQ.Matrix4};return Object.assign(new eQ.MeshNormalMaterial({side:e}),{viewMatrix:t,onBeforeCompile:e=>{e.uniforms.viewMatrix=t,e.fragmentShader=`vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
           return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
         }
`+e.fragmentShader.replace("#include <normal_fragment_maps>",`#include <normal_fragment_maps>
           normal = inverseTransformDirection( normal, viewMatrix );
`)}})}let gb=sv({causticsTexture:null,causticsTextureB:null,color:new eQ.Color,lightProjMatrix:new eQ.Matrix4,lightViewMatrix:new eQ.Matrix4},`varying vec3 vWorldPosition;
   void main() {
     gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.);
     vec4 worldPosition = modelMatrix * vec4(position, 1.);
     vWorldPosition = worldPosition.xyz;
   }`,`varying vec3 vWorldPosition;
  uniform vec3 color;
  uniform sampler2D causticsTexture;
  uniform sampler2D causticsTextureB;
  uniform mat4 lightProjMatrix;
  uniform mat4 lightViewMatrix;
   void main() {
    // Apply caustics
    vec4 lightSpacePos = lightProjMatrix * lightViewMatrix * vec4(vWorldPosition, 1.0);
    lightSpacePos.xyz /= lightSpacePos.w;
    lightSpacePos.xyz = lightSpacePos.xyz * 0.5 + 0.5;
    vec3 front = texture2D(causticsTexture, lightSpacePos.xy).rgb;
    vec3 back = texture2D(causticsTextureB, lightSpacePos.xy).rgb;
    gl_FragColor = vec4((front + back) * color, 1.0);
    #include <tonemapping_fragment>
    #include <${s_>=154?"colorspace_fragment":"encodings_fragment"}>
   }`),gw=sv({cameraMatrixWorld:new eQ.Matrix4,cameraProjectionMatrixInv:new eQ.Matrix4,normalTexture:null,depthTexture:null,lightDir:new eQ.Vector3(0,1,0),lightPlaneNormal:new eQ.Vector3(0,1,0),lightPlaneConstant:0,near:.1,far:100,modelMatrix:new eQ.Matrix4,worldRadius:1/40,ior:1.1,bounces:0,resolution:1024,size:10,intensity:.5},`
  varying vec2 vUv;
  void main() {
      vUv = uv;
      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
  }`,`
  uniform mat4 cameraMatrixWorld;
  uniform mat4 cameraProjectionMatrixInv;
  uniform vec3 lightDir;
  uniform vec3 lightPlaneNormal;
  uniform float lightPlaneConstant;
  uniform float near;
  uniform float far;
  uniform float time;
  uniform float worldRadius;
  uniform float resolution;
  uniform float size;
  uniform float intensity;
  uniform float ior;
  precision highp isampler2D;
  precision highp usampler2D;
  uniform sampler2D normalTexture;
  uniform sampler2D depthTexture;
  uniform float bounces;
  varying vec2 vUv;
  vec3 WorldPosFromDepth(float depth, vec2 coord) {
    float z = depth * 2.0 - 1.0;
    vec4 clipSpacePosition = vec4(coord * 2.0 - 1.0, z, 1.0);
    vec4 viewSpacePosition = cameraProjectionMatrixInv * clipSpacePosition;
    // Perspective division
    viewSpacePosition /= viewSpacePosition.w;
    vec4 worldSpacePosition = cameraMatrixWorld * viewSpacePosition;
    return worldSpacePosition.xyz;
  }
  float sdPlane( vec3 p, vec3 n, float h ) {
    // n must be normalized
    return dot(p,n) + h;
  }
  float planeIntersect( vec3 ro, vec3 rd, vec4 p ) {
    return -(dot(ro,p.xyz)+p.w)/dot(rd,p.xyz);
  }
  vec3 totalInternalReflection(vec3 ro, vec3 rd, vec3 pos, vec3 normal, float ior, out vec3 rayOrigin, out vec3 rayDirection) {
    rayOrigin = ro;
    rayDirection = rd;
    rayDirection = refract(rayDirection, normal, 1.0 / ior);
    rayOrigin = pos + rayDirection * 0.1;
    return rayDirection;
  }
  void main() {
    // Each sample consists of random offset in the x and y direction
    float caustic = 0.0;
    float causticTexelSize = (1.0 / resolution) * size * 2.0;
    float texelsNeeded = worldRadius / causticTexelSize;
    float sampleRadius = texelsNeeded / resolution;
    float sum = 0.0;
    if (texture2D(depthTexture, vUv).x == 1.0) {
      gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);
      return;
    }
    vec2 offset1 = vec2(-0.5, -0.5);//vec2(rand() - 0.5, rand() - 0.5);
    vec2 offset2 = vec2(-0.5, 0.5);//vec2(rand() - 0.5, rand() - 0.5);
    vec2 offset3 = vec2(0.5, 0.5);//vec2(rand() - 0.5, rand() - 0.5);
    vec2 offset4 = vec2(0.5, -0.5);//vec2(rand() - 0.5, rand() - 0.5);
    vec2 uv1 = vUv + offset1 * sampleRadius;
    vec2 uv2 = vUv + offset2 * sampleRadius;
    vec2 uv3 = vUv + offset3 * sampleRadius;
    vec2 uv4 = vUv + offset4 * sampleRadius;
    vec3 normal1 = texture2D(normalTexture, uv1, -10.0).rgb * 2.0 - 1.0;
    vec3 normal2 = texture2D(normalTexture, uv2, -10.0).rgb * 2.0 - 1.0;
    vec3 normal3 = texture2D(normalTexture, uv3, -10.0).rgb * 2.0 - 1.0;
    vec3 normal4 = texture2D(normalTexture, uv4, -10.0).rgb * 2.0 - 1.0;
    float depth1 = texture2D(depthTexture, uv1, -10.0).x;
    float depth2 = texture2D(depthTexture, uv2, -10.0).x;
    float depth3 = texture2D(depthTexture, uv3, -10.0).x;
    float depth4 = texture2D(depthTexture, uv4, -10.0).x;
    // Sanity check the depths
    if (depth1 == 1.0 || depth2 == 1.0 || depth3 == 1.0 || depth4 == 1.0) {
      gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);
      return;
    }
    vec3 pos1 = WorldPosFromDepth(depth1, uv1);
    vec3 pos2 = WorldPosFromDepth(depth2, uv2);
    vec3 pos3 = WorldPosFromDepth(depth3, uv3);
    vec3 pos4 = WorldPosFromDepth(depth4, uv4);
    vec3 originPos1 = WorldPosFromDepth(0.0, uv1);
    vec3 originPos2 = WorldPosFromDepth(0.0, uv2);
    vec3 originPos3 = WorldPosFromDepth(0.0, uv3);
    vec3 originPos4 = WorldPosFromDepth(0.0, uv4);
    vec3 endPos1, endPos2, endPos3, endPos4;
    vec3 endDir1, endDir2, endDir3, endDir4;
    totalInternalReflection(originPos1, lightDir, pos1, normal1, ior, endPos1, endDir1);
    totalInternalReflection(originPos2, lightDir, pos2, normal2, ior, endPos2, endDir2);
    totalInternalReflection(originPos3, lightDir, pos3, normal3, ior, endPos3, endDir3);
    totalInternalReflection(originPos4, lightDir, pos4, normal4, ior, endPos4, endDir4);
    float lightPosArea = length(cross(originPos2 - originPos1, originPos3 - originPos1)) + length(cross(originPos3 - originPos1, originPos4 - originPos1));
    float t1 = planeIntersect(endPos1, endDir1, vec4(lightPlaneNormal, lightPlaneConstant));
    float t2 = planeIntersect(endPos2, endDir2, vec4(lightPlaneNormal, lightPlaneConstant));
    float t3 = planeIntersect(endPos3, endDir3, vec4(lightPlaneNormal, lightPlaneConstant));
    float t4 = planeIntersect(endPos4, endDir4, vec4(lightPlaneNormal, lightPlaneConstant));
    vec3 finalPos1 = endPos1 + endDir1 * t1;
    vec3 finalPos2 = endPos2 + endDir2 * t2;
    vec3 finalPos3 = endPos3 + endDir3 * t3;
    vec3 finalPos4 = endPos4 + endDir4 * t4;
    float finalArea = length(cross(finalPos2 - finalPos1, finalPos3 - finalPos1)) + length(cross(finalPos3 - finalPos1, finalPos4 - finalPos1));
    caustic += intensity * (lightPosArea / finalArea);
    // Calculate the area of the triangle in light spaces
    gl_FragColor = vec4(vec3(max(caustic, 0.0)), 1.0);
  }`),gB={depth:!0,minFilter:eQ.LinearFilter,magFilter:eQ.LinearFilter,type:eQ.UnsignedByteType},gI={minFilter:eQ.LinearMipmapLinearFilter,magFilter:eQ.LinearFilter,type:eQ.FloatType,generateMipmaps:!0},gM=ez.forwardRef(({debug:e,children:t,frames:r=1,ior:n=1.1,color:i="white",causticsOnly:a=!1,backside:o=!1,backsideIOR:s=1.1,worldRadius:l=.3125,intensity:c=.05,resolution:u=2024,lightSource:h=[5,5,5],...d},f)=>{(0,eL.e)({CausticsProjectionMaterial:gb});let p=ez.useRef(null),m=ez.useRef(null),A=ez.useRef(null),g=ez.useRef(null),v=(0,eL.A)(e=>e.gl),y=dW(e&&m,eQ.CameraHelper),x=ca(u,u,gB),E=ca(u,u,gB),_=ca(u,u,gI),C=ca(u,u,gI),[b]=ez.useState(()=>gC()),[w]=ez.useState(()=>gC(eQ.BackSide)),[B]=ez.useState(()=>new gw),[I]=ez.useState(()=>new o5(B));ez.useLayoutEffect(()=>{p.current.updateWorldMatrix(!1,!0)});let M=0,S=new eQ.Vector3,T=new eQ.Frustum,P=new eQ.Matrix4,D=new eQ.Plane,R=new eQ.Vector3,F=new eQ.Vector3,z=new eQ.Box3,O=new eQ.Vector3,Q=[],L=[],k=[],U=[],N=new eQ.Vector3;for(let e=0;e<8;e++)Q.push(new eQ.Vector3),L.push(new eQ.Vector3),k.push(new eQ.Vector3),U.push(new eQ.Vector3);return(0,eL.C)(()=>{if(r===1/0||M++<r){var t,i;Array.isArray(h)?R.fromArray(h).normalize():R.copy(p.current.worldToLocal(h.current.getWorldPosition(S)).normalize()),F.copy(R).multiplyScalar(-1),null==(t=A.current.parent)||t.matrixWorld.identity(),z.setFromObject(A.current,!0),Q[0].set(z.min.x,z.min.y,z.min.z),Q[1].set(z.min.x,z.min.y,z.max.z),Q[2].set(z.min.x,z.max.y,z.min.z),Q[3].set(z.min.x,z.max.y,z.max.z),Q[4].set(z.max.x,z.min.y,z.min.z),Q[5].set(z.max.x,z.min.y,z.max.z),Q[6].set(z.max.x,z.max.y,z.min.z),Q[7].set(z.max.x,z.max.y,z.max.z);for(let e=0;e<8;e++)L[e].copy(Q[e]);z.getCenter(O),Q.map(e=>e.sub(O));let r=D.set(F,0);Q.map((e,t)=>r.projectPoint(e,k[t]));let d=k.reduce((e,t)=>e.add(t),S.set(0,0,0)).divideScalar(k.length),f=k.map(e=>e.distanceTo(d)).reduce((e,t)=>Math.max(e,t)),M=Q.map(e=>e.dot(R)).reduce((e,t)=>Math.max(e,t));m.current.position.copy(N.copy(R).multiplyScalar(M).add(O)),m.current.lookAt(A.current.localToWorld(O));let G=P.lookAt(m.current.position,O,S.set(0,1,0));m.current.left=-f,m.current.right=f,m.current.top=f,m.current.bottom=-f;let H=S.set(0,f,0).applyMatrix4(G),V=(m.current.position.y+H.y)/R.y;m.current.near=.1,m.current.far=V,m.current.updateProjectionMatrix(),m.current.updateMatrixWorld();let j=L.map((e,t)=>e.add(U[t].copy(R).multiplyScalar(-e.y/R.y))),Y=j.reduce((e,t)=>e.add(t),S.set(0,0,0)).divideScalar(j.length),J=2*j.map(e=>Math.hypot(e.x-Y.x,e.z-Y.z)).reduce((e,t)=>Math.max(e,t));g.current.scale.setScalar(J),g.current.position.copy(Y),e&&(null==(i=y.current)||i.update()),w.viewMatrix.value=b.viewMatrix.value=m.current.matrixWorldInverse;let W=T.setFromProjectionMatrix(P.multiplyMatrices(m.current.projectionMatrix,m.current.matrixWorldInverse)).planes[4];B.cameraMatrixWorld=m.current.matrixWorld,B.cameraProjectionMatrixInv=m.current.projectionMatrixInverse,B.lightDir=F,B.lightPlaneNormal=W.normal,B.lightPlaneConstant=W.constant,B.near=m.current.near,B.far=m.current.far,B.resolution=u,B.size=f,B.intensity=c,B.worldRadius=l,A.current.visible=!0,v.setRenderTarget(x),v.clear(),A.current.overrideMaterial=b,v.render(A.current,m.current),v.setRenderTarget(E),v.clear(),o&&(A.current.overrideMaterial=w,v.render(A.current,m.current)),A.current.overrideMaterial=null,B.ior=n,g.current.material.lightProjMatrix=m.current.projectionMatrix,g.current.material.lightViewMatrix=m.current.matrixWorldInverse,B.normalTexture=x.texture,B.depthTexture=x.depthTexture,v.setRenderTarget(_),v.clear(),I.render(v),B.ior=s,B.normalTexture=E.texture,B.depthTexture=E.depthTexture,v.setRenderTarget(C),v.clear(),o&&I.render(v),v.setRenderTarget(null),a&&(A.current.visible=!1)}}),ez.useImperativeHandle(f,()=>p.current,[]),ez.createElement("group",ee({ref:p},d),ez.createElement("scene",{ref:A},ez.createElement("orthographicCamera",{ref:m,up:[0,1,0]}),t),ez.createElement("mesh",{renderOrder:2,ref:g,"rotation-x":-Math.PI/2},ez.createElement("planeGeometry",null),ez.createElement("causticsProjectionMaterial",{transparent:!0,color:i,causticsTexture:_.texture,causticsTextureB:C.texture,blending:eQ.CustomBlending,blendSrc:eQ.OneFactor,blendDst:eQ.SrcAlphaFactor,depthWrite:!1}),e&&ez.createElement(sM,null,ez.createElement("lineBasicMaterial",{color:"#ffff00",toneMapped:!1}))))}),gS=ez.forwardRef(({mixBlur:e=0,mixStrength:t=.5,resolution:r=256,blur:n=[0,0],args:i=[1,1],minDepthThreshold:a=.9,maxDepthThreshold:o=1,depthScale:s=0,depthToBlurRatioBias:l=.25,mirror:c=0,children:u,debug:h=0,distortion:d=1,mixContrast:f=1,distortionMap:p,...m},A)=>{(0,eL.e)({MeshReflectorMaterial:mV}),ez.useEffect(()=>{console.warn("Reflector has been deprecated and will be removed next major. Replace it with <MeshReflectorMaterial />!")},[]);let g=(0,eL.A)(({gl:e})=>e),v=(0,eL.A)(({camera:e})=>e),y=(0,eL.A)(({scene:e})=>e),x=(n=Array.isArray(n)?n:[n,n])[0]+n[1]>0,E=ez.useRef(null);ez.useImperativeHandle(A,()=>E.current,[]);let[_]=ez.useState(()=>new eQ.Plane),[C]=ez.useState(()=>new eQ.Vector3),[b]=ez.useState(()=>new eQ.Vector3),[w]=ez.useState(()=>new eQ.Vector3),[B]=ez.useState(()=>new eQ.Matrix4),[I]=ez.useState(()=>new eQ.Vector3(0,0,-1)),[M]=ez.useState(()=>new eQ.Vector4),[S]=ez.useState(()=>new eQ.Vector3),[T]=ez.useState(()=>new eQ.Vector3),[P]=ez.useState(()=>new eQ.Vector4),[D]=ez.useState(()=>new eQ.Matrix4),[R]=ez.useState(()=>new eQ.PerspectiveCamera),F=ez.useCallback(()=>{if(b.setFromMatrixPosition(E.current.matrixWorld),w.setFromMatrixPosition(v.matrixWorld),B.extractRotation(E.current.matrixWorld),C.set(0,0,1),C.applyMatrix4(B),S.subVectors(b,w),S.dot(C)>0)return;S.reflect(C).negate(),S.add(b),B.extractRotation(v.matrixWorld),I.set(0,0,-1),I.applyMatrix4(B),I.add(w),T.subVectors(b,I),T.reflect(C).negate(),T.add(b),R.position.copy(S),R.up.set(0,1,0),R.up.applyMatrix4(B),R.up.reflect(C),R.lookAt(T),R.far=v.far,R.updateMatrixWorld(),R.projectionMatrix.copy(v.projectionMatrix),D.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),D.multiply(R.projectionMatrix),D.multiply(R.matrixWorldInverse),D.multiply(E.current.matrixWorld),_.setFromNormalAndCoplanarPoint(C,b),_.applyMatrix4(R.matrixWorldInverse),M.set(_.normal.x,_.normal.y,_.normal.z,_.constant);let e=R.projectionMatrix;P.x=(Math.sign(M.x)+e.elements[8])/e.elements[0],P.y=(Math.sign(M.y)+e.elements[9])/e.elements[5],P.z=-1,P.w=(1+e.elements[10])/e.elements[14],M.multiplyScalar(2/M.dot(P)),e.elements[2]=M.x,e.elements[6]=M.y,e.elements[10]=M.z+1,e.elements[14]=M.w},[]),[z,O,Q,L]=ez.useMemo(()=>{let i={type:eQ.HalfFloatType,minFilter:eQ.LinearFilter,magFilter:eQ.LinearFilter},u=new eQ.WebGLRenderTarget(r,r,i);u.depthBuffer=!0,u.depthTexture=new eQ.DepthTexture(r,r),u.depthTexture.format=eQ.DepthFormat,u.depthTexture.type=eQ.UnsignedShortType;let m=new eQ.WebGLRenderTarget(r,r,i),A=new mH({gl:g,resolution:r,width:n[0],height:n[1],minDepthThreshold:a,maxDepthThreshold:o,depthScale:s,depthToBlurRatioBias:l}),v={mirror:c,textureMatrix:D,mixBlur:e,tDiffuse:u.texture,tDepth:u.depthTexture,tDiffuseBlur:m.texture,hasBlur:x,mixStrength:t,minDepthThreshold:a,maxDepthThreshold:o,depthScale:s,depthToBlurRatioBias:l,transparent:!0,debug:h,distortion:d,distortionMap:p,mixContrast:f,"defines-USE_BLUR":x?"":void 0,"defines-USE_DEPTH":s>0?"":void 0,"defines-USE_DISTORTION":p?"":void 0};return[u,m,A,v]},[g,n,D,r,c,x,e,t,a,o,s,l,h,d,p,f]);return(0,eL.C)(()=>{if(!(null!=E&&E.current))return;E.current.visible=!1;let e=g.xr.enabled,t=g.shadowMap.autoUpdate;F(),g.xr.enabled=!1,g.shadowMap.autoUpdate=!1,g.setRenderTarget(z),g.state.buffers.depth.setMask(!0),g.autoClear||g.clear(),g.render(y,R),x&&Q.render(g,z,O),g.xr.enabled=e,g.shadowMap.autoUpdate=t,E.current.visible=!0,g.setRenderTarget(null)}),ez.createElement("mesh",ee({ref:E},m),ez.createElement("planeGeometry",{args:i}),u?u("meshReflectorMaterial",L):ez.createElement("meshReflectorMaterial",L))});class gT extends eQ.ShaderMaterial{constructor(){super({uniforms:{depth:{value:null},opacity:{value:1},attenuation:{value:2.5},anglePower:{value:12},spotPosition:{value:new eQ.Vector3(0,0,0)},lightColor:{value:new eQ.Color("white")},cameraNear:{value:0},cameraFar:{value:1},resolution:{value:new eQ.Vector2(0,0)}},transparent:!0,depthWrite:!1,vertexShader:`
        varying vec3 vNormal;
        varying float vViewZ;
        varying float vIntensity;
        uniform vec3 spotPosition;
        uniform float attenuation;

        #include <common>
        #include <logdepthbuf_pars_vertex>

        void main() {
          // compute intensity
          vNormal = normalize(normalMatrix * normal);
          vec4 worldPosition = modelMatrix * vec4(position, 1);
          vec4 viewPosition = viewMatrix * worldPosition;
          vViewZ = viewPosition.z;

          vIntensity = 1.0 - saturate(distance(worldPosition.xyz, spotPosition) / attenuation);

          gl_Position = projectionMatrix * viewPosition;

          #include <logdepthbuf_vertex>
        }
      `,fragmentShader:`
        varying vec3 vNormal;
        varying float vViewZ;
        varying float vIntensity;

        uniform vec3 lightColor;
        uniform float anglePower;
        uniform sampler2D depth;
        uniform vec2 resolution;
        uniform float cameraNear;
        uniform float cameraFar;
        uniform float opacity;

        #include <packing>
        #include <logdepthbuf_pars_fragment>

        float readDepth(sampler2D depthSampler, vec2 uv) {
          float fragCoordZ = texture(depthSampler, uv).r;

          // https://github.com/mrdoob/three.js/issues/23072
          #ifdef USE_LOGDEPTHBUF
            float viewZ = 1.0 - exp2(fragCoordZ * log(cameraFar + 1.0) / log(2.0));
          #else
            float viewZ = perspectiveDepthToViewZ(fragCoordZ, cameraNear, cameraFar);
          #endif

          return viewZ;
        }

        void main() {
          #include <logdepthbuf_fragment>

          vec3 normal = vec3(vNormal.x, vNormal.y, abs(vNormal.z));
          float angleIntensity = pow(dot(normal, vec3(0, 0, 1)), anglePower);
          float intensity = vIntensity * angleIntensity;

          // fades when z is close to sampled depth, meaning the cone is intersecting existing geometry
          bool isSoft = resolution[0] > 0.0 && resolution[1] > 0.0;
          if (isSoft) {
            vec2 uv = gl_FragCoord.xy / resolution;
            intensity *= smoothstep(0.0, 1.0, vViewZ - readDepth(depth, uv));
          }

          gl_FragColor = vec4(lightColor, intensity * opacity);

          #include <tonemapping_fragment>
          #include <${s_>=154?"colorspace_fragment":"encodings_fragment"}>
        }
      `})}}let gP=e=>null==e?void 0:e.isSpotLight;function gD({opacity:e=1,radiusTop:t,radiusBottom:r,depthBuffer:n,color:i="white",distance:a=5,angle:o=.15,attenuation:s=5,anglePower:l=5}){let c=ez.useRef(null),u=(0,eL.A)(e=>e.size),h=(0,eL.A)(e=>e.camera),d=(0,eL.A)(e=>e.viewport.dpr),[f]=ez.useState(()=>new gT),[p]=ez.useState(()=>new eQ.Vector3);t=void 0===t?.1:t,r=void 0===r?7*o:r,(0,eL.C)(()=>{f.uniforms.spotPosition.value.copy(c.current.getWorldPosition(p)),c.current.lookAt(c.current.parent.target.getWorldPosition(p))});let m=ez.useMemo(()=>{let e=new eQ.CylinderGeometry(t,r,a,128,64,!0);return e.applyMatrix4(new eQ.Matrix4().makeTranslation(0,-a/2,0)),e.applyMatrix4(new eQ.Matrix4().makeRotationX(-Math.PI/2)),e},[a,t,r]);return ez.createElement(ez.Fragment,null,ez.createElement("mesh",{ref:c,geometry:m,raycast:()=>null},ez.createElement("primitive",{object:f,attach:"material","uniforms-opacity-value":e,"uniforms-lightColor-value":i,"uniforms-attenuation-value":s,"uniforms-anglePower-value":l,"uniforms-depth-value":n,"uniforms-cameraNear-value":h.near,"uniforms-cameraFar-value":h.far,"uniforms-resolution-value":n?[u.width*d,u.height*d]:[0,0]})))}function gR(e,t,r,n,i){let[[a,o]]=ez.useState(()=>[new eQ.Vector3,new eQ.Vector3]);ez.useLayoutEffect(()=>{if(gP(e.current))e.current.shadow.mapSize.set(r,n),e.current.shadow.needsUpdate=!0;else throw Error("SpotlightShadow must be a child of a SpotLight")},[e,r,n]),(0,eL.C)(()=>{if(!e.current)return;let r=e.current.position,n=e.current.target.position;o.copy(n).sub(r);var s=o.length();o.normalize().multiplyScalar(s*i),a.copy(r).add(o),t.current.position.copy(a),t.current.lookAt(e.current.target.position)})}function gF({distance:e=.4,alphaTest:t=.5,map:r,shader:n="#define GLSLIFY 1\nvarying vec2 vUv;uniform sampler2D uShadowMap;uniform float uTime;void main(){vec3 color=texture2D(uShadowMap,vUv).xyz;gl_FragColor=vec4(color,1.);}",width:i=512,height:a=512,scale:o=1,children:s,...l}){let c=ez.useRef(null),u=l.spotlightRef,h=l.debug;gR(u,c,i,a,e);let d=ez.useMemo(()=>new eQ.WebGLRenderTarget(i,a,{format:eQ.RGBAFormat,stencilBuffer:!1}),[i,a]),f=ez.useRef({uShadowMap:{value:r},uTime:{value:0}});ez.useEffect(()=>void(f.current.uShadowMap.value=r),[r]);let p=ez.useMemo(()=>new o5(new eQ.ShaderMaterial({uniforms:f.current,vertexShader:`
          varying vec2 vUv;

          void main() {
            vUv = uv;
            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
          }
          `,fragmentShader:n})),[n]);return ez.useEffect(()=>()=>{p.material.dispose(),p.dispose()},[p]),ez.useEffect(()=>()=>d.dispose(),[d]),(0,eL.C)(({gl:e},t)=>{f.current.uTime.value+=t,e.setRenderTarget(d),p.render(e),e.setRenderTarget(null)}),ez.createElement(ez.Fragment,null,ez.createElement("mesh",{ref:c,scale:o,castShadow:!0},ez.createElement("planeGeometry",null),ez.createElement("meshBasicMaterial",{transparent:!0,side:eQ.DoubleSide,alphaTest:t,alphaMap:d.texture,"alphaMap-wrapS":eQ.RepeatWrapping,"alphaMap-wrapT":eQ.RepeatWrapping,opacity:h?1:0},s)))}function gz({distance:e=.4,alphaTest:t=.5,map:r,width:n=512,height:i=512,scale:a,children:o,...s}){let l=ez.useRef(null),c=s.spotlightRef,u=s.debug;return gR(c,l,n,i,e),ez.createElement(ez.Fragment,null,ez.createElement("mesh",{ref:l,scale:a,castShadow:!0},ez.createElement("planeGeometry",null),ez.createElement("meshBasicMaterial",{transparent:!0,side:eQ.DoubleSide,alphaTest:t,alphaMap:r,"alphaMap-wrapS":eQ.RepeatWrapping,"alphaMap-wrapT":eQ.RepeatWrapping,opacity:u?1:0},o)))}function gO(e){return e.shader?ez.createElement(gF,e):ez.createElement(gz,e)}let gQ=ez.forwardRef(({opacity:e=1,radiusTop:t,radiusBottom:r,depthBuffer:n,color:i="white",distance:a=5,angle:o=.15,attenuation:s=5,anglePower:l=5,volumetric:c=!0,debug:u=!1,children:h,...d},f)=>{let p=ez.useRef(null);return ez.useImperativeHandle(f,()=>p.current,[]),ez.createElement("group",null,u&&p.current&&ez.createElement("spotLightHelper",{args:[p.current]}),ez.createElement("spotLight",ee({ref:p,angle:o,color:i,distance:a,castShadow:!0},d),c&&ez.createElement(gD,{debug:u,opacity:e,radiusTop:t,radiusBottom:r,depthBuffer:n,color:i,distance:a,angle:o,attenuation:s,anglePower:l})),h&&ez.cloneElement(h,{spotlightRef:p,debug:u}))}),gL=ez.forwardRef(({args:e,map:t,toneMapped:r=!1,color:n="white",form:i="rect",intensity:a=1,scale:o=1,target:s,children:l,...c},u)=>{let h=ez.useRef(null);return ez.useImperativeHandle(u,()=>h.current,[]),ez.useLayoutEffect(()=>{l||c.material||((0,eL.j)(h.current.material,{color:n}),h.current.material.color.multiplyScalar(a))},[n,a,l,c.material]),ez.useLayoutEffect(()=>{s&&h.current.lookAt(Array.isArray(s)?new eQ.Vector3(...s):s)},[s]),o=Array.isArray(o)&&2===o.length?[o[0],o[1],1]:o,ez.createElement("mesh",ee({ref:h,scale:o},c),"circle"===i?ez.createElement("ringGeometry",{args:[0,1,64]}):"ring"===i?ez.createElement("ringGeometry",{args:[.5,1,64]}):"rect"===i?ez.createElement("planeGeometry",null):ez.createElement(i,{args:e}),l||(c.material?null:ez.createElement("meshBasicMaterial",{toneMapped:r,map:t,side:eQ.DoubleSide})))});var gk=Object.defineProperty,gU=(e,t,r)=>t in e?gk(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,gN=(e,t,r)=>(gU(e,"symbol"!=typeof t?t+"":t,r),r);let gG={uniforms:{turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new eQ.Vector3},up:{value:new eQ.Vector3(0,1,0)}},vertexShader:`
      uniform vec3 sunPosition;
      uniform float rayleigh;
      uniform float turbidity;
      uniform float mieCoefficient;
      uniform vec3 up;

      varying vec3 vWorldPosition;
      varying vec3 vSunDirection;
      varying float vSunfade;
      varying vec3 vBetaR;
      varying vec3 vBetaM;
      varying float vSunE;

      // constants for atmospheric scattering
      const float e = 2.71828182845904523536028747135266249775724709369995957;
      const float pi = 3.141592653589793238462643383279502884197169;

      // wavelength of used primaries, according to preetham
      const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );
      // this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:
      // (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))
      const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );

      // mie stuff
      // K coefficient for the primaries
      const float v = 4.0;
      const vec3 K = vec3( 0.686, 0.678, 0.666 );
      // MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K
      const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );

      // earth shadow hack
      // cutoffAngle = pi / 1.95;
      const float cutoffAngle = 1.6110731556870734;
      const float steepness = 1.5;
      const float EE = 1000.0;

      float sunIntensity( float zenithAngleCos ) {
        zenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );
        return EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );
      }

      vec3 totalMie( float T ) {
        float c = ( 0.2 * T ) * 10E-18;
        return 0.434 * c * MieConst;
      }

      void main() {

        vec4 worldPosition = modelMatrix * vec4( position, 1.0 );
        vWorldPosition = worldPosition.xyz;

        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        gl_Position.z = gl_Position.w; // set z to camera.far

        vSunDirection = normalize( sunPosition );

        vSunE = sunIntensity( dot( vSunDirection, up ) );

        vSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );

        float rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );

      // extinction (absorbtion + out scattering)
      // rayleigh coefficients
        vBetaR = totalRayleigh * rayleighCoefficient;

      // mie coefficients
        vBetaM = totalMie( turbidity ) * mieCoefficient;

      }
    `,fragmentShader:`
      varying vec3 vWorldPosition;
      varying vec3 vSunDirection;
      varying float vSunfade;
      varying vec3 vBetaR;
      varying vec3 vBetaM;
      varying float vSunE;

      uniform float mieDirectionalG;
      uniform vec3 up;

      const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );

      // constants for atmospheric scattering
      const float pi = 3.141592653589793238462643383279502884197169;

      const float n = 1.0003; // refractive index of air
      const float N = 2.545E25; // number of molecules per unit volume for air at 288.15K and 1013mb (sea level -45 celsius)

      // optical length at zenith for molecules
      const float rayleighZenithLength = 8.4E3;
      const float mieZenithLength = 1.25E3;
      // 66 arc seconds -> degrees, and the cosine of that
      const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;

      // 3.0 / ( 16.0 * pi )
      const float THREE_OVER_SIXTEENPI = 0.05968310365946075;
      // 1.0 / ( 4.0 * pi )
      const float ONE_OVER_FOURPI = 0.07957747154594767;

      float rayleighPhase( float cosTheta ) {
        return THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );
      }

      float hgPhase( float cosTheta, float g ) {
        float g2 = pow( g, 2.0 );
        float inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );
        return ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );
      }

      void main() {

        vec3 direction = normalize( vWorldPosition - cameraPos );

      // optical length
      // cutoff angle at 90 to avoid singularity in next formula.
        float zenithAngle = acos( max( 0.0, dot( up, direction ) ) );
        float inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );
        float sR = rayleighZenithLength * inverse;
        float sM = mieZenithLength * inverse;

      // combined extinction factor
        vec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );

      // in scattering
        float cosTheta = dot( direction, vSunDirection );

        float rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );
        vec3 betaRTheta = vBetaR * rPhase;

        float mPhase = hgPhase( cosTheta, mieDirectionalG );
        vec3 betaMTheta = vBetaM * mPhase;

        vec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );
        Lin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );

      // nightsky
        float theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]
        float phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]
        vec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );
        vec3 L0 = vec3( 0.1 ) * Fex;

      // composition + solar disc
        float sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );
        L0 += ( vSunE * 19000.0 * Fex ) * sundisk;

        vec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );

        vec3 retColor = pow( texColor, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );

        gl_FragColor = vec4( retColor, 1.0 );

      #include <tonemapping_fragment>
      #include <${la>=154?"colorspace_fragment":"encodings_fragment"}>

      }
    `},gH=new eQ.ShaderMaterial({name:"SkyShader",fragmentShader:gG.fragmentShader,vertexShader:gG.vertexShader,uniforms:eQ.UniformsUtils.clone(gG.uniforms),side:eQ.BackSide,depthWrite:!1});class gV extends eQ.Mesh{constructor(){super(new eQ.BoxGeometry(1,1,1),gH)}}function gj(e,t,r=new eQ.Vector3){let n=2*Math.PI*(t-.5);return r.x=Math.cos(n),r.y=Math.sin(Math.PI*(e-.5)),r.z=Math.sin(n),r}gN(gV,"SkyShader",gG),gN(gV,"material",gH);let gY=ez.forwardRef(({inclination:e=.6,azimuth:t=.1,distance:r=1e3,mieCoefficient:n=.005,mieDirectionalG:i=.8,rayleigh:a=.5,turbidity:o=10,sunPosition:s=gj(e,t),...l},c)=>{let u=ez.useMemo(()=>new eQ.Vector3().setScalar(r),[r]),[h]=ez.useState(()=>new gV);return ez.createElement("primitive",ee({object:h,ref:c,"material-uniforms-mieCoefficient-value":n,"material-uniforms-mieDirectionalG-value":i,"material-uniforms-rayleigh-value":a,"material-uniforms-sunPosition-value":s,"material-uniforms-turbidity-value":o,scale:u},l))});class gJ extends eQ.ShaderMaterial{constructor(){super({uniforms:{time:{value:0},fade:{value:1}},vertexShader:`
      uniform float time;
      attribute float size;
      varying vec3 vColor;
      void main() {
        vColor = color;
        vec4 mvPosition = modelViewMatrix * vec4(position, 0.5);
        gl_PointSize = size * (30.0 / -mvPosition.z) * (3.0 + sin(time + 100.0));
        gl_Position = projectionMatrix * mvPosition;
      }`,fragmentShader:`
      uniform sampler2D pointTexture;
      uniform float fade;
      varying vec3 vColor;
      void main() {
        float opacity = 1.0;
        if (fade == 1.0) {
          float d = distance(gl_PointCoord, vec2(0.5, 0.5));
          opacity = 1.0 / (1.0 + exp(16.0 * (d - 0.25)));
        }
        gl_FragColor = vec4(vColor, opacity);

        #include <tonemapping_fragment>
	      #include <${s_>=154?"colorspace_fragment":"encodings_fragment"}>
      }`})}}let gW=e=>new eQ.Vector3().setFromSpherical(new eQ.Spherical(e,Math.acos(1-2*Math.random()),2*Math.random()*Math.PI)),gq=ez.forwardRef(({radius:e=100,depth:t=50,count:r=5e3,saturation:n=0,factor:i=4,fade:a=!1,speed:o=1},s)=>{let l=ez.useRef(),[c,u,h]=ez.useMemo(()=>{let a=[],o=[],s=Array.from({length:r},()=>(.5+.5*Math.random())*i),l=new eQ.Color,c=e+t,u=t/r;for(let e=0;e<r;e++)c-=u*Math.random(),a.push(...gW(c).toArray()),l.setHSL(e/r,n,.9),o.push(l.r,l.g,l.b);return[new Float32Array(a),new Float32Array(o),new Float32Array(s)]},[r,t,i,e,n]);(0,eL.C)(e=>l.current&&(l.current.uniforms.time.value=e.clock.getElapsedTime()*o));let[d]=ez.useState(()=>new gJ);return ez.createElement("points",{ref:s},ez.createElement("bufferGeometry",null,ez.createElement("bufferAttribute",{attach:"attributes-position",args:[c,3]}),ez.createElement("bufferAttribute",{attach:"attributes-color",args:[u,3]}),ez.createElement("bufferAttribute",{attach:"attributes-size",args:[h,1]})),ez.createElement("primitive",{ref:l,object:d,attach:"material",blending:eQ.AdditiveBlending,"uniforms-fade-value":a,depthWrite:!1,transparent:!0,vertexColors:!0}))});var gK={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let gX=new Uint8Array(16),gZ=[];for(let e=0;e<256;++e)gZ.push((e+256).toString(16).slice(1));var g$=function(e,t,r){if(gK.randomUUID&&!t&&!e)return gK.randomUUID();let n=(e=e||{}).random||(e.rng||function(){if(!q&&!(q="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return q(gX)})();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=n[e];return t}return function(e,t=0){return gZ[e[t+0]]+gZ[e[t+1]]+gZ[e[t+2]]+gZ[e[t+3]]+"-"+gZ[e[t+4]]+gZ[e[t+5]]+"-"+gZ[e[t+6]]+gZ[e[t+7]]+"-"+gZ[e[t+8]]+gZ[e[t+9]]+"-"+gZ[e[t+10]]+gZ[e[t+11]]+gZ[e[t+12]]+gZ[e[t+13]]+gZ[e[t+14]]+gZ[e[t+15]]}(n)};let g0="https://rawcdn.githack.com/pmndrs/drei-assets/9225a9f1fbd449d9411125c2f419b843d0308c9f/cloud.png",g1=new eQ.Matrix4,g2=new eQ.Vector3,g3=new eQ.Quaternion,g4=new eQ.Vector3,g5=new eQ.Quaternion,g6=new eQ.Vector3,g8=ez.createContext(null),g9=ez.forwardRef(({children:e,material:t=eQ.MeshLambertMaterial,texture:r=g0,range:n,limit:i=200,frustumCulled:a,...o},s)=>{var l,c;let u;let h=ez.useMemo(()=>class extends t{constructor(){super();let e=parseInt(eQ.REVISION.replace(/\D+/g,""))>=154?"opaque_fragment":"output_fragment";this.onBeforeCompile=t=>{t.vertexShader=`attribute float opacity;
               varying float vOpacity;
              `+t.vertexShader.replace("#include <fog_vertex>",`#include <fog_vertex>
                 vOpacity = opacity;
                `),t.fragmentShader=`varying float vOpacity;
              `+t.fragmentShader.replace(`#include <${e}>`,`#include <${e}>
                 gl_FragColor = vec4(outgoingLight, diffuseColor.a * vOpacity);
                `)}}},[t]);(0,eL.e)({CloudMaterial:h});let d=ez.useRef(null),f=ez.useRef([]),p=ez.useMemo(()=>new Float32Array(Array.from({length:i},()=>1)),[i]),m=ez.useMemo(()=>new Float32Array(Array.from({length:i},()=>[1,1,1]).flat()),[i]),A=sx(r),g=0,v=0,y=new eQ.Quaternion,x=new eQ.Vector3(0,0,1),E=new eQ.Vector3;(0,eL.C)((e,t)=>{for(g=e.clock.getElapsedTime(),g1.copy(d.current.matrixWorld).invert(),e.camera.matrixWorld.decompose(g4,g5,g6),v=0;v<f.current.length;v++)(u=f.current[v]).ref.current.matrixWorld.decompose(g2,g3,g6),g2.add(E.copy(u.position).applyQuaternion(g3).multiply(g6)),g3.copy(g5).multiply(y.setFromAxisAngle(x,u.rotation+=t*u.rotationFactor)),g6.multiplyScalar(u.volume+(1+Math.sin(g*u.density*u.speed))/2*u.growth),u.matrix.compose(g2,g3,g6).premultiply(g1),u.dist=g2.distanceTo(g4);for(f.current.sort((e,t)=>t.dist-e.dist),v=0;v<f.current.length;v++)u=f.current[v],p[v]=u.opacity*(u.dist<u.fade-1?u.dist/u.fade:1),d.current.setMatrixAt(v,u.matrix),d.current.setColorAt(v,u.color);d.current.geometry.attributes.opacity.needsUpdate=!0,d.current.instanceMatrix.needsUpdate=!0,d.current.instanceColor&&(d.current.instanceColor.needsUpdate=!0)}),ez.useLayoutEffect(()=>{let e=Math.min(i,void 0!==n?n:i,f.current.length);d.current.count=e,mu(d.current.instanceMatrix,{offset:0,count:16*e}),d.current.instanceColor&&mu(d.current.instanceColor,{offset:0,count:3*e}),mu(d.current.geometry.attributes.opacity,{offset:0,count:e})});let _=[null!==(l=A.image.width)&&void 0!==l?l:1,null!==(c=A.image.height)&&void 0!==c?c:1],C=Math.max(_[0],_[1]);return _=[_[0]/C,_[1]/C],ez.createElement("group",ee({ref:s},o),ez.createElement(g8.Provider,{value:f},e,ez.createElement("instancedMesh",{matrixAutoUpdate:!1,ref:d,args:[null,null,i],frustumCulled:a},ez.createElement("instancedBufferAttribute",{usage:eQ.DynamicDrawUsage,attach:"instanceColor",args:[m,3]}),ez.createElement("planeGeometry",{args:[..._]},ez.createElement("instancedBufferAttribute",{usage:eQ.DynamicDrawUsage,attach:"attributes-opacity",args:[p,1]})),ez.createElement("cloudMaterial",{key:t.name,map:A,transparent:!0,depthWrite:!1}))))}),g7=ez.forwardRef(({opacity:e=1,speed:t=0,bounds:r=[5,1,1],segments:n=20,color:i="#ffffff",fade:a=10,volume:o=6,smallestVolume:s=.25,distribute:l=null,growth:c=4,concentrate:u="inside",seed:h=Math.random(),...d},f)=>{function p(){let e=1e4*Math.sin(h++);return e-Math.floor(e)}let m=ez.useContext(g8),A=ez.useRef(null),[g]=ez.useState(()=>g$()),v=ez.useMemo(()=>[...Array(n)].map((e,t)=>({segments:n,bounds:new eQ.Vector3(1,1,1),position:new eQ.Vector3,uuid:g,index:t,ref:A,dist:0,matrix:new eQ.Matrix4,color:new eQ.Color,rotation:Math.PI/n*t})),[n,g]);return ez.useLayoutEffect(()=>{v.forEach((h,d)=>{var f;(0,eL.j)(h,{volume:o,color:i,speed:t,growth:c,opacity:e,fade:a,bounds:r,density:Math.max(.5,p()),rotationFactor:Math.max(.2,.5*p())*t});let m=null==l?void 0:l(h,d);(m||n>1)&&h.position.copy(h.bounds).multiply(null!==(f=null==m?void 0:m.point)&&void 0!==f?f:{x:2*p()-1,y:2*p()-1,z:2*p()-1});let A=Math.abs(h.position.x),g=Math.abs(h.position.y),v=Math.abs(h.position.z),y=Math.max(A,g,v);h.length=1,A===y&&(h.length-=A/h.bounds.x),g===y&&(h.length-=g/h.bounds.y),v===y&&(h.length-=v/h.bounds.z),h.volume=((null==m?void 0:m.volume)!==void 0?m.volume:Math.max(Math.max(0,s),"random"===u?p():"inside"===u?h.length:1-h.length))*o})},[u,r,a,i,e,c,o,h,n,t]),ez.useLayoutEffect(()=>(m.current=[...m.current,...v],()=>{m.current=m.current.filter(e=>e.uuid!==g)}),[v]),ez.useImperativeHandle(f,()=>A.current,[]),ez.createElement("group",ee({ref:A},d))}),ve=ez.forwardRef((e,t)=>ez.useContext(g8)?ez.createElement(g7,ee({ref:t},e)):ez.createElement(g9,null,ez.createElement(g7,ee({ref:t},e)))),vt=sv({time:0,pixelRatio:1},` uniform float pixelRatio;
    uniform float time;
    attribute float size;  
    attribute float speed;  
    attribute float opacity;
    attribute vec3 noise;
    attribute vec3 color;
    varying vec3 vColor;
    varying float vOpacity;
    void main() {
      vec4 modelPosition = modelMatrix * vec4(position, 1.0);
      modelPosition.y += sin(time * speed + modelPosition.x * noise.x * 100.0) * 0.2;
      modelPosition.z += cos(time * speed + modelPosition.x * noise.y * 100.0) * 0.2;
      modelPosition.x += cos(time * speed + modelPosition.x * noise.z * 100.0) * 0.2;
      vec4 viewPosition = viewMatrix * modelPosition;
      vec4 projectionPostion = projectionMatrix * viewPosition;
      gl_Position = projectionPostion;
      gl_PointSize = size * 25. * pixelRatio;
      gl_PointSize *= (1.0 / - viewPosition.z);
      vColor = color;
      vOpacity = opacity;
    }`,` varying vec3 vColor;
    varying float vOpacity;
    void main() {
      float distanceToCenter = distance(gl_PointCoord, vec2(0.5));
      float strength = 0.05 / distanceToCenter - 0.1;
      gl_FragColor = vec4(vColor, strength * vOpacity);
      #include <tonemapping_fragment>
      #include <${s_>=154?"colorspace_fragment":"encodings_fragment"}>
    }`),vr=e=>e&&e.constructor===Float32Array,vn=e=>[e.r,e.g,e.b],vi=e=>e instanceof eQ.Vector2||e instanceof eQ.Vector3||e instanceof eQ.Vector4,va=e=>Array.isArray(e)?e:vi(e)?e.toArray():[e,e,e];function vo(e,t,r){return ez.useMemo(()=>{if(void 0!==t){if(vr(t))return t;if(t instanceof eQ.Color){let r=Array.from({length:3*e},()=>vn(t)).flat();return Float32Array.from(r)}if(vi(t)||Array.isArray(t)){let r=Array.from({length:3*e},()=>va(t)).flat();return Float32Array.from(r)}return Float32Array.from({length:e},()=>t)}return Float32Array.from({length:e},r)},[t])}let vs=ez.forwardRef(({noise:e=1,count:t=100,speed:r=1,opacity:n=1,scale:i=1,size:a,color:o,children:s,...l},c)=>{ez.useMemo(()=>(0,eL.e)({SparklesImplMaterial:vt}),[]);let u=ez.useRef(null),h=(0,eL.A)(e=>e.viewport.dpr),d=va(i),f=ez.useMemo(()=>Float32Array.from(Array.from({length:t},()=>d.map(eQ.MathUtils.randFloatSpread)).flat()),[t,...d]),p=vo(t,a,Math.random),m=vo(t,n),A=vo(t,r),g=vo(3*t,e),v=vo(void 0===o?3*t:t,vr(o)?o:new eQ.Color(o),()=>1);return(0,eL.C)(e=>{u.current&&u.current.material&&(u.current.material.time=e.clock.elapsedTime)}),ez.useImperativeHandle(c,()=>u.current,[]),ez.createElement("points",ee({key:`particle-${t}-${JSON.stringify(i)}`},l,{ref:u}),ez.createElement("bufferGeometry",null,ez.createElement("bufferAttribute",{attach:"attributes-position",args:[f,3]}),ez.createElement("bufferAttribute",{attach:"attributes-size",args:[p,1]}),ez.createElement("bufferAttribute",{attach:"attributes-opacity",args:[m,1]}),ez.createElement("bufferAttribute",{attach:"attributes-speed",args:[A,1]}),ez.createElement("bufferAttribute",{attach:"attributes-color",args:[v,3]}),ez.createElement("bufferAttribute",{attach:"attributes-noise",args:[g,3]})),s||ez.createElement("sparklesImplMaterial",{transparent:!0,pixelRatio:h,depthWrite:!1}))});function vl(e=0,t=1024,r){let n=(0,oQ.Rq)(()=>fetch("https://cdn.jsdelivr.net/gh/pmndrs/drei-assets@master/matcaps.json").then(e=>e.json()),["matcapList"]),i=n[0],a=ez.useMemo(()=>Object.keys(n).length,[]),o=ez.useMemo(()=>"string"==typeof e?e:"number"==typeof e?n[e]:null,[e]),s=`${o||i}${function(e){switch(e){case 64:return"-64px";case 128:return"-128px";case 256:return"-256px";case 512:return"-512px";default:return""}}(t)}.png`,l=`https://rawcdn.githack.com/emmelleppi/matcaps/9b36ccaaf0a24881a39062d05566c9e92be4aa0d/${t}/${s}`;return[sx(l,r),l,a]}let vc=({children:e,id:t,format:r,onLoad:n})=>{let i=vl(t,r,n);return ez.createElement(ez.Fragment,null,null==e?void 0:e(i))};function vu(e=0,t={},r){let{repeat:n=[1,1],anisotropy:i=1,offset:a=[0,0]}=t,o=(0,oQ.Rq)(()=>fetch("https://cdn.jsdelivr.net/gh/pmndrs/drei-assets@master/normals/normals.json").then(e=>e.json()),["normalsList"]),s=ez.useMemo(()=>Object.keys(o).length,[]),l=o[0],c=o[e]||l,u=`https://rawcdn.githack.com/pmndrs/drei-assets/7a3104997e1576f83472829815b00880d88b32fb/normals/${c}`,h=sx(u,r);return ez.useLayoutEffect(()=>{h&&(h.wrapS=h.wrapT=eQ.RepeatWrapping,h.repeat=new eQ.Vector2(n[0],n[1]),h.offset=new eQ.Vector2(a[0],a[1]),h.anisotropy=i)},[h,i,n,a]),[h,u,s]}let vh=({children:e,id:t,onLoad:r,...n})=>{let i=vu(t,n,r);return ez.createElement(ez.Fragment,null,null==e?void 0:e(i))},vd={uniforms:{strokeOpacity:1,fillOpacity:.25,fillMix:0,thickness:.05,colorBackfaces:!1,dashInvert:!0,dash:!1,dashRepeats:4,dashLength:.5,squeeze:!1,squeezeMin:.2,squeezeMax:1,stroke:new eQ.Color("#ff0000"),backfaceStroke:new eQ.Color("#0000ff"),fill:new eQ.Color("#00ff00")},vertex:`
	  attribute vec3 barycentric;
	
		varying vec3 v_edges_Barycentric;
		varying vec3 v_edges_Position;

		void initWireframe() {
			v_edges_Barycentric = barycentric;
			v_edges_Position = position.xyz;
		}
	  `,fragment:`
		#ifndef PI
	  	#define PI 3.1415926535897932384626433832795
		#endif
  
	  varying vec3 v_edges_Barycentric;
	  varying vec3 v_edges_Position;
  
	  uniform float strokeOpacity;
	  uniform float fillOpacity;
	  uniform float fillMix;
	  uniform float thickness;
	  uniform bool colorBackfaces;
  
	  // Dash
	  uniform bool dashInvert;
	  uniform bool dash;
	  uniform bool dashOnly;
	  uniform float dashRepeats;
	  uniform float dashLength;
  
	  // Squeeze
	  uniform bool squeeze;
	  uniform float squeezeMin;
	  uniform float squeezeMax;
  
	  // Colors
	  uniform vec3 stroke;
	  uniform vec3 backfaceStroke;
	  uniform vec3 fill;
  
	  // This is like
	  float wireframe_aastep(float threshold, float dist) {
		  float afwidth = fwidth(dist) * 0.5;
		  return smoothstep(threshold - afwidth, threshold + afwidth, dist);
	  }
  
	  float wireframe_map(float value, float min1, float max1, float min2, float max2) {
		  return min2 + (value - min1) * (max2 - min2) / (max1 - min1);
	  }
  
	  float getWireframe() {
			vec3 barycentric = v_edges_Barycentric;
		
			// Distance from center of each triangle to its edges.
			float d = min(min(barycentric.x, barycentric.y), barycentric.z);

			// for dashed rendering, we can use this to get the 0 .. 1 value of the line length
			float positionAlong = max(barycentric.x, barycentric.y);
			if (barycentric.y < barycentric.x && barycentric.y < barycentric.z) {
				positionAlong = 1.0 - positionAlong;
			}

			// the thickness of the stroke
			float computedThickness = wireframe_map(thickness, 0.0, 1.0, 0.0, 0.34);

			// if we want to shrink the thickness toward the center of the line segment
			if (squeeze) {
				computedThickness *= mix(squeezeMin, squeezeMax, (1.0 - sin(positionAlong * PI)));
			}

			// Create dash pattern
			if (dash) {
				// here we offset the stroke position depending on whether it
				// should overlap or not
				float offset = 1.0 / dashRepeats * dashLength / 2.0;
				if (!dashInvert) {
					offset += 1.0 / dashRepeats / 2.0;
				}

				// if we should animate the dash or not
				// if (dashAnimate) {
				// 	offset += time * 0.22;
				// }

				// create the repeating dash pattern
				float pattern = fract((positionAlong + offset) * dashRepeats);
				computedThickness *= 1.0 - wireframe_aastep(dashLength, pattern);
			}

			// compute the anti-aliased stroke edge  
			float edge = 1.0 - wireframe_aastep(computedThickness, d);

			return edge;
	  }
	  `},vf=sv(vd.uniforms,vd.vertex+`
  	void main() {
		initWireframe();
		gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
	}
  `,vd.fragment+`
  void main () {
		// Compute color

		float edge = getWireframe();
		vec4 colorStroke = vec4(stroke, edge);

		#ifdef FLIP_SIDED
			colorStroke.rgb = backfaceStroke;
		#endif
    
		vec4 colorFill = vec4(fill, fillOpacity);
		vec4 outColor = mix(colorFill, colorStroke, edge * strokeOpacity);

		gl_FragColor = outColor;
	}
  `);function vp(e){return(null==e?void 0:e.current)!==void 0}function vm(e){return"WireframeGeometry"===e.type}function vA(e){let t=null!=e&&e.current?e.current:e;if(null!=t&&t.isBufferGeometry)return t;{if(vm(t))throw Error("Wireframe: WireframeGeometry is not supported.");let e=t.parent;if(null!=e&&e.geometry){if(vm(e.geometry))throw Error("Wireframe: WireframeGeometry is not supported.");return e.geometry}}}function vg(e,t){if(e.index){console.warn("Wireframe: Requires non-indexed geometry, converting to non-indexed geometry.");let t=e.toNonIndexed();e.copy(t),e.setIndex(null)}let r=function(e,t){let r=e.getAttribute("position").count,n=[];for(let e=0;e<r;e++){let r=t?1:0;e%2==0?n.push(0,0,1,0,1,0,1,0,r):n.push(0,1,0,0,0,1,1,0,r)}return new eQ.BufferAttribute(Float32Array.from(n),3)}(e,t);e.setAttribute("barycentric",r)}function vv({geometry:e,simplify:t=!1,...r}){(0,eL.e)({MeshWireframeMaterial:vf});let[n,i]=ez.useState(null);ez.useLayoutEffect(()=>{let r=vA(e);if(!r)throw Error("Wireframe: geometry prop must be a BufferGeometry or a ref to a BufferGeometry.");vg(r,t),vp(e)&&i(r)},[t,e]);let a=vp(e)?n:e;return ez.createElement(ez.Fragment,null,a&&ez.createElement("mesh",{geometry:a},ez.createElement("meshWireframeMaterial",ee({attach:"material",transparent:!0,side:eQ.DoubleSide,polygonOffset:!0,polygonOffsetFactor:-4},r,{extensions:{derivatives:!0,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1}}))))}function vy({simplify:e=!1,...t}){let r=ez.useRef(null),n=ez.useMemo(()=>(function(){let e={};for(let t in vd.uniforms)e[t]={value:vd.uniforms[t]};return e})(),[vd.uniforms]);return ez.useEffect(()=>{var e;n.fillOpacity.value=null!==(e=t.fillOpacity)&&void 0!==e?e:n.fillOpacity.value},[t.fillOpacity]),ez.useEffect(()=>{var e;n.fillMix.value=null!==(e=t.fillMix)&&void 0!==e?e:n.fillMix.value},[t.fillMix]),ez.useEffect(()=>{var e;n.strokeOpacity.value=null!==(e=t.strokeOpacity)&&void 0!==e?e:n.strokeOpacity.value},[t.strokeOpacity]),ez.useEffect(()=>{var e;n.thickness.value=null!==(e=t.thickness)&&void 0!==e?e:n.thickness.value},[t.thickness]),ez.useEffect(()=>void(n.colorBackfaces.value=!!t.colorBackfaces),[t.colorBackfaces]),ez.useEffect(()=>void(n.dash.value=!!t.dash),[t.dash]),ez.useEffect(()=>void(n.dashInvert.value=!!t.dashInvert),[t.dashInvert]),ez.useEffect(()=>{var e;n.dashRepeats.value=null!==(e=t.dashRepeats)&&void 0!==e?e:n.dashRepeats.value},[t.dashRepeats]),ez.useEffect(()=>{var e;n.dashLength.value=null!==(e=t.dashLength)&&void 0!==e?e:n.dashLength.value},[t.dashLength]),ez.useEffect(()=>void(n.squeeze.value=!!t.squeeze),[t.squeeze]),ez.useEffect(()=>{var e;n.squeezeMin.value=null!==(e=t.squeezeMin)&&void 0!==e?e:n.squeezeMin.value},[t.squeezeMin]),ez.useEffect(()=>{var e;n.squeezeMax.value=null!==(e=t.squeezeMax)&&void 0!==e?e:n.squeezeMax.value},[t.squeezeMax]),ez.useEffect(()=>void(n.stroke.value=t.stroke?new eQ.Color(t.stroke):n.stroke.value),[t.stroke]),ez.useEffect(()=>void(n.fill.value=t.fill?new eQ.Color(t.fill):n.fill.value),[t.fill]),ez.useEffect(()=>void(n.backfaceStroke.value=t.backfaceStroke?new eQ.Color(t.backfaceStroke):n.backfaceStroke.value),[t.backfaceStroke]),ez.useLayoutEffect(()=>{let t=vA(r);if(!t)throw Error("Wireframe: Must be a child of a Mesh, Line or Points object or specify a geometry prop.");let n=t.clone();return vg(t,e),()=>{t.copy(n),n.dispose()}},[e]),ez.useLayoutEffect(()=>{var e;let t=r.current.parent,i=t.material.clone();return(e=t.material).onBeforeCompile=e=>{e.uniforms={...e.uniforms,...n},e.vertexShader=e.vertexShader.replace("void main() {",`
		  ${vd.vertex}
		  void main() {
			initWireframe();
		`),e.fragmentShader=e.fragmentShader.replace("void main() {",`
		  ${vd.fragment}
		  void main() {
		`),e.fragmentShader=e.fragmentShader.replace("#include <color_fragment>",`
		  #include <color_fragment>
			  float edge = getWireframe();
		  vec4 colorStroke = vec4(stroke, edge);
		  #ifdef FLIP_SIDED
			colorStroke.rgb = backfaceStroke;
		  #endif
		  vec4 colorFill = vec4(mix(diffuseColor.rgb, fill, fillMix), mix(diffuseColor.a, fillOpacity, fillMix));
		  vec4 outColor = mix(colorFill, colorStroke, edge * strokeOpacity);

		  diffuseColor.rgb = outColor.rgb;
		  diffuseColor.a *= outColor.a;
		`)},e.side=eQ.DoubleSide,e.transparent=!0,()=>{t.material.dispose(),t.material=i}},[]),ez.createElement("object3D",{ref:r})}function vx({geometry:e,...t}){return e?ez.createElement(vv,ee({geometry:e},t)):ez.createElement(vy,t)}function vE({opacity:e,alphaMap:t}){let r=ez.useRef(null),n=ez.useRef(null),i=ez.useRef({value:1}),a=ez.useRef({value:null}),o=ez.useRef({value:!1});return ez.useLayoutEffect(()=>{r.current.onBeforeCompile=n.current.onBeforeCompile=e=>{let t;let r=e.fragmentShader.indexOf("void main"),n="",s=r;for(;"\n"!==t&&s<r+100;)n+=t=e.fragmentShader.charAt(s),s++;n=n.trim(),e.vertexShader=e.vertexShader.replace("void main() {",`
        varying vec2 custom_vUv;

        void main() {
          custom_vUv = uv;
          
        `),e.fragmentShader=e.fragmentShader.replace(n,`
          uniform float uShadowOpacity;
          uniform sampler2D uAlphaMap;
          uniform bool uHasAlphaMap;

          varying vec2 custom_vUv;
  
          float bayerDither2x2( vec2 v ) {
            return mod( 3.0 * v.y + 2.0 * v.x, 4.0 );
          }
    
          float bayerDither4x4( vec2 v ) {
            vec2 P1 = mod( v, 2.0 );
            vec2 P2 = mod( floor( 0.5  * v ), 2.0 );
            return 4.0 * bayerDither2x2( P1 ) + bayerDither2x2( P2 );
          }
  
          void main() {
            float alpha = 
              uHasAlphaMap ? 
                uShadowOpacity * texture2D(uAlphaMap, custom_vUv).x
              : uShadowOpacity;

            if( ( bayerDither4x4( floor( mod( gl_FragCoord.xy, 4.0 ) ) ) ) / 16.0 >= alpha ) discard;
            
          `),e.uniforms.uShadowOpacity=i.current,e.uniforms.uAlphaMap=a.current,e.uniforms.uHasAlphaMap=o.current}},[]),(0,eL.C)(()=>{var n;let s=null==(n=r.current.__r3f)?void 0:n.parent;if(s){let r=s.material;r&&(i.current.value=null!=e?e:r.opacity,!1===t?(a.current.value=null,o.current.value=!1):(a.current.value=t||r.alphaMap,o.current.value=!!a.current.value))}}),ez.createElement(ez.Fragment,null,ez.createElement("meshDepthMaterial",{ref:r,attach:"customDepthMaterial",depthPacking:eQ.RGBADepthPacking}),ez.createElement("meshDistanceMaterial",{ref:n,attach:"customDistanceMaterial"}))}let v_=new eQ.Matrix4,vC=new eQ.Ray,vb=new eQ.Sphere,vw=new eQ.Vector3;class vB extends eQ.Group{constructor(){super(),this.size=0,this.color=new eQ.Color("white"),this.instance={current:void 0},this.instanceKey={current:void 0}}get geometry(){var e;return null==(e=this.instance.current)?void 0:e.geometry}raycast(e,t){var r,n;let i=this.instance.current;if(!i||!i.geometry)return;let a=i.userData.instances.indexOf(this.instanceKey);if(-1===a||a>i.geometry.drawRange.count)return;let o=null!==(r=null==(n=e.params.Points)?void 0:n.threshold)&&void 0!==r?r:1;if(vb.set(this.getWorldPosition(vw),o),!1===e.ray.intersectsSphere(vb))return;v_.copy(i.matrixWorld).invert(),vC.copy(e.ray).applyMatrix4(v_);let s=o/((this.scale.x+this.scale.y+this.scale.z)/3),l=vC.distanceSqToPoint(this.position);if(l<s*s){let r=new eQ.Vector3;vC.closestPointToPoint(this.position,r),r.applyMatrix4(this.matrixWorld);let n=e.ray.origin.distanceTo(r);if(n<e.near||n>e.far)return;t.push({distance:n,distanceToRay:Math.sqrt(l),point:r,index:a,face:null,object:this})}}}let vI=ez.createContext(null),vM=new eQ.Matrix4,vS=new eQ.Vector3,vT=ez.forwardRef(({children:e,range:t,limit:r=1e3,...n},i)=>{let a=ez.useRef(null);ez.useImperativeHandle(i,()=>a.current,[]);let[o,s]=ez.useState([]),[[l,c,u]]=ez.useState(()=>[new Float32Array(3*r),Float32Array.from({length:3*r},()=>1),Float32Array.from({length:r},()=>1)]);ez.useEffect(()=>{a.current.geometry.attributes.position.needsUpdate=!0}),(0,eL.C)(()=>{for(a.current.updateMatrix(),a.current.updateMatrixWorld(),vM.copy(a.current.matrixWorld).invert(),a.current.geometry.drawRange.count=Math.min(r,void 0!==t?t:r,o.length),K=0;K<o.length;K++)(X=o[K].current).getWorldPosition(vS).applyMatrix4(vM),vS.toArray(l,3*K),a.current.geometry.attributes.position.needsUpdate=!0,X.matrixWorldNeedsUpdate=!0,X.color.toArray(c,3*K),a.current.geometry.attributes.color.needsUpdate=!0,u.set([X.size],K),a.current.geometry.attributes.size.needsUpdate=!0});let h=ez.useMemo(()=>({getParent:()=>a,subscribe:e=>(s(t=>[...t,e]),()=>s(t=>t.filter(t=>t.current!==e.current)))}),[]);return ez.createElement("points",ee({userData:{instances:o},matrixAutoUpdate:!1,ref:a,raycast:()=>null},n),ez.createElement("bufferGeometry",null,ez.createElement("bufferAttribute",{attach:"attributes-position",count:l.length/3,array:l,itemSize:3,usage:eQ.DynamicDrawUsage}),ez.createElement("bufferAttribute",{attach:"attributes-color",count:c.length/3,array:c,itemSize:3,usage:eQ.DynamicDrawUsage}),ez.createElement("bufferAttribute",{attach:"attributes-size",count:u.length,array:u,itemSize:1,usage:eQ.DynamicDrawUsage})),ez.createElement(vI.Provider,{value:h},e))}),vP=ez.forwardRef(({children:e,...t},r)=>{ez.useMemo(()=>(0,eL.e)({PositionPoint:vB}),[]);let n=ez.useRef(null);ez.useImperativeHandle(r,()=>n.current,[]);let{subscribe:i,getParent:a}=ez.useContext(vI);return ez.useLayoutEffect(()=>i(n),[]),ez.createElement("positionPoint",ee({instance:a(),instanceKey:n,ref:n},t),e)}),vD=ez.forwardRef(({children:e,positions:t,colors:r,sizes:n,stride:i=3,...a},o)=>{let s=ez.useRef(null);return ez.useImperativeHandle(o,()=>s.current,[]),(0,eL.C)(()=>{let e=s.current.geometry.attributes;e.position.needsUpdate=!0,r&&(e.color.needsUpdate=!0),n&&(e.size.needsUpdate=!0)}),ez.createElement("points",ee({ref:s},a),ez.createElement("bufferGeometry",null,ez.createElement("bufferAttribute",{attach:"attributes-position",count:t.length/i,array:t,itemSize:i,usage:eQ.DynamicDrawUsage}),r&&ez.createElement("bufferAttribute",{attach:"attributes-color",count:r.length/i,array:r,itemSize:3,usage:eQ.DynamicDrawUsage}),n&&ez.createElement("bufferAttribute",{attach:"attributes-size",count:n.length/i,array:n,itemSize:1,usage:eQ.DynamicDrawUsage})),e)}),vR=ez.forwardRef((e,t)=>e.positions instanceof Float32Array?ez.createElement(vD,ee({},e,{ref:t})):ez.createElement(vT,ee({},e,{ref:t}))),vF=ez.createContext(null),vz=ez.forwardRef((e,t)=>{ez.useMemo(()=>(0,eL.e)({SegmentObject:vO}),[]);let{limit:r=1e3,lineWidth:n=1,children:i,...a}=e,[o,s]=ez.useState([]),[l]=ez.useState(()=>new oS),[c]=ez.useState(()=>new of),[u]=ez.useState(()=>new od),[h]=ez.useState(()=>new eQ.Vector2(512,512)),[d]=ez.useState(()=>Array(6*r).fill(0)),[f]=ez.useState(()=>Array(6*r).fill(0)),p=ez.useMemo(()=>({subscribe:e=>(s(t=>[...t,e]),()=>s(t=>t.filter(t=>t.current!==e.current)))}),[]);return(0,eL.C)(()=>{for(let t=0;t<r;t++){var e;let r=null==(e=o[t])?void 0:e.current;r&&(d[6*t+0]=r.start.x,d[6*t+1]=r.start.y,d[6*t+2]=r.start.z,d[6*t+3]=r.end.x,d[6*t+4]=r.end.y,d[6*t+5]=r.end.z,f[6*t+0]=r.color.r,f[6*t+1]=r.color.g,f[6*t+2]=r.color.b,f[6*t+3]=r.color.r,f[6*t+4]=r.color.g,f[6*t+5]=r.color.b)}u.setColors(f),u.setPositions(d),l.computeLineDistances()}),ez.createElement("primitive",{object:l,ref:t},ez.createElement("primitive",{object:u,attach:"geometry"}),ez.createElement("primitive",ee({object:c,attach:"material",vertexColors:!0,resolution:h,linewidth:n},a)),ez.createElement(vF.Provider,{value:p},i))});class vO{constructor(){this.color=new eQ.Color("white"),this.start=new eQ.Vector3(0,0,0),this.end=new eQ.Vector3(0,0,0)}}let vQ=e=>e instanceof eQ.Vector3?e:new eQ.Vector3(..."number"==typeof e?[e,e,e]:e),vL=ez.forwardRef(({color:e,start:t,end:r},n)=>{let i=ez.useContext(vF);if(!i)throw"Segment must used inside Segments component.";let a=ez.useRef(null);return ez.useImperativeHandle(n,()=>a.current,[]),ez.useLayoutEffect(()=>i.subscribe(a),[]),ez.createElement("segmentObject",{ref:a,color:e,start:vQ(t),end:vQ(r)})}),vk=ez.forwardRef(({children:e,hysteresis:t=0,distances:r,...n},i)=>{let a=ez.useRef(null);return ez.useImperativeHandle(i,()=>a.current,[]),ez.useLayoutEffect(()=>{let{current:e}=a;e.levels.length=0,e.children.forEach((n,i)=>e.levels.push({object:n,hysteresis:t,distance:r[i]}))}),(0,eL.C)(e=>{var t;return null==(t=a.current)?void 0:t.update(e.camera)}),ez.createElement("lOD",ee({ref:a},n),e)});function vU({all:e,scene:t,camera:r}){let n=(0,eL.A)(({gl:e})=>e),i=(0,eL.A)(({camera:e})=>e),a=(0,eL.A)(({scene:e})=>e);return ez.useLayoutEffect(()=>{let o=[];e&&(t||a).traverse(e=>{!1===e.visible&&(o.push(e),e.visible=!0)}),n.compile(t||a,r||i);let s=new eQ.WebGLCubeRenderTarget(128);new eQ.CubeCamera(.01,1e5,s).update(n,t||a),s.dispose(),o.forEach(e=>e.visible=!1)},[]),null}function vN(){let e=(0,eL.A)(e=>e.gl);return(0,ez.useEffect)(()=>(e.shadowMap.autoUpdate=!1,e.shadowMap.needsUpdate=!0,()=>{e.shadowMap.autoUpdate=e.shadowMap.needsUpdate=!0}),[e.shadowMap]),null}let vG=new eQ.Matrix4,vH=new eQ.Ray,vV=new eQ.Sphere,vj=new eQ.Vector3;function vY(e,t){let r=this.geometry,n=this.material,i=this.matrixWorld;void 0!==n&&(null===r.boundingSphere&&r.computeBoundingSphere(),vV.copy(r.boundingSphere),vV.applyMatrix4(i),!1!==e.ray.intersectsSphere(vV)&&(vG.copy(i).invert(),vH.copy(e.ray).applyMatrix4(vG),(null===r.boundingBox||null!==vH.intersectBox(r.boundingBox,vj))&&t.push({distance:vj.distanceTo(e.ray.origin),point:vj.clone(),object:this})))}function vJ({pixelated:e}){let t=(0,eL.A)(e=>e.gl),r=(0,eL.A)(e=>e.internal.active),n=(0,eL.A)(e=>e.performance.current),i=(0,eL.A)(e=>e.viewport.initialDpr),a=(0,eL.A)(e=>e.setDpr);return ez.useEffect(()=>{let n=t.domElement;return()=>{r&&a(i),e&&n&&(n.style.imageRendering="auto")}},[]),ez.useEffect(()=>{a(n*i),e&&t.domElement&&(t.domElement.style.imageRendering=1===n?"auto":"pixelated")},[n]),null}function vW(){let e=(0,eL.A)(e=>e.get),t=(0,eL.A)(e=>e.setEvents),r=(0,eL.A)(e=>e.performance.current);return ez.useEffect(()=>{let r=e().events.enabled;return()=>t({enabled:r})},[]),ez.useEffect(()=>t({enabled:1===r}),[r]),null}let vq=(0,ez.createContext)(null);function vK({iterations:e=10,ms:t=250,threshold:r=.75,step:n=.1,factor:i=.5,flipflops:a=1/0,bounds:o=e=>e>100?[60,100]:[40,60],onIncline:s,onDecline:l,onChange:c,onFallback:u,children:h}){let[d,f]=(0,ez.useState)(()=>({fps:0,index:0,factor:i,flipped:0,refreshrate:0,fallback:!1,frames:[],averages:[],subscriptions:new Map,subscribe:e=>{let t=Symbol();return d.subscriptions.set(t,e.current),()=>void d.subscriptions.delete(t)}})),p=0;return(0,eL.C)(()=>{let{frames:i,averages:h}=d;if(!d.fallback&&h.length<e){i.push(performance.now());let f=i[i.length-1]-i[0];if(f>=t){if(d.fps=Math.round(i.length/f*1e3)/1,d.refreshrate=Math.max(d.refreshrate,d.fps),h[d.index++%e]=d.fps,h.length===e){let[t,i]=o(d.refreshrate),f=h.filter(e=>e>=i),m=h.filter(e=>e<t);f.length>e*r&&(d.factor=Math.min(1,d.factor+n),d.flipped++,s&&s(d),d.subscriptions.forEach(e=>e.onIncline&&e.onIncline(d))),m.length>e*r&&(d.factor=Math.max(0,d.factor-n),d.flipped++,l&&l(d),d.subscriptions.forEach(e=>e.onDecline&&e.onDecline(d))),p!==d.factor&&(p=d.factor,c&&c(d),d.subscriptions.forEach(e=>e.onChange&&e.onChange(d))),d.flipped>a&&!d.fallback&&(d.fallback=!0,u&&u(d),d.subscriptions.forEach(e=>e.onFallback&&e.onFallback(d))),d.averages=[]}d.frames=[]}}}),ez.createElement(vq.Provider,{value:d},h)}function vX({onIncline:e,onDecline:t,onChange:r,onFallback:n}){let i=(0,ez.useContext)(vq),a=(0,ez.useRef)({onIncline:e,onDecline:t,onChange:r,onFallback:n});(0,ez.useLayoutEffect)(()=>{a.current.onIncline=e,a.current.onDecline=t,a.current.onChange=r,a.current.onFallback=n},[e,t,r,n]),(0,ez.useLayoutEffect)(()=>i.subscribe(a),[i])}let vZ=ez.forwardRef(({children:e,compute:t,width:r,height:n,samples:i=8,renderPriority:a=0,eventPriority:o=0,frames:s=1/0,stencilBuffer:l=!1,depthBuffer:c=!0,generateMipmaps:u=!1,...h},d)=>{let{size:f,viewport:p}=(0,eL.A)(),m=ca((r||f.width)*p.dpr,(n||f.height)*p.dpr,{samples:i,stencilBuffer:l,depthBuffer:c,generateMipmaps:u}),[A]=ez.useState(()=>new eQ.Scene),g=ez.useCallback((e,t,r)=>{var n,i;let a=null==(n=m.texture)?void 0:n.__r3f.parent;for(;a&&!(a instanceof eQ.Object3D);)a=a.__r3f.parent;if(!a)return!1;r.raycaster.camera||r.events.compute(e,r,null==(i=r.previousRoot)?void 0:i.getState());let[o]=r.raycaster.intersectObject(a);if(!o)return!1;let s=o.uv;if(!s)return!1;t.raycaster.setFromCamera(t.pointer.set(2*s.x-1,2*s.y-1),t.camera)},[]);return ez.useImperativeHandle(d,()=>m.texture,[m]),ez.createElement(ez.Fragment,null,(0,eL.g)(ez.createElement(v$,{renderPriority:a,frames:s,fbo:m},e,ez.createElement("group",{onPointerOver:()=>null})),A,{events:{compute:t||g,priority:o}}),ez.createElement("primitive",ee({object:m.texture},h)))});function v$({frames:e,renderPriority:t,children:r,fbo:n}){let i,a,o,s,l=0;return(0,eL.C)(t=>{(e===1/0||l<e)&&(i=t.gl.autoClear,a=t.gl.xr.enabled,o=t.gl.getRenderTarget(),s=t.gl.xr.isPresenting,t.gl.autoClear=!0,t.gl.xr.enabled=!1,t.gl.xr.isPresenting=!1,t.gl.setRenderTarget(n),t.gl.render(t.scene,t.camera),t.gl.setRenderTarget(o),t.gl.autoClear=i,t.gl.xr.enabled=a,t.gl.xr.isPresenting=s,l++)},t),ez.createElement(ez.Fragment,null,r)}let v0=ez.forwardRef(({children:e,compute:t,renderPriority:r=-1,eventPriority:n=0,frames:i=1/0,stencilBuffer:a=!1,depthBuffer:o=!0,generateMipmaps:s=!1,resolution:l=896,near:c=.1,far:u=1e3,flip:h=!1,position:d,rotation:f,scale:p,quaternion:m,matrix:A,matrixAutoUpdate:g,...v},y)=>{let{size:x,viewport:E}=(0,eL.A)(),_=ez.useRef(null),C=ez.useMemo(()=>{let e=new eQ.WebGLCubeRenderTarget(Math.max((l||x.width)*E.dpr,(l||x.height)*E.dpr),{stencilBuffer:a,depthBuffer:o,generateMipmaps:s});return e.texture.isRenderTargetTexture=!h,e.texture.flipY=!0,e.texture.type=eQ.HalfFloatType,e},[l,h]);ez.useEffect(()=>()=>C.dispose(),[C]);let[b]=ez.useState(()=>new eQ.Scene);return ez.useImperativeHandle(y,()=>({scene:b,fbo:C,camera:_.current}),[C]),ez.createElement(ez.Fragment,null,(0,eL.g)(ez.createElement(v1,{renderPriority:r,frames:i,camera:_},e,ez.createElement("group",{onPointerOver:()=>null})),b,{events:{compute:t,priority:n}}),ez.createElement("primitive",ee({object:C.texture},v)),ez.createElement("cubeCamera",{ref:_,args:[c,u,C],position:d,rotation:f,scale:p,quaternion:m,matrix:A,matrixAutoUpdate:g}))});function v1({frames:e,renderPriority:t,children:r,camera:n}){let i=0;return(0,eL.C)(t=>{(e===1/0||i<e)&&(n.current.update(t.gl,t.scene),i++)},t),ez.createElement(ez.Fragment,null,r)}let v2=ez.forwardRef(({id:e=1,colorWrite:t=!1,depthWrite:r=!1,...n},i)=>{let a=ez.useRef(null),o=ez.useMemo(()=>({colorWrite:t,depthWrite:r,stencilWrite:!0,stencilRef:e,stencilFunc:eQ.AlwaysStencilFunc,stencilFail:eQ.ReplaceStencilOp,stencilZFail:eQ.ReplaceStencilOp,stencilZPass:eQ.ReplaceStencilOp}),[e,t,r]);return ez.useLayoutEffect(()=>{Object.assign(a.current.material,o)}),ez.useImperativeHandle(i,()=>a.current,[]),ez.createElement("mesh",ee({ref:a,renderOrder:-e},n))});function v3(e,t=!1){return{stencilWrite:!0,stencilRef:e,stencilFunc:t?eQ.NotEqualStencilFunc:eQ.EqualStencilFunc,stencilFail:eQ.KeepStencilOp,stencilZFail:eQ.KeepStencilOp,stencilZPass:eQ.KeepStencilOp}}function v4({renderPriority:e=1,zoom:t=0,segments:r=64,children:n,resolution:i=896,...a}){let o=ez.useRef(null),s=ez.useRef(null),{width:l,height:c}=(0,eL.A)(e=>e.size),[u]=ez.useState(()=>new eQ.OrthographicCamera);ez.useLayoutEffect(()=>{u.position.set(0,0,100),u.zoom=100,u.left=-(l/2),u.right=l/2,u.top=c/2,u.bottom=-(c/2),u.updateProjectionMatrix()},[l,c]);let h=Math.sqrt(l*l+c*c)/100*(.5+t/2),d=new eQ.Vector3,f=new eQ.Sphere(new eQ.Vector3,h),p=new eQ.Matrix3,m=ez.useCallback((e,t,r)=>{t.pointer.set(e.offsetX/t.size.width*2-1,-(e.offsetY/t.size.height*2)+1),t.raycaster.setFromCamera(t.pointer,u),t.raycaster.ray.intersectSphere(f,d)&&(d.normalize(),p.getNormalMatrix(s.current.camera.matrixWorld),s.current.camera.getWorldPosition(t.raycaster.ray.origin),t.raycaster.ray.direction.set(0,0,1).reflect(d),t.raycaster.ray.direction.x*=-1,t.raycaster.ray.direction.applyNormalMatrix(p).multiplyScalar(-1))},[]);return(0,eL.C)(t=>{e&&t.gl.render(o.current,u)},e),ez.createElement(ez.Fragment,null,ez.createElement("mesh",ee({ref:o},a,{scale:h}),ez.createElement("sphereGeometry",{args:[1,r,r]}),ez.createElement("meshBasicMaterial",null,ez.createElement(v0,{compute:m,attach:"envMap",flip:!0,resolution:i,ref:s},n,ez.createElement(v5,{api:s})))))}function v5({api:e}){let t=new eQ.Vector3,r=new eQ.Quaternion,n=new eQ.Vector3,i=new eQ.Euler(0,Math.PI,0);return(0,eL.C)(a=>{a.camera.matrixWorld.decompose(t,r,n),e.current.camera.position.copy(t),e.current.camera.quaternion.setFromEuler(i).premultiply(r)}),null}let v6=sv({blur:0,map:null,sdf:null,blend:0,size:0,resolution:new eQ.Vector2},`varying vec2 vUv;
   void main() {
     gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
     vUv = uv;
   }`,`uniform sampler2D sdf;
   uniform sampler2D map;
   uniform float blur;
   uniform float size;
   uniform float time;
   uniform vec2 resolution;
   varying vec2 vUv;
   #include <packing>
   void main() {
     vec2 uv = gl_FragCoord.xy / resolution.xy;
     vec4 t = texture2D(map, uv);
     float k = blur;
     float d = texture2D(sdf, vUv).r/size;
     float alpha = 1.0 - smoothstep(0.0, 1.0, clamp(d/k + 1.0, 0.0, 1.0));
     gl_FragColor = vec4(t.rgb, blur == 0.0 ? t.a : t.a * alpha);
     #include <tonemapping_fragment>
     #include <${s_>=154?"colorspace_fragment":"encodings_fragment"}>
   }`),v8=ez.forwardRef(({children:e,events:t,blur:r=0,eventPriority:n=0,renderPriority:i=0,worldUnits:a=!1,resolution:o=512,...s},l)=>{(0,eL.e)({PortalMaterialImpl:v6});let c=ez.useRef(null),{scene:u,gl:h,size:d,viewport:f,setEvents:p}=(0,eL.A)(),m=ca(o,o),[A,g]=ez.useState(0);(0,eL.C)(()=>{let e=c.current.blend>0?Math.max(1,i):0;A!==e&&g(e)}),ez.useEffect(()=>{void 0!==t&&p({enabled:!t})},[t]);let[v,y]=ez.useState(!0),x=p2(y);ez.useLayoutEffect(()=>{var e;x.current=null==(e=c.current)?void 0:e.__r3f.parent},[]),ez.useLayoutEffect(()=>{if(x.current&&r&&null===c.current.sdf){let e=new eQ.Mesh(x.current.geometry,new eQ.MeshBasicMaterial),t=new eQ.Box3().setFromBufferAttribute(e.geometry.attributes.position),r=new eQ.OrthographicCamera(t.min.x*(1+2/o),t.max.x*(1+2/o),t.max.y*(1+2/o),t.min.y*(1+2/o),.1,1e3);r.position.set(0,0,1),r.lookAt(0,0,0),h.setRenderTarget(m),h.render(e,r);let n=v7(o,o,h)(m.texture),i=new Float32Array(o*o);h.readRenderTargetPixels(n,0,0,o,o,i);let a=1/0;for(let e=0;e<i.length;e++)i[e]<a&&(a=i[e]);a=-a,c.current.size=a,c.current.sdf=n.texture,h.setRenderTarget(null)}},[o,r]),ez.useImperativeHandle(l,()=>c.current);let E=ez.useCallback((e,t,r)=>{var n;if(!x.current)return!1;if(t.pointer.set(e.offsetX/t.size.width*2-1,-(e.offsetY/t.size.height*2)+1),t.raycaster.setFromCamera(t.pointer,t.camera),(null==(n=c.current)?void 0:n.blend)===0){let[e]=t.raycaster.intersectObject(x.current);if(!e)return t.raycaster.camera=void 0,!1}},[]);return ez.createElement("portalMaterialImpl",ee({ref:c,blur:r,blend:0,resolution:[d.width*f.dpr,d.height*f.dpr],attach:"material"},s),ez.createElement(vZ,{attach:"map",frames:v?1/0:0,eventPriority:n,renderPriority:i,compute:E},e,ez.createElement(v9,{events:t,rootScene:u,priority:A,material:c,worldUnits:a})))});function v9({events:e,rootScene:t,material:r,priority:n,worldUnits:i}){let a=(0,eL.A)(e=>e.scene),o=(0,eL.A)(e=>e.setEvents),s=ca(),l=ca();ez.useLayoutEffect(()=>{a.matrixAutoUpdate=!1},[]),ez.useEffect(()=>{void 0!==e&&o({enabled:e})},[e]);let[c,u]=ez.useMemo(()=>{let e={value:0};return[new o5(new eQ.ShaderMaterial({uniforms:{a:{value:s.texture},b:{value:l.texture},blend:e},vertexShader:`
          varying vec2 vUv;
          void main() {
            vUv = uv;
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
          }`,fragmentShader:`
          uniform sampler2D a;
          uniform sampler2D b;
          uniform float blend;
          varying vec2 vUv;
          #include <packing>
          void main() {
            vec4 ta = texture2D(a, vUv);
            vec4 tb = texture2D(b, vUv);
            gl_FragColor = mix(tb, ta, blend);
            #include <tonemapping_fragment>
            #include <${s_>=154?"colorspace_fragment":"encodings_fragment"}>
          }`})),e]},[]);return(0,eL.C)(e=>{var o,h,d,f,p;let m=null==r||null==(o=r.current)?void 0:o.__r3f.parent;m&&(i?a.matrixWorld.identity():(n&&(null==(h=r.current)?void 0:h.blend)===1&&m.updateWorldMatrix(!0,!1),a.matrixWorld.copy(m.matrixWorld)),n&&((null==(d=r.current)?void 0:d.blend)>0&&(null==(f=r.current)?void 0:f.blend)<1?(u.value=r.current.blend,e.gl.setRenderTarget(s),e.gl.render(a,e.camera),e.gl.setRenderTarget(l),e.gl.render(t,e.camera),e.gl.setRenderTarget(null),c.render(e.gl)):(null==(p=r.current)?void 0:p.blend)===1&&e.gl.render(a,e.camera)))},n),ez.createElement(ez.Fragment,null)}let v7=(e,t,r)=>{let n=new eQ.WebGLRenderTarget(e,t,{minFilter:eQ.LinearMipmapLinearFilter,magFilter:eQ.LinearFilter,type:eQ.FloatType,format:eQ.RedFormat,generateMipmaps:!0}),i=new eQ.WebGLRenderTarget(e,t,{minFilter:eQ.NearestFilter,magFilter:eQ.NearestFilter}),a=new eQ.WebGLRenderTarget(e,t,{minFilter:eQ.NearestFilter,magFilter:eQ.NearestFilter}),o=new eQ.WebGLRenderTarget(e,t,{minFilter:eQ.NearestFilter,magFilter:eQ.NearestFilter}),s=new eQ.WebGLRenderTarget(e,t,{minFilter:eQ.NearestFilter,magFilter:eQ.NearestFilter}),l=new eQ.WebGLRenderTarget(e,t,{minFilter:eQ.NearestFilter,magFilter:eQ.NearestFilter,type:eQ.FloatType,format:eQ.RedFormat}),c=new eQ.WebGLRenderTarget(e,t,{minFilter:eQ.NearestFilter,magFilter:eQ.NearestFilter,type:eQ.FloatType,format:eQ.RedFormat}),u=new o5(new eQ.ShaderMaterial({uniforms:{tex:{value:null}},vertexShader:`
        varying vec2 vUv;
        void main() {
          vUv = uv;
          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }`,fragmentShader:`
        uniform sampler2D tex;
        varying vec2 vUv;
        #include <packing>
        void main() {
          gl_FragColor = pack2HalfToRGBA(vUv * (round(texture2D(tex, vUv).x)));
        }`})),h=new o5(new eQ.ShaderMaterial({uniforms:{tex:{value:null}},vertexShader:`
        varying vec2 vUv;
        void main() {
          vUv = uv;
          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }`,fragmentShader:`
        uniform sampler2D tex;
        varying vec2 vUv;
        #include <packing>
        void main() {
          gl_FragColor = pack2HalfToRGBA(vUv * (1.0 - round(texture2D(tex, vUv).x)));
        }`})),d=new o5(new eQ.ShaderMaterial({uniforms:{tex:{value:null},offset:{value:0},level:{value:0},maxSteps:{value:0}},vertexShader:`
        varying vec2 vUv;
        void main() {
          vUv = uv;
          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }`,fragmentShader:`
        varying vec2 vUv;
        uniform sampler2D tex;
        uniform float offset;
        uniform float level;
        uniform float maxSteps;
        #include <packing>
        void main() {
          float closestDist = 9999999.9;
          vec2 closestPos = vec2(0.0);
          for (float x = -1.0; x <= 1.0; x += 1.0) {
            for (float y = -1.0; y <= 1.0; y += 1.0) {
              vec2 voffset = vUv;
              voffset += vec2(x, y) * vec2(${1/e}, ${1/t}) * offset;
              vec2 pos = unpackRGBATo2Half(texture2D(tex, voffset));
              float dist = distance(pos.xy, vUv);
              if(pos.x != 0.0 && pos.y != 0.0 && dist < closestDist) {
                closestDist = dist;
                closestPos = pos;
              }
            }
          }
          gl_FragColor = pack2HalfToRGBA(closestPos);
        }`})),f=new o5(new eQ.ShaderMaterial({uniforms:{tex:{value:null},size:{value:new eQ.Vector2(e,t)}},vertexShader:`
        varying vec2 vUv;
        void main() {
          vUv = uv;
          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }`,fragmentShader:`
        varying vec2 vUv;
        uniform sampler2D tex;
        uniform vec2 size;
        #include <packing>
        void main() {
          gl_FragColor = vec4(distance(size * unpackRGBATo2Half(texture2D(tex, vUv)), size * vUv), 0.0, 0.0, 0.0);
        }`})),p=new o5(new eQ.ShaderMaterial({uniforms:{inside:{value:c.texture},outside:{value:l.texture},tex:{value:null}},vertexShader:`
        varying vec2 vUv;
        void main() {
          vUv = uv;
          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }`,fragmentShader:`
        varying vec2 vUv;
        uniform sampler2D inside;
        uniform sampler2D outside;
        uniform sampler2D tex;
        #include <packing>
        void main() {
          float i = texture2D(inside, vUv).x;
          float o =texture2D(outside, vUv).x;
          if (texture2D(tex, vUv).x == 0.0) {
            gl_FragColor = vec4(o, 0.0, 0.0, 0.0);
          } else {
            gl_FragColor = vec4(-i, 0.0, 0.0, 0.0);
          }
        }`}));return m=>{m.minFilter=eQ.NearestFilter,m.magFilter=eQ.NearestFilter,u.material.uniforms.tex.value=m,r.setRenderTarget(i),u.render(r);let A=Math.ceil(Math.log(Math.max(e,t))/Math.log(2)),g=i,v=null;for(let e=0;e<A;e++){let t=Math.pow(2,A-e-1);v=g===i?o:i,d.material.uniforms.level.value=e,d.material.uniforms.maxSteps.value=A,d.material.uniforms.offset.value=t,d.material.uniforms.tex.value=g.texture,r.setRenderTarget(v),d.render(r),g=v}r.setRenderTarget(l),f.material.uniforms.tex.value=v.texture,f.render(r),h.material.uniforms.tex.value=m,r.setRenderTarget(a),h.render(r),g=a;for(let e=0;e<A;e++){let t=Math.pow(2,A-e-1);v=g===a?s:a,d.material.uniforms.level.value=e,d.material.uniforms.maxSteps.value=A,d.material.uniforms.offset.value=t,d.material.uniforms.tex.value=g.texture,r.setRenderTarget(v),d.render(r),g=v}return r.setRenderTarget(c),f.material.uniforms.tex.value=v.texture,f.render(r),r.setRenderTarget(n),p.material.uniforms.tex.value=m,p.render(r),r.setRenderTarget(null),n}},ye=e=>{let t;let r=new Set,n=(e,n)=>{let i="function"==typeof e?e(t):e;if(!Object.is(i,t)){let e=t;t=(null!=n?n:"object"!=typeof i||null===i)?i:Object.assign({},t,i),r.forEach(r=>r(t,e))}},i=()=>t,a={setState:n,getState:i,getInitialState:()=>o,subscribe:e=>(r.add(e),()=>r.delete(e)),destroy:()=>{console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},o=t=e(n,i,a);return a},yt=e=>e?ye(e):ye;var yr=r(5006);let{useDebugValue:yn}=ez,{useSyncExternalStoreWithSelector:yi}=yr,ya=!1,yo=e=>e,ys=e=>{"function"!=typeof e&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");let t="function"==typeof e?yt(e):e,r=(e,r)=>(function(e,t=yo,r){r&&!ya&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),ya=!0);let n=yi(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return yn(n),n})(t,e,r);return Object.assign(r,t),r},yl=e=>e?ys(e):ys,yc="undefined"!=typeof window&&(null!=(eR=window.document)&&eR.createElement||(null==(eF=window.navigator)?void 0:eF.product)==="ReactNative")?ez.useLayoutEffect:ez.useEffect,yu=e=>e&&e.isOrthographicCamera,yh=new eQ.Color,yd=function(){let e=yl(e=>({current:[],version:0,set:e}));return{In:({children:t})=>{let r=e(e=>e.set),n=e(e=>e.version);return yc(()=>{r(e=>({version:e.version+1}))},[]),yc(()=>(r(({current:e})=>({current:[...e,t]})),()=>r(({current:e})=>({current:e.filter(e=>e!==t)}))),[t,n]),null},Out:()=>{let t=e(e=>e.current);return ez.createElement(ez.Fragment,null,t)}}}();function yf(e,t){let{right:r,top:n,left:i,bottom:a,width:o,height:s}=t,l=t.bottom<0||n>e.height||r<0||t.left>e.width;if("top"in e){let t=e.top+e.height;return{position:{width:o,height:s,left:i-e.left,top:n,bottom:t-a,right:r},isOffscreen:l}}return{position:{width:o,height:s,top:n,left:i,bottom:e.height-a,right:r},isOffscreen:l}}function yp(e,{left:t,bottom:r,width:n,height:i}){let a;let o=n/i;return yu(e.camera)?(e.camera.left!==-(n/2)||e.camera.right!==n/2||e.camera.top!==i/2||e.camera.bottom!==-(i/2))&&(Object.assign(e.camera,{left:-(n/2),right:n/2,top:i/2,bottom:-(i/2)}),e.camera.updateProjectionMatrix()):e.camera.aspect!==o&&(e.camera.aspect=o,e.camera.updateProjectionMatrix()),a=e.gl.autoClear,e.gl.autoClear=!1,e.gl.setViewport(t,r,n,i),e.gl.setScissor(t,r,n,i),e.gl.setScissorTest(!0),a}function ym(e,t){e.gl.setScissorTest(!1),e.gl.autoClear=t}function yA(e){e.gl.getClearColor(yh),e.gl.setClearColor(yh,e.gl.getClearAlpha()),e.gl.clear(!0,!0)}function yg({visible:e=!0,canvasSize:t,scene:r,index:n,children:i,frames:a,rect:o,track:s}){let l=(0,eL.A)(),[c,u]=ez.useState(!1),h=0;return(0,eL.C)(n=>{if(a===1/0||h<=a){var l;s&&(o.current=null==(l=s.current)?void 0:l.getBoundingClientRect()),h++}if(o.current){let{position:a,isOffscreen:s}=yf(t,o.current);if(c!==s&&u(s),e&&!c&&o.current){let e=yp(n,a);n.gl.render(i?n.scene:r,n.camera),ym(n,e)}}},n),ez.useLayoutEffect(()=>{let r=o.current;if(r&&(!e||!c)){let{position:e}=yf(t,r),n=yp(l,e);yA(l),ym(l,n)}},[e,c]),ez.useEffect(()=>{if(!s)return;let e=o.current,r=l.get().events.connected;return l.setEvents({connected:s.current}),()=>{if(e){let{position:r}=yf(t,e),n=yp(l,r);yA(l),ym(l,n)}l.setEvents({connected:r})}},[s]),ez.useEffect(()=>{"top"in t||console.warn("Detected @react-three/fiber canvas size does not include position information. <View /> may not work as expected. Upgrade to @react-three/fiber ^8.1.0 for support.\n See https://github.com/pmndrs/drei/issues/944")},[]),ez.createElement(ez.Fragment,null,i,ez.createElement("group",{onPointerOver:()=>null}))}let yv=ez.forwardRef(({track:e,visible:t=!0,index:r=1,id:n,style:i,className:a,frames:o=1/0,children:s,...l},c)=>{var u,h,d,f;let p=ez.useRef(null),{size:m,scene:A}=(0,eL.A)(),[g]=ez.useState(()=>new eQ.Scene),[v,y]=ez.useReducer(()=>!0,!1),x=ez.useCallback((t,r)=>{if(p.current&&e&&e.current&&t.target===e.current){let{width:e,height:n,left:i,top:a}=p.current,o=t.clientX-i,s=t.clientY-a;r.pointer.set(o/e*2-1,-(s/n*2)+1),r.raycaster.setFromCamera(r.pointer,r.camera)}},[p,e]);return ez.useEffect(()=>{var t;e&&(p.current=null==(t=e.current)?void 0:t.getBoundingClientRect()),y()},[e]),ez.createElement("group",ee({ref:c},l),v&&(0,eL.g)(ez.createElement(yg,{visible:t,canvasSize:m,frames:o,scene:A,track:e,rect:p,index:r},s),g,{events:{compute:x,priority:r},size:{width:null==(u=p.current)?void 0:u.width,height:null==(h=p.current)?void 0:h.height,top:null==(d=p.current)?void 0:d.top,left:null==(f=p.current)?void 0:f.left}}))}),yy=ez.forwardRef(({as:e="div",id:t,visible:r,className:n,style:i,index:a=1,track:o,frames:s=1/0,children:l,...c},u)=>{let h=ez.useId(),d=ez.useRef(null);return ez.useImperativeHandle(u,()=>d.current),ez.createElement(ez.Fragment,null,ez.createElement(e,ee({ref:d,id:t,className:n,style:i},c)),ez.createElement(yd.In,null,ez.createElement(yv,{visible:r,key:h,track:d,frames:s,index:a},l)))}),yx=ez.forwardRef((e,t)=>ez.useContext(eL.f)?ez.createElement(yv,ee({ref:t},e)):ez.createElement(yy,ee({ref:t},e)));yx.Port=()=>ez.createElement(yd.Out,null);let yE=ez.createContext(null),y_=new eQ.Vector3,yC=new eQ.Vector3,yb=(e,t,r,n)=>{let i=t.dot(t),a=t.dot(e)-t.dot(r),o=t.dot(n);return 0===o?-a/i:(y_.copy(n).multiplyScalar(i/o).sub(t),yC.copy(n).multiplyScalar(a/o).add(r).sub(e),-y_.dot(yC)/y_.dot(y_))},yw=new eQ.Vector3(0,1,0),yB=new eQ.Matrix4,yI=({direction:e,axis:t})=>{let{translation:r,translationLimits:n,annotations:i,annotationsClass:a,depthTest:o,scale:s,lineWidth:l,fixed:c,axisColors:u,hoveredColor:h,opacity:d,onDragStart:f,onDrag:p,onDragEnd:m,userData:A}=ez.useContext(yE),g=(0,eL.A)(e=>e.controls),v=ez.useRef(null),y=ez.useRef(null),x=ez.useRef(null),E=ez.useRef(0),[_,C]=ez.useState(!1),b=ez.useCallback(n=>{i&&(v.current.innerText=`${r.current[t].toFixed(2)}`,v.current.style.display="block"),n.stopPropagation();let a=new eQ.Matrix4().extractRotation(y.current.matrixWorld),o=n.point.clone(),s=new eQ.Vector3().setFromMatrixPosition(y.current.matrixWorld),l=e.clone().applyMatrix4(a).normalize();x.current={clickPoint:o,dir:l},E.current=r.current[t],f({component:"Arrow",axis:t,origin:s,directions:[l]}),g&&(g.enabled=!1),n.target.setPointerCapture(n.pointerId)},[i,e,g,f,r,t]),w=ez.useCallback(e=>{if(e.stopPropagation(),_||C(!0),x.current){let{clickPoint:a,dir:o}=x.current,[s,l]=(null==n?void 0:n[t])||[void 0,void 0],c=yb(a,o,e.ray.origin,e.ray.direction);void 0!==s&&(c=Math.max(c,s-E.current)),void 0!==l&&(c=Math.min(c,l-E.current)),r.current[t]=E.current+c,i&&(v.current.innerText=`${r.current[t].toFixed(2)}`),yB.makeTranslation(o.x*c,o.y*c,o.z*c),p(yB)}},[i,p,_,r,n,t]),B=ez.useCallback(e=>{i&&(v.current.style.display="none"),e.stopPropagation(),x.current=null,m(),g&&(g.enabled=!0),e.target.releasePointerCapture(e.pointerId)},[i,g,m]),I=ez.useCallback(e=>{e.stopPropagation(),C(!1)},[]),{cylinderLength:M,coneWidth:S,coneLength:T,matrixL:P}=ez.useMemo(()=>{let t=c?l/s*1.6:s/20,r=c?.2:s/5,n=c?1-r:s-r,i=new eQ.Quaternion().setFromUnitVectors(yw,e.clone().normalize());return{cylinderLength:n,coneWidth:t,coneLength:r,matrixL:new eQ.Matrix4().makeRotationFromQuaternion(i)}},[e,s,l,c]),D=_?h:u[t];return ez.createElement("group",{ref:y},ez.createElement("group",{matrix:P,matrixAutoUpdate:!1,onPointerDown:b,onPointerMove:w,onPointerUp:B,onPointerOut:I},i&&ez.createElement(eW,{position:[0,-T,0]},ez.createElement("div",{style:{display:"none",background:"#151520",color:"white",padding:"6px 8px",borderRadius:7,whiteSpace:"nowrap"},className:a,ref:v})),ez.createElement("mesh",{visible:!1,position:[0,(M+T)/2,0],userData:A},ez.createElement("cylinderGeometry",{args:[1.4*S,1.4*S,M+T,8,1]})),ez.createElement(oT,{transparent:!0,raycast:()=>null,depthTest:o,points:[0,0,0,0,M,0],lineWidth:l,side:eQ.DoubleSide,color:D,opacity:d,polygonOffset:!0,renderOrder:1,polygonOffsetFactor:-10,fog:!1}),ez.createElement("mesh",{raycast:()=>null,position:[0,M+T/2,0],renderOrder:500},ez.createElement("coneGeometry",{args:[S,T,24,1]}),ez.createElement("meshBasicMaterial",{transparent:!0,depthTest:o,color:D,opacity:d,polygonOffset:!0,polygonOffsetFactor:-10,fog:!1}))))},yM=new eQ.Vector3,yS=new eQ.Vector3,yT=e=>180*e/Math.PI,yP=e=>e*Math.PI/180,yD=(e,t,r,n,i)=>{yM.copy(e).sub(r),yS.copy(t).sub(r);let a=n.dot(n),o=i.dot(i),s=yM.dot(n)/a,l=yM.dot(i)/o,c=yS.dot(n)/a;return Math.atan2(yS.dot(i)/o,c)-Math.atan2(l,s)},yR=(e,t)=>{let r=Math.floor(e/t);return e-(r=r<0?r+1:r)*t},yF=e=>{let t=yR(e,2*Math.PI);return 1e-6>Math.abs(t)?0:(t<0&&(t+=2*Math.PI),t)},yz=new eQ.Matrix4,yO=new eQ.Vector3,yQ=new eQ.Ray,yL=new eQ.Vector3,yk=({dir1:e,dir2:t,axis:r})=>{let{rotationLimits:n,annotations:i,annotationsClass:a,depthTest:o,scale:s,lineWidth:l,fixed:c,axisColors:u,hoveredColor:h,opacity:d,onDragStart:f,onDrag:p,onDragEnd:m,userData:A}=ez.useContext(yE),g=(0,eL.A)(e=>e.controls),v=ez.useRef(null),y=ez.useRef(null),x=ez.useRef(0),E=ez.useRef(0),_=ez.useRef(null),[C,b]=ez.useState(!1),w=ez.useCallback(e=>{i&&(v.current.innerText=`${yT(E.current).toFixed(0)}\xba`,v.current.style.display="block"),e.stopPropagation();let t=e.point.clone(),n=new eQ.Vector3().setFromMatrixPosition(y.current.matrixWorld),a=new eQ.Vector3().setFromMatrixColumn(y.current.matrixWorld,0).normalize(),o=new eQ.Vector3().setFromMatrixColumn(y.current.matrixWorld,1).normalize(),s=new eQ.Vector3().setFromMatrixColumn(y.current.matrixWorld,2).normalize(),l=new eQ.Plane().setFromNormalAndCoplanarPoint(s,n);_.current={clickPoint:t,origin:n,e1:a,e2:o,normal:s,plane:l},f({component:"Rotator",axis:r,origin:n,directions:[a,o,s]}),g&&(g.enabled=!1),e.target.setPointerCapture(e.pointerId)},[i,g,f,r]),B=ez.useCallback(e=>{if(e.stopPropagation(),C||b(!0),_.current){let{clickPoint:t,origin:a,e1:o,e2:s,normal:l,plane:c}=_.current,[u,h]=(null==n?void 0:n[r])||[void 0,void 0];yQ.copy(e.ray),yQ.intersectPlane(c,yL),yQ.direction.negate(),yQ.intersectPlane(c,yL);let d=yD(t,yL,a,o,s),f=yT(d);e.shiftKey&&(d=yP(f=10*Math.round(f/10))),void 0!==u&&void 0!==h&&h-u<2*Math.PI?(d=(d=yF(d))>Math.PI?d-2*Math.PI:d,d=eQ.MathUtils.clamp(d,u-x.current,h-x.current),E.current=x.current+d):(E.current=yF(x.current+d),E.current=E.current>Math.PI?E.current-2*Math.PI:E.current),i&&(f=yT(E.current),v.current.innerText=`${f.toFixed(0)}\xba`),yz.makeRotationAxis(l,d),yO.copy(a).applyMatrix4(yz).sub(a).negate(),yz.setPosition(yO),p(yz)}},[i,p,C,n,r]),I=ez.useCallback(e=>{i&&(v.current.style.display="none"),e.stopPropagation(),x.current=E.current,_.current=null,m(),g&&(g.enabled=!0),e.target.releasePointerCapture(e.pointerId)},[i,g,m]),M=ez.useCallback(e=>{e.stopPropagation(),b(!1)},[]),S=ez.useMemo(()=>{let r=e.clone().normalize(),n=t.clone().normalize();return new eQ.Matrix4().makeBasis(r,n,r.clone().cross(n))},[e,t]),T=c?.65:.65*s,P=ez.useMemo(()=>{let e=[];for(let t=0;t<=32;t++){let r=Math.PI/2*t/32;e.push(new eQ.Vector3(Math.cos(r)*T,Math.sin(r)*T,0))}return e},[T]);return ez.createElement("group",{ref:y,onPointerDown:w,onPointerMove:B,onPointerUp:I,onPointerOut:M,matrix:S,matrixAutoUpdate:!1},i&&ez.createElement(eW,{position:[T,T,0]},ez.createElement("div",{style:{display:"none",background:"#151520",color:"white",padding:"6px 8px",borderRadius:7,whiteSpace:"nowrap"},className:a,ref:v})),ez.createElement(oT,{points:P,lineWidth:4*l,visible:!1,userData:A}),ez.createElement(oT,{transparent:!0,raycast:()=>null,depthTest:o,points:P,lineWidth:l,side:eQ.DoubleSide,color:C?h:u[r],opacity:d,polygonOffset:!0,polygonOffsetFactor:-10,fog:!1}))},yU=(e,t,r)=>{let n=Math.abs(e.x)>=Math.abs(e.y)&&Math.abs(e.x)>=Math.abs(e.z)?0:Math.abs(e.y)>=Math.abs(e.x)&&Math.abs(e.y)>=Math.abs(e.z)?1:2,i=[0,1,2].sort((e,r)=>Math.abs(t.getComponent(r))-Math.abs(t.getComponent(e))),a=n===i[0]?i[1]:i[0],o=e.getComponent(n),s=e.getComponent(a),l=t.getComponent(n),c=t.getComponent(a),u=r.getComponent(n),h=(r.getComponent(a)-s/o*u)/(c-s/o*l);return[(u-h*l)/o,h]},yN=new eQ.Ray,yG=new eQ.Vector3,yH=new eQ.Matrix4,yV=({dir1:e,dir2:t,axis:r})=>{let{translation:n,translationLimits:i,annotations:a,annotationsClass:o,depthTest:s,scale:l,lineWidth:c,fixed:u,axisColors:h,hoveredColor:d,opacity:f,onDragStart:p,onDrag:m,onDragEnd:A,userData:g}=ez.useContext(yE),v=(0,eL.A)(e=>e.controls),y=ez.useRef(null),x=ez.useRef(null),E=ez.useRef(null),_=ez.useRef(0),C=ez.useRef(0),[b,w]=ez.useState(!1),B=ez.useCallback(e=>{a&&(y.current.innerText=`${n.current[(r+1)%3].toFixed(2)}, ${n.current[(r+2)%3].toFixed(2)}`,y.current.style.display="block"),e.stopPropagation();let t=e.point.clone(),i=new eQ.Vector3().setFromMatrixPosition(x.current.matrixWorld),o=new eQ.Vector3().setFromMatrixColumn(x.current.matrixWorld,0).normalize(),s=new eQ.Vector3().setFromMatrixColumn(x.current.matrixWorld,1).normalize(),l=new eQ.Vector3().setFromMatrixColumn(x.current.matrixWorld,2).normalize(),c=new eQ.Plane().setFromNormalAndCoplanarPoint(l,i);E.current={clickPoint:t,e1:o,e2:s,plane:c},_.current=n.current[(r+1)%3],C.current=n.current[(r+2)%3],p({component:"Slider",axis:r,origin:i,directions:[o,s,l]}),v&&(v.enabled=!1),e.target.setPointerCapture(e.pointerId)},[a,v,p,r]),I=ez.useCallback(e=>{if(e.stopPropagation(),b||w(!0),E.current){let{clickPoint:t,e1:o,e2:s,plane:l}=E.current,[c,u]=(null==i?void 0:i[(r+1)%3])||[void 0,void 0],[h,d]=(null==i?void 0:i[(r+2)%3])||[void 0,void 0];yN.copy(e.ray),yN.intersectPlane(l,yG),yN.direction.negate(),yN.intersectPlane(l,yG),yG.sub(t);let[f,p]=yU(o,s,yG);void 0!==c&&(f=Math.max(f,c-_.current)),void 0!==u&&(f=Math.min(f,u-_.current)),void 0!==h&&(p=Math.max(p,h-C.current)),void 0!==d&&(p=Math.min(p,d-C.current)),n.current[(r+1)%3]=_.current+f,n.current[(r+2)%3]=C.current+p,a&&(y.current.innerText=`${n.current[(r+1)%3].toFixed(2)}, ${n.current[(r+2)%3].toFixed(2)}`),yH.makeTranslation(f*o.x+p*s.x,f*o.y+p*s.y,f*o.z+p*s.z),m(yH)}},[a,m,b,n,i,r]),M=ez.useCallback(e=>{a&&(y.current.style.display="none"),e.stopPropagation(),E.current=null,A(),v&&(v.enabled=!0),e.target.releasePointerCapture(e.pointerId)},[a,v,A]),S=ez.useCallback(e=>{e.stopPropagation(),w(!1)},[]),T=ez.useMemo(()=>{let r=e.clone().normalize(),n=t.clone().normalize();return new eQ.Matrix4().makeBasis(r,n,r.clone().cross(n))},[e,t]),P=u?1/7:l/7,D=u?.225:.225*l,R=b?d:h[r],F=ez.useMemo(()=>[new eQ.Vector3(0,0,0),new eQ.Vector3(0,D,0),new eQ.Vector3(D,D,0),new eQ.Vector3(D,0,0),new eQ.Vector3(0,0,0)],[D]);return ez.createElement("group",{ref:x,matrix:T,matrixAutoUpdate:!1},a&&ez.createElement(eW,{position:[0,0,0]},ez.createElement("div",{style:{display:"none",background:"#151520",color:"white",padding:"6px 8px",borderRadius:7,whiteSpace:"nowrap"},className:o,ref:y})),ez.createElement("group",{position:[1.7*P,1.7*P,0]},ez.createElement("mesh",{visible:!0,onPointerDown:B,onPointerMove:I,onPointerUp:M,onPointerOut:S,scale:D,userData:g},ez.createElement("planeGeometry",null),ez.createElement("meshBasicMaterial",{transparent:!0,depthTest:s,color:R,polygonOffset:!0,polygonOffsetFactor:-10,side:eQ.DoubleSide,fog:!1})),ez.createElement(oT,{position:[-D/2,-D/2,0],transparent:!0,depthTest:s,points:F,lineWidth:c,color:R,opacity:f,polygonOffset:!0,polygonOffsetFactor:-10,userData:g,fog:!1})))},yj=new eQ.Vector3,yY=new eQ.Vector3,yJ=(e,t,r,n)=>{let i=t.dot(t),a=t.dot(e)-t.dot(r),o=t.dot(n);return 0===o?-a/i:(yj.copy(n).multiplyScalar(i/o).sub(t),yY.copy(n).multiplyScalar(a/o).add(r).sub(e),-yj.dot(yY)/yj.dot(yj))},yW=new eQ.Vector3(0,1,0),yq=new eQ.Vector3,yK=new eQ.Matrix4,yX=({direction:e,axis:t})=>{let{scaleLimits:r,annotations:n,annotationsClass:i,depthTest:a,scale:o,lineWidth:s,fixed:l,axisColors:c,hoveredColor:u,opacity:h,onDragStart:d,onDrag:f,onDragEnd:p,userData:m}=ez.useContext(yE),A=(0,eL.A)(e=>e.size),g=(0,eL.A)(e=>e.controls),v=ez.useRef(null),y=ez.useRef(null),x=ez.useRef(null),E=ez.useRef(1),_=ez.useRef(1),C=ez.useRef(null),[b,w]=ez.useState(!1),B=l?1.2:1.2*o,I=ez.useCallback(r=>{n&&(v.current.innerText=`${_.current.toFixed(2)}`,v.current.style.display="block"),r.stopPropagation();let i=new eQ.Matrix4().extractRotation(y.current.matrixWorld),a=r.point.clone(),s=new eQ.Vector3().setFromMatrixPosition(y.current.matrixWorld),c=e.clone().applyMatrix4(i).normalize(),u=y.current.matrixWorld.clone(),h=u.clone().invert(),f=l?1/os(y.current.getWorldPosition(yj),o,r.camera,A):1;C.current={clickPoint:a,dir:c,mPLG:u,mPLGInv:h,offsetMultiplier:f},d({component:"Sphere",axis:t,origin:s,directions:[c]}),g&&(g.enabled=!1),r.target.setPointerCapture(r.pointerId)},[n,g,e,d,t,l,o,A]),M=ez.useCallback(e=>{if(e.stopPropagation(),b||w(!0),C.current){let{clickPoint:i,dir:a,mPLG:s,mPLGInv:c,offsetMultiplier:u}=C.current,[h,d]=(null==r?void 0:r[t])||[1e-5,void 0],p=yJ(i,a,e.ray.origin,e.ray.direction)*u,m=Math.pow(2,.2*(l?p:p/o));e.shiftKey&&(m=Math.round(10*m)/10),m=Math.max(m,h/E.current),void 0!==d&&(m=Math.min(m,d/E.current)),_.current=E.current*m,x.current.position.set(0,B+p,0),n&&(v.current.innerText=`${_.current.toFixed(2)}`),yq.set(1,1,1),yq.setComponent(t,m),yK.makeScale(yq.x,yq.y,yq.z).premultiply(s).multiply(c),f(yK)}},[n,B,f,b,r,t]),S=ez.useCallback(e=>{n&&(v.current.style.display="none"),e.stopPropagation(),E.current=_.current,C.current=null,x.current.position.set(0,B,0),p(),g&&(g.enabled=!0),e.target.releasePointerCapture(e.pointerId)},[n,g,p,B]),T=ez.useCallback(e=>{e.stopPropagation(),w(!1)},[]),{radius:P,matrixL:D}=ez.useMemo(()=>{let t=l?s/o*1.8:o/22.5,r=new eQ.Quaternion().setFromUnitVectors(yW,e.clone().normalize());return{radius:t,matrixL:new eQ.Matrix4().makeRotationFromQuaternion(r)}},[e,o,s,l]),R=b?u:c[t];return ez.createElement("group",{ref:y},ez.createElement("group",{matrix:D,matrixAutoUpdate:!1,onPointerDown:I,onPointerMove:M,onPointerUp:S,onPointerOut:T},n&&ez.createElement(eW,{position:[0,B/2,0]},ez.createElement("div",{style:{display:"none",background:"#151520",color:"white",padding:"6px 8px",borderRadius:7,whiteSpace:"nowrap"},className:i,ref:v})),ez.createElement("mesh",{ref:x,position:[0,B,0],renderOrder:500,userData:m},ez.createElement("sphereGeometry",{args:[P,12,12]}),ez.createElement("meshBasicMaterial",{transparent:!0,depthTest:a,color:R,opacity:h,polygonOffset:!0,polygonOffsetFactor:-10}))))},yZ=new eQ.Matrix4,y$=new eQ.Matrix4,y0=new eQ.Matrix4,y1=new eQ.Matrix4,y2=new eQ.Matrix4,y3=new eQ.Matrix4,y4=new eQ.Matrix4,y5=new eQ.Matrix4,y6=new eQ.Matrix4,y8=new eQ.Box3,y9=new eQ.Box3,y7=new eQ.Vector3,xe=new eQ.Vector3,xt=new eQ.Vector3,xr=new eQ.Vector3,xn=new eQ.Vector3,xi=new eQ.Vector3(1,0,0),xa=new eQ.Vector3(0,1,0),xo=new eQ.Vector3(0,0,1),xs=ez.forwardRef(({enabled:e=!0,matrix:t,onDragStart:r,onDrag:n,onDragEnd:i,autoTransform:a=!0,anchor:o,disableAxes:s=!1,disableSliders:l=!1,disableRotations:c=!1,disableScaling:u=!1,activeAxes:h=[!0,!0,!0],offset:d=[0,0,0],rotation:f=[0,0,0],scale:p=1,lineWidth:m=4,fixed:A=!1,translationLimits:g,rotationLimits:v,scaleLimits:y,depthTest:x=!0,axisColors:E=["#ff2060","#20df80","#2080ff"],hoveredColor:_="#ffff40",annotations:C=!1,annotationsClass:b,opacity:w=1,visible:B=!0,userData:I,children:M,...S},T)=>{let P=(0,eL.A)(e=>e.invalidate),D=ez.useRef(null),R=ez.useRef(null),F=ez.useRef(null),z=ez.useRef(null),O=ez.useRef([0,0,0]),Q=ez.useRef(new eQ.Vector3(1,1,1)),L=ez.useRef(new eQ.Vector3(1,1,1));ez.useLayoutEffect(()=>{o&&(z.current.updateWorldMatrix(!0,!0),y1.copy(z.current.matrixWorld).invert(),y8.makeEmpty(),z.current.traverse(e=>{e.geometry&&(e.geometry.boundingBox||e.geometry.computeBoundingBox(),y3.copy(e.matrixWorld).premultiply(y1),y9.copy(e.geometry.boundingBox),y9.applyMatrix4(y3),y8.union(y9))}),y7.copy(y8.max).add(y8.min).multiplyScalar(.5),xe.copy(y8.max).sub(y8.min).multiplyScalar(.5),xt.copy(xe).multiply(new eQ.Vector3(...o)).add(y7),xr.set(...d).add(xt),F.current.position.copy(xr),P())});let k=ez.useMemo(()=>({onDragStart:e=>{yZ.copy(R.current.matrix),y$.copy(R.current.matrixWorld),r&&r(e),P()},onDrag:e=>{y0.copy(D.current.matrixWorld),y1.copy(y0).invert(),y2.copy(y$).premultiply(e),y3.copy(y2).premultiply(y1),y4.copy(yZ).invert(),y5.copy(y3).multiply(y4),a&&R.current.matrix.copy(y3),n&&n(y3,y5,y2,e),P()},onDragEnd:()=>{i&&i(),P()},translation:O,translationLimits:g,rotationLimits:v,axisColors:E,hoveredColor:_,opacity:w,scale:p,lineWidth:m,fixed:A,depthTest:x,userData:I,annotations:C,annotationsClass:b}),[r,n,i,O,g,v,y,x,p,m,A,...E,_,w,I,a,C,b]),U=new eQ.Vector3;return(0,eL.C)(e=>{if(A){let t=os(F.current.getWorldPosition(U),p,e.camera,e.size);Q.current.setScalar(t)}t&&t instanceof eQ.Matrix4&&(R.current.matrix=t),R.current.updateWorldMatrix(!0,!0),y6.makeRotationFromEuler(F.current.rotation).setPosition(F.current.position).premultiply(R.current.matrixWorld),L.current.setFromMatrixScale(y6),xn.copy(Q.current).divide(L.current),(Math.abs(F.current.scale.x-xn.x)>1e-4||Math.abs(F.current.scale.y-xn.y)>1e-4||Math.abs(F.current.scale.z-xn.z)>1e-4)&&(F.current.scale.copy(xn),e.invalidate())}),ez.useImperativeHandle(T,()=>R.current,[]),ez.createElement(yE.Provider,{value:k},ez.createElement("group",{ref:D},ez.createElement("group",ee({ref:R,matrix:t,matrixAutoUpdate:!1},S),ez.createElement("group",{visible:B,ref:F,position:d,rotation:f},e&&ez.createElement(ez.Fragment,null,!s&&h[0]&&ez.createElement(yI,{axis:0,direction:xi}),!s&&h[1]&&ez.createElement(yI,{axis:1,direction:xa}),!s&&h[2]&&ez.createElement(yI,{axis:2,direction:xo}),!l&&h[0]&&h[1]&&ez.createElement(yV,{axis:2,dir1:xi,dir2:xa}),!l&&h[0]&&h[2]&&ez.createElement(yV,{axis:1,dir1:xo,dir2:xi}),!l&&h[2]&&h[1]&&ez.createElement(yV,{axis:0,dir1:xa,dir2:xo}),!c&&h[0]&&h[1]&&ez.createElement(yk,{axis:2,dir1:xi,dir2:xa}),!c&&h[0]&&h[2]&&ez.createElement(yk,{axis:1,dir1:xo,dir2:xi}),!c&&h[2]&&h[1]&&ez.createElement(yk,{axis:0,dir1:xa,dir2:xo}),!u&&h[0]&&ez.createElement(yX,{axis:0,direction:xi}),!u&&h[1]&&ez.createElement(yX,{axis:1,direction:xa}),!u&&h[2]&&ez.createElement(yX,{axis:2,direction:xo}))),ez.createElement("group",{ref:z},M))))}),xl=new eQ.Vector3(0,0,-1),xc=function(){let e=new eQ.Vector3,t=new eQ.Vector3,r=new eQ.Vector3,n=new eQ.Vector3,i=new eQ.Vector3;return function(a,o,s,l){return e.copy(a),t.copy(o),r.copy(s),n.copy(t).sub(e),i.copy(r).sub(e),l.crossVectors(i,n).normalize()}}(),xu=ez.forwardRef(({points:e=xf.SAMPLE_FACELANDMARKER_RESULT.faceLandmarks[0],face:t,facialTransformationMatrix:r,faceBlendshapes:n,offset:i,offsetScalar:a=80,width:o,height:s,depth:l=1,verticalTri:c=[159,386,152],origin:u,eyes:h=!0,eyesAsOrigin:d=!1,debug:f=!1,children:p,...m},A)=>{var g;t&&(e=t.keypoints,console.warn("Facemesh `face` prop is deprecated: use `points` instead"));let v=ez.useRef(null),y=ez.useRef(null),x=ez.useRef(null),E=ez.useRef(null),_=ez.useRef(null),C=ez.useRef(null),b=ez.useRef(null),[w]=ez.useState(()=>new eQ.Vector3),[B]=ez.useState(()=>new eQ.Object3D),[I]=ez.useState(()=>new eQ.Quaternion),[M]=ez.useState(()=>new eQ.Vector3),{invalidate:S}=(0,eL.A)();ez.useEffect(()=>{var e;null==(e=_.current)||e.geometry.setIndex(xf.TRIANGULATION)},[]);let[T]=ez.useState(()=>new eQ.Vector3);ez.useEffect(()=>{var t,p,m,A,g,P;let D=null==(t=_.current)?void 0:t.geometry;if(!D)return;D.setFromPoints(e),D.setDrawRange(0,xf.TRIANGULATION.length),r?(B.matrix.fromArray(r.data),B.matrix.decompose(B.position,B.quaternion,B.scale),B.rotation.y*=-1,B.rotation.z*=-1,I.setFromEuler(B.rotation),i?(B.position.y*=-1,B.position.z*=-1,null==(m=v.current)||m.position.copy(B.position.divideScalar(a))):null==(A=v.current)||A.position.set(0,0,0)):(xc(e[c[0]],e[c[1]],e[c[2]],w),I.setFromUnitVectors(xl,w));let R=I.clone().invert();if(D.computeBoundingBox(),f&&S(),D.center(),D.applyQuaternion(R),null==(p=E.current)||p.setRotationFromQuaternion(I),h){if(n){if(C.current&&b.current&&x.current){if(d){let e=C.current._computeSphere(D),t=b.current._computeSphere(D);u=(g=e.center,P=t.center,g.clone().add(P).multiplyScalar(.5)).negate(),C.current._update(D,n,e),b.current._update(D,n,t)}else C.current._update(D,n),b.current._update(D,n)}}else console.warn("Facemesh `eyes` option only works if `faceBlendshapes` is provided: skipping.")}if(x.current){if(void 0!==u){if("number"==typeof u){let e=D.getAttribute("position");M.set(-e.getX(u),-e.getY(u),-e.getZ(u))}else u.isVector3&&M.copy(u)}else M.setScalar(0);x.current.position.copy(M)}if(y.current){let e=1;(o||s||l)&&(D.boundingBox.getSize(T),o&&(e=o/T.x),s&&(e=s/T.y),l&&(e=l/T.z)),y.current.scale.setScalar(1!==e?e:1)}D.computeVertexNormals(),D.attributes.position.needsUpdate=!0},[e,r,n,B,i,a,o,s,l,c,u,h,f,S,w,I,T,M]);let P=ez.useMemo(()=>({outerRef:E,meshRef:_,eyeRightRef:C,eyeLeftRef:b}),[]);ez.useImperativeHandle(A,()=>P,[P]);let[D]=ez.useState(()=>new eQ.Vector3),R=null==(g=_.current)?void 0:g.geometry.boundingBox,F=(null==R?void 0:R.getSize(D).z)||1;return ez.createElement("group",m,ez.createElement("group",{ref:v},ez.createElement("group",{ref:E},ez.createElement("group",{ref:y},f?ez.createElement(ez.Fragment,null,ez.createElement("axesHelper",{args:[F]}),ez.createElement(oT,{points:[[0,0,0],[0,0,-F]],color:65535})):null,ez.createElement("group",{ref:x},h&&n&&ez.createElement("group",{name:"eyes"},ez.createElement(xd,{side:"left",ref:C,debug:f}),ez.createElement(xd,{side:"right",ref:b,debug:f})),ez.createElement("mesh",{ref:_,name:"face"},p,f?ez.createElement(ez.Fragment,null,R&&ez.createElement("box3Helper",{args:[R]})):null))))))}),xh={contourLandmarks:{right:[33,133,159,145,153],left:[263,362,386,374,380]},blendshapes:{right:[14,16,18,12],left:[13,15,17,11]},color:{right:"red",left:"#00ff00"},fov:{horizontal:100,vertical:90}},xd=ez.forwardRef(({side:e,debug:t=!0},r)=>{let n=ez.useRef(null),i=ez.useRef(null),[a]=ez.useState(()=>new eQ.Sphere),o=ez.useCallback(t=>{let r=t.getAttribute("position"),n=xh.contourLandmarks[e].map(e=>new eQ.Vector3(r.getX(e),r.getY(e),r.getZ(e)));return a.center.set(0,0,0),n.forEach(e=>a.center.add(e)),a.center.divideScalar(n.length),a.radius=n[0].sub(n[1]).length()/2,a},[a,e]),[s]=ez.useState(()=>new eQ.Euler),l=ez.useCallback((t,r,a)=>{if(n.current){var l;null!==(l=a)&&void 0!==l||(a=o(t)),n.current.position.copy(a.center),n.current.scale.setScalar(a.radius)}if(r&&i.current){let t=xh.blendshapes[e],n=r.categories[t[0]].score,a=r.categories[t[1]].score,o=r.categories[t[2]].score,l=r.categories[t[3]].score,c=xh.fov.horizontal*eQ.MathUtils.DEG2RAD,u=xh.fov.vertical*eQ.MathUtils.DEG2RAD*.5*(n-a)*("left"===e?1:-1);s.set(.5*c*(l-o),u,0),i.current.setRotationFromEuler(s)}},[o,e,s]),c=ez.useMemo(()=>({eyeMeshRef:n,irisDirRef:i,_computeSphere:o,_update:l}),[o,l]);ez.useImperativeHandle(r,()=>c,[c]);let u=xh.color[e];return ez.createElement("group",null,ez.createElement("group",{ref:n},t&&ez.createElement("axesHelper",null),ez.createElement("group",{ref:i},ez.createElement(ez.Fragment,null,t&&ez.createElement(oT,{points:[[0,0,0],[0,0,-2]],lineWidth:1,color:u})))))}),xf={TRIANGULATION:[127,34,139,11,0,37,232,231,120,72,37,39,128,121,47,232,121,128,104,69,67,175,171,148,157,154,155,118,50,101,73,39,40,9,151,108,48,115,131,194,204,211,74,40,185,80,42,183,40,92,186,230,229,118,202,212,214,83,18,17,76,61,146,160,29,30,56,157,173,106,204,194,135,214,192,203,165,98,21,71,68,51,45,4,144,24,23,77,146,91,205,50,187,201,200,18,91,106,182,90,91,181,85,84,17,206,203,36,148,171,140,92,40,39,193,189,244,159,158,28,247,246,161,236,3,196,54,68,104,193,168,8,117,228,31,189,193,55,98,97,99,126,47,100,166,79,218,155,154,26,209,49,131,135,136,150,47,126,217,223,52,53,45,51,134,211,170,140,67,69,108,43,106,91,230,119,120,226,130,247,63,53,52,238,20,242,46,70,156,78,62,96,46,53,63,143,34,227,173,155,133,123,117,111,44,125,19,236,134,51,216,206,205,154,153,22,39,37,167,200,201,208,36,142,100,57,212,202,20,60,99,28,158,157,35,226,113,160,159,27,204,202,210,113,225,46,43,202,204,62,76,77,137,123,116,41,38,72,203,129,142,64,98,240,49,102,64,41,73,74,212,216,207,42,74,184,169,170,211,170,149,176,105,66,69,122,6,168,123,147,187,96,77,90,65,55,107,89,90,180,101,100,120,63,105,104,93,137,227,15,86,85,129,102,49,14,87,86,55,8,9,100,47,121,145,23,22,88,89,179,6,122,196,88,95,96,138,172,136,215,58,172,115,48,219,42,80,81,195,3,51,43,146,61,171,175,199,81,82,38,53,46,225,144,163,110,246,33,7,52,65,66,229,228,117,34,127,234,107,108,69,109,108,151,48,64,235,62,78,191,129,209,126,111,35,143,163,161,246,117,123,50,222,65,52,19,125,141,221,55,65,3,195,197,25,7,33,220,237,44,70,71,139,122,193,245,247,130,33,71,21,162,153,158,159,170,169,150,188,174,196,216,186,92,144,160,161,2,97,167,141,125,241,164,167,37,72,38,12,145,159,160,38,82,13,63,68,71,226,35,111,158,153,154,101,50,205,206,92,165,209,198,217,165,167,97,220,115,218,133,112,243,239,238,241,214,135,169,190,173,133,171,208,32,125,44,237,86,87,178,85,86,179,84,85,180,83,84,181,201,83,182,137,93,132,76,62,183,61,76,184,57,61,185,212,57,186,214,207,187,34,143,156,79,239,237,123,137,177,44,1,4,201,194,32,64,102,129,213,215,138,59,166,219,242,99,97,2,94,141,75,59,235,24,110,228,25,130,226,23,24,229,22,23,230,26,22,231,112,26,232,189,190,243,221,56,190,28,56,221,27,28,222,29,27,223,30,29,224,247,30,225,238,79,20,166,59,75,60,75,240,147,177,215,20,79,166,187,147,213,112,233,244,233,128,245,128,114,188,114,217,174,131,115,220,217,198,236,198,131,134,177,132,58,143,35,124,110,163,7,228,110,25,356,389,368,11,302,267,452,350,349,302,303,269,357,343,277,452,453,357,333,332,297,175,152,377,384,398,382,347,348,330,303,304,270,9,336,337,278,279,360,418,262,431,304,408,409,310,415,407,270,409,410,450,348,347,422,430,434,313,314,17,306,307,375,387,388,260,286,414,398,335,406,418,364,367,416,423,358,327,251,284,298,281,5,4,373,374,253,307,320,321,425,427,411,421,313,18,321,405,406,320,404,405,315,16,17,426,425,266,377,400,369,322,391,269,417,465,464,386,257,258,466,260,388,456,399,419,284,332,333,417,285,8,346,340,261,413,441,285,327,460,328,355,371,329,392,439,438,382,341,256,429,420,360,364,394,379,277,343,437,443,444,283,275,440,363,431,262,369,297,338,337,273,375,321,450,451,349,446,342,467,293,334,282,458,461,462,276,353,383,308,324,325,276,300,293,372,345,447,382,398,362,352,345,340,274,1,19,456,248,281,436,427,425,381,256,252,269,391,393,200,199,428,266,330,329,287,273,422,250,462,328,258,286,384,265,353,342,387,259,257,424,431,430,342,353,276,273,335,424,292,325,307,366,447,345,271,303,302,423,266,371,294,455,460,279,278,294,271,272,304,432,434,427,272,407,408,394,430,431,395,369,400,334,333,299,351,417,168,352,280,411,325,319,320,295,296,336,319,403,404,330,348,349,293,298,333,323,454,447,15,16,315,358,429,279,14,15,316,285,336,9,329,349,350,374,380,252,318,402,403,6,197,419,318,319,325,367,364,365,435,367,397,344,438,439,272,271,311,195,5,281,273,287,291,396,428,199,311,271,268,283,444,445,373,254,339,263,466,249,282,334,296,449,347,346,264,447,454,336,296,299,338,10,151,278,439,455,292,407,415,358,371,355,340,345,372,390,249,466,346,347,280,442,443,282,19,94,370,441,442,295,248,419,197,263,255,359,440,275,274,300,383,368,351,412,465,263,467,466,301,368,389,380,374,386,395,378,379,412,351,419,436,426,322,373,390,388,2,164,393,370,462,461,164,0,267,302,11,12,374,373,387,268,12,13,293,300,301,446,261,340,385,384,381,330,266,425,426,423,391,429,355,437,391,327,326,440,457,438,341,382,362,459,457,461,434,430,394,414,463,362,396,369,262,354,461,457,316,403,402,315,404,403,314,405,404,313,406,405,421,418,406,366,401,361,306,408,407,291,409,408,287,410,409,432,436,410,434,416,411,264,368,383,309,438,457,352,376,401,274,275,4,421,428,262,294,327,358,433,416,367,289,455,439,462,370,326,2,326,370,305,460,455,254,449,448,255,261,446,253,450,449,252,451,450,256,452,451,341,453,452,413,464,463,441,413,414,258,442,441,257,443,442,259,444,443,260,445,444,467,342,445,459,458,250,289,392,290,290,328,460,376,433,435,250,290,392,411,416,433,341,463,464,453,464,465,357,465,412,343,412,399,360,363,440,437,399,456,420,456,363,401,435,288,372,383,353,339,255,249,448,261,255,133,243,190,133,155,112,33,246,247,33,130,25,398,384,286,362,398,414,362,463,341,263,359,467,263,249,255,466,467,260,75,60,166,238,239,79,162,127,139,72,11,37,121,232,120,73,72,39,114,128,47,233,232,128,103,104,67,152,175,148,173,157,155,119,118,101,74,73,40,107,9,108,49,48,131,32,194,211,184,74,185,191,80,183,185,40,186,119,230,118,210,202,214,84,83,17,77,76,146,161,160,30,190,56,173,182,106,194,138,135,192,129,203,98,54,21,68,5,51,4,145,144,23,90,77,91,207,205,187,83,201,18,181,91,182,180,90,181,16,85,17,205,206,36,176,148,140,165,92,39,245,193,244,27,159,28,30,247,161,174,236,196,103,54,104,55,193,8,111,117,31,221,189,55,240,98,99,142,126,100,219,166,218,112,155,26,198,209,131,169,135,150,114,47,217,224,223,53,220,45,134,32,211,140,109,67,108,146,43,91,231,230,120,113,226,247,105,63,52,241,238,242,124,46,156,95,78,96,70,46,63,116,143,227,116,123,111,1,44,19,3,236,51,207,216,205,26,154,22,165,39,167,199,200,208,101,36,100,43,57,202,242,20,99,56,28,157,124,35,113,29,160,27,211,204,210,124,113,46,106,43,204,96,62,77,227,137,116,73,41,72,36,203,142,235,64,240,48,49,64,42,41,74,214,212,207,183,42,184,210,169,211,140,170,176,104,105,69,193,122,168,50,123,187,89,96,90,66,65,107,179,89,180,119,101,120,68,63,104,234,93,227,16,15,85,209,129,49,15,14,86,107,55,9,120,100,121,153,145,22,178,88,179,197,6,196,89,88,96,135,138,136,138,215,172,218,115,219,41,42,81,5,195,51,57,43,61,208,171,199,41,81,38,224,53,225,24,144,110,105,52,66,118,229,117,227,34,234,66,107,69,10,109,151,219,48,235,183,62,191,142,129,126,116,111,143,7,163,246,118,117,50,223,222,52,94,19,141,222,221,65,196,3,197,45,220,44,156,70,139,188,122,245,139,71,162,145,153,159,149,170,150,122,188,196,206,216,92,163,144,161,164,2,167,242,141,241,0,164,37,11,72,12,144,145,160,12,38,13,70,63,71,31,226,111,157,158,154,36,101,205,203,206,165,126,209,217,98,165,97,237,220,218,237,239,241,210,214,169,140,171,32,241,125,237,179,86,178,180,85,179,181,84,180,182,83,181,194,201,182,177,137,132,184,76,183,185,61,184,186,57,185,216,212,186,192,214,187,139,34,156,218,79,237,147,123,177,45,44,4,208,201,32,98,64,129,192,213,138,235,59,219,141,242,97,97,2,141,240,75,235,229,24,228,31,25,226,230,23,229,231,22,230,232,26,231,233,112,232,244,189,243,189,221,190,222,28,221,223,27,222,224,29,223,225,30,224,113,247,225,99,60,240,213,147,215,60,20,166,192,187,213,243,112,244,244,233,245,245,128,188,188,114,174,134,131,220,174,217,236,236,198,134,215,177,58,156,143,124,25,110,7,31,228,25,264,356,368,0,11,267,451,452,349,267,302,269,350,357,277,350,452,357,299,333,297,396,175,377,381,384,382,280,347,330,269,303,270,151,9,337,344,278,360,424,418,431,270,304,409,272,310,407,322,270,410,449,450,347,432,422,434,18,313,17,291,306,375,259,387,260,424,335,418,434,364,416,391,423,327,301,251,298,275,281,4,254,373,253,375,307,321,280,425,411,200,421,18,335,321,406,321,320,405,314,315,17,423,426,266,396,377,369,270,322,269,413,417,464,385,386,258,248,456,419,298,284,333,168,417,8,448,346,261,417,413,285,326,327,328,277,355,329,309,392,438,381,382,256,279,429,360,365,364,379,355,277,437,282,443,283,281,275,363,395,431,369,299,297,337,335,273,321,348,450,349,359,446,467,283,293,282,250,458,462,300,276,383,292,308,325,283,276,293,264,372,447,346,352,340,354,274,19,363,456,281,426,436,425,380,381,252,267,269,393,421,200,428,371,266,329,432,287,422,290,250,328,385,258,384,446,265,342,386,387,257,422,424,430,445,342,276,422,273,424,306,292,307,352,366,345,268,271,302,358,423,371,327,294,460,331,279,294,303,271,304,436,432,427,304,272,408,395,394,431,378,395,400,296,334,299,6,351,168,376,352,411,307,325,320,285,295,336,320,319,404,329,330,349,334,293,333,366,323,447,316,15,315,331,358,279,317,14,316,8,285,9,277,329,350,253,374,252,319,318,403,351,6,419,324,318,325,397,367,365,288,435,397,278,344,439,310,272,311,248,195,281,375,273,291,175,396,199,312,311,268,276,283,445,390,373,339,295,282,296,448,449,346,356,264,454,337,336,299,337,338,151,294,278,455,308,292,415,429,358,355,265,340,372,388,390,466,352,346,280,295,442,282,354,19,370,285,441,295,195,248,197,457,440,274,301,300,368,417,351,465,251,301,389,385,380,386,394,395,379,399,412,419,410,436,322,387,373,388,326,2,393,354,370,461,393,164,267,268,302,12,386,374,387,312,268,13,298,293,301,265,446,340,380,385,381,280,330,425,322,426,391,420,429,437,393,391,326,344,440,438,458,459,461,364,434,394,428,396,262,274,354,457,317,316,402,316,315,403,315,314,404,314,313,405,313,421,406,323,366,361,292,306,407,306,291,408,291,287,409,287,432,410,427,434,411,372,264,383,459,309,457,366,352,401,1,274,4,418,421,262,331,294,358,435,433,367,392,289,439,328,462,326,94,2,370,289,305,455,339,254,448,359,255,446,254,253,449,253,252,450,252,256,451,256,341,452,414,413,463,286,441,414,286,258,441,258,257,442,257,259,443,259,260,444,260,467,445,309,459,250,305,289,290,305,290,460,401,376,435,309,250,392,376,411,433,453,341,464,357,453,465,343,357,412,437,343,399,344,360,440,420,437,456,360,420,363,361,401,288,265,372,353,390,339,249,339,448,255],SAMPLE_FACE:{keypoints:[{x:356.2804412841797,y:295.1960563659668,z:-23.786449432373047,name:"lips"},{x:354.8859405517578,y:264.69520568847656,z:-36.718435287475586},{x:355.2180862426758,y:275.3360366821289,z:-21.183712482452393},{x:347.349853515625,y:242.4400234222412,z:-25.093655586242676},{x:354.40135955810547,y:256.67933464050293,z:-38.23572635650635},{x:353.7689971923828,y:247.54886627197266,z:-34.5475435256958},{x:352.1288299560547,y:227.34312057495117,z:-13.095386028289795},{x:303.5013198852539,y:234.67002868652344,z:12.500141859054565,name:"rightEye"},{x:351.09378814697266,y:211.87547206878662,z:-6.413471698760986},{x:350.7115936279297,y:202.1251630783081,z:-6.413471698760986},{x:348.33667755126953,y:168.7741756439209,z:6.483500003814697,name:"faceOval"},{x:356.4806365966797,y:299.2995357513428,z:-23.144519329071045},{x:356.5511703491211,y:302.66146659851074,z:-21.020312309265137},{x:356.6239547729492,y:304.1536331176758,z:-18.137459754943848,name:"lips"},{x:356.5807342529297,y:305.1840591430664,z:-18.767719268798828,name:"lips"},{x:356.8241500854492,y:308.25711250305176,z:-20.16829490661621},{x:357.113037109375,y:312.26277351379395,z:-22.10575819015503},{x:357.34962463378906,y:317.1123218536377,z:-21.837315559387207,name:"lips"},{x:357.6658630371094,y:325.51036834716797,z:-16.27002477645874},{x:355.0201416015625,y:269.36279296875,z:-33.73054027557373},{x:348.5237503051758,y:270.33411026000977,z:-24.93025302886963},{x:279.97331619262695,y:213.24176788330078,z:47.759642601013184,name:"faceOval"},{x:322.66529083251953,y:238.5027265548706,z:5.535193085670471},{x:316.0983657836914,y:239.94489669799805,z:5.777376294136047},{x:309.9431610107422,y:240.24518966674805,z:7.510589361190796},{x:301.31994247436523,y:237.86138534545898,z:13.118728399276733},{x:328.14266204833984,y:235.80496788024902,z:6.646900177001953},{x:313.7326431274414,y:222.11161136627197,z:3.9887237548828125},{x:320.45196533203125,y:221.87729358673096,z:4.601476192474365},{x:307.35679626464844,y:223.63793849945068,z:5.932023525238037},{x:303.0031204223633,y:226.3743782043457,z:8.479321002960205},{x:296.80023193359375,y:242.94299125671387,z:15.931552648544312},{x:332.2352981567383,y:340.77341079711914,z:-10.165848731994629},{x:301.38587951660156,y:233.46447944641113,z:14.764405488967896,name:"rightEye"},{x:279.0147018432617,y:244.37155723571777,z:45.77549457550049},{x:289.60548400878906,y:239.1807460784912,z:23.191204071044922},{x:320.32257080078125,y:267.1292781829834,z:-4.954537749290466},{x:347.64583587646484,y:294.4955062866211,z:-23.062820434570313,name:"lips"},{x:349.28138732910156,y:303.1095886230469,z:-20.238323211669922},{x:338.9453125,y:298.19186210632324,z:-19.456336498260498,name:"lips"},{x:333.36788177490234,y:302.6706790924072,z:-14.776077270507813,name:"lips"},{x:342.89188385009766,y:304.3561363220215,z:-17.752301692962646},{x:337.7375030517578,y:306.0098361968994,z:-13.410515785217285},{x:325.6159210205078,y:316.22995376586914,z:-6.681914925575256},{x:349.0104675292969,y:264.9818515777588,z:-36.274919509887695},{x:347.7138900756836,y:257.5664806365967,z:-37.67549514770508},{x:291.79357528686523,y:218.88171672821045,z:11.578094959259033,name:"rightEyebrow"},{x:332.2689437866211,y:247.56946563720703,z:-3.3730539679527283},{x:332.0074462890625,y:267.1201229095459,z:-19.969879388809204},{x:331.27952575683594,y:263.6967658996582,z:-17.47218608856201},{x:301.04373931884766,y:269.56552505493164,z:3.61815482378006},{x:347.4863815307617,y:249.0706443786621,z:-32.633421421051025},{x:307.26118087768555,y:208.2646894454956,z:1.1591226607561111,name:"rightEyebrow"},{x:297.91919708251953,y:212.22604751586914,z:5.914516448974609,name:"rightEyebrow"},{x:285.1651382446289,y:197.98450469970703,z:36.391637325286865,name:"faceOval"},{x:337.04097747802734,y:211.25229835510254,z:-4.548954665660858},{x:326.5912628173828,y:223.16698551177979,z:6.670243740081787},{x:320.05664825439453,y:309.5834255218506,z:-4.055835008621216},{x:289.6866226196289,y:314.617395401001,z:53.875489234924316,name:"faceOval"},{x:337.4256896972656,y:270.8755302429199,z:-17.67060160636902},{x:343.69922637939453,y:273.0000400543213,z:-18.756048679351807},{x:327.4242401123047,y:309.22399520874023,z:-4.703601002693176,name:"lips"},{x:330.37220001220703,y:308.3323001861572,z:-6.442649960517883},{x:293.87027740478516,y:207.7961826324463,z:9.821539521217346,name:"rightEyebrow"},{x:332.11437225341797,y:271.22812271118164,z:-16.64351224899292},{x:320.1197814941406,y:207.40366458892822,z:-2.48164564371109,name:"rightEyebrow"},{x:318.59575271606445,y:201.07443809509277,z:-3.110446035861969,name:"rightEyebrow"},{x:310.72303771972656,y:175.75075149536133,z:13.328815698623657,name:"faceOval"},{x:289.67578887939453,y:202.29835510253906,z:21.370456218719482},{x:315.30879974365234,y:187.35260009765625,z:5.0304025411605835},{x:287.8936767578125,y:216.54793739318848,z:17.81065821647644,name:"rightEyebrow"},{x:283.9391899108887,y:215.01142501831055,z:32.04984903335571},{x:348.35330963134766,y:299.4155788421631,z:-22.47924566268921},{x:341.1790466308594,y:301.8221855163574,z:-18.977805376052856},{x:335.69713592529297,y:304.4266891479492,z:-14.682706594467163},{x:339.4615173339844,y:272.3654365539551,z:-16.38674020767212},{x:328.99600982666016,y:308.86685371398926,z:-5.616893768310547},{x:332.00313568115234,y:309.1875743865967,z:-10.335084199905396},{x:331.0068130493164,y:307.9274368286133,z:-6.681914925575256,name:"lips"},{x:341.13792419433594,y:266.4876937866211,z:-26.56425952911377},{x:339.02950286865234,y:305.6663703918457,z:-12.33674168586731,name:"lips"},{x:344.22935485839844,y:304.9452781677246,z:-15.161235332489014,name:"lips"},{x:350.1844024658203,y:304.374303817749,z:-17.5305438041687,name:"lips"},{x:348.52630615234375,y:325.9562301635742,z:-16.164982318878174},{x:348.6581802368164,y:317.1624183654785,z:-21.510512828826904,name:"lips"},{x:348.9766311645508,y:312.1923065185547,z:-21.708929538726807},{x:349.2427444458008,y:308.0660820007324,z:-19.643079042434692},{x:349.67491149902344,y:305.42747497558594,z:-18.16080331802368,name:"lips"},{x:337.95589447021484,y:306.6535949707031,z:-12.803598642349243,name:"lips"},{x:337.06878662109375,y:307.63169288635254,z:-14.274203777313232},{x:335.77449798583984,y:309.8449516296387,z:-15.698124170303345},{x:334.6099090576172,y:312.7997016906738,z:-14.764405488967896,name:"lips"},{x:327.2330856323242,y:293.80866050720215,z:-11.864047050476074},{x:280.97679138183594,y:279.79928970336914,z:68.90834331512451,name:"faceOval"},{x:355.13843536376953,y:271.7875671386719,z:-25.350427627563477},{x:334.7235870361328,y:307.4656391143799,z:-9.302158951759338,name:"lips"},{x:333.5293960571289,y:307.89782524108887,z:-10.200862884521484},{x:346.29688262939453,y:276.4256286621094,z:-19.748122692108154},{x:335.16246795654297,y:276.22097969055176,z:-12.313398122787476},{x:345.09132385253906,y:274.7082996368408,z:-19.304605722427368},{x:325.4267883300781,y:252.95130729675293,z:-1.6661019623279572},{x:315.347843170166,y:259.05200958251953,z:-.25604281574487686},{x:330.44933319091797,y:267.7570152282715,z:-14.017432928085327},{x:294.96768951416016,y:185.26001930236816,z:23.903164863586426,name:"faceOval"},{x:299.63531494140625,y:192.7913761138916,z:12.640198469161987},{x:304.5452117919922,y:202.4142837524414,z:3.244667649269104,name:"rightEyebrow"},{x:331.6915512084961,y:320.0467872619629,z:-10.632705688476563},{x:334.5911407470703,y:201.27566814422607,z:-6.133356094360352,name:"rightEyebrow"},{x:331.4815902709961,y:185.44180870056152,z:.6627205014228821},{x:328.05816650390625,y:170.8385467529297,z:7.358860373497009,name:"faceOval"},{x:304.49764251708984,y:239.76297855377197,z:10.387605428695679},{x:290.6382179260254,y:248.85257720947266,z:19.03616428375244},{x:331.5682601928711,y:233.20727348327637,z:7.837390303611755},{x:295.5115509033203,y:228.9834451675415,z:14.41426157951355},{x:336.94332122802734,y:241.8259334564209,z:-5.27842104434967},{x:336.2792205810547,y:262.7049922943115,z:-26.12074375152588},{x:284.4102478027344,y:255.3262710571289,z:25.467140674591064},{x:295.1420593261719,y:253.02655220031738,z:12.430112361907959},{x:303.5196113586426,y:254.20703887939453,z:6.139191389083862},{x:315.73450088500977,y:251.64799690246582,z:3.3788898587226868},{x:324.69661712646484,y:247.56494522094727,z:2.3328344523906708},{x:331.57970428466797,y:243.02241325378418,z:1.1423448473215103},{x:345.6210708618164,y:229.9976634979248,z:-10.825285911560059},{x:286.26644134521484,y:270.37991523742676,z:21.708929538726807},{x:290.2525520324707,y:228.4921360015869,z:17.71728754043579},{x:351.65367126464844,y:269.3400764465332,z:-33.450424671173096},{x:333.1378936767578,y:253.88388633728027,z:-7.230473756790161},{x:277.8318977355957,y:246.95331573486328,z:68.20805549621582,name:"faceOval"},{x:336.6680908203125,y:238.10003757476807,z:.7688578963279724},{x:329.95800018310547,y:269.18323516845703,z:-7.207130789756775},{x:299.17491912841797,y:234.13324356079102,z:15.95489501953125},{x:335.61729431152344,y:258.71752738952637,z:-23.016133308410645},{x:284.1079330444336,y:297.0343494415283,z:63.25934886932373,name:"faceOval"},{x:331.44542694091797,y:230.6892442703247,z:9.92658257484436,name:"rightEye"},{x:341.41536712646484,y:253.01264762878418,z:-29.038610458374023},{x:303.5472869873047,y:327.5896739959717,z:16.725212335586548},{x:304.7756576538086,y:337.4389457702637,z:27.38126277923584,name:"faceOval"},{x:280.80501556396484,y:275.32050132751465,z:45.0752067565918},{x:295.43582916259766,y:318.4501647949219,z:26.2608003616333},{x:281.4303207397461,y:228.7355661392212,z:40.94350814819336},{x:331.2549591064453,y:349.4216537475586,z:-7.376367449760437},{x:352.4247741699219,y:271.7330074310303,z:-24.953596591949463},{x:327.5672912597656,y:260.41900634765625,z:-5.456410646438599},{x:284.5432472229004,y:241.7647933959961,z:29.668869972229004},{x:310,y:235.66174507141113,z:8.502663969993591,name:"rightEye"},{x:315.7071113586426,y:235.7572603225708,z:6.938687562942505,name:"rightEye"},{x:330.41088104248047,y:311.04143142700195,z:-9.325502514839172,name:"lips"},{x:288.5377502441406,y:285.31983375549316,z:21.837315559387207},{x:344.55039978027344,y:359.4300842285156,z:-6.705257892608643,name:"faceOval"},{x:323.41880798339844,y:351.67362213134766,z:7.802375555038452,name:"faceOval"},{x:314.64088439941406,y:346.11894607543945,z:16.36339783668518,name:"faceOval"},{x:349.4945526123047,y:184.8434829711914,z:-.21847527474164963},{x:359.24694061279297,y:359.8348903656006,z:-8.403456211090088,name:"faceOval"},{x:321.26182556152344,y:234.64492321014404,z:6.90950870513916,name:"rightEye"},{x:326.318359375,y:232.90250301361084,z:8.029969334602356,name:"rightEye"},{x:329.6211624145508,y:231.6195774078369,z:9.722331762313843,name:"rightEye"},{x:285.9398078918457,y:228.2351303100586,z:24.650139808654785},{x:325.79288482666016,y:227.88007736206055,z:7.469738721847534,name:"rightEye"},{x:320.1699447631836,y:227.5934886932373,z:6.168370842933655,name:"rightEye"},{x:314.85408782958984,y:227.85282611846924,z:6.2675780057907104,name:"rightEye"},{x:309.3084907531738,y:229.1516876220703,z:7.7031683921813965,name:"rightEye"},{x:305.5621337890625,y:230.92366218566895,z:9.722331762313843,name:"rightEye"},{x:277.8681945800781,y:228.5354232788086,z:59.71122741699219,name:"faceOval"},{x:306.1444664001465,y:235.1954698562622,z:10.603528022766113,name:"rightEye"},{x:355.4478454589844,y:281.96210861206055,z:-20.565123558044434},{x:333.02661895751953,y:288.0105400085449,z:-14.72939133644104},{x:337.15728759765625,y:269.2059516906738,z:-19.8414945602417},{x:345.9898376464844,y:283.5453128814697,z:-20.4834246635437},{x:351.48963928222656,y:219.98916149139404,z:-7.0378947257995605},{x:312.39574432373047,y:336.50628089904785,z:8.671900033950806},{x:321.32152557373047,y:343.1755256652832,z:.9067271649837494},{x:343.78379821777344,y:353.2975959777832,z:-14.355905055999756},{x:296.8791389465332,y:327.91497230529785,z:41.01353645324707,name:"faceOval"},{x:329.6939468383789,y:229.27897453308105,z:8.934508562088013,name:"rightEye"},{x:341.6905212402344,y:241.4073657989502,z:-14.589333534240723},{x:359.03079986572266,y:353.48859786987305,z:-15.803166627883911},{x:333.1861877441406,y:356.43213272094727,z:-1.0234417766332626,name:"faceOval"},{x:283.97483825683594,y:291.4318656921387,z:41.94725513458252},{x:343.33770751953125,y:305.830135345459,z:-15.756480693817139,name:"lips"},{x:342.40283966064453,y:307.7453899383545,z:-17.4021577835083},{x:341.53621673583984,y:311.0595703125,z:-19.047834873199463},{x:340.9107208251953,y:315.4837703704834,z:-18.5576331615448,name:"lips"},{x:339.1478729248047,y:323.42233657836914,z:-14.367576837539673},{x:333.3201599121094,y:307.4406337738037,z:-9.617288708686829},{x:331.2411117553711,y:306.9811820983887,z:-9.669809937477112},{x:329.23255920410156,y:306.0508346557617,z:-9.582273960113525,name:"lips"},{x:322.4586486816406,y:301.33323669433594,z:-7.720675468444824},{x:297.1712112426758,y:286.9552803039551,z:8.240055441856384},{x:341.3060760498047,y:235.4432201385498,z:-7.504753470420837},{x:336.9318389892578,y:224.3451976776123,z:5.829898118972778},{x:332.65323638916016,y:226.70403957366943,z:8.105834126472473},{x:334.67357635498047,y:306.4397621154785,z:-8.981193900108337,name:"lips"},{x:297.4601936340332,y:306.29210472106934,z:15.476365089416504},{x:342.9119110107422,y:222.37077713012695,z:-2.754466235637665},{x:335.4629898071289,y:332.20250129699707,z:-11.823196411132813},{x:353.2412338256836,y:240.56339263916016,z:-27.147831916809082},{x:346.3080596923828,y:236.41446590423584,z:-18.452589511871338},{x:352.6475143432617,y:234.1420555114746,z:-19.748122692108154},{x:337.3209762573242,y:253.39937210083008,z:-16.024924516677856},{x:358.6122131347656,y:344.90861892700195,z:-18.592647314071655},{x:358.1117248535156,y:334.64990615844727,z:-17.49552845954895},{x:346.4450454711914,y:335.0321102142334,z:-16.32838249206543},{x:319.17640686035156,y:320.2833938598633,z:-3.276764452457428},{x:325.2540588378906,y:276.2369728088379,z:-6.460157036781311},{x:326.7214584350586,y:327.3939514160156,z:-7.417217493057251},{x:310.7190132141113,y:277.2265148162842,z:-3.5452082753181458},{x:319.78355407714844,y:284.8238182067871,z:-6.4543211460113525},{x:305.773983001709,y:290.83580017089844,z:.06907138042151928},{x:344.4001770019531,y:344.85408782958984,z:-16.946970224380493},{x:333.1879425048828,y:258.74256134033203,z:-11.90489649772644},{x:313.80598068237305,y:327.08919525146484,z:2.2277912497520447},{x:322.9637908935547,y:334.6819496154785,z:-3.3643004298210144},{x:313.4055519104004,y:311.2166690826416,z:-1.1175429821014404},{x:291.0865783691406,y:298.2831001281738,z:22.467575073242188},{x:305.6580924987793,y:313.3707904815674,z:5.561453700065613},{x:288.23760986328125,y:305.9941864013672,z:36.765122413635254},{x:315.10692596435547,y:296.26991271972656,z:-4.604393839836121},{x:337.50518798828125,y:247.5944423675537,z:-10.597691535949707},{x:338.8450622558594,y:265.47778129577637,z:-27.778091430664063},{x:334.25254821777344,y:269.0671920776367,z:-20.938611030578613},{x:341.64512634277344,y:259.6387195587158,z:-32.189905643463135},{x:331.44081115722656,y:219.0976095199585,z:4.207563698291779},{x:320.56339263916016,y:216.49658203125,z:2.930997312068939},{x:311.21912002563477,y:216.57853603363037,z:2.9674705862998962},{x:303.46256256103516,y:218.54614734649658,z:5.357203483581543},{x:297.99999237060547,y:222.505202293396,z:9.325502514839172},{x:294.93839263916016,y:236.39654159545898,z:18.534289598464966},{x:278.87489318847656,y:259.7095584869385,z:45.68212032318115},{x:300.3782653808594,y:245.38593292236328,z:12.278382778167725},{x:307.06348419189453,y:246.36857986450195,z:8.164191246032715},{x:315.5229187011719,y:245.3949737548828,z:5.503097176551819},{x:323.71395111083984,y:242.75178909301758,z:4.6335723996162415},{x:330.2785873413086,y:239.34658527374268,z:4.937030673027039},{x:334.6982192993164,y:236.0460376739502,z:4.823233783245087},{x:279.3412208557129,y:263.5196113586426,z:70.91583728790283,name:"faceOval"},{x:334.65972900390625,y:271.6648578643799,z:-17.775644063949585},{x:342.05677032470703,y:246.99846267700195,z:-20.84523916244507},{x:344.0357971191406,y:264.5701503753662,z:-32.936880588531494},{x:348.25531005859375,y:268.6645030975342,z:-30.695960521697998},{x:344.12227630615234,y:266.34212493896484,z:-29.808926582336426},{x:337.12318420410156,y:274.2556858062744,z:-15.768152475357056},{x:349.49047088623047,y:269.071683883667,z:-32.51670837402344},{x:350.1683044433594,y:271.4691352844238,z:-24.93025302886963},{x:333.9634704589844,y:230.56639194488525,z:8.89949381351471},{x:338.2147979736328,y:231.4807891845703,z:4.6715047955513},{x:340.4712677001953,y:231.74463272094727,z:-.34996166825294495},{x:303.28975677490234,y:232.24980354309082,z:11.916568279266357,name:"rightEye"},{x:299.4649124145508,y:229.53842639923096,z:12.325069904327393},{x:359.09618377685547,y:241.77349090576172,z:-24.650139808654785},{x:399.46216583251953,y:229.89503860473633,z:15.919880867004395,name:"leftEye"},{x:361.38919830322266,y:269.6129894256592,z:-24.510080814361572},{x:416.9973373413086,y:206.0895538330078,z:53.26857566833496,name:"faceOval"},{x:381.32179260253906,y:235.5476474761963,z:7.6214683055877686},{x:387.8068542480469,y:236.25958442687988,z:8.345099091529846},{x:393.95751953125,y:235.8660364151001,z:10.475142002105713},{x:401.84600830078125,y:232.77019500732422,z:16.760226488113403},{x:375.70568084716797,y:233.48456382751465,z:8.234220147132874},{x:388.17752838134766,y:218.94717693328857,z:6.810300946235657},{x:381.64928436279297,y:219.2656660079956,z:6.711093783378601},{x:394.4760513305664,y:219.66821193695068,z:9.173773527145386},{x:398.8843536376953,y:221.8837022781372,z:12.03328251838684},{x:406.5454864501953,y:237.12156772613525,z:19.7131085395813},{x:383.87447357177734,y:337.6932907104492,z:-8.631049990653992},{x:401.2682342529297,y:228.5916566848755,z:18.359217643737793,name:"leftEye"},{x:422.0449447631836,y:236.73934936523438,z:51.16771221160889},{x:412.69153594970703,y:232.80198097229004,z:27.52131938934326},{x:387.3497772216797,y:263.298397064209,z:-2.8609684109687805},{x:364.5124053955078,y:293.39221000671387,z:-22.397546768188477,name:"lips"},{x:363.62987518310547,y:302.1291446685791,z:-19.643079042434692},{x:373.2334518432617,y:295.8647060394287,z:-18.125789165496826,name:"lips"},{x:378.83365631103516,y:299.5177745819092,z:-13.153743743896484,name:"lips"},{x:369.91477966308594,y:302.5704002380371,z:-16.65518283843994},{x:374.9167251586914,y:303.5416603088379,z:-11.963253021240234},{x:387.58888244628906,y:312.2716999053955,z:-4.680258631706238},{x:360.6635284423828,y:264.31986808776855,z:-35.94811677932739},{x:361.04564666748047,y:256.8225860595703,z:-37.278664112091064},{x:408.3855438232422,y:213.52088928222656,z:15.756480693817139,name:"leftEyebrow"},{x:373.2946014404297,y:245.38101196289063,z:-1.9316278398036957},{x:376.83860778808594,y:264.3721103668213,z:-18.510947227478027},{x:376.9546127319336,y:261.0010528564453,z:-15.989909172058105},{x:406.1498260498047,y:263.5030174255371,z:7.072908878326416},{x:360.07205963134766,y:248.3631706237793,z:-32.16656446456909},{x:393.11119079589844,y:205.10473251342773,z:3.7786373496055603,name:"leftEyebrow"},{x:402.12791442871094,y:207.89000988006592,z:9.383859634399414,name:"leftEyebrow"},{x:410.8693313598633,y:191.6182279586792,z:41.27030849456787,name:"faceOval"},{x:364.9509811401367,y:210.40483474731445,z:-3.758212625980377},{x:375.94444274902344,y:221.1331844329834,z:8.368442058563232},{x:392.1904754638672,y:305.0360298156738,z:-1.752179116010666},{x:419.50225830078125,y:307.25592613220215,z:58.96425247192383,name:"faceOval"},{x:372.0027160644531,y:268.7212657928467,z:-16.631840467453003},{x:366.1614227294922,y:271.6237449645996,z:-18.219159841537476},{x:385.00938415527344,y:305.3863334655762,z:-2.567722797393799},{x:381.99771881103516,y:304.9723720550537,z:-4.575215280056},{x:405.078125,y:203.21216583251953,z:13.713973760604858,name:"leftEyebrow"},{x:377.13207244873047,y:268.4710121154785,z:-15.266278982162476},{x:380.9713363647461,y:205.36980628967285,z:-.7250899076461792,name:"leftEyebrow"},{x:381.7788314819336,y:198.9268398284912,z:-1.184653863310814,name:"leftEyebrow"},{x:385.5204772949219,y:172.1484375,z:16.04826807975769,name:"faceOval"},{x:407.94189453125,y:196.76236152648926,z:25.723915100097656},{x:383.03890228271484,y:184.5157527923584,z:7.393874526023865},{x:411.61781311035156,y:210.79241752624512,z:22.315845489501953,name:"leftEyebrow"},{x:414.30870056152344,y:208.4643030166626,z:37.021894454956055},{x:364.28722381591797,y:298.35777282714844,z:-21.86065673828125},{x:371.3682556152344,y:299.78848457336426,z:-17.834001779556274},{x:376.88201904296875,y:301.6696071624756,z:-13.153743743896484},{x:370.2193832397461,y:270.49095153808594,z:-15.569736957550049},{x:383.5081100463867,y:305.2726364135742,z:-3.673594295978546},{x:380.73760986328125,y:305.96869468688965,z:-8.660228252410889},{x:381.2334442138672,y:304.63574409484863,z:-4.820316135883331,name:"lips"},{x:368.1698989868164,y:264.8884963989258,z:-25.653886795043945},{x:373.5087203979492,y:303.4233856201172,z:-10.95950722694397,name:"lips"},{x:368.4544372558594,y:303.29601287841797,z:-14.169161319732666,name:"lips"},{x:362.76554107666016,y:303.5735607147217,z:-16.911956071853638,name:"lips"},{x:366.60980224609375,y:324.8870658874512,z:-15.616422891616821},{x:365.7067108154297,y:315.95678329467773,z:-20.903596878051758,name:"lips"},{x:365.0083923339844,y:311.2232208251953,z:-21.066999435424805},{x:364.1508102416992,y:307.0583438873291,z:-18.907777070999146},{x:363.37512969970703,y:304.5721435546875,z:-17.42550015449524,name:"lips"},{x:374.580078125,y:304.3059539794922,z:-11.40302300453186,name:"lips"},{x:375.55362701416016,y:305.0998020172119,z:-12.861957550048828},{x:377.2437286376953,y:307.1674346923828,z:-14.215847253799438},{x:378.68587493896484,y:309.9015712738037,z:-13.223772048950195,name:"lips"},{x:383.8992691040039,y:290.29629707336426,z:-9.97326910495758},{x:423.3871841430664,y:271.91688537597656,z:74.37058925628662,name:"faceOval"},{x:377.68043518066406,y:304.62209701538086,z:-7.603961229324341,name:"lips"},{x:379.00428771972656,y:304.9314594268799,z:-8.57852816581726},{x:364.00279998779297,y:275.2813911437988,z:-19.25792098045349},{x:374.68231201171875,y:273.82555961608887,z:-11.28047227859497},{x:365.0354766845703,y:273.4548568725586,z:-18.791062831878662},{x:380.61901092529297,y:249.8848056793213,z:.15501167625188828},{x:391.14158630371094,y:254.7934627532959,z:2.0906515419483185},{x:378.1761169433594,y:264.9612236022949,z:-12.605184316635132},{x:400.9540557861328,y:179.99592304229736,z:27.82477855682373,name:"faceOval"},{x:398.0038833618164,y:188.50656509399414,z:16.094952821731567},{x:394.8717498779297,y:199.0359592437744,z:6.226727366447449,name:"leftEyebrow"},{x:382.10926055908203,y:316.83926582336426,z:-8.946179747581482},{x:366.51588439941406,y:200.32583713531494,z:-5.24632453918457,name:"leftEyebrow"},{x:367.4893569946289,y:183.87210845947266,z:1.9039081037044525},{x:368.6243438720703,y:168.8127565383911,z:8.736093044281006,name:"faceOval"},{x:398.96175384521484,y:234.9675178527832,z:13.713973760604858},{x:412.9645538330078,y:242.23042488098145,z:23.272905349731445},{x:372.05257415771484,y:231.41919136047363,z:9.226294755935669},{x:406.0722351074219,y:223.58965873718262,z:18.370890617370605},{x:368.27442169189453,y:240.2039337158203,z:-4.166713654994965},{x:372.3575210571289,y:260.66442489624023,z:-24.976940155029297},{x:419.2244338989258,y:247.9079246520996,z:30.299127101898193},{x:409.43885803222656,y:246.60913467407227,z:16.398411989212036},{x:401.69139862060547,y:248.76328468322754,z:9.395531415939331},{x:389.7608184814453,y:247.56915092468262,z:5.841569304466248},{x:380.5461883544922,y:244.55984115600586,z:4.263003468513489},{x:373.25817108154297,y:240.80214500427246,z:2.5356262922286987},{x:358.77086639404297,y:229.35615062713623,z:-10.387605428695679},{x:419.5793914794922,y:262.8478717803955,z:26.5175724029541},{x:410.8808898925781,y:222.51372814178467,z:22.199130058288574},{x:358.45714569091797,y:268.91467094421387,z:-33.17030906677246},{x:373.4129333496094,y:251.6385841369629,z:-5.771540403366089},{x:422.5408172607422,y:239.23919677734375,z:74.04378890991211,name:"faceOval"},{x:367.8171920776367,y:236.58040523529053,z:1.820748895406723},{x:378.51959228515625,y:266.2532329559326,z:-5.74819803237915},{x:403.3472442626953,y:229.05112266540527,z:19.689764976501465},{x:372.34840393066406,y:256.6451168060303,z:-21.872329711914063},{x:422.54566192626953,y:289.1587829589844,z:68.67491245269775,name:"faceOval"},{x:371.9297409057617,y:228.90116214752197,z:11.432201862335205,name:"leftEye"},{x:366.21360778808594,y:251.6158962249756,z:-28.19826364517212},{x:409.1571807861328,y:321.3156223297119,z:20.2266526222229},{x:408.52943420410156,y:331.44238471984863,z:31.09278917312622,name:"faceOval"},{x:424.2788314819336,y:267.1992301940918,z:50.467424392700195},{x:415.60352325439453,y:311.6528606414795,z:30.579242706298828},{x:418.12793731689453,y:221.59927368164063,z:46.26569747924805},{x:385.68286895751953,y:346.0184955596924,z:-5.70151150226593},{x:357.82936096191406,y:271.3758373260498,z:-24.836881160736084},{x:379.588623046875,y:257.5071716308594,z:-3.755294680595398},{x:417.4592590332031,y:234.71948146820068,z:34.5475435256958},{x:393.4684371948242,y:231.58967971801758,z:11.408859491348267,name:"leftEye"},{x:387.8864288330078,y:232.14245796203613,z:9.51808214187622,name:"leftEye"},{x:382.4981689453125,y:307.5654888153076,z:-7.522260546684265,name:"lips"},{x:419.00169372558594,y:277.8332805633545,z:26.424202919006348},{x:373.62953186035156,y:357.6375102996826,z:-5.75986921787262,name:"faceOval"},{x:392.8708267211914,y:347.72446632385254,z:10.154176950454712,name:"faceOval"},{x:400.3953552246094,y:341.0005187988281,z:19.39797878265381,name:"faceOval"},{x:382.25440979003906,y:231.66935920715332,z:8.998700976371765,name:"leftEye"},{x:377.14550018310547,y:230.4228687286377,z:9.804032444953918,name:"leftEye"},{x:373.8358688354492,y:229.64950561523438,z:11.292144060134888,name:"leftEye"},{x:414.5794677734375,y:221.67891025543213,z:29.412097930908203},{x:377.00672149658203,y:225.66201210021973,z:9.360517263412476,name:"leftEye"},{x:382.29530334472656,y:224.8431158065796,z:8.32175612449646,name:"leftEye"},{x:387.5133514404297,y:224.49507236480713,z:8.917000889778137,name:"leftEye"},{x:393.15906524658203,y:225.24795055389404,z:10.737749338150024,name:"leftEye"},{x:397.05554962158203,y:226.55359268188477,z:13.002015352249146,name:"leftEye"},{x:420.5299377441406,y:221.014666557312,z:65.40690422058105,name:"faceOval"},{x:397.06920623779297,y:230.6661558151245,z:13.807345628738403,name:"leftEye"},{x:377.94647216796875,y:285.1647090911865,z:-13.305472135543823},{x:372.1118927001953,y:267.1267318725586,z:-18.83774757385254},{x:364.9968719482422,y:282.24411964416504,z:-19.818150997161865},{x:401.973876953125,y:331.20131492614746,z:11.566424369812012},{x:394.3083190917969,y:338.86693954467773,z:3.142542541027069},{x:373.9820861816406,y:351.4504623413086,z:-13.50388765335083},{x:414.3888854980469,y:321.24735832214355,z:45.51872253417969,name:"faceOval"},{x:373.44234466552734,y:227.33163356781006,z:10.626870393753052,name:"leftEye"},{x:364.0731430053711,y:240.31539916992188,z:-13.807345628738403},{x:384.2658233642578,y:353.3793067932129,z:.7385850697755814,name:"faceOval"},{x:423.20526123046875,y:283.5176181793213,z:47.152724266052246},{x:369.42798614501953,y:304.0898895263672,z:-14.647691249847412,name:"lips"},{x:370.63812255859375,y:305.90051651000977,z:-16.211668252944946},{x:371.91192626953125,y:309.0167713165283,z:-17.84567356109619},{x:373.0583953857422,y:313.3545398712158,z:-17.378815412521362,name:"lips"},{x:375.39905548095703,y:321.09289169311523,z:-13.118728399276733},{x:379.2567825317383,y:304.3582534790039,z:-7.924926280975342},{x:381.18797302246094,y:303.7031364440918,z:-7.843226194381714},{x:383.0918502807617,y:302.4884605407715,z:-7.6506465673446655,name:"lips"},{x:389.09461975097656,y:297.1475315093994,z:-5.5497825145721436},{x:411.6408920288086,y:280.24898529052734,z:12.02161192893982},{x:363.3110809326172,y:234.27620887756348,z:-6.775286793708801},{x:366.0474395751953,y:223.29872131347656,z:6.827808618545532},{x:370.34427642822266,y:225.1457118988037,z:9.558931589126587},{x:377.5371551513672,y:303.60079765319824,z:-7.358860373497009,name:"lips"},{x:412.9557800292969,y:299.53579902648926,z:19.39797878265381},{x:360.0810241699219,y:221.72012329101563,z:-2.153385728597641},{x:379.82784271240234,y:329.47723388671875,z:-10.48097848892212},{x:359.08477783203125,y:235.7911491394043,z:-18.079102039337158},{x:369.6688461303711,y:251.5407943725586,z:-14.962821006774902},{x:369.5555114746094,y:333.5307312011719,z:-15.67478060722351},{x:394.0193176269531,y:315.6973171234131,z:-.9920747578144073},{x:383.78997802734375,y:272.7268695831299,z:-4.689012169837952},{x:387.67765045166016,y:323.6722755432129,z:-5.640236139297485},{x:397.8769302368164,y:272.1331214904785,z:-.9395531564950943},{x:389.87476348876953,y:280.5630111694336,z:-4.29218202829361},{x:403.83888244628906,y:285.1167869567871,z:3.0229100584983826},{x:372.5467300415039,y:343.1070327758789,z:-16.153310537338257},{x:374.1112518310547,y:256.3721466064453,z:-10.574349164962769},{x:399.73785400390625,y:321.77515983581543,z:4.849494695663452},{x:392.03365325927734,y:330.56447982788086,z:-1.3407598435878754},{x:398.59134674072266,y:305.93902587890625,z:1.517290621995926},{x:417.95997619628906,y:290.9716987609863,z:26.89105987548828},{x:406.04541778564453,y:307.35154151916504,z:8.666064143180847},{x:420.75328826904297,y:298.40752601623535,z:41.78385257720947},{x:395.4522705078125,y:291.4153575897217,z:-2.1752697229385376},{x:368.6452102661133,y:245.8882999420166,z:-9.453888535499573},{x:370.34900665283203,y:263.56690406799316,z:-26.75100326538086},{x:374.98477935791016,y:266.6126346588135,z:-19.77146625518799},{x:366.99840545654297,y:258.12140464782715,z:-31.372904777526855},{x:371.00616455078125,y:217.63479709625244,z:5.60522198677063},{x:381.30577087402344,y:214.14087295532227,z:4.983716309070587},{x:390.1496124267578,y:213.38221549987793,z:5.593550801277161},{x:397.7696990966797,y:214.3659782409668,z:8.57852816581726},{x:403.1652069091797,y:217.65509605407715,z:13.013685941696167},{x:407.3551940917969,y:230.72525024414063,z:22.444231510162354},{x:424.0876770019531,y:251.7839241027832,z:51.16771221160889},{x:403.50196838378906,y:239.88757610321045,z:15.803166627883911},{x:397.31719970703125,y:241.49806022644043,z:11.233787536621094},{x:388.99425506591797,y:241.4366912841797,z:7.948269248008728},{x:380.7804489135742,y:239.78078842163086,z:6.600214838981628},{x:374.01336669921875,y:237.11946487426758,z:6.349278092384338},{x:369.39125061035156,y:234.35351371765137,z:5.987462401390076},{x:422.9730987548828,y:255.76455116271973,z:76.61150932312012,name:"faceOval"},{x:374.73915100097656,y:269.24214363098145,z:-16.608498096466064},{x:364.61681365966797,y:245.71088790893555,z:-20.02823829650879},{x:365.3834533691406,y:263.34174156188965,z:-32.32996463775635},{x:361.58252716064453,y:267.8273677825928,z:-30.345816612243652},{x:365.37208557128906,y:265.0249671936035,z:-29.178667068481445},{x:372.72605895996094,y:272.05135345458984,z:-14.834434986114502},{x:360.48614501953125,y:268.34827423095703,z:-32.189905643463135},{x:359.9516296386719,y:270.8049201965332,z:-24.650139808654785},{x:369.5049285888672,y:229.01945114135742,z:10.107489824295044},{x:365.5447769165039,y:230.24096488952637,z:5.593550801277161},{x:363.50669860839844,y:230.6208372116089,z:.43622106313705444},{x:399.3529510498047,y:227.65677452087402,z:15.35965085029602,name:"leftEye"},{x:402.5693130493164,y:224.60190296173096,z:15.931552648544312}],box:{xMin:277.8318977355957,yMin:168.7741756439209,xMax:424.2788314819336,yMax:359.8348903656006,width:146.4469337463379,height:191.0607147216797}},SAMPLE_FACELANDMARKER_RESULT:{faceLandmarks:[[{x:.5760777592658997,y:.8639070391654968,z:-.030997956171631813},{x:.572094738483429,y:.7886289358139038,z:-.07189624011516571},{x:.5723551511764526,y:.8075382709503174,z:-.03578168898820877},{x:.5548420548439026,y:.7188365459442139,z:-.057787876576185226},{x:.5706077814102173,y:.7674974799156189,z:-.07740399986505508},{x:.5681378245353699,y:.7387768030166626,z:-.07356284558773041},{x:.5621535181999207,y:.6681165099143982,z:-.04189874976873398},{x:.46613582968711853,y:.6679812073707581,z:.011289681307971478},{x:.5579932928085327,y:.6174106597900391,z:-.03502821549773216},{x:.5563451647758484,y:.5905600190162659,z:-.03928658738732338},{x:.5487832427024841,y:.4900572597980499,z:-.029898937791585922},{x:.5765544176101685,y:.8692144751548767,z:-.02831427752971649},{x:.5771114230155945,y:.873644232749939,z:-.02345779910683632},{x:.5771905779838562,y:.877016007900238,z:-.016658689826726913},{x:.5778058767318726,y:.8770116567611694,z:-.014505492523312569},{x:.5783766508102417,y:.8835000991821289,z:-.015996402129530907},{x:.5792440176010132,y:.8913810849189758,z:-.01924579218029976},{x:.5796768069267273,y:.8996334671974182,z:-.018261712044477463},{x:.5817288160324097,y:.9255813956260681,z:-.007126849144697189},{x:.5726592540740967,y:.7992473244667053,z:-.0643521398305893},{x:.5579419136047363,y:.7996989488601685,z:-.04566684365272522},{x:.4216199815273285,y:.5958762764930725,z:.06776496022939682},{x:.5052269697189331,y:.6796539425849915,z:-.0010737782577052712},{x:.49243026971817017,y:.6838865876197815,z:-.0005227324436418712},{x:.4796970784664154,y:.6856290102005005,z:.002684245817363262},{x:.4618356227874756,y:.6764569878578186,z:.013439622707664967},{x:.5160380601882935,y:.6737282276153564,z:-.000017607348127057776},{x:.48070961236953735,y:.6255870461463928,z:-.008339674212038517},{x:.49719780683517456,y:.6256808042526245,z:-.008027955889701843},{x:.46674346923828125,y:.6317623853683472,z:-.004460199736058712},{x:.4582492709159851,y:.641118049621582,z:.0011905613355338573},{x:.45408669114112854,y:.6911458969116211,z:.020514748990535736},{x:.535312294960022,y:.9619986414909363,z:.012499462813138962},{x:.4608460068702698,y:.6628725528717041,z:.01517564244568348},{x:.4206731915473938,y:.6828458309173584,z:.07848648726940155},{x:.4390624463558197,y:.6796106696128845,z:.03283142298460007},{x:.5029968619346619,y:.7701570391654968,z:-.009734481573104858},{x:.5595027208328247,y:.8607323169708252,z:-.030043255537748337},{x:.5621269941329956,y:.8738374710083008,z:-.021709579974412918},{x:.5451499819755554,y:.865527331829071,z:-.022014077752828598},{x:.5351184010505676,y:.8705098032951355,z:-.011602800339460373},{x:.5495014190673828,y:.8744956254959106,z:-.016490943729877472},{x:.5395170450210571,y:.8759440779685974,z:-.007333362940698862},{x:.5183624029159546,y:.8959754705429077,z:.010520773939788342},{x:.5604349374771118,y:.7895449995994568,z:-.07082037627696991},{x:.557381272315979,y:.7687489986419678,z:-.07590588927268982},{x:.4432901442050934,y:.6308897733688354,z:.0027153254486620426},{x:.5258325338363647,y:.7151225805282593,z:-.014676518738269806},{x:.5271827578544617,y:.7833116054534912,z:-.037643320858478546},{x:.5257382988929749,y:.7717816233634949,z:-.03401920944452286},{x:.46516409516334534,y:.7705106735229492,z:.0065747760236263275},{x:.5558893084526062,y:.7420997619628906,z:-.0694495290517807},{x:.4720408320426941,y:.6066038608551025,z:-.021204356104135513},{x:.45432573556900024,y:.6158540844917297,z:-.011054684408009052},{x:.4305151402950287,y:.5608053803443909,z:.0396830290555954},{x:.5310865640640259,y:.6157484650611877,z:-.03081176057457924},{x:.5114666223526001,y:.6329749226570129,z:-.00335998204536736},{x:.506435751914978,y:.8786543607711792,z:.012980876490473747},{x:.4480472207069397,y:.8640613555908203,z:.12569651007652283},{x:.5372058153152466,y:.7942581176757813,z:-.03168361634016037},{x:.5488379597663879,y:.8001630306243896,z:-.03280917927622795},{x:.5213388204574585,y:.8794381618499756,z:.011892606504261494},{x:.5242055654525757,y:.8789222240447998,z:.008370225317776203},{x:.4477175176143646,y:.6039950251579285,z:-.0050799972377717495},{x:.526964008808136,y:.7916748523712158,z:-.02968614175915718},{x:.4971255660057068,y:.6050706505775452,z:-.028175678104162216},{x:.4938119053840637,y:.5882453918457031,z:-.03210941329598427},{x:.4757143557071686,y:.5094879865646362,z:-.01300730835646391},{x:.43947282433509827,y:.5816648006439209,z:.01415177434682846},{x:.485664039850235,y:.5477864146232605,z:-.023685332387685776},{x:.43635931611061096,y:.6226438283920288,z:.013606148771941662},{x:.42910251021385193,y:.6102726459503174,z:.03926564007997513},{x:.5605402588844299,y:.8680099248886108,z:-.027318159118294716},{x:.5474816560745239,y:.8702861070632935,z:-.019686367362737656},{x:.5373021364212036,y:.8728838562965393,z:-.010484928265213966},{x:.540735125541687,y:.7979167103767395,z:-.029073253273963928},{x:.5228585004806519,y:.87913578748703,z:.009915109723806381},{x:.530497670173645,y:.8815253973007202,z:.0020524784922599792},{x:.5259912610054016,y:.8790552616119385,z:.007895970717072487},{x:.5433906316757202,y:.7882310748100281,z:-.05121905356645584},{x:.541388213634491,y:.8777219653129578,z:-.00466804439201951},{x:.5515822172164917,y:.8767023086547852,z:-.010475946590304375},{x:.5637003779411316,y:.877059817314148,z:-.015273625031113625},{x:.5640299320220947,y:.9263423085212708,z:-.00658724969252944},{x:.5642300248146057,y:.8993074893951416,z:-.017653480172157288},{x:.5637336373329163,y:.8910360932350159,z:-.01852807030081749},{x:.5637134313583374,y:.8837276697158813,z:-.01482592523097992},{x:.564205527305603,y:.8768964409828186,z:-.01331155002117157},{x:.5419867634773254,y:.8778373599052429,z:-.0037720394320786},{x:.5404468774795532,y:.880696177482605,z:-.005610354244709015},{x:.5392338633537292,y:.8845721483230591,z:-.007352025713771582},{x:.538469672203064,y:.8891173601150513,z:-.005154991988092661},{x:.5189250111579895,y:.8452741503715515,z:-.009755070321261883},{x:.4258975088596344,y:.7662280797958374,z:.1387351155281067},{x:.5725725293159485,y:.8041572570800781,z:-.04583907872438431},{x:.5342061519622803,y:.8785833120346069,z:.002659974154084921},{x:.5324031114578247,y:.8804071545600891,z:.0017832003068178892},{x:.5538818836212158,y:.8078407645225525,z:-.03254539892077446},{x:.5325431823730469,y:.8026832938194275,z:-.019140373915433884},{x:.5514076948165894,y:.8043903112411499,z:-.03313535451889038},{x:.5131856203079224,y:.7284771800041199,z:-.009399853646755219},{x:.49331504106521606,y:.7443980574607849,z:-.005225230939686298},{x:.5239617824554443,y:.7807451486587524,z:-.025881027802824974},{x:.4473606050014496,y:.5315827131271362,z:.011164786294102669},{x:.45718759298324585,y:.5604941248893738,z:-.005943301599472761},{x:.4670005738735199,y:.5909327268600464,z:-.019681761041283607},{x:.5311570167541504,y:.9076261520385742,z:.00389476353302598},{x:.5249923467636108,y:.5893563628196716,z:-.037981919944286346},{x:.5166932344436646,y:.5429551005363464,z:-.03319704160094261},{x:.5085030198097229,y:.49676206707954407,z:-.02691275253891945},{x:.4687720239162445,y:.6834565997123718,z:.008113506250083447},{x:.4426414966583252,y:.7069531679153442,z:.028577271848917007},{x:.5230373740196228,y:.6675713658332825,z:.001773772411979735},{x:.4481240212917328,y:.6527872085571289,z:.012414850294589996},{x:.5339856743812561,y:.7012367844581604,z:-.020220188423991203},{x:.5347223281860352,y:.7761190533638,z:-.05141595005989075},{x:.4315067231655121,y:.7211957573890686,z:.04381405934691429},{x:.45203351974487305,y:.7206180095672607,z:.017288070172071457},{x:.46892452239990234,y:.7265436053276062,z:.005602988880127668},{x:.49314674735069275,y:.7202282547950745,z:-.0006408205372281373},{x:.5104925632476807,y:.7091827392578125,z:-.00362918758764863},{x:.5232142210006714,y:.698553740978241,z:-.00787867046892643},{x:.5497883558273315,y:.6743605136871338,z:-.036349106580019},{x:.43658503890037537,y:.7627100348472595,z:.042555369436740875},{x:.4397648870944977,y:.6528646349906921,z:.017956094816327095},{x:.5653332471847534,y:.7992802858352661,z:-.06365057826042175},{x:.5285563468933105,y:.736810564994812,z:-.018836988136172295},{x:.4180678725242615,y:.6792560815811157,z:.12284679710865021},{x:.5328429937362671,y:.6865872144699097,z:-.010484723374247551},{x:.5230283141136169,y:.7809416055679321,z:-.011922398582100868},{x:.4551771283149719,y:.6650775074958801,z:.01774493046104908},{x:.5337203741073608,y:.7618928551673889,z:-.04697106033563614},{x:.43463975191116333,y:.8133478164672852,z:.1354849934577942},{x:.5225707292556763,y:.6605283617973328,z:.004980515688657761},{x:.5441933870315552,y:.7497199773788452,z:-.06091512367129326},{x:.4774007797241211,y:.9159183502197266,z:.059622734785079956},{x:.48068761825561523,y:.9364941716194153,z:.08404944837093353},{x:.4268292486667633,y:.7657528519630432,z:.09051097184419632},{x:.46051913499832153,y:.8880485892295837,z:.0738474428653717},{x:.4243420660495758,y:.6434382200241089,z:.06230505183339119},{x:.5342157483100891,y:.9835634231567383,z:.021662971004843712},{x:.5668109655380249,y:.8042187094688416,z:-.044937074184417725},{x:.5176341533660889,y:.7530587315559387,z:-.012967454269528389},{x:.430206298828125,y:.6835605502128601,z:.04612284153699875},{x:.4794231951236725,y:.6732114553451538,z:.003970044665038586},{x:.49073347449302673,y:.6722435355186462,z:8692514384165406e-19},{x:.5294116139411926,y:.884677529335022,z:.004413890186697245},{x:.4430122375488281,y:.80235356092453,z:.04987282305955887},{x:.5603825449943542,y:1.0092442035675049,z:.026417359709739685},{x:.5186598300933838,y:.9828659892082214,z:.0513598807156086},{x:.5010536909103394,y:.9640932679176331,z:.06591596454381943},{x:.5524769425392151,y:.539441704750061,z:-.035816047340631485},{x:.5879997611045837,y:1.0091472864151,z:.02285068854689598},{x:.5016193985939026,y:.6684437990188599,z:28415941051207483e-20},{x:.511952817440033,y:.6642197370529175,z:.0021144719794392586},{x:.5194343328475952,y:.6623469591140747,z:.004674181342124939},{x:.4321230351924896,y:.6496355533599854,z:.03124697133898735},{x:.508686363697052,y:.6479565501213074,z:-.00044765998609364033},{x:.4963986277580261,y:.6431032419204712,z:-.0032507688738405704},{x:.4845542013645172,y:.6430778503417969,z:-.002903624437749386},{x:.4733612537384033,y:.647506833076477,z:23347247042693198e-20},{x:.4668654501438141,y:.653346598148346,z:.004762572236359119},{x:.41815051436424255,y:.633708119392395,z:.09809435904026031},{x:.47159942984580994,y:.6711485385894775,z:.007849935442209244},{x:.5734396576881409,y:.8256140351295471,z:-.03155219927430153},{x:.5306524038314819,y:.8337990641593933,z:-.018351426348090172},{x:.5371729135513306,y:.7910830974578857,z:-.037286680191755295},{x:.5549534559249878,y:.8275275826454163,z:-.030664825811982155},{x:.5597432255744934,y:.6418541669845581,z:-.03318847343325615},{x:.4958484172821045,y:.9429569244384766,z:.048340678215026855},{x:.5140507817268372,y:.9634028077125549,z:.03589847311377525},{x:.5587693452835083,y:.9951097369194031,z:.00908728688955307},{x:.46411189436912537,y:.9051855206489563,z:.10601935535669327},{x:.5181609392166138,y:.6554316878318787,z:.002546071307733655},{x:.5436590909957886,y:.7085841298103333,z:-.03844436630606651},{x:.5872187614440918,y:.9960382580757141,z:.0063423276878893375},{x:.5379653573036194,y:.9989125728607178,z:.03636329993605614},{x:.4350326955318451,y:.8088565468788147,z:.09147704392671585},{x:.5523084998130798,y:.8773422837257385,z:-.009068487212061882},{x:.5510149598121643,y:.8816931843757629,z:-.011043853126466274},{x:.5503793954849243,y:.88776695728302,z:-.01348799467086792},{x:.5501549243927002,y:.8954370617866516,z:-.012142189778387547},{x:.546072781085968,y:.9192524552345276,z:-.003157563041895628},{x:.5314661860466003,y:.8771666884422302,z:5075141089037061e-19},{x:.5293324589729309,y:.8762547969818115,z:39177737198770046e-20},{x:.5275698900222778,y:.8750609755516052,z:47732755774632096e-21},{x:.5104271173477173,y:.8607332110404968,z:.0012934643309563398},{x:.45938700437545776,y:.8134918212890625,z:.023569690063595772},{x:.5418947339057922,y:.6864100694656372,z:-.027333909645676613},{x:.531914234161377,y:.6456130743026733,z:-.005434140563011169},{x:.523697018623352,y:.647885262966156,z:-.0002466466394253075},{x:.5338191390037537,y:.8783687353134155,z:.002268768846988678},{x:.46226605772972107,y:.8610277771949768,z:.04718952998518944},{x:.5434442758560181,y:.6456181406974792,z:-.02327350154519081},{x:.5399754643440247,y:.940219521522522,z:.005075343884527683},{x:.5661457777023315,y:.71457839012146,z:-.06242101639509201},{x:.5523148775100708,y:.6974870562553406,z:-.04863070324063301},{x:.5639959573745728,y:.6923378109931946,z:-.05180761218070984},{x:.5367592573165894,y:.7423217296600342,z:-.03623027727007866},{x:.5853689908981323,y:.9752064943313599,z:-.002361974213272333},{x:.5835235118865967,y:.9493685960769653,z:-.003941743168979883},{x:.5615018606185913,y:.949194610118866,z:-.0015953965485095978},{x:.5068561434745789,y:.9048219323158264,z:.01862684078514576},{x:.5134067535400391,y:.7971825003623962,z:-.008485661819577217},{x:.5223897099494934,y:.925589919090271,z:.01249657291918993},{x:.48500555753707886,y:.7959478497505188,z:-.0032065745908766985},{x:.5037734508514404,y:.8184596300125122,z:-.004932103678584099},{x:.4766361117362976,y:.828806459903717,z:.01027688942849636},{x:.5589827299118042,y:.974656343460083,z:9666886180639267e-19},{x:.5294582843780518,y:.7541216611862183,z:-.025603046640753746},{x:.4973002076148987,y:.9208990931510925,z:.031931452453136444},{x:.5163551568984985,y:.9432790875434875,z:.024321340024471283},{x:.49399662017822266,y:.8814862370491028,z:.018687399104237556},{x:.44948166608810425,y:.836137592792511,z:.05702034756541252},{x:.47898444533348083,y:.8836610913276672,z:.03150695189833641},{x:.4454479217529297,y:.8499438166618347,z:.08868525922298431},{x:.49572959542274475,y:.8452823758125305,z:.0036111653316766024},{x:.5362502336502075,y:.7222585678100586,z:-.027912352234125137},{x:.5393770337104797,y:.7850722074508667,z:-.05415399745106697},{x:.531399667263031,y:.7898418307304382,z:-.03883346915245056},{x:.5451627373695374,y:.7717036604881287,z:-.06480253487825394},{x:.5206395983695984,y:.6287745833396912,z:-.010521138086915016},{x:.4974782466888428,y:.6191938519477844,z:-.014098240062594414},{x:.4774145185947418,y:.6193130612373352,z:-.013643337413668633},{x:.4616098403930664,y:.6259890198707581,z:-.008448202162981033},{x:.4516478478908539,y:.6368461847305298,z:9050309745362028e-20},{x:.4485096037387848,y:.6719120740890503,z:.022984720766544342},{x:.42177659273147583,y:.7240667343139648,z:.08511673659086227},{x:.4616215229034424,y:.6988231539726257,z:.014238474890589714},{x:.4755798876285553,y:.7034608721733093,z:.00625590980052948},{x:.4924992024898529,y:.7005885243415833,z:9391739731654525e-19},{x:.5082254409790039,y:.693384051322937,z:-.0009464038303121924},{x:.5203112959861755,y:.6849707961082458,z:-.0022114769089967012},{x:.52867591381073,y:.6779075860977173,z:-.002962538506835699},{x:.4213953912258148,y:.7219811677932739,z:.1350894570350647},{x:.5320829749107361,y:.794858992099762,z:-.03181503340601921},{x:.5452795028686523,y:.7286570072174072,z:-.04771539941430092},{x:.5496407747268677,y:.7866933345794678,z:-.06452003121376038},{x:.557040274143219,y:.7962084412574768,z:-.05837344378232956},{x:.549176812171936,y:.7895247936248779,z:-.057761140167713165},{x:.5362890362739563,y:.8005836606025696,z:-.026903774589300156},{x:.560200035572052,y:.7983731031417847,z:-.06172555685043335},{x:.5616944432258606,y:.8022753596305847,z:-.045200999826192856},{x:.5273328423500061,y:.6611284017562866,z:.0029021520167589188},{x:.534850537776947,y:.6660012006759644,z:-.005215510260313749},{x:.5394860506057739,y:.6701375246047974,z:-.014931917190551758},{x:.4634307324886322,y:.658291757106781,z:.009295716881752014},{x:.4538393020629883,y:.6519932150840759,z:.00930330716073513},{x:.5776031613349915,y:.7159298658370972,z:-.057365912944078445},{x:.6504855155944824,y:.6461779475212097,z:.014184834435582161},{x:.5860154032707214,y:.7962266206741333,z:-.04522843658924103},{x:.6842049360275269,y:.5631637573242188,z:.07207967340946198},{x:.6152560710906982,y:.6674962639808655,z:7529259892180562e-19},{x:.6280948519706726,y:.6684326529502869,z:.0016892586136236787},{x:.6408625245094299,y:.6663892269134521,z:.005331226624548435},{x:.6557814478874207,y:.6534678936004639,z:.01646413467824459},{x:.6035663485527039,y:.6639701724052429,z:.0013799630105495453},{x:.6329053044319153,y:.608010470867157,z:-.006195899099111557},{x:.6167260408401489,y:.6117533445358276,z:-.006319951266050339},{x:.6471013426780701,y:.6112449765205383,z:-.0017843559617176652},{x:.6560901999473572,y:.6185776591300964,z:.004047257360070944},{x:.6666946411132813,y:.6651176810264587,z:.023647578433156013},{x:.6311345100402832,y:.9495396018028259,z:.014004078693687916},{x:.6544655561447144,y:.6397901773452759,z:.01809609681367874},{x:.6965808868408203,y:.6482675075531006,z:.08304904401302338},{x:.679817259311676,y:.650188148021698,z:.03632688894867897},{x:.6336516737937927,y:.7541458010673523,z:-.007742783520370722},{x:.5921701192855835,y:.8567668199539185,z:-.029399123042821884},{x:.591663658618927,y:.870215654373169,z:-.02103729173541069},{x:.6068367958068848,y:.8584195375442505,z:-.020668085664510727},{x:.6176617741584778,y:.860965371131897,z:-.009790095500648022},{x:.6040634512901306,y:.8686612844467163,z:-.015289564616978168},{x:.6143736839294434,y:.8671170473098755,z:-.005712216719985008},{x:.6373105049133301,y:.8815656900405884,z:.012672550976276398},{x:.5832505822181702,y:.7866312861442566,z:-.07051534950733185},{x:.5836675763130188,y:.7658692598342896,z:-.07566110789775848},{x:.6709531545639038,y:.604898989200592,z:.005951565690338612},{x:.6029891967773438,y:.705652117729187,z:-.013388276100158691},{x:.6131622195243835,y:.7728396058082581,z:-.036248479038476944},{x:.6123163104057312,y:.7612020373344421,z:-.03264721855521202},{x:.6696187853813171,y:.744706928730011,z:.009673702530562878},{x:.5803102254867554,y:.7385968565940857,z:-.0689152330160141},{x:.6404349207878113,y:.5877999663352966,z:-.01929756999015808},{x:.6588467955589294,y:.5929454565048218,z:-.008487257175147533},{x:.6720337867736816,y:.530631422996521,z:.043437421321868896},{x:.584305465221405,y:.6099005341529846,z:-.030301367864012718},{x:.6034283638000488,y:.6217452883720398,z:-.001970183802768588},{x:.6460927724838257,y:.8608663082122803,z:.015541625209152699},{x:.6957815289497375,y:.8326103091239929,z:.13015234470367432},{x:.6043362617492676,y:.7861682772636414,z:-.030476901680231094},{x:.594293475151062,y:.7942103147506714,z:-.032218821346759796},{x:.6324057579040527,y:.8665139675140381,z:.014255806803703308},{x:.6296147704124451,y:.8667733669281006,z:.010388285852968693},{x:.663644552230835,y:.5798642635345459,z:-.0022301070857793093},{x:.6140630841255188,y:.7809288501739502,z:-.02835679054260254},{x:.615908145904541,y:.5921698212623596,z:-.026804860681295395},{x:.617181122303009,y:.5748661756515503,z:-.03060605563223362},{x:.6222207546234131,y:.49137672781944275,z:-.011151673272252083},{x:.6669357419013977,y:.5541607141494751,z:.017466170713305473},{x:.6182981729507446,y:.5320425629615784,z:-.021793590858578682},{x:.6760554313659668,y:.595052182674408,z:.017115700989961624},{x:.6801463961601257,y:.5800720453262329,z:.043127160519361496},{x:.5922210812568665,y:.8644017577171326,z:-.02662893570959568},{x:.6054555177688599,y:.8637874722480774,z:-.018363753333687782},{x:.6161889433860779,y:.8641164898872375,z:-.008808949030935764},{x:.6017249822616577,y:.7901403307914734,z:-.028126630932092667},{x:.631446123123169,y:.8664817810058594,z:.012112865224480629},{x:.6249198913574219,y:.8716511130332947,z:.003882825840264559},{x:.6281915903091431,y:.867301881313324,z:.009891441091895103},{x:.5986843109130859,y:.7813931703567505,z:-.050227612257003784},{x:.6126407384872437,y:.869275689125061,z:-.0031255714129656553},{x:.6027271151542664,y:.8711842894554138,z:-.009324162267148495},{x:.59088134765625,y:.8742044568061829,z:-.014608660712838173},{x:.5984604358673096,y:.9216185212135315,z:-.005981989670544863},{x:.5950398445129395,y:.8964707255363464,z:-.01703473925590515},{x:.5941568613052368,y:.8882410526275635,z:-.017784785479307175},{x:.5928806662559509,y:.8803883194923401,z:-.014153128489851952},{x:.5909661054611206,y:.8748103976249695,z:-.012609979137778282},{x:.6128016710281372,y:.8702545762062073,z:-.0022550546564161777},{x:.6150846481323242,y:.8726804256439209,z:-.00414019962772727},{x:.6173093914985657,y:.8770190477371216,z:-.005970994010567665},{x:.619335412979126,y:.8814800977706909,z:-.0036864024586975574},{x:.6292637586593628,y:.8314558267593384,z:-.007714875973761082},{x:.702275276184082,y:.7320667505264282,z:.1433621346950531},{x:.6204835176467896,y:.8689177632331848,z:.0044869170524179935},{x:.6223508715629578,y:.8704851269721985,z:.00352082890458405},{x:.590448260307312,y:.8029727935791016,z:-.03200828656554222},{x:.6097423434257507,y:.7933741211891174,z:-.018042555078864098},{x:.59229576587677,y:.7993767261505127,z:-.032564569264650345},{x:.6171364188194275,y:.7153720259666443,z:-.007672437466681004},{x:.6389747858047485,y:.726390540599823,z:-.002999067772179842},{x:.6151940226554871,y:.769412100315094,z:-.024427521973848343},{x:.6526776552200317,y:.505868136882782,z:.01412637997418642},{x:.6475822329521179,y:.5375454425811768,z:-.0033899128902703524},{x:.6433356404304504,y:.5714520215988159,z:-.017428796738386154},{x:.626949667930603,y:.8962116837501526,z:.005602736957371235},{x:.5868416428565979,y:.5829002261161804,z:-.03727729618549347},{x:.5877229571342468,y:.5345035791397095,z:-.032396964728832245},{x:.5887066125869751,y:.48655083775520325,z:-.025856535881757736},{x:.6507197618484497,y:.6612282991409302,z:.011114613153040409},{x:.6803066730499268,y:.677992045879364,z:.032125361263751984},{x:.5963194370269775,y:.6598632335662842,z:.002976928371936083},{x:.667536199092865,y:.6274255514144897,z:.015618261881172657},{x:.5930740833282471,y:.6940041780471802,z:-.019217798486351967},{x:.6053346395492554,y:.7676517963409424,z:-.050308309495449066},{x:.6934473514556885,y:.6884298920631409,z:.04794462397694588},{x:.6738007664680481,y:.6934011578559875,z:.020697161555290222},{x:.6588084697723389,y:.7033141851425171,z:.008462334051728249},{x:.6346072554588318,y:.7029502391815186,z:.001542167621664703},{x:.6157816648483276,y:.6966525912284851,z:-.002009218093007803},{x:.6015574336051941,y:.688928484916687,z:-.006588225718587637},{x:.5746836066246033,y:.6711069345474243,z:-.03597589209675789},{x:.6947521567344666,y:.7309479117393494,z:.046707939356565475},{x:.6759101152420044,y:.6249120831489563,z:.021654341369867325},{x:.5794773101806641,y:.7971615195274353,z:-.06339326500892639},{x:.6041849851608276,y:.727514922618866,z:-.017512541264295578},{x:.6968844532966614,y:.6440950036048889,z:.12727996706962585},{x:.5910853147506714,y:.679325520992279,z:-.009497715160250664},{x:.6157375574111938,y:.7695677280426025,z:-.010624290443956852},{x:.6606494784355164,y:.6410489678382874,z:.0208158977329731},{x:.6040687561035156,y:.7531470656394958,z:-.045887019485235214},{x:.7012156248092651,y:.780247151851654,z:.14028730988502502},{x:.595149576663971,y:.6527782678604126,z:.006308757700026035},{x:.5925500392913818,y:.7436665892601013,z:-.060151755809783936},{x:.6780198812484741,y:.8905693888664246,z:.0626060739159584},{x:.676746666431427,y:.9113880395889282,z:.08726003766059875},{x:.7030686140060425,y:.7312687635421753,z:.09529774636030197},{x:.688987135887146,y:.8588417172431946,z:.07752864807844162},{x:.6883691549301147,y:.6109960675239563,z:.06669612973928452},{x:.6358906030654907,y:.9702065587043762,z:.023120900616049767},{x:.5781539678573608,y:.8023634552955627,z:-.044763918966054916},{x:.6170316934585571,y:.7408350706100464,z:-.011375460773706436},{x:.688542366027832,y:.6516284346580505,z:.050206027925014496},{x:.6385149359703064,y:.6540714502334595,z:.006462941411882639},{x:.6279382109642029,y:.6563615798950195,z:.003062846139073372},{x:.6268895268440247,y:.8736732006072998,z:.00627936702221632},{x:.6944946050643921,y:.7709181308746338,z:.053824134171009064},{x:.614617109298706,y:1.0022112131118774,z:.02719894051551819},{x:.6493719220161438,y:.9665167927742004,z:.053563784807920456},{x:.6624587178230286,y:.943530797958374,z:.068605437874794},{x:.6162528991699219,y:.6558693051338196,z:.002187855076044798},{x:.6058168411254883,y:.654328465461731,z:.0036193584091961384},{x:.5987918972969055,y:.6536934971809387,z:.006134530063718557},{x:.6831037402153015,y:.6195642948150635,z:.03511790186166763},{x:.6062582731246948,y:.6356398463249207,z:.001280312892049551},{x:.6174948811531067,y:.62776118516922,z:-.0013642468256875873},{x:.6297246217727661,y:.6253792643547058,z:-.0007034156005829573},{x:.6407091617584229,y:.627578616142273,z:.0028144705574959517},{x:.6479622721672058,y:.6322650909423828,z:.00750273372977972},{x:.6915091276168823,y:.5990704298019409,z:.10270945727825165},{x:.6457163095474243,y:.6504453420639038,z:.010696077719330788},{x:.6164222955703735,y:.8231936097145081,z:-.016772059723734856},{x:.6042401194572449,y:.7830976843833923,z:-.03630910441279411},{x:.5922216773033142,y:.8228387236595154,z:-.029992375522851944},{x:.6646111011505127,y:.92097008228302,z:.050967294722795486},{x:.651232898235321,y:.9460107088088989,z:.038000158965587616},{x:.6140977144241333,y:.9882472157478333,z:.009882091544568539},{x:.6870781183242798,y:.8768675327301025,z:.10980932414531708},{x:.5986856818199158,y:.6456438899040222,z:.003999010659754276},{x:.585981547832489,y:.7034481763839722,z:-.0377722829580307},{x:.6342031359672546,y:.9867448806762695,z:.03786521404981613},{x:.7013950943946838,y:.776049017906189,z:.09598205983638763},{x:.6030206680297852,y:.8719133138656616,z:-.007931148633360863},{x:.6050592064857483,y:.8767156004905701,z:-.009791925549507141},{x:.6073468923568726,y:.8831382393836975,z:-.012361008673906326},{x:.6087977290153503,y:.890143632888794,z:-.01098148338496685},{x:.6147705316543579,y:.9110084772109985,z:-.0018823575228452682},{x:.622577965259552,y:.8670604825019836,z:.002609190298244357},{x:.6241236329078674,y:.8651344180107117,z:.0025534380692988634},{x:.6257084608078003,y:.8638408184051514,z:.0023300074972212315},{x:.639931321144104,y:.8449671268463135,z:.0038123116828501225},{x:.6810906529426575,y:.7856625318527222,z:.02717764675617218},{x:.583532452583313,y:.6811994910240173,z:-.026588857173919678},{x:.5855660438537598,y:.6393819451332092,z:-.004512844607234001},{x:.5932201743125916,y:.6398029327392578,z:8020466193556786e-19},{x:.6200879812240601,y:.8683351874351501,z:.00417016725987196},{x:.6842559576034546,y:.8330534100532532,z:.050836317241191864},{x:.5754412412643433,y:.6418221592903137,z:-.022838059812784195},{x:.6232790350914001,y:.9295297265052795,z:.006339520215988159},{x:.5764067769050598,y:.694546639919281,z:-.04825803264975548},{x:.59778892993927,y:.7343927621841431,z:-.035004377365112305},{x:.6042810678482056,y:.9441440105438232,z:-.0010970570147037506},{x:.6496372222900391,y:.8869078159332275,z:.021036235615611076},{x:.6274012327194214,y:.7830310463905334,z:-.006658440921455622},{x:.637792706489563,y:.9104999899864197,z:.014290250837802887},{x:.6549934148788452,y:.7748609185218811,z:-.0006672973395325243},{x:.6404005289077759,y:.801220715045929,z:-.0026642554439604282},{x:.6671456694602966,y:.8045546412467957,z:.013180811889469624},{x:.6107483506202698,y:.9680658578872681,z:.001778992242179811},{x:.6060343980789185,y:.744587242603302,z:-.024382334202528},{x:.6602751612663269,y:.8998945355415344,z:.0344940721988678},{x:.6463775038719177,y:.9262562394142151,z:.02617623284459114},{x:.6579852104187012,y:.8602304458618164,z:.021586716175079346},{x:.6926165223121643,y:.8053340315818787,z:.061075080186128616},{x:.6724731922149658,y:.8594399690628052,z:.03457934781908989},{x:.6975721716880798,y:.8183245062828064,z:.09300774335861206},{x:.6512877941131592,y:.8258221745491028,z:.006324059329926968},{x:.594887375831604,y:.7148372530937195,z:-.026898479089140892},{x:.6017440557479858,y:.7773507833480835,z:-.05312420800328255},{x:.6096571683883667,y:.7806998491287231,z:-.037646256387233734},{x:.5952993035316467,y:.7654367685317993,z:-.06398405134677887},{x:.5950021147727966,y:.6201304793357849,z:-.009297547861933708},{x:.6165438890457153,y:.6052900552749634,z:-.012455573305487633},{x:.6362661719322205,y:.6015968918800354,z:-.011649220250546932},{x:.6522727608680725,y:.6046400666236877,z:-.005903332494199276},{x:.6625409722328186,y:.6128141283988953,z:.0030042496509850025},{x:.6688099503517151,y:.6457712054252625,z:.026322703808546066},{x:.7013440728187561,y:.6893666386604309,z:.08984331786632538},{x:.6608623266220093,y:.6749406456947327,z:.0172116681933403},{x:.6482325196266174,y:.6823726296424866,z:.008881398476660252},{x:.6313265562057495,y:.6842025518417358,z:.0031308617908507586},{x:.6147016286849976,y:.6809731721878052,z:7630771724507213e-19},{x:.6018834114074707,y:.6755372285842896,z:-.0008834321051836014},{x:.5925027132034302,y:.670681357383728,z:-.001968748401850462},{x:.700127363204956,y:.6871103644371033,z:.13980500400066376},{x:.6095665693283081,y:.7853189706802368,z:-.03074747882783413},{x:.5880423784255981,y:.7229287028312683,z:-.04691500961780548},{x:.5930182337760925,y:.7811514139175415,z:-.06398335844278336},{x:.5867722034454346,y:.7922660112380981,z:-.05794971063733101},{x:.5933279991149902,y:.7842848896980286,z:-.05714067071676254},{x:.6063535809516907,y:.7920218706130981,z:-.02590685710310936},{x:.5839452743530273,y:.794978141784668,z:-.0615212507545948},{x:.5828126072883606,y:.8000800013542175,z:-.0449722595512867},{x:.5909603834152222,y:.6541213393211365,z:.003991890233010054},{x:.5852181911468506,y:.6602938771247864,z:-.004428438376635313},{x:.5825737714767456,y:.6651063561439514,z:-.014345290139317513},{x:.6517343521118164,y:.6362385153770447,z:.012151890434324741},{x:.6615052819252014,y:.6281577944755554,z:.0123682152479887},{x:.4856873154640198,y:.6568945646286011,z:720038078725338e-18},{x:.49988406896591187,y:.6547410488128662,z:6949726957827806e-19},{x:.48438939452171326,y:.6392973065376282,z:705525919329375e-18},{x:.47143134474754333,y:.6589511632919312,z:6980331381782889e-19},{x:.48704618215560913,y:.6752797961235046,z:6921177846379578e-19},{x:.6243702173233032,y:.640461802482605,z:-.00006592126737814397},{x:.6390967965126038,y:.6385173797607422,z:-.00016105435497593135},{x:.6230536699295044,y:.6224825382232666,z:-.00016136496560648084},{x:.6095397472381592,y:.641917884349823,z:-.0001803556369850412},{x:.6250996589660645,y:.6586247682571411,z:-.0001785515050869435}]],faceBlendshapes:[{categories:[{index:0,score:5187174338061595e-21,categoryName:"_neutral",displayName:""},{index:1,score:.24521504342556,categoryName:"browDownLeft",displayName:""},{index:2,score:.1987743377685547,categoryName:"browDownRight",displayName:""},{index:3,score:.013400448486208916,categoryName:"browInnerUp",displayName:""},{index:4,score:.012361560948193073,categoryName:"browOuterUpLeft",displayName:""},{index:5,score:.019305096939206123,categoryName:"browOuterUpRight",displayName:""},{index:6,score:28426356948330067e-21,categoryName:"cheekPuff",displayName:""},{index:7,score:34500112633395474e-23,categoryName:"cheekSquintLeft",displayName:""},{index:8,score:483789051486383e-21,categoryName:"cheekSquintRight",displayName:""},{index:9,score:.07650448381900787,categoryName:"eyeBlinkLeft",displayName:""},{index:10,score:.05070012807846069,categoryName:"eyeBlinkRight",displayName:""},{index:11,score:.13978900015354156,categoryName:"eyeLookDownLeft",displayName:""},{index:12,score:.14198613166809082,categoryName:"eyeLookDownRight",displayName:""},{index:13,score:.2177766114473343,categoryName:"eyeLookInLeft",displayName:""},{index:14,score:.014739357866346836,categoryName:"eyeLookInRight",displayName:""},{index:15,score:.02361512929201126,categoryName:"eyeLookOutLeft",displayName:""},{index:16,score:.19679604470729828,categoryName:"eyeLookOutRight",displayName:""},{index:17,score:.04874616861343384,categoryName:"eyeLookUpLeft",displayName:""},{index:18,score:.049392376095056534,categoryName:"eyeLookUpRight",displayName:""},{index:19,score:.34944331645965576,categoryName:"eyeSquintLeft",displayName:""},{index:20,score:.2939716875553131,categoryName:"eyeSquintRight",displayName:""},{index:21,score:.005955042317509651,categoryName:"eyeWideLeft",displayName:""},{index:22,score:.006776117719709873,categoryName:"eyeWideRight",displayName:""},{index:23,score:16942436559475027e-21,categoryName:"jawForward",displayName:""},{index:24,score:.0045165494084358215,categoryName:"jawLeft",displayName:""},{index:25,score:.07803940027952194,categoryName:"jawOpen",displayName:""},{index:26,score:2090057751047425e-20,categoryName:"jawRight",displayName:""},{index:27,score:.06032035872340202,categoryName:"mouthClose",displayName:""},{index:28,score:.00228882092051208,categoryName:"mouthDimpleLeft",displayName:""},{index:29,score:.00781762320548296,categoryName:"mouthDimpleRight",displayName:""},{index:30,score:.0017093931091949344,categoryName:"mouthFrownLeft",displayName:""},{index:31,score:.0019319106359034777,categoryName:"mouthFrownRight",displayName:""},{index:32,score:8485237776767462e-20,categoryName:"mouthFunnel",displayName:""},{index:33,score:9051355300471187e-19,categoryName:"mouthLeft",displayName:""},{index:34,score:3630454302765429e-19,categoryName:"mouthLowerDownLeft",displayName:""},{index:35,score:17601238505449146e-20,categoryName:"mouthLowerDownRight",displayName:""},{index:36,score:.12865161895751953,categoryName:"mouthPressLeft",displayName:""},{index:37,score:.20137207210063934,categoryName:"mouthPressRight",displayName:""},{index:38,score:.0022203284315764904,categoryName:"mouthPucker",displayName:""},{index:39,score:9096377179957926e-19,categoryName:"mouthRight",displayName:""},{index:40,score:.34189721941947937,categoryName:"mouthRollLower",displayName:""},{index:41,score:.11409689486026764,categoryName:"mouthRollUpper",displayName:""},{index:42,score:.17172536253929138,categoryName:"mouthShrugLower",displayName:""},{index:43,score:.004038424696773291,categoryName:"mouthShrugUpper",displayName:""},{index:44,score:23205230536404997e-20,categoryName:"mouthSmileLeft",displayName:""},{index:45,score:19313619122840464e-20,categoryName:"mouthSmileRight",displayName:""},{index:46,score:.0018571305554360151,categoryName:"mouthStretchLeft",displayName:""},{index:47,score:.0023813238367438316,categoryName:"mouthStretchRight",displayName:""},{index:48,score:24323100660694763e-21,categoryName:"mouthUpperUpLeft",displayName:""},{index:49,score:3161552012898028e-20,categoryName:"mouthUpperUpRight",displayName:""},{index:50,score:108198406678639e-21,categoryName:"noseSneerLeft",displayName:""},{index:51,score:12652527630052646e-22,categoryName:"noseSneerRight",displayName:""}],headIndex:-1,headName:""}],facialTransformationMatrixes:[{rows:4,columns:4,data:[.9947517514228821,.10230544209480286,.0013679931871592999,0,-.10230997204780579,.9947447776794434,.003816320328041911,0,-.000970348424743861,-.0039362297393381596,.9999914169311523,0,2.8888821601867676,-7.808934211730957,-30.52109146118164,1]}]}},xp=(0,ez.createContext)({}),xm={basePath:"https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@0.10.8/wasm",options:{baseOptions:{modelAssetPath:"https://storage.googleapis.com/mediapipe-models/face_landmarker/face_landmarker/float16/1/face_landmarker.task",delegate:"GPU"},runningMode:"VIDEO",outputFaceBlendshapes:!0,outputFacialTransformationMatrixes:!0}};function xA({basePath:e=xm.basePath,options:t=xm.options,children:n}){let i=JSON.stringify(t),a=(0,oQ.Rq)(async()=>{let{FilesetResolver:n,FaceLandmarker:i}=await r.e(398).then(r.bind(r,8398)),a=await n.forVisionTasks(e);return i.createFromOptions(a,t)},[e,i]);return(0,ez.useEffect)(()=>()=>{null==a||a.close(),(0,oQ.ZH)([e,i])},[a,e,i]),ez.createElement(xp.Provider,{value:a},n)}function xg(){return(0,ez.useContext)(xp)}function xv(e,t){return e.clone().add(t).multiplyScalar(.5)}function xy(e,t,r){let n=e.localToWorld(t);return r.worldToLocal(n)}let xx=(0,ez.createContext)({}),xE=(0,ez.forwardRef)(({camera:e,autostart:t=!0,webcam:r=!0,webcamVideoTextureSrc:n,manualUpdate:i=!1,manualDetect:a=!1,onVideoFrame:o,smoothTime:s=.25,offset:l=!0,offsetScalar:c=80,eyes:u=!1,eyesAsOrigin:h=!0,depth:d=.15,debug:f=!1,facemesh:p,makeDefault:m},A)=>{var g,v;let y=(0,eL.A)(e=>e.scene),x=(0,eL.A)(e=>e.camera),E=(0,eL.A)(e=>e.set),_=(0,eL.A)(e=>e.get),C=e||x,b=(0,ez.useRef)(null),w=(0,ez.useRef)(null),[B]=(0,ez.useState)(()=>new eQ.Object3D),[I]=(0,ez.useState)(()=>new eQ.Vector3),[M]=(0,ez.useState)(()=>new eQ.Vector3),[S]=(0,ez.useState)(()=>new eQ.Vector3),[T]=(0,ez.useState)(()=>new eQ.Vector3),P=(0,ez.useCallback)(()=>{B.parent=C.parent;let e=w.current;if(e){let{outerRef:t,eyeRightRef:r,eyeLeftRef:n}=e;if(r.current&&n.current){let{irisDirRef:e}=r.current,{irisDirRef:i}=n.current;e.current&&i.current&&t.current&&(I.copy(xy(e.current,new eQ.Vector3(0,0,0),t.current)),M.copy(xy(i.current,new eQ.Vector3(0,0,0),t.current)),B.position.copy(xy(t.current,xv(I,M),C.parent||y)),S.copy(xy(e.current,new eQ.Vector3(0,0,1),t.current)),T.copy(xy(i.current,new eQ.Vector3(0,0,1),t.current)),B.lookAt(t.current.localToWorld(xv(S,T))))}else t.current&&(B.position.copy(xy(t.current,new eQ.Vector3(0,0,0),C.parent||y)),B.lookAt(t.current.localToWorld(new eQ.Vector3(0,0,1))))}return B},[C,M,T,I,S,y,B]),[D]=(0,ez.useState)(()=>new eQ.Object3D),R=(0,ez.useCallback)(function(e,t){if(C){var r;null!==(r=t)&&void 0!==r||(t=P()),s>0?(rK.damp3(D.position,t.position,s,e,void 0,void 0,1e-9),rK.dampE(D.rotation,t.rotation,s,e,void 0,void 0,1e-9)):(D.position.copy(t.position),D.rotation.copy(t.rotation)),C.position.copy(D.position),C.rotation.copy(D.rotation)}},[C,P,s,D.position,D.rotation]),[F,z]=(0,ez.useState)(),O=xg(),Q=(0,ez.useCallback)((e,t)=>{z(null==O?void 0:O.detectForVideo(e,t))},[O]);(0,eL.C)((e,t)=>{i||R(t)});let L=(0,ez.useMemo)(()=>Object.assign(Object.create(eQ.EventDispatcher.prototype),{detect:Q,computeTarget:P,update:R,facemeshApiRef:w,webcamApiRef:b,play:()=>{var e;null==(e=b.current)||null==(e=e.videoTextureApiRef.current)||e.texture.source.data.play()},pause:()=>{var e;null==(e=b.current)||null==(e=e.videoTextureApiRef.current)||e.texture.source.data.pause()}}),[Q,P,R]);(0,ez.useImperativeHandle)(A,()=>L,[L]),(0,ez.useEffect)(()=>{let e=e=>{a||Q(e.texture.source.data,e.time),o&&o(e)};return L.addEventListener("videoFrame",e),()=>{L.removeEventListener("videoFrame",e)}},[L,Q,O,a,o]),(0,ez.useEffect)(()=>{if(m){let e=_().controls;return E({controls:L}),()=>E({controls:e})}},[m,L,_,E]);let k=null==F?void 0:F.faceLandmarks[0],U=null==F||null==(g=F.facialTransformationMatrixes)?void 0:g[0],N=null==F||null==(v=F.faceBlendshapes)?void 0:v[0];return ez.createElement(xx.Provider,{value:L},r&&ez.createElement(ez.Suspense,{fallback:null},ez.createElement(xC,{ref:b,autostart:t,videoTextureSrc:n})),ez.createElement(xu,ee({ref:w},p,{points:k,depth:d,facialTransformationMatrix:U,faceBlendshapes:N,eyes:u,eyesAsOrigin:h,offset:l,offsetScalar:c,debug:f,"rotation-z":Math.PI,visible:f}),ez.createElement("meshBasicMaterial",{side:eQ.DoubleSide})))}),x_=()=>(0,ez.useContext)(xx),xC=(0,ez.forwardRef)(({videoTextureSrc:e,autostart:t=!0},r)=>{let n=(0,ez.useRef)(null),i=x_(),a=(0,oQ.Rq)(async()=>e?Promise.resolve(null):await navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"user"}}),[e]);(0,ez.useEffect)(()=>(i.dispatchEvent({type:"stream",stream:a}),()=>{null==a||a.getTracks().forEach(e=>e.stop()),(0,oQ.ZH)([e])}),[a,i,e]);let o=(0,ez.useMemo)(()=>({videoTextureApiRef:n}),[]);return(0,ez.useImperativeHandle)(r,()=>o,[o]),ez.createElement(ez.Suspense,{fallback:null},ez.createElement(xb,{ref:n,src:e||a,start:t}))}),xb=(0,ez.forwardRef)(({src:e,start:t},r)=>{let n=dG(e,{start:t}),i=n.source.data,a=x_();xw(i,(0,ez.useCallback)(e=>{a.dispatchEvent({type:"videoFrame",texture:n,time:e})},[n,a]));let o=(0,ez.useMemo)(()=>({texture:n}),[n]);return(0,ez.useImperativeHandle)(r,()=>o,[o]),ez.createElement(ez.Fragment,null)}),xw=(e,t)=>{(0,ez.useEffect)(()=>{let r;if(e&&e.requestVideoFrameCallback)return e.requestVideoFrameCallback(function n(...i){t(...i),r=e.requestVideoFrameCallback(n)}),()=>e.cancelVideoFrameCallback(r)},[e,t])}},5238:function(e,t,r){"use strict";let n,i,a;r.d(t,{A:function(){return ep},B:function(){return I},C:function(){return em},D:function(){return eA},E:function(){return M},F:function(){return ey},a:function(){return w},b:function(){return eI},c:function(){return X},d:function(){return eT},e:function(){return x},f:function(){return ee},g:function(){return eP},h:function(){return eC},i:function(){return b},j:function(){return eb},k:function(){return Q},l:function(){return eE},m:function(){return e_},n:function(){return eo},o:function(){return es},p:function(){return el},q:function(){return eu},r:function(){return eM},s:function(){return R},t:function(){return v},u:function(){return B},v:function(){return eR},w:function(){return O},x:function(){return ex},y:function(){return ed},z:function(){return ef}});var o,s,l=r(7776),c=r(2265),u=r(2777),h=r(5901),d=r(1543),f=r.n(d),p=r(8276),m=r(9429),A=r(7437),g=r(357),v=Object.freeze({__proto__:null});let y={},x=e=>void Object.assign(y,e),E=e=>"colorSpace"in e||"outputColorSpace"in e,_=()=>{var e;return null!=(e=y.ColorManagement)?e:null},C=e=>e&&e.isOrthographicCamera,b=e=>e&&e.hasOwnProperty("current"),w="undefined"!=typeof window&&(null!=(o=window.document)&&o.createElement||(null==(s=window.navigator)?void 0:s.product)==="ReactNative")?c.useLayoutEffect:c.useEffect;function B(e){let t=c.useRef(e);return w(()=>void(t.current=e),[e]),t}function I({set:e}){return w(()=>(e(new Promise(()=>null)),()=>e(!1)),[e]),null}class M extends c.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}M.getDerivedStateFromError=()=>({error:!0});let S="__default",T=new Map,P=e=>e&&!!e.memoized&&!!e.changes;function D(e){var t;let r="undefined"!=typeof window?null!=(t=window.devicePixelRatio)?t:2:1;return Array.isArray(e)?Math.min(Math.max(e[0],r),e[1]):e}let R=e=>{var t;return null==(t=e.__r3f)?void 0:t.root.getState()};function F(e){let t=e.__r3f.root;for(;t.getState().previousRoot;)t=t.getState().previousRoot;return t}let z={obj:e=>e===Object(e)&&!z.arr(e)&&"function"!=typeof e,fun:e=>"function"==typeof e,str:e=>"string"==typeof e,num:e=>"number"==typeof e,boo:e=>"boolean"==typeof e,und:e=>void 0===e,arr:e=>Array.isArray(e),equ(e,t,{arrays:r="shallow",objects:n="reference",strict:i=!0}={}){let a;if(typeof e!=typeof t||!!e!=!!t)return!1;if(z.str(e)||z.num(e)||z.boo(e))return e===t;let o=z.obj(e);if(o&&"reference"===n)return e===t;let s=z.arr(e);if(s&&"reference"===r)return e===t;if((s||o)&&e===t)return!0;for(a in e)if(!(a in t))return!1;if(o&&"shallow"===r&&"shallow"===n){for(a in i?t:e)if(!z.equ(e[a],t[a],{strict:i,objects:"reference"}))return!1}else for(a in i?t:e)if(e[a]!==t[a])return!1;if(z.und(a)){if(s&&0===e.length&&0===t.length||o&&0===Object.keys(e).length&&0===Object.keys(t).length)return!0;if(e!==t)return!1}return!0}};function O(e){let t={nodes:{},materials:{}};return e&&e.traverse(e=>{e.name&&(t.nodes[e.name]=e),e.material&&!t.materials[e.material.name]&&(t.materials[e.material.name]=e.material)}),t}function Q(e){for(let t in e.dispose&&"Scene"!==e.type&&e.dispose(),e)null==t.dispose||t.dispose(),delete e[t]}function L(e,t){return e.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...t},e}function k(e,t){let r=e;if(!t.includes("-"))return{target:r,key:t};{let n=t.split("-"),i=n.pop();return{target:r=n.reduce((e,t)=>e[t],e),key:i}}}let U=/-\d+$/;function N(e,t,r){if(z.str(r)){if(U.test(r)){let{target:t,key:n}=k(e,r.replace(U,""));Array.isArray(t[n])||(t[n]=[])}let{target:n,key:i}=k(e,r);t.__r3f.previousAttach=n[i],n[i]=t}else t.__r3f.previousAttach=r(e,t)}function G(e,t,r){var n,i;if(z.str(r)){let{target:n,key:i}=k(e,r),a=t.__r3f.previousAttach;void 0===a?delete n[i]:n[i]=a}else null==(n=t.__r3f)||null==n.previousAttach||n.previousAttach(e,t);null==(i=t.__r3f)||delete i.previousAttach}function H(e,{children:t,key:r,ref:n,...i},{children:a,key:o,ref:s,...l}={},c=!1){let u=e.__r3f,h=Object.entries(i),d=[];if(c){let e=Object.keys(l);for(let t=0;t<e.length;t++)i.hasOwnProperty(e[t])||h.unshift([e[t],S+"remove"])}h.forEach(([t,r])=>{var n;if(null!=(n=e.__r3f)&&n.primitive&&"object"===t||z.equ(r,l[t]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(t))return d.push([t,r,!0,[]]);let a=[];for(let e in t.includes("-")&&(a=t.split("-")),d.push([t,r,!1,a]),i){let r=i[e];e.startsWith(`${t}-`)&&d.push([e,r,!1,e.split("-")])}});let f={...i};return null!=u&&u.memoizedProps&&null!=u&&u.memoizedProps.args&&(f.args=u.memoizedProps.args),null!=u&&u.memoizedProps&&null!=u&&u.memoizedProps.attach&&(f.attach=u.memoizedProps.attach),{memoized:f,changes:d}}let V=void 0!==g&&!1;function j(e,t){var r;let n=e.__r3f,i=null==n?void 0:n.root,a=null==i?void 0:null==i.getState?void 0:i.getState(),{memoized:o,changes:s}=P(t)?t:H(e,t),c=null==n?void 0:n.eventCount;e.__r3f&&(e.__r3f.memoizedProps=o);for(let t=0;t<s.length;t++){let[r,i,o,c]=s[t];if(E(e)){let e="srgb",t="srgb-linear";"encoding"===r?(r="colorSpace",i=3001===i?e:t):"outputEncoding"===r&&(r="outputColorSpace",i=3001===i?e:t)}let u=e,h=u[r];if(c.length&&!((h=c.reduce((e,t)=>e[t],e))&&h.set)){let[t,...n]=c.reverse();u=n.reverse().reduce((e,t)=>e[t],e),r=t}if(i===S+"remove"){if(u.constructor){let e=T.get(u.constructor);e||(e=new u.constructor,T.set(u.constructor,e)),i=e[r]}else i=0}if(o&&n)i?n.handlers[r]=i:delete n.handlers[r],n.eventCount=Object.keys(n.handlers).length;else if(h&&h.set&&(h.copy||h instanceof l.Layers)){if(Array.isArray(i))h.fromArray?h.fromArray(i):h.set(...i);else if(h.copy&&i&&i.constructor&&(V?h.constructor.name===i.constructor.name:h.constructor===i.constructor))h.copy(i);else if(void 0!==i){let e=h instanceof l.Color;!e&&h.setScalar?h.setScalar(i):h instanceof l.Layers&&i instanceof l.Layers?h.mask=i.mask:h.set(i),!_()&&a&&!a.linear&&e&&h.convertSRGBToLinear()}}else if(u[r]=i,u[r]instanceof l.Texture&&u[r].format===l.RGBAFormat&&u[r].type===l.UnsignedByteType&&a){let e=u[r];E(e)&&E(a.gl)?e.colorSpace=a.gl.outputColorSpace:e.encoding=a.gl.outputEncoding}Y(e)}if(n&&n.parent&&e.raycast&&c!==n.eventCount){let t=F(e).getState().internal,r=t.interaction.indexOf(e);r>-1&&t.interaction.splice(r,1),n.eventCount&&t.interaction.push(e)}return!(1===s.length&&"onUpdate"===s[0][0])&&s.length&&null!=(r=e.__r3f)&&r.parent&&J(e),e}function Y(e){var t,r;let n=null==(t=e.__r3f)?void 0:null==(r=t.root)?void 0:null==r.getState?void 0:r.getState();n&&0===n.internal.frames&&n.invalidate()}function J(e){null==e.onUpdate||e.onUpdate(e)}function W(e,t){e.manual||(C(e)?(e.left=-(t.width/2),e.right=t.width/2,e.top=t.height/2,e.bottom=-(t.height/2)):e.aspect=t.width/t.height,e.updateProjectionMatrix(),e.updateMatrixWorld())}function q(e){return(e.eventObject||e.object).uuid+"/"+e.index+e.instanceId}function K(e,t,r,n){let i=r.get(t);i&&(r.delete(t),0===r.size&&(e.delete(n),i.target.releasePointerCapture(n)))}function X(e){function t(e){return e.filter(e=>["Move","Over","Enter","Out","Leave"].some(t=>{var r;return null==(r=e.__r3f)?void 0:r.handlers["onPointer"+t]}))}function r(t){let{internal:r}=e.getState();for(let e of r.hovered.values())if(!t.length||!t.find(t=>t.object===e.object&&t.index===e.index&&t.instanceId===e.instanceId)){let n=e.eventObject.__r3f,i=null==n?void 0:n.handlers;if(r.hovered.delete(q(e)),null!=n&&n.eventCount){let r={...e,intersections:t};null==i.onPointerOut||i.onPointerOut(r),null==i.onPointerLeave||i.onPointerLeave(r)}}}function n(e,t){for(let r=0;r<t.length;r++){let n=t[r].__r3f;null==n||null==n.handlers.onPointerMissed||n.handlers.onPointerMissed(e)}}return{handlePointer:function(i){switch(i){case"onPointerLeave":case"onPointerCancel":return()=>r([]);case"onLostPointerCapture":return t=>{let{internal:n}=e.getState();"pointerId"in t&&n.capturedMap.has(t.pointerId)&&requestAnimationFrame(()=>{n.capturedMap.has(t.pointerId)&&(n.capturedMap.delete(t.pointerId),r([]))})}}return function(a){let{onPointerMissed:o,internal:s}=e.getState();s.lastEvent.current=a;let c="onPointerMove"===i,u="onClick"===i||"onContextMenu"===i||"onDoubleClick"===i,h=function(t,r){let n=e.getState(),i=new Set,a=[],o=r?r(n.internal.interaction):n.internal.interaction;for(let e=0;e<o.length;e++){let t=R(o[e]);t&&(t.raycaster.camera=void 0)}n.previousRoot||null==n.events.compute||n.events.compute(t,n);let s=o.flatMap(function(e){let r=R(e);if(!r||!r.events.enabled||null===r.raycaster.camera)return[];if(void 0===r.raycaster.camera){var n;null==r.events.compute||r.events.compute(t,r,null==(n=r.previousRoot)?void 0:n.getState()),void 0===r.raycaster.camera&&(r.raycaster.camera=null)}return r.raycaster.camera?r.raycaster.intersectObject(e,!0):[]}).sort((e,t)=>{let r=R(e.object),n=R(t.object);return r&&n&&n.events.priority-r.events.priority||e.distance-t.distance}).filter(e=>{let t=q(e);return!i.has(t)&&(i.add(t),!0)});for(let e of(n.events.filter&&(s=n.events.filter(s,n)),s)){let t=e.object;for(;t;){var l;null!=(l=t.__r3f)&&l.eventCount&&a.push({...e,eventObject:t}),t=t.parent}}if("pointerId"in t&&n.internal.capturedMap.has(t.pointerId))for(let e of n.internal.capturedMap.get(t.pointerId).values())i.has(q(e.intersection))||a.push(e.intersection);return a}(a,c?t:void 0),d=u?function(t){let{internal:r}=e.getState(),n=t.offsetX-r.initialClick[0],i=t.offsetY-r.initialClick[1];return Math.round(Math.sqrt(n*n+i*i))}(a):0;"onPointerDown"===i&&(s.initialClick=[a.offsetX,a.offsetY],s.initialHits=h.map(e=>e.eventObject)),u&&!h.length&&d<=2&&(n(a,s.interaction),o&&o(a)),c&&r(h),function(t,n,i,a){let o=e.getState();if(t.length){let e={stopped:!1};for(let s of t){let{raycaster:c,pointer:u,camera:h,internal:d}=R(s.object)||o,f=new l.Vector3(u.x,u.y,0).unproject(h),p=e=>{var t,r;return null!=(t=null==(r=d.capturedMap.get(e))?void 0:r.has(s.eventObject))&&t},m=e=>{let t={intersection:s,target:n.target};d.capturedMap.has(e)?d.capturedMap.get(e).set(s.eventObject,t):d.capturedMap.set(e,new Map([[s.eventObject,t]])),n.target.setPointerCapture(e)},A=e=>{let t=d.capturedMap.get(e);t&&K(d.capturedMap,s.eventObject,t,e)},g={};for(let e in n){let t=n[e];"function"!=typeof t&&(g[e]=t)}let v={...s,...g,pointer:u,intersections:t,stopped:e.stopped,delta:i,unprojectedPoint:f,ray:c.ray,camera:h,stopPropagation(){let i="pointerId"in n&&d.capturedMap.get(n.pointerId);(!i||i.has(s.eventObject))&&(v.stopped=e.stopped=!0,d.hovered.size&&Array.from(d.hovered.values()).find(e=>e.eventObject===s.eventObject)&&r([...t.slice(0,t.indexOf(s)),s]))},target:{hasPointerCapture:p,setPointerCapture:m,releasePointerCapture:A},currentTarget:{hasPointerCapture:p,setPointerCapture:m,releasePointerCapture:A},nativeEvent:n};if(a(v),!0===e.stopped)break}}}(h,a,d,function(e){let t=e.eventObject,r=t.__r3f,o=null==r?void 0:r.handlers;if(null!=r&&r.eventCount){if(c){if(o.onPointerOver||o.onPointerEnter||o.onPointerOut||o.onPointerLeave){let t=q(e),r=s.hovered.get(t);r?r.stopped&&e.stopPropagation():(s.hovered.set(t,e),null==o.onPointerOver||o.onPointerOver(e),null==o.onPointerEnter||o.onPointerEnter(e))}null==o.onPointerMove||o.onPointerMove(e)}else{let r=o[i];r?(!u||s.initialHits.includes(t))&&(n(a,s.interaction.filter(e=>!s.initialHits.includes(e))),r(e)):u&&s.initialHits.includes(t)&&n(a,s.interaction.filter(e=>!s.initialHits.includes(e)))}}})}}}}let Z=["set","get","setSize","setFrameloop","setDpr","events","invalidate","advance","size","viewport"],$=e=>!!(null!=e&&e.render),ee=c.createContext(null),et=(e,t)=>{let r=(0,h.Z)((r,n)=>{let i;let a=new l.Vector3,o=new l.Vector3,s=new l.Vector3;function u(e=n().camera,t=o,r=n().size){let{width:i,height:c,top:u,left:h}=r,d=i/c;t instanceof l.Vector3?s.copy(t):s.set(...t);let f=e.getWorldPosition(a).distanceTo(s);if(C(e))return{width:i/e.zoom,height:c/e.zoom,top:u,left:h,factor:1,distance:f,aspect:d};{let t=2*Math.tan(e.fov*Math.PI/180/2)*f,r=i/c*t;return{width:r,height:t,top:u,left:h,factor:i/r,distance:f,aspect:d}}}let h=e=>r(t=>({performance:{...t.performance,current:e}})),d=new l.Vector2;return{set:r,get:n,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(t=1)=>e(n(),t),advance:(e,r)=>t(e,r,n()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new l.Clock,pointer:d,mouse:d,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{let e=n();i&&clearTimeout(i),e.performance.current!==e.performance.min&&h(e.performance.min),i=setTimeout(()=>h(n().performance.max),e.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:u},setEvents:e=>r(t=>({...t,events:{...t.events,...e}})),setSize:(e,t,i,a,s)=>{let l=n().camera,c={width:e,height:t,top:a||0,left:s||0,updateStyle:i};r(e=>({size:c,viewport:{...e.viewport,...u(l,o,c)}}))},setDpr:e=>r(t=>{let r=D(e);return{viewport:{...t.viewport,dpr:r,initialDpr:t.viewport.initialDpr||r}}}),setFrameloop:(e="always")=>{let t=n().clock;t.stop(),t.elapsedTime=0,"never"!==e&&(t.start(),t.elapsedTime=0),r(()=>({frameloop:e}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:c.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(e,t,r)=>{let i=n().internal;return i.priority=i.priority+(t>0?1:0),i.subscribers.push({ref:e,priority:t,store:r}),i.subscribers=i.subscribers.sort((e,t)=>e.priority-t.priority),()=>{let r=n().internal;null!=r&&r.subscribers&&(r.priority=r.priority-(t>0?1:0),r.subscribers=r.subscribers.filter(t=>t.ref!==e))}}}}}),n=r.getState(),i=n.size,a=n.viewport.dpr,o=n.camera;return r.subscribe(()=>{let{camera:e,size:t,viewport:n,gl:s,set:l}=r.getState();if(t.width!==i.width||t.height!==i.height||n.dpr!==a){var c;i=t,a=n.dpr,W(e,t),s.setPixelRatio(n.dpr);let r=null!=(c=t.updateStyle)?c:"undefined"!=typeof HTMLCanvasElement&&s.domElement instanceof HTMLCanvasElement;s.setSize(t.width,t.height,r)}e!==o&&(o=e,l(t=>({viewport:{...t.viewport,...t.viewport.getCurrentViewport(e)}})))}),r.subscribe(t=>e(t)),r};function er(e,t){let r={callback:e};return t.add(r),()=>void t.delete(r)}let en=new Set,ei=new Set,ea=new Set,eo=e=>er(e,en),es=e=>er(e,ei),el=e=>er(e,ea);function ec(e,t){if(e.size)for(let{callback:r}of e.values())r(t)}function eu(e,t){switch(e){case"before":return ec(en,t);case"after":return ec(ei,t);case"tail":return ec(ea,t)}}function eh(e,t,r){let o=t.clock.getDelta();for("never"===t.frameloop&&"number"==typeof e&&(o=e-t.clock.elapsedTime,t.clock.oldTime=t.clock.elapsedTime,t.clock.elapsedTime=e),i=t.internal.subscribers,n=0;n<i.length;n++)(a=i[n]).ref.current(a.store.getState(),o,r);return!t.internal.priority&&t.gl.render&&t.gl.render(t.scene,t.camera),t.internal.frames=Math.max(0,t.internal.frames-1),"always"===t.frameloop?1:t.internal.frames}function ed(e){let t=c.useRef(null);return w(()=>void(t.current=e.current.__r3f),[e]),t}function ef(){let e=c.useContext(ee);if(!e)throw Error("R3F: Hooks can only be used within the Canvas component!");return e}function ep(e=e=>e,t){return ef()(e,t)}function em(e,t=0){let r=ef(),n=r.getState().internal.subscribe,i=B(e);return w(()=>n(i,t,r),[t,n,r]),null}function eA(e){return c.useMemo(()=>O(e),[e])}let eg=new WeakMap;function ev(e,t){return function(r,...n){let i=eg.get(r);return i||(i=new r,eg.set(r,i)),e&&e(i),Promise.all(n.map(e=>new Promise((r,n)=>i.load(e,e=>{e.scene&&Object.assign(e,O(e.scene)),r(e)},t,t=>n(Error(`Could not load ${e}: ${null==t?void 0:t.message}`))))))}}function ey(e,t,r,n){let i=Array.isArray(t)?t:[t],a=(0,m.Rq)(ev(r,n),[e,...i],{equal:z.equ});return Array.isArray(t)?a:a[0]}ey.preload=function(e,t,r){let n=Array.isArray(t)?t:[t];return(0,m.MA)(ev(r),[e,...n])},ey.clear=function(e,t){let r=Array.isArray(t)?t:[t];return(0,m.ZH)([e,...r])};let ex=new Map,{invalidate:eE,advance:e_}=function(e){let t,r,n,i=!1,a=!1;function o(s){for(let c of(r=requestAnimationFrame(o),i=!0,t=0,eu("before",s),a=!0,e.values())){var l;(n=c.store.getState()).internal.active&&("always"===n.frameloop||n.internal.frames>0)&&!(null!=(l=n.gl.xr)&&l.isPresenting)&&(t+=eh(s,n))}if(a=!1,eu("after",s),0===t)return eu("tail",s),i=!1,cancelAnimationFrame(r)}return{loop:o,invalidate:function t(r,n=1){var s;if(!r)return e.forEach(e=>t(e.store.getState(),n));null!=(s=r.gl.xr)&&s.isPresenting||!r.internal.active||"never"===r.frameloop||(n>1?r.internal.frames=Math.min(60,r.internal.frames+n):a?r.internal.frames=2:r.internal.frames=1,i||(i=!0,requestAnimationFrame(o)))},advance:function(t,r=!0,n,i){if(r&&eu("before",t),n)eh(t,n,i);else for(let r of e.values())eh(t,r.store.getState());r&&eu("after",t)}}}(ex),{reconciler:eC,applyProps:eb}=function(e,t){function r(e,{args:t=[],attach:r,...n},i){let a,o=`${e[0].toUpperCase()}${e.slice(1)}`;if("primitive"===e){if(void 0===n.object)throw Error("R3F: Primitives without 'object' are invalid!");a=L(n.object,{type:e,root:i,attach:r,primitive:!0})}else{let n=y[o];if(!n)throw Error(`R3F: ${o} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(t))throw Error("R3F: The args prop must be an array!");a=L(new n(...t),{type:e,root:i,attach:r,memoizedProps:{args:t}})}return void 0===a.__r3f.attach&&(a instanceof l.BufferGeometry?a.__r3f.attach="geometry":a instanceof l.Material&&(a.__r3f.attach="material")),"inject"!==o&&j(a,n),a}function n(e,t){let r=!1;if(t){var n,i;null!=(n=t.__r3f)&&n.attach?N(e,t,t.__r3f.attach):t.isObject3D&&e.isObject3D&&(e.add(t),r=!0),r||null==(i=e.__r3f)||i.objects.push(t),t.__r3f||L(t,{}),t.__r3f.parent=e,J(t),Y(t)}}function i(e,t,r){let n=!1;if(t){var i,a;if(null!=(i=t.__r3f)&&i.attach)N(e,t,t.__r3f.attach);else if(t.isObject3D&&e.isObject3D){t.parent=e,t.dispatchEvent({type:"added"}),e.dispatchEvent({type:"childadded",child:t});let i=e.children.filter(e=>e!==t),a=i.indexOf(r);e.children=[...i.slice(0,a),t,...i.slice(a)],n=!0}n||null==(a=e.__r3f)||a.objects.push(t),t.__r3f||L(t,{}),t.__r3f.parent=e,J(t),Y(t)}}function a(e,t,r=!1){e&&[...e].forEach(e=>o(t,e,r))}function o(e,t,r){if(t){var n,i,o,s,l;t.__r3f&&(t.__r3f.parent=null),null!=(n=e.__r3f)&&n.objects&&(e.__r3f.objects=e.__r3f.objects.filter(e=>e!==t)),null!=(i=t.__r3f)&&i.attach?G(e,t,t.__r3f.attach):t.isObject3D&&e.isObject3D&&(e.remove(t),null!=(s=t.__r3f)&&s.root&&function(e,t){let{internal:r}=e.getState();r.interaction=r.interaction.filter(e=>e!==t),r.initialHits=r.initialHits.filter(e=>e!==t),r.hovered.forEach((e,n)=>{(e.eventObject===t||e.object===t)&&r.hovered.delete(n)}),r.capturedMap.forEach((e,n)=>{K(r.capturedMap,t,e,n)})}(F(t),t));let c=null==(o=t.__r3f)?void 0:o.primitive,u=!c&&(void 0===r?null!==t.dispose:r);if(c||(a(null==(l=t.__r3f)?void 0:l.objects,t,u),a(t.children,t,u)),delete t.__r3f,u&&t.dispose&&"Scene"!==t.type){let e=()=>{try{t.dispose()}catch(e){}};"undefined"==typeof IS_REACT_ACT_ENVIRONMENT?(0,p.unstable_scheduleCallback)(p.unstable_IdlePriority,e):e()}Y(e)}}let s=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:f()({createInstance:r,removeChild:o,appendChild:n,appendInitialChild:n,insertBefore:i,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(e,t)=>{if(!t)return;let r=e.getState().scene;r.__r3f&&(r.__r3f.root=e,n(r,t))},removeChildFromContainer:(e,t)=>{t&&o(e.getState().scene,t)},insertInContainerBefore:(e,t,r)=>{if(!t||!r)return;let n=e.getState().scene;n.__r3f&&i(n,t,r)},getRootHostContext:()=>null,getChildHostContext:e=>e,finalizeInitialChildren(e){var t;return!!(null!=(t=null==e?void 0:e.__r3f)?t:{}).handlers},prepareUpdate(e,t,r,n){var i;if((null!=(i=null==e?void 0:e.__r3f)?i:{}).primitive&&n.object&&n.object!==e)return[!0];{let{args:t=[],children:i,...a}=n,{args:o=[],children:s,...l}=r;if(!Array.isArray(t))throw Error("R3F: the args prop must be an array!");if(t.some((e,t)=>e!==o[t]))return[!0];let c=H(e,a,l,!0);return c.changes.length?[!1,c]:null}},commitUpdate(e,[t,i],a,s,l,c){t?function(e,t,i,a){var s;let l=null==(s=e.__r3f)?void 0:s.parent;if(!l)return;let c=r(t,i,e.__r3f.root);if(e.children){for(let t of e.children)t.__r3f&&n(c,t);e.children=e.children.filter(e=>!e.__r3f)}e.__r3f.objects.forEach(e=>n(c,e)),e.__r3f.objects=[],e.__r3f.autoRemovedBeforeAppend||o(l,e),c.parent&&(c.__r3f.autoRemovedBeforeAppend=!0),n(l,c),c.raycast&&c.__r3f.eventCount&&F(c).getState().internal.interaction.push(c),[a,a.alternate].forEach(e=>{null!==e&&(e.stateNode=c,e.ref&&("function"==typeof e.ref?e.ref(c):e.ref.current=c))})}(e,a,l,c):j(e,i)},commitMount(e,t,r,n){var i;let a=null!=(i=e.__r3f)?i:{};e.raycast&&a.handlers&&a.eventCount&&F(e).getState().internal.interaction.push(e)},getPublicInstance:e=>e,prepareForCommit:()=>null,preparePortalMount:e=>L(e.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(e){var t;let{attach:r,parent:n}=null!=(t=e.__r3f)?t:{};r&&n&&G(n,e,r),e.isObject3D&&(e.visible=!1),Y(e)},unhideInstance(e,t){var r;let{attach:n,parent:i}=null!=(r=e.__r3f)?r:{};n&&i&&N(i,e,n),(e.isObject3D&&null==t.visible||t.visible)&&(e.visible=!0),Y(e)},createTextInstance:s,hideTextInstance:s,unhideTextInstance:s,getCurrentEventPriority:()=>t?t():u.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:"undefined"!=typeof performance&&z.fun(performance.now)?performance.now:z.fun(Date.now)?Date.now:()=>0,scheduleTimeout:z.fun(setTimeout)?setTimeout:void 0,cancelTimeout:z.fun(clearTimeout)?clearTimeout:void 0}),applyProps:j}}(0,function(){var e;let t="undefined"!=typeof self&&self||"undefined"!=typeof window&&window;if(!t)return u.DefaultEventPriority;switch(null==(e=t.event)?void 0:e.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return u.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return u.ContinuousEventPriority;default:return u.DefaultEventPriority}}),ew={objects:"shallow",strict:!1},eB=(e,t)=>{let r="function"==typeof e?e(t):e;return $(r)?r:new l.WebGLRenderer({powerPreference:"high-performance",canvas:t,antialias:!0,alpha:!0,...e})};function eI(e){let t,r;let n=ex.get(e),i=null==n?void 0:n.fiber,a=null==n?void 0:n.store;n&&console.warn("R3F.createRoot should only be called once!");let o="function"==typeof reportError?reportError:console.error,s=a||et(eE,e_),c=i||eC.createContainer(s,u.ConcurrentRoot,null,!1,null,"",o,null);n||ex.set(e,{fiber:c,store:s});let h=!1;return{configure(n={}){var i,a;let{gl:o,size:c,scene:u,events:d,onCreated:f,shadows:p=!1,linear:m=!1,flat:A=!1,legacy:g=!1,orthographic:v=!1,frameloop:y="always",dpr:x=[1,2],performance:E,raycaster:C,camera:b,onPointerMissed:w}=n,B=s.getState(),I=B.gl;B.gl||B.set({gl:I=eB(o,e)});let M=B.raycaster;M||B.set({raycaster:M=new l.Raycaster});let{params:S,...T}=C||{};if(z.equ(T,M,ew)||eb(M,{...T}),z.equ(S,M.params,ew)||eb(M,{params:{...M.params,...S}}),!B.camera||B.camera===r&&!z.equ(r,b,ew)){r=b;let e=b instanceof l.Camera,t=e?b:v?new l.OrthographicCamera(0,0,0,0,.1,1e3):new l.PerspectiveCamera(75,0,.1,1e3);e||(t.position.z=5,b&&(eb(t,b),("aspect"in b||"left"in b||"right"in b||"bottom"in b||"top"in b)&&(t.manual=!0,t.updateProjectionMatrix())),B.camera||null!=b&&b.rotation||t.lookAt(0,0,0)),B.set({camera:t}),M.camera=t}if(!B.scene){let e;u instanceof l.Scene?e=u:(e=new l.Scene,u&&eb(e,u)),B.set({scene:L(e)})}if(!B.xr){let e=(e,t)=>{let r=s.getState();"never"!==r.frameloop&&e_(e,!0,r,t)},t=()=>{let t=s.getState();t.gl.xr.enabled=t.gl.xr.isPresenting,t.gl.xr.setAnimationLoop(t.gl.xr.isPresenting?e:null),t.gl.xr.isPresenting||eE(t)},r={connect(){let e=s.getState().gl;e.xr.addEventListener("sessionstart",t),e.xr.addEventListener("sessionend",t)},disconnect(){let e=s.getState().gl;e.xr.removeEventListener("sessionstart",t),e.xr.removeEventListener("sessionend",t)}};"function"==typeof(null==(i=I.xr)?void 0:i.addEventListener)&&r.connect(),B.set({xr:r})}if(I.shadowMap){let e=I.shadowMap.enabled,t=I.shadowMap.type;if(I.shadowMap.enabled=!!p,z.boo(p))I.shadowMap.type=l.PCFSoftShadowMap;else if(z.str(p)){let e={basic:l.BasicShadowMap,percentage:l.PCFShadowMap,soft:l.PCFSoftShadowMap,variance:l.VSMShadowMap};I.shadowMap.type=null!=(a=e[p])?a:l.PCFSoftShadowMap}else z.obj(p)&&Object.assign(I.shadowMap,p);(e!==I.shadowMap.enabled||t!==I.shadowMap.type)&&(I.shadowMap.needsUpdate=!0)}let P=_();P&&("enabled"in P?P.enabled=!g:"legacyMode"in P&&(P.legacyMode=g)),h||eb(I,{outputEncoding:m?3e3:3001,toneMapping:A?l.NoToneMapping:l.ACESFilmicToneMapping}),B.legacy!==g&&B.set(()=>({legacy:g})),B.linear!==m&&B.set(()=>({linear:m})),B.flat!==A&&B.set(()=>({flat:A})),!o||z.fun(o)||$(o)||z.equ(o,I,ew)||eb(I,o),d&&!B.events.handlers&&B.set({events:d(s)});let R=function(e,t){let r="undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement;if(t){let{width:e,height:n,top:i,left:a,updateStyle:o=r}=t;return{width:e,height:n,top:i,left:a,updateStyle:o}}if("undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement&&e.parentElement){let{width:t,height:n,top:i,left:a}=e.parentElement.getBoundingClientRect();return{width:t,height:n,top:i,left:a,updateStyle:r}}return"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas?{width:e.width,height:e.height,top:0,left:0,updateStyle:r}:{width:0,height:0,top:0,left:0}}(e,c);return z.equ(R,B.size,ew)||B.setSize(R.width,R.height,R.updateStyle,R.top,R.left),x&&B.viewport.dpr!==D(x)&&B.setDpr(x),B.frameloop!==y&&B.setFrameloop(y),B.onPointerMissed||B.set({onPointerMissed:w}),E&&!z.equ(E,B.performance,ew)&&B.set(e=>({performance:{...e.performance,...E}})),t=f,h=!0,this},render(r){return h||this.configure(),eC.updateContainer((0,A.jsx)(eS,{store:s,children:r,onCreated:t,rootElement:e}),c,null,()=>void 0),s},unmount(){eT(e)}}}function eM(e,t,r){console.warn("R3F.render is no longer supported in React 18. Use createRoot instead!");let n=eI(t);return n.configure(r),n.render(e)}function eS({store:e,children:t,onCreated:r,rootElement:n}){return w(()=>{let t=e.getState();t.set(e=>({internal:{...e.internal,active:!0}})),r&&r(t),e.getState().events.connected||null==t.events.connect||t.events.connect(n)},[]),(0,A.jsx)(ee.Provider,{value:e,children:t})}function eT(e,t){let r=ex.get(e),n=null==r?void 0:r.fiber;if(n){let i=null==r?void 0:r.store.getState();i&&(i.internal.active=!1),eC.updateContainer(null,n,null,()=>{i&&setTimeout(()=>{try{var r,n,a,o;null==i.events.disconnect||i.events.disconnect(),null==(r=i.gl)||null==(n=r.renderLists)||null==n.dispose||n.dispose(),null==(a=i.gl)||null==a.forceContextLoss||a.forceContextLoss(),null!=(o=i.gl)&&o.xr&&i.xr.disconnect(),Q(i),ex.delete(e),t&&t(e)}catch(e){}},500)})}}function eP(e,t,r){return(0,A.jsx)(eD,{children:e,container:t,state:r},t.uuid)}function eD({state:e={},children:t,container:r}){let{events:n,size:i,...a}=e,o=ef(),[s]=c.useState(()=>new l.Raycaster),[u]=c.useState(()=>new l.Vector2),d=c.useCallback((e,t)=>{let c;let h={...e};if(Object.keys(e).forEach(r=>{(Z.includes(r)||e[r]!==t[r]&&t[r])&&delete h[r]}),t&&i){let r=t.camera;c=e.viewport.getCurrentViewport(r,new l.Vector3,i),r!==e.camera&&W(r,i)}return{...h,scene:r,raycaster:s,pointer:u,mouse:u,previousRoot:o,events:{...e.events,...null==t?void 0:t.events,...n},size:{...e.size,...i},viewport:{...e.viewport,...c},...a}},[e]),[f]=c.useState(()=>{let e=o.getState();return(0,h.Z)((t,l)=>({...e,scene:r,raycaster:s,pointer:u,mouse:u,previousRoot:o,events:{...e.events,...n},size:{...e.size,...i},...a,set:t,get:l,setEvents:e=>t(t=>({...t,events:{...t.events,...e}}))}))});return c.useEffect(()=>{let e=o.subscribe(e=>f.setState(t=>d(e,t)));return()=>{e()}},[d]),c.useEffect(()=>{f.setState(e=>d(o.getState(),e))},[d]),c.useEffect(()=>()=>{f.destroy()},[]),(0,A.jsx)(A.Fragment,{children:eC.createPortal((0,A.jsx)(ee.Provider,{value:f,children:t}),f,null)})}eC.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:c.version});let eR=c.unstable_act},3149:function(e,t,r){"use strict";r.r(t),r.d(t,{Canvas:function(){return S},ReactThreeFiber:function(){return a.t},_roots:function(){return a.x},act:function(){return a.v},addAfterEffect:function(){return a.o},addEffect:function(){return a.n},addTail:function(){return a.p},advance:function(){return a.m},applyProps:function(){return a.j},buildGraph:function(){return a.w},context:function(){return a.f},createEvents:function(){return a.c},createPortal:function(){return a.g},createRoot:function(){return a.b},dispose:function(){return a.k},events:function(){return I},extend:function(){return a.e},flushGlobalEffects:function(){return a.q},getRootState:function(){return a.s},invalidate:function(){return a.l},reconciler:function(){return a.h},render:function(){return a.r},unmountComponentAtNode:function(){return a.d},useFrame:function(){return a.C},useGraph:function(){return a.D},useInstanceHandle:function(){return a.y},useLoader:function(){return a.F},useStore:function(){return a.z},useThree:function(){return a.A}});var n,i,a=r(5238),o=r(2265),s=r(7776),l=r(4692),c=r.n(l);let u=["x","y","top","bottom","left","right","width","height"],h=(e,t)=>u.every(r=>e[r]===t[r]);var d=Object.defineProperty,f=Object.defineProperties,p=Object.getOwnPropertyDescriptors,m=Object.getOwnPropertySymbols,A=Object.prototype.hasOwnProperty,g=Object.prototype.propertyIsEnumerable,v=(e,t,r)=>t in e?d(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,y=(e,t)=>{for(var r in t||(t={}))A.call(t,r)&&v(e,r,t[r]);if(m)for(var r of m(t))g.call(t,r)&&v(e,r,t[r]);return e},x=(e,t)=>f(e,p(t));function E(e){try{return Object.defineProperties(e,{_currentRenderer:{get:()=>null,set(){}},_currentRenderer2:{get:()=>null,set(){}}})}catch(t){return e}}"undefined"!=typeof window&&((null==(n=window.document)?void 0:n.createElement)||(null==(i=window.navigator)?void 0:i.product)==="ReactNative")?o.useLayoutEffect:o.useEffect;let _=console.error;console.error=function(){let e=[...arguments].join("");if((null==e?void 0:e.startsWith("Warning:"))&&e.includes("useContext")){console.error=_;return}return _.apply(this,arguments)};let C=E(o.createContext(null));class b extends o.Component{render(){return o.createElement(C.Provider,{value:this._reactInternals},this.props.children)}}var w=r(7437);r(2777),r(1543),r(8276);let B={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function I(e){let{handlePointer:t}=(0,a.c)(e);return{priority:1,enabled:!0,compute(e,t,r){t.pointer.set(e.offsetX/t.size.width*2-1,-(e.offsetY/t.size.height*2)+1),t.raycaster.setFromCamera(t.pointer,t.camera)},connected:void 0,handlers:Object.keys(B).reduce((e,r)=>({...e,[r]:t(r)}),{}),update:()=>{var t;let{events:r,internal:n}=e.getState();null!=(t=n.lastEvent)&&t.current&&r.handlers&&r.handlers.onPointerMove(n.lastEvent.current)},connect:t=>{var r;let{set:n,events:i}=e.getState();null==i.disconnect||i.disconnect(),n(e=>({events:{...e.events,connected:t}})),Object.entries(null!=(r=i.handlers)?r:[]).forEach(([e,r])=>{let[n,i]=B[e];t.addEventListener(n,r,{passive:i})})},disconnect:()=>{let{set:t,events:r}=e.getState();if(r.connected){var n;Object.entries(null!=(n=r.handlers)?n:[]).forEach(([e,t])=>{if(r&&r.connected instanceof HTMLElement){let[n]=B[e];r.connected.removeEventListener(n,t)}}),t(e=>({events:{...e.events,connected:void 0}}))}}}}let M=o.forwardRef(function({children:e,fallback:t,resize:r,style:n,gl:i,events:l=I,eventSource:u,eventPrefix:d,shadows:f,linear:p,flat:m,legacy:A,orthographic:g,frameloop:v,dpr:_,performance:B,raycaster:M,camera:S,scene:T,onPointerMissed:P,onCreated:D,...R},F){o.useMemo(()=>(0,a.e)(s),[]);let z=function(){let e=function(){let e=function(){let e=o.useContext(C);if(null===e)throw Error("its-fine: useFiber must be called within a <FiberProvider />!");let t=o.useId();return o.useMemo(()=>{for(let r of[e,null==e?void 0:e.alternate]){if(!r)continue;let e=function e(t,r,n){if(!t)return;if(!0===n(t))return t;let i=r?t.return:t.child;for(;i;){let t=e(i,r,n);if(t)return t;i=r?null:i.sibling}}(r,!1,e=>{let r=e.memoizedState;for(;r;){if(r.memoizedState===t)return!0;r=r.next}});if(e)return e}},[e,t])}(),[t]=o.useState(()=>new Map);t.clear();let r=e;for(;r;){if(r.type&&"object"==typeof r.type){let e=void 0===r.type._context&&r.type.Provider===r.type?r.type:r.type._context;e&&e!==C&&!t.has(e)&&t.set(e,o.useContext(E(e)))}r=r.return}return t}();return o.useMemo(()=>Array.from(e.keys()).reduce((t,r)=>n=>o.createElement(t,null,o.createElement(r.Provider,x(y({},n),{value:e.get(r)}))),e=>o.createElement(b,y({},e))),[e])}(),[O,Q]=function(e){var t;let{debounce:r,scroll:n,polyfill:i,offsetSize:a}=void 0===e?{debounce:0,scroll:!1,offsetSize:!1}:e,s=i||("undefined"==typeof window?class{}:window.ResizeObserver);if(!s)throw Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");let[l,u]=(0,o.useState)({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),d=(0,o.useRef)({element:null,scrollContainers:null,resizeObserver:null,lastBounds:l}),f=r?"number"==typeof r?r:r.scroll:null,p=r?"number"==typeof r?r:r.resize:null,m=(0,o.useRef)(!1);(0,o.useEffect)(()=>(m.current=!0,()=>void(m.current=!1)));let[A,g,v]=(0,o.useMemo)(()=>{let e=()=>{if(!d.current.element)return;let{left:e,top:t,width:r,height:n,bottom:i,right:o,x:s,y:l}=d.current.element.getBoundingClientRect(),c={left:e,top:t,width:r,height:n,bottom:i,right:o,x:s,y:l};d.current.element instanceof HTMLElement&&a&&(c.height=d.current.element.offsetHeight,c.width=d.current.element.offsetWidth),Object.freeze(c),m.current&&!h(d.current.lastBounds,c)&&u(d.current.lastBounds=c)};return[e,p?c()(e,p):e,f?c()(e,f):e]},[u,a,f,p]);function y(){d.current.scrollContainers&&(d.current.scrollContainers.forEach(e=>e.removeEventListener("scroll",v,!0)),d.current.scrollContainers=null),d.current.resizeObserver&&(d.current.resizeObserver.disconnect(),d.current.resizeObserver=null)}function x(){d.current.element&&(d.current.resizeObserver=new s(v),d.current.resizeObserver.observe(d.current.element),n&&d.current.scrollContainers&&d.current.scrollContainers.forEach(e=>e.addEventListener("scroll",v,{capture:!0,passive:!0})))}return t=!!n,(0,o.useEffect)(()=>{if(t)return window.addEventListener("scroll",v,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",v,!0)},[v,t]),(0,o.useEffect)(()=>(window.addEventListener("resize",g),()=>void window.removeEventListener("resize",g)),[g]),(0,o.useEffect)(()=>{y(),x()},[n,v,g]),(0,o.useEffect)(()=>y,[]),[e=>{e&&e!==d.current.element&&(y(),d.current.element=e,d.current.scrollContainers=function e(t){let r=[];if(!t||t===document.body)return r;let{overflow:n,overflowX:i,overflowY:a}=window.getComputedStyle(t);return[n,i,a].some(e=>"auto"===e||"scroll"===e)&&r.push(t),[...r,...e(t.parentElement)]}(e),x())},l,A]}({scroll:!0,debounce:{scroll:50,resize:0},...r}),L=o.useRef(null),k=o.useRef(null);o.useImperativeHandle(F,()=>L.current);let U=(0,a.u)(P),[N,G]=o.useState(!1),[H,V]=o.useState(!1);if(N)throw N;if(H)throw H;let j=o.useRef(null);(0,a.a)(()=>{let t=L.current;Q.width>0&&Q.height>0&&t&&(j.current||(j.current=(0,a.b)(t)),j.current.configure({gl:i,events:l,shadows:f,linear:p,flat:m,legacy:A,orthographic:g,frameloop:v,dpr:_,performance:B,raycaster:M,camera:S,scene:T,size:Q,onPointerMissed:(...e)=>null==U.current?void 0:U.current(...e),onCreated:e=>{null==e.events.connect||e.events.connect(u?(0,a.i)(u)?u.current:u:k.current),d&&e.setEvents({compute:(e,t)=>{let r=e[d+"X"],n=e[d+"Y"];t.pointer.set(r/t.size.width*2-1,-(n/t.size.height*2)+1),t.raycaster.setFromCamera(t.pointer,t.camera)}}),null==D||D(e)}}),j.current.render((0,w.jsx)(z,{children:(0,w.jsx)(a.E,{set:V,children:(0,w.jsx)(o.Suspense,{fallback:(0,w.jsx)(a.B,{set:G}),children:e})})})))}),o.useEffect(()=>{let e=L.current;if(e)return()=>(0,a.d)(e)},[]);let Y=u?"none":"auto";return(0,w.jsx)("div",{ref:k,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:Y,...n},...R,children:(0,w.jsx)("div",{ref:O,style:{width:"100%",height:"100%"},children:(0,w.jsx)("canvas",{ref:L,style:{display:"block"},children:t})})})}),S=o.forwardRef(function(e,t){return(0,w.jsx)(b,{children:(0,w.jsx)(M,{...e,ref:t})})})},9540:function(e,t){"use strict";/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function r(e,t){var r=e.length;for(e.push(t);0<r;){var n=r-1>>>1,i=e[n];if(0<a(i,t))e[n]=t,e[r]=i,r=n;else break}}function n(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;for(var n=0,i=e.length,o=i>>>1;n<o;){var s=2*(n+1)-1,l=e[s],c=s+1,u=e[c];if(0>a(l,r))c<i&&0>a(u,l)?(e[n]=u,e[c]=r,n=c):(e[n]=l,e[s]=r,n=s);else if(c<i&&0>a(u,r))e[n]=u,e[c]=r,n=c;else break}}return t}function a(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var o,s=performance;t.unstable_now=function(){return s.now()}}else{var l=Date,c=l.now();t.unstable_now=function(){return l.now()-c}}var u=[],h=[],d=1,f=null,p=3,m=!1,A=!1,g=!1,v="function"==typeof setTimeout?setTimeout:null,y="function"==typeof clearTimeout?clearTimeout:null,x="undefined"!=typeof setImmediate?setImmediate:null;function E(e){for(var t=n(h);null!==t;){if(null===t.callback)i(h);else if(t.startTime<=e)i(h),t.sortIndex=t.expirationTime,r(u,t);else break;t=n(h)}}function _(e){if(g=!1,E(e),!A){if(null!==n(u))A=!0,R(C);else{var t=n(h);null!==t&&F(_,t.startTime-e)}}}function C(e,r){A=!1,g&&(g=!1,y(B),B=-1),m=!0;var a=p;try{for(E(r),f=n(u);null!==f&&(!(f.expirationTime>r)||e&&!S());){var o=f.callback;if("function"==typeof o){f.callback=null,p=f.priorityLevel;var s=o(f.expirationTime<=r);r=t.unstable_now(),"function"==typeof s?f.callback=s:f===n(u)&&i(u),E(r)}else i(u);f=n(u)}if(null!==f)var l=!0;else{var c=n(h);null!==c&&F(_,c.startTime-r),l=!1}return l}finally{f=null,p=a,m=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var b=!1,w=null,B=-1,I=5,M=-1;function S(){return!(t.unstable_now()-M<I)}function T(){if(null!==w){var e=t.unstable_now();M=e;var r=!0;try{r=w(!0,e)}finally{r?o():(b=!1,w=null)}}else b=!1}if("function"==typeof x)o=function(){x(T)};else if("undefined"!=typeof MessageChannel){var P=new MessageChannel,D=P.port2;P.port1.onmessage=T,o=function(){D.postMessage(null)}}else o=function(){v(T,0)};function R(e){w=e,b||(b=!0,o())}function F(e,r){B=v(function(){e(t.unstable_now())},r)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){A||m||(A=!0,R(C))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var r=p;p=t;try{return e()}finally{p=r}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=p;p=e;try{return t()}finally{p=r}},t.unstable_scheduleCallback=function(e,i,a){var o=t.unstable_now();switch(a="object"==typeof a&&null!==a&&"number"==typeof(a=a.delay)&&0<a?o+a:o,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return s=a+s,e={id:d++,callback:i,priorityLevel:e,startTime:a,expirationTime:s,sortIndex:-1},a>o?(e.sortIndex=a,r(h,e),null===n(u)&&e===n(h)&&(g?(y(B),B=-1):g=!0,F(_,a-o))):(e.sortIndex=s,r(u,e),A||m||(A=!0,R(C))),e},t.unstable_shouldYield=S,t.unstable_wrapCallback=function(e){var t=p;return function(){var r=p;p=t;try{return e.apply(this,arguments)}finally{p=r}}}},8276:function(e,t,r){"use strict";e.exports=r(9540)},8738:function(e,t){"use strict";t.byteLength=function(e){var t=l(e),r=t[0],n=t[1];return(r+n)*3/4-n},t.toByteArray=function(e){var t,r,a=l(e),o=a[0],s=a[1],c=new i((o+s)*3/4-s),u=0,h=s>0?o-4:o;for(r=0;r<h;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],c[u++]=t>>16&255,c[u++]=t>>8&255,c[u++]=255&t;return 2===s&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,c[u++]=255&t),1===s&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,c[u++]=t>>8&255,c[u++]=255&t),c},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,a=[],o=0,s=n-i;o<s;o+=16383)a.push(function(e,t,n){for(var i,a=[],o=t;o<n;o+=3)a.push(r[(i=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]))>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return a.join("")}(e,o,o+16383>s?s:o+16383));return 1===i?a.push(r[(t=e[n-1])>>2]+r[t<<4&63]+"=="):2===i&&a.push(r[(t=(e[n-2]<<8)+e[n-1])>>10]+r[t>>4&63]+r[t<<2&63]+"="),a.join("")};for(var r=[],n=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,s=a.length;o<s;++o)r[o]=a[o],n[a.charCodeAt(o)]=o;function l(e){var t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");-1===r&&(r=t);var n=r===t?0:4-r%4;return[r,n]}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},9109:function(e,t,r){"use strict";/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */let n=r(8738),i=r(6868),a="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function o(e){if(e>2147483647)throw RangeError('The value "'+e+'" is invalid for option "size"');let t=new Uint8Array(e);return Object.setPrototypeOf(t,s.prototype),t}function s(e,t,r){if("number"==typeof e){if("string"==typeof t)throw TypeError('The "string" argument must be of type string. Received type number');return u(e)}return l(e,t,r)}function l(e,t,r){if("string"==typeof e)return function(e,t){if(("string"!=typeof t||""===t)&&(t="utf8"),!s.isEncoding(t))throw TypeError("Unknown encoding: "+t);let r=0|p(e,t),n=o(r),i=n.write(e,t);return i!==r&&(n=n.slice(0,i)),n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(Q(e,Uint8Array)){let t=new Uint8Array(e);return d(t.buffer,t.byteOffset,t.byteLength)}return h(e)}(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(Q(e,ArrayBuffer)||e&&Q(e.buffer,ArrayBuffer)||"undefined"!=typeof SharedArrayBuffer&&(Q(e,SharedArrayBuffer)||e&&Q(e.buffer,SharedArrayBuffer)))return d(e,t,r);if("number"==typeof e)throw TypeError('The "value" argument must not be of type number. Received type number');let n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return s.from(n,t,r);let i=function(e){var t;if(s.isBuffer(e)){let t=0|f(e.length),r=o(t);return 0===r.length||e.copy(r,0,0,t),r}return void 0!==e.length?"number"!=typeof e.length||(t=e.length)!=t?o(0):h(e):"Buffer"===e.type&&Array.isArray(e.data)?h(e.data):void 0}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return s.from(e[Symbol.toPrimitive]("string"),t,r);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function c(e){if("number"!=typeof e)throw TypeError('"size" argument must be of type number');if(e<0)throw RangeError('The value "'+e+'" is invalid for option "size"')}function u(e){return c(e),o(e<0?0:0|f(e))}function h(e){let t=e.length<0?0:0|f(e.length),r=o(t);for(let n=0;n<t;n+=1)r[n]=255&e[n];return r}function d(e,t,r){let n;if(t<0||e.byteLength<t)throw RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),s.prototype),n}function f(e){if(e>=2147483647)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|e}function p(e,t){if(s.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||Q(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);let r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return F(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return z(e).length;default:if(i)return n?-1:F(e).length;t=(""+t).toLowerCase(),i=!0}}function m(e,t,r){let i=!1;if((void 0===t||t<0)&&(t=0),t>this.length||((void 0===r||r>this.length)&&(r=this.length),r<=0||(r>>>=0)<=(t>>>=0)))return"";for(e||(e="utf8");;)switch(e){case"hex":return function(e,t,r){let n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);let i="";for(let n=t;n<r;++n)i+=L[e[n]];return i}(this,t,r);case"utf8":case"utf-8":return y(this,t,r);case"ascii":return function(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}(this,t,r);case"latin1":case"binary":return function(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}(this,t,r);case"base64":var a,o;return a=t,o=r,0===a&&o===this.length?n.fromByteArray(this):n.fromByteArray(this.slice(a,o));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(e,t,r){let n=e.slice(t,r),i="";for(let e=0;e<n.length-1;e+=2)i+=String.fromCharCode(n[e]+256*n[e+1]);return i}(this,t,r);default:if(i)throw TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function A(e,t,r){let n=e[t];e[t]=e[r],e[r]=n}function g(e,t,r,n,i){var a;if(0===e.length)return -1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),(a=r=+r)!=a&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return -1;r=e.length-1}else if(r<0){if(!i)return -1;r=0}if("string"==typeof t&&(t=s.from(t,n)),s.isBuffer(t))return 0===t.length?-1:v(e,t,r,n,i);if("number"==typeof t)return(t&=255,"function"==typeof Uint8Array.prototype.indexOf)?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):v(e,[t],r,n,i);throw TypeError("val must be string, number or Buffer")}function v(e,t,r,n,i){let a,o=1,s=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return -1;o=2,s/=2,l/=2,r/=2}function c(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(i){let n=-1;for(a=r;a<s;a++)if(c(e,a)===c(t,-1===n?0:a-n)){if(-1===n&&(n=a),a-n+1===l)return n*o}else -1!==n&&(a-=a-n),n=-1}else for(r+l>s&&(r=s-l),a=r;a>=0;a--){let r=!0;for(let n=0;n<l;n++)if(c(e,a+n)!==c(t,n)){r=!1;break}if(r)return a}return -1}function y(e,t,r){r=Math.min(e.length,r);let n=[],i=t;for(;i<r;){let t=e[i],a=null,o=t>239?4:t>223?3:t>191?2:1;if(i+o<=r){let r,n,s,l;switch(o){case 1:t<128&&(a=t);break;case 2:(192&(r=e[i+1]))==128&&(l=(31&t)<<6|63&r)>127&&(a=l);break;case 3:r=e[i+1],n=e[i+2],(192&r)==128&&(192&n)==128&&(l=(15&t)<<12|(63&r)<<6|63&n)>2047&&(l<55296||l>57343)&&(a=l);break;case 4:r=e[i+1],n=e[i+2],s=e[i+3],(192&r)==128&&(192&n)==128&&(192&s)==128&&(l=(15&t)<<18|(63&r)<<12|(63&n)<<6|63&s)>65535&&l<1114112&&(a=l)}}null===a?(a=65533,o=1):a>65535&&(a-=65536,n.push(a>>>10&1023|55296),a=56320|1023&a),n.push(a),i+=o}return function(e){let t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=4096));return r}(n)}function x(e,t,r){if(e%1!=0||e<0)throw RangeError("offset is not uint");if(e+t>r)throw RangeError("Trying to access beyond buffer length")}function E(e,t,r,n,i,a){if(!s.isBuffer(e))throw TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<a)throw RangeError('"value" argument is out of bounds');if(r+n>e.length)throw RangeError("Index out of range")}function _(e,t,r,n,i){T(t,n,i,e,r,7);let a=Number(t&BigInt(4294967295));e[r++]=a,a>>=8,e[r++]=a,a>>=8,e[r++]=a,a>>=8,e[r++]=a;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,r}function C(e,t,r,n,i){T(t,n,i,e,r,7);let a=Number(t&BigInt(4294967295));e[r+7]=a,a>>=8,e[r+6]=a,a>>=8,e[r+5]=a,a>>=8,e[r+4]=a;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=o,o>>=8,e[r+2]=o,o>>=8,e[r+1]=o,o>>=8,e[r]=o,r+8}function b(e,t,r,n,i,a){if(r+n>e.length||r<0)throw RangeError("Index out of range")}function w(e,t,r,n,a){return t=+t,r>>>=0,a||b(e,t,r,4,34028234663852886e22,-34028234663852886e22),i.write(e,t,r,n,23,4),r+4}function B(e,t,r,n,a){return t=+t,r>>>=0,a||b(e,t,r,8,17976931348623157e292,-17976931348623157e292),i.write(e,t,r,n,52,8),r+8}t.lW=s,t.h2=50,s.TYPED_ARRAY_SUPPORT=function(){try{let e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),s.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}}),s.poolSize=8192,s.from=function(e,t,r){return l(e,t,r)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array),s.alloc=function(e,t,r){return(c(e),e<=0)?o(e):void 0!==t?"string"==typeof r?o(e).fill(t,r):o(e).fill(t):o(e)},s.allocUnsafe=function(e){return u(e)},s.allocUnsafeSlow=function(e){return u(e)},s.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==s.prototype},s.compare=function(e,t){if(Q(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),Q(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),!s.isBuffer(e)||!s.isBuffer(t))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let r=e.length,n=t.length;for(let i=0,a=Math.min(r,n);i<a;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},s.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(e,t){let r;if(!Array.isArray(e))throw TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return s.alloc(0);if(void 0===t)for(r=0,t=0;r<e.length;++r)t+=e[r].length;let n=s.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){let t=e[r];if(Q(t,Uint8Array))i+t.length>n.length?(s.isBuffer(t)||(t=s.from(t)),t.copy(n,i)):Uint8Array.prototype.set.call(n,t,i);else if(s.isBuffer(t))t.copy(n,i);else throw TypeError('"list" argument must be an Array of Buffers');i+=t.length}return n},s.byteLength=p,s.prototype._isBuffer=!0,s.prototype.swap16=function(){let e=this.length;if(e%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)A(this,t,t+1);return this},s.prototype.swap32=function(){let e=this.length;if(e%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)A(this,t,t+3),A(this,t+1,t+2);return this},s.prototype.swap64=function(){let e=this.length;if(e%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)A(this,t,t+7),A(this,t+1,t+6),A(this,t+2,t+5),A(this,t+3,t+4);return this},s.prototype.toString=function(){let e=this.length;return 0===e?"":0==arguments.length?y(this,0,e):m.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(e){if(!s.isBuffer(e))throw TypeError("Argument must be a Buffer");return this===e||0===s.compare(this,e)},s.prototype.inspect=function(){let e="",r=t.h2;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},a&&(s.prototype[a]=s.prototype.inspect),s.prototype.compare=function(e,t,r,n,i){if(Q(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),!s.isBuffer(e))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return -1;if(t>=r)return 1;if(t>>>=0,r>>>=0,n>>>=0,i>>>=0,this===e)return 0;let a=i-n,o=r-t,l=Math.min(a,o),c=this.slice(n,i),u=e.slice(t,r);for(let e=0;e<l;++e)if(c[e]!==u[e]){a=c[e],o=u[e];break}return a<o?-1:o<a?1:0},s.prototype.includes=function(e,t,r){return -1!==this.indexOf(e,t,r)},s.prototype.indexOf=function(e,t,r){return g(this,e,t,r,!0)},s.prototype.lastIndexOf=function(e,t,r){return g(this,e,t,r,!1)},s.prototype.write=function(e,t,r,n){var i,a,o,s,l,c,u,h;if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else if(isFinite(t))t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let d=this.length-t;if((void 0===r||r>d)&&(r=d),e.length>0&&(r<0||t<0)||t>this.length)throw RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let f=!1;for(;;)switch(n){case"hex":return function(e,t,r,n){let i;r=Number(r)||0;let a=e.length-r;n?(n=Number(n))>a&&(n=a):n=a;let o=t.length;for(n>o/2&&(n=o/2),i=0;i<n;++i){let n=parseInt(t.substr(2*i,2),16);if(n!=n)break;e[r+i]=n}return i}(this,e,t,r);case"utf8":case"utf-8":return i=t,a=r,O(F(e,this.length-i),this,i,a);case"ascii":case"latin1":case"binary":return o=t,s=r,O(function(e){let t=[];for(let r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(e),this,o,s);case"base64":return l=t,c=r,O(z(e),this,l,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return u=t,h=r,O(function(e,t){let r,n;let i=[];for(let a=0;a<e.length&&!((t-=2)<0);++a)n=(r=e.charCodeAt(a))>>8,i.push(r%256),i.push(n);return i}(e,this.length-u),this,u,h);default:if(f)throw TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),f=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},s.prototype.slice=function(e,t){let r=this.length;e=~~e,t=void 0===t?r:~~t,e<0?(e+=r)<0&&(e=0):e>r&&(e=r),t<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);let n=this.subarray(e,t);return Object.setPrototypeOf(n,s.prototype),n},s.prototype.readUintLE=s.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||x(e,t,this.length);let n=this[e],i=1,a=0;for(;++a<t&&(i*=256);)n+=this[e+a]*i;return n},s.prototype.readUintBE=s.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||x(e,t,this.length);let n=this[e+--t],i=1;for(;t>0&&(i*=256);)n+=this[e+--t]*i;return n},s.prototype.readUint8=s.prototype.readUInt8=function(e,t){return e>>>=0,t||x(e,1,this.length),this[e]},s.prototype.readUint16LE=s.prototype.readUInt16LE=function(e,t){return e>>>=0,t||x(e,2,this.length),this[e]|this[e+1]<<8},s.prototype.readUint16BE=s.prototype.readUInt16BE=function(e,t){return e>>>=0,t||x(e,2,this.length),this[e]<<8|this[e+1]},s.prototype.readUint32LE=s.prototype.readUInt32LE=function(e,t){return e>>>=0,t||x(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},s.prototype.readUint32BE=s.prototype.readUInt32BE=function(e,t){return e>>>=0,t||x(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},s.prototype.readBigUInt64LE=k(function(e){P(e>>>=0,"offset");let t=this[e],r=this[e+7];(void 0===t||void 0===r)&&D(e,this.length-8);let n=t+256*this[++e]+65536*this[++e]+16777216*this[++e],i=this[++e]+256*this[++e]+65536*this[++e]+16777216*r;return BigInt(n)+(BigInt(i)<<BigInt(32))}),s.prototype.readBigUInt64BE=k(function(e){P(e>>>=0,"offset");let t=this[e],r=this[e+7];(void 0===t||void 0===r)&&D(e,this.length-8);let n=16777216*t+65536*this[++e]+256*this[++e]+this[++e],i=16777216*this[++e]+65536*this[++e]+256*this[++e]+r;return(BigInt(n)<<BigInt(32))+BigInt(i)}),s.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||x(e,t,this.length);let n=this[e],i=1,a=0;for(;++a<t&&(i*=256);)n+=this[e+a]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},s.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||x(e,t,this.length);let n=t,i=1,a=this[e+--n];for(;n>0&&(i*=256);)a+=this[e+--n]*i;return a>=(i*=128)&&(a-=Math.pow(2,8*t)),a},s.prototype.readInt8=function(e,t){return(e>>>=0,t||x(e,1,this.length),128&this[e])?-((255-this[e]+1)*1):this[e]},s.prototype.readInt16LE=function(e,t){e>>>=0,t||x(e,2,this.length);let r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},s.prototype.readInt16BE=function(e,t){e>>>=0,t||x(e,2,this.length);let r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},s.prototype.readInt32LE=function(e,t){return e>>>=0,t||x(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},s.prototype.readInt32BE=function(e,t){return e>>>=0,t||x(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},s.prototype.readBigInt64LE=k(function(e){P(e>>>=0,"offset");let t=this[e],r=this[e+7];return(void 0===t||void 0===r)&&D(e,this.length-8),(BigInt(this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24))<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+16777216*this[++e])}),s.prototype.readBigInt64BE=k(function(e){P(e>>>=0,"offset");let t=this[e],r=this[e+7];return(void 0===t||void 0===r)&&D(e,this.length-8),(BigInt((t<<24)+65536*this[++e]+256*this[++e]+this[++e])<<BigInt(32))+BigInt(16777216*this[++e]+65536*this[++e]+256*this[++e]+r)}),s.prototype.readFloatLE=function(e,t){return e>>>=0,t||x(e,4,this.length),i.read(this,e,!0,23,4)},s.prototype.readFloatBE=function(e,t){return e>>>=0,t||x(e,4,this.length),i.read(this,e,!1,23,4)},s.prototype.readDoubleLE=function(e,t){return e>>>=0,t||x(e,8,this.length),i.read(this,e,!0,52,8)},s.prototype.readDoubleBE=function(e,t){return e>>>=0,t||x(e,8,this.length),i.read(this,e,!1,52,8)},s.prototype.writeUintLE=s.prototype.writeUIntLE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){let n=Math.pow(2,8*r)-1;E(this,e,t,r,n,0)}let i=1,a=0;for(this[t]=255&e;++a<r&&(i*=256);)this[t+a]=e/i&255;return t+r},s.prototype.writeUintBE=s.prototype.writeUIntBE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){let n=Math.pow(2,8*r)-1;E(this,e,t,r,n,0)}let i=r-1,a=1;for(this[t+i]=255&e;--i>=0&&(a*=256);)this[t+i]=e/a&255;return t+r},s.prototype.writeUint8=s.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||E(this,e,t,1,255,0),this[t]=255&e,t+1},s.prototype.writeUint16LE=s.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||E(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},s.prototype.writeUint16BE=s.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||E(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},s.prototype.writeUint32LE=s.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||E(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},s.prototype.writeUint32BE=s.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||E(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},s.prototype.writeBigUInt64LE=k(function(e,t=0){return _(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),s.prototype.writeBigUInt64BE=k(function(e,t=0){return C(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),s.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){let n=Math.pow(2,8*r-1);E(this,e,t,r,n-1,-n)}let i=0,a=1,o=0;for(this[t]=255&e;++i<r&&(a*=256);)e<0&&0===o&&0!==this[t+i-1]&&(o=1),this[t+i]=(e/a>>0)-o&255;return t+r},s.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){let n=Math.pow(2,8*r-1);E(this,e,t,r,n-1,-n)}let i=r-1,a=1,o=0;for(this[t+i]=255&e;--i>=0&&(a*=256);)e<0&&0===o&&0!==this[t+i+1]&&(o=1),this[t+i]=(e/a>>0)-o&255;return t+r},s.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||E(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},s.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||E(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},s.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||E(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},s.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||E(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},s.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||E(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},s.prototype.writeBigInt64LE=k(function(e,t=0){return _(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),s.prototype.writeBigInt64BE=k(function(e,t=0){return C(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),s.prototype.writeFloatLE=function(e,t,r){return w(this,e,t,!0,r)},s.prototype.writeFloatBE=function(e,t,r){return w(this,e,t,!1,r)},s.prototype.writeDoubleLE=function(e,t,r){return B(this,e,t,!0,r)},s.prototype.writeDoubleBE=function(e,t,r){return B(this,e,t,!1,r)},s.prototype.copy=function(e,t,r,n){if(!s.isBuffer(e))throw TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r||0===e.length||0===this.length)return 0;if(t<0)throw RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw RangeError("Index out of range");if(n<0)throw RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);let i=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),i},s.prototype.fill=function(e,t,r,n){let i;if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw TypeError("encoding must be a string");if("string"==typeof n&&!s.isEncoding(n))throw TypeError("Unknown encoding: "+n);if(1===e.length){let t=e.charCodeAt(0);("utf8"===n&&t<128||"latin1"===n)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw RangeError("Out of range index");if(r<=t)return this;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{let a=s.isBuffer(e)?e:s.from(e,n),o=a.length;if(0===o)throw TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<r-t;++i)this[i+t]=a[i%o]}return this};let I={};function M(e,t,r){I[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function S(e){let t="",r=e.length,n="-"===e[0]?1:0;for(;r>=n+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function T(e,t,r,n,i,a){if(e>r||e<t){let n;let i="bigint"==typeof t?"n":"";throw n=a>3?0===t||t===BigInt(0)?`>= 0${i} and < 2${i} ** ${(a+1)*8}${i}`:`>= -(2${i} ** ${(a+1)*8-1}${i}) and < 2 ** ${(a+1)*8-1}${i}`:`>= ${t}${i} and <= ${r}${i}`,new I.ERR_OUT_OF_RANGE("value",n,e)}P(i,"offset"),(void 0===n[i]||void 0===n[i+a])&&D(i,n.length-(a+1))}function P(e,t){if("number"!=typeof e)throw new I.ERR_INVALID_ARG_TYPE(t,"number",e)}function D(e,t,r){if(Math.floor(e)!==e)throw P(e,r),new I.ERR_OUT_OF_RANGE(r||"offset","an integer",e);if(t<0)throw new I.ERR_BUFFER_OUT_OF_BOUNDS;throw new I.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${t}`,e)}M("ERR_BUFFER_OUT_OF_BOUNDS",function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),M("ERR_INVALID_ARG_TYPE",function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`},TypeError),M("ERR_OUT_OF_RANGE",function(e,t,r){let n=`The value of "${e}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>4294967296?i=S(String(r)):"bigint"==typeof r&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=S(i)),i+="n"),n+=` It must be ${t}. Received ${i}`},RangeError);let R=/[^+/0-9A-Za-z-_]/g;function F(e,t){let r;t=t||1/0;let n=e.length,i=null,a=[];for(let o=0;o<n;++o){if((r=e.charCodeAt(o))>55295&&r<57344){if(!i){if(r>56319||o+1===n){(t-=3)>-1&&a.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&a.push(239,191,189),i=r;continue}r=(i-55296<<10|r-56320)+65536}else i&&(t-=3)>-1&&a.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;a.push(r)}else if(r<2048){if((t-=2)<0)break;a.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;a.push(r>>12|224,r>>6&63|128,63&r|128)}else if(r<1114112){if((t-=4)<0)break;a.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}else throw Error("Invalid code point")}return a}function z(e){return n.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(R,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function O(e,t,r,n){let i;for(i=0;i<n&&!(i+r>=t.length)&&!(i>=e.length);++i)t[i+r]=e[i];return i}function Q(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}let L=function(){let e="0123456789abcdef",t=Array(256);for(let r=0;r<16;++r){let n=16*r;for(let i=0;i<16;++i)t[n+i]=e[r]+e[i]}return t}();function k(e){return"undefined"==typeof BigInt?U:e}function U(){throw Error("BigInt not supported")}},4692:function(e){function t(e,t,r){function n(){var c=Date.now()-s;c<t&&c>=0?i=setTimeout(n,t-c):(i=null,r||(l=e.apply(o,a),o=a=null))}null==t&&(t=100);var i,a,o,s,l,c=function(){o=this,a=arguments,s=Date.now();var c=r&&!i;return i||(i=setTimeout(n,t)),c&&(l=e.apply(o,a),o=a=null),l};return c.clear=function(){i&&(clearTimeout(i),i=null)},c.flush=function(){i&&(l=e.apply(o,a),o=a=null,clearTimeout(i),i=null)},c}t.debounce=t,e.exports=t},6868:function(e,t){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */t.read=function(e,t,r,n,i){var a,o,s=8*i-n-1,l=(1<<s)-1,c=l>>1,u=-7,h=r?i-1:0,d=r?-1:1,f=e[t+h];for(h+=d,a=f&(1<<-u)-1,f>>=-u,u+=s;u>0;a=256*a+e[t+h],h+=d,u-=8);for(o=a&(1<<-u)-1,a>>=-u,u+=n;u>0;o=256*o+e[t+h],h+=d,u-=8);if(0===a)a=1-c;else{if(a===l)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,n),a-=c}return(f?-1:1)*o*Math.pow(2,a-n)},t.write=function(e,t,r,n,i,a){var o,s,l,c=8*a-i-1,u=(1<<c)-1,h=u>>1,d=23===i?5960464477539062e-23:0,f=n?0:a-1,p=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(isNaN(t=Math.abs(t))||t===1/0?(s=isNaN(t)?1:0,o=u):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),o+h>=1?t+=d/l:t+=d*Math.pow(2,1-h),t*l>=2&&(o++,l/=2),o+h>=u?(s=0,o=u):o+h>=1?(s=(t*l-1)*Math.pow(2,i),o+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,i),o=0));i>=8;e[r+f]=255&s,f+=p,s/=256,i-=8);for(o=o<<i|s,c+=i;c>0;e[r+f]=255&o,f+=p,o/=256,c-=8);e[r+f-p]|=128*m}},6648:function(e,t,r){"use strict";r.d(t,{default:function(){return i.a}});var n=r(5601),i=r.n(n)},7138:function(e,t,r){"use strict";r.d(t,{default:function(){return i.a}});var n=r(231),i=r.n(n)},357:function(e,t,r){"use strict";var n,i;e.exports=(null==(n=r.g.process)?void 0:n.env)&&"object"==typeof(null==(i=r.g.process)?void 0:i.env)?r.g.process:r(8081)},844:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"addLocale",{enumerable:!0,get:function(){return n}}),r(8157);let n=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e};("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},5944:function(e,t,r){"use strict";function n(e,t,r,n){return!1}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getDomainLocale",{enumerable:!0,get:function(){return n}}),r(8157),("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},8173:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Image",{enumerable:!0,get:function(){return y}});let n=r(9920),i=r(1452),a=r(7437),o=i._(r(2265)),s=n._(r(4887)),l=n._(r(8321)),c=r(497),u=r(7103),h=r(3938);r(2301);let d=r(291),f=n._(r(1241)),p={deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1};function m(e,t,r,n,i,a,o){let s=null==e?void 0:e.src;e&&e["data-loaded-src"]!==s&&(e["data-loaded-src"]=s,("decode"in e?e.decode():Promise.resolve()).catch(()=>{}).then(()=>{if(e.parentElement&&e.isConnected){if("empty"!==t&&i(!0),null==r?void 0:r.current){let t=new Event("load");Object.defineProperty(t,"target",{writable:!1,value:e});let n=!1,i=!1;r.current({...t,nativeEvent:t,currentTarget:e,target:e,isDefaultPrevented:()=>n,isPropagationStopped:()=>i,persist:()=>{},preventDefault:()=>{n=!0,t.preventDefault()},stopPropagation:()=>{i=!0,t.stopPropagation()}})}(null==n?void 0:n.current)&&n.current(e)}}))}function A(e){return o.use?{fetchPriority:e}:{fetchpriority:e}}"undefined"==typeof window&&(globalThis.__NEXT_IMAGE_IMPORTED=!0);let g=(0,o.forwardRef)((e,t)=>{let{src:r,srcSet:n,sizes:i,height:s,width:l,decoding:c,className:u,style:h,fetchPriority:d,placeholder:f,loading:p,unoptimized:g,fill:v,onLoadRef:y,onLoadingCompleteRef:x,setBlurComplete:E,setShowAltText:_,sizesInput:C,onLoad:b,onError:w,...B}=e;return(0,a.jsx)("img",{...B,...A(d),loading:p,width:l,height:s,decoding:c,"data-nimg":v?"fill":"1",className:u,style:h,sizes:i,srcSet:n,src:r,ref:(0,o.useCallback)(e=>{t&&("function"==typeof t?t(e):"object"==typeof t&&(t.current=e)),e&&(w&&(e.src=e.src),e.complete&&m(e,f,y,x,E,g,C))},[r,f,y,x,E,w,g,C,t]),onLoad:e=>{m(e.currentTarget,f,y,x,E,g,C)},onError:e=>{_(!0),"empty"!==f&&E(!0),w&&w(e)}})});function v(e){let{isAppRouter:t,imgAttributes:r}=e,n={as:"image",imageSrcSet:r.srcSet,imageSizes:r.sizes,crossOrigin:r.crossOrigin,referrerPolicy:r.referrerPolicy,...A(r.fetchPriority)};return t&&s.default.preload?(s.default.preload(r.src,n),null):(0,a.jsx)(l.default,{children:(0,a.jsx)("link",{rel:"preload",href:r.srcSet?void 0:r.src,...n},"__nimg-"+r.src+r.srcSet+r.sizes)})}let y=(0,o.forwardRef)((e,t)=>{let r=(0,o.useContext)(d.RouterContext),n=(0,o.useContext)(h.ImageConfigContext),i=(0,o.useMemo)(()=>{let e=p||n||u.imageConfigDefault,t=[...e.deviceSizes,...e.imageSizes].sort((e,t)=>e-t),r=e.deviceSizes.sort((e,t)=>e-t);return{...e,allSizes:t,deviceSizes:r}},[n]),{onLoad:s,onLoadingComplete:l}=e,m=(0,o.useRef)(s);(0,o.useEffect)(()=>{m.current=s},[s]);let A=(0,o.useRef)(l);(0,o.useEffect)(()=>{A.current=l},[l]);let[y,x]=(0,o.useState)(!1),[E,_]=(0,o.useState)(!1),{props:C,meta:b}=(0,c.getImgProps)(e,{defaultLoader:f.default,imgConf:i,blurComplete:y,showAltText:E});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g,{...C,unoptimized:b.unoptimized,placeholder:b.placeholder,fill:b.fill,onLoadRef:m,onLoadingCompleteRef:A,setBlurComplete:x,setShowAltText:_,sizesInput:e.sizes,ref:t}),b.priority?(0,a.jsx)(v,{isAppRouter:!r,imgAttributes:C}):null]})});("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},231:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return x}});let n=r(9920),i=r(7437),a=n._(r(2265)),o=r(8016),s=r(8029),l=r(1142),c=r(3461),u=r(844),h=r(291),d=r(4467),f=r(3106),p=r(5944),m=r(4897),A=r(1507),g=new Set;function v(e,t,r,n,i,a){if("undefined"!=typeof window&&(a||(0,s.isLocalURL)(t))){if(!n.bypassPrefetchedCheck){let i=t+"%"+r+"%"+(void 0!==n.locale?n.locale:"locale"in e?e.locale:void 0);if(g.has(i))return;g.add(i)}(async()=>a?e.prefetch(t,i):e.prefetch(t,r,n))().catch(e=>{})}}function y(e){return"string"==typeof e?e:(0,l.formatUrl)(e)}let x=a.default.forwardRef(function(e,t){let r,n;let{href:l,as:g,children:x,prefetch:E=null,passHref:_,replace:C,shallow:b,scroll:w,locale:B,onClick:I,onMouseEnter:M,onTouchStart:S,legacyBehavior:T=!1,...P}=e;r=x,T&&("string"==typeof r||"number"==typeof r)&&(r=(0,i.jsx)("a",{children:r}));let D=a.default.useContext(h.RouterContext),R=a.default.useContext(d.AppRouterContext),F=null!=D?D:R,z=!D,O=!1!==E,Q=null===E?A.PrefetchKind.AUTO:A.PrefetchKind.FULL,{href:L,as:k}=a.default.useMemo(()=>{if(!D){let e=y(l);return{href:e,as:g?y(g):e}}let[e,t]=(0,o.resolveHref)(D,l,!0);return{href:e,as:g?(0,o.resolveHref)(D,g):t||e}},[D,l,g]),U=a.default.useRef(L),N=a.default.useRef(k);T&&(n=a.default.Children.only(r));let G=T?n&&"object"==typeof n&&n.ref:t,[H,V,j]=(0,f.useIntersection)({rootMargin:"200px"}),Y=a.default.useCallback(e=>{(N.current!==k||U.current!==L)&&(j(),N.current=k,U.current=L),H(e),G&&("function"==typeof G?G(e):"object"==typeof G&&(G.current=e))},[k,G,L,j,H]);a.default.useEffect(()=>{F&&V&&O&&v(F,L,k,{locale:B},{kind:Q},z)},[k,L,V,B,O,null==D?void 0:D.locale,F,z,Q]);let J={ref:Y,onClick(e){T||"function"!=typeof I||I(e),T&&n.props&&"function"==typeof n.props.onClick&&n.props.onClick(e),F&&!e.defaultPrevented&&function(e,t,r,n,i,o,l,c,u){let{nodeName:h}=e.currentTarget;if("A"===h.toUpperCase()&&(function(e){let t=e.currentTarget.getAttribute("target");return t&&"_self"!==t||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||e.nativeEvent&&2===e.nativeEvent.which}(e)||!u&&!(0,s.isLocalURL)(r)))return;e.preventDefault();let d=()=>{let e=null==l||l;"beforePopState"in t?t[i?"replace":"push"](r,n,{shallow:o,locale:c,scroll:e}):t[i?"replace":"push"](n||r,{scroll:e})};u?a.default.startTransition(d):d()}(e,F,L,k,C,b,w,B,z)},onMouseEnter(e){T||"function"!=typeof M||M(e),T&&n.props&&"function"==typeof n.props.onMouseEnter&&n.props.onMouseEnter(e),F&&(O||!z)&&v(F,L,k,{locale:B,priority:!0,bypassPrefetchedCheck:!0},{kind:Q},z)},onTouchStart:function(e){T||"function"!=typeof S||S(e),T&&n.props&&"function"==typeof n.props.onTouchStart&&n.props.onTouchStart(e),F&&(O||!z)&&v(F,L,k,{locale:B,priority:!0,bypassPrefetchedCheck:!0},{kind:Q},z)}};if((0,c.isAbsoluteUrl)(k))J.href=k;else if(!T||_||"a"===n.type&&!("href"in n.props)){let e=void 0!==B?B:null==D?void 0:D.locale,t=(null==D?void 0:D.isLocaleDomain)&&(0,p.getDomainLocale)(k,e,null==D?void 0:D.locales,null==D?void 0:D.domainLocales);J.href=t||(0,m.addBasePath)((0,u.addLocale)(k,e,null==D?void 0:D.defaultLocale))}return T?a.default.cloneElement(n,J):(0,i.jsx)("a",{...P,...J,children:r})});("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},9189:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{cancelIdleCallback:function(){return n},requestIdleCallback:function(){return r}});let r="undefined"!=typeof self&&self.requestIdleCallback&&self.requestIdleCallback.bind(window)||function(e){let t=Date.now();return self.setTimeout(function(){e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-t))}})},1)},n="undefined"!=typeof self&&self.cancelIdleCallback&&self.cancelIdleCallback.bind(window)||function(e){return clearTimeout(e)};("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},8016:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"resolveHref",{enumerable:!0,get:function(){return h}});let n=r(8323),i=r(1142),a=r(5519),o=r(3461),s=r(8157),l=r(8029),c=r(9195),u=r(20);function h(e,t,r){let h;let d="string"==typeof t?t:(0,i.formatWithValidation)(t),f=d.match(/^[a-zA-Z]{1,}:\/\//),p=f?d.slice(f[0].length):d;if((p.split("?",1)[0]||"").match(/(\/\/|\\)/)){console.error("Invalid href '"+d+"' passed to next/router in page: '"+e.pathname+"'. Repeated forward-slashes (//) or backslashes \\ are not valid in the href.");let t=(0,o.normalizeRepeatedSlashes)(p);d=(f?f[0]:"")+t}if(!(0,l.isLocalURL)(d))return r?[d]:d;try{h=new URL(d.startsWith("#")?e.asPath:e.pathname,"http://n")}catch(e){h=new URL("/","http://n")}try{let e=new URL(d,h);e.pathname=(0,s.normalizePathTrailingSlash)(e.pathname);let t="";if((0,c.isDynamicRoute)(e.pathname)&&e.searchParams&&r){let r=(0,n.searchParamsToUrlQuery)(e.searchParams),{result:o,params:s}=(0,u.interpolateAs)(e.pathname,e.pathname,r);o&&(t=(0,i.formatWithValidation)({pathname:o,hash:e.hash,query:(0,a.omit)(r,s)}))}let o=e.origin===h.origin?e.href.slice(e.origin.length):e.href;return r?[o,t||o]:o}catch(e){return r?[d]:d}}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},3106:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"useIntersection",{enumerable:!0,get:function(){return l}});let n=r(2265),i=r(9189),a="function"==typeof IntersectionObserver,o=new Map,s=[];function l(e){let{rootRef:t,rootMargin:r,disabled:l}=e,c=l||!a,[u,h]=(0,n.useState)(!1),d=(0,n.useRef)(null),f=(0,n.useCallback)(e=>{d.current=e},[]);return(0,n.useEffect)(()=>{if(a){if(c||u)return;let e=d.current;if(e&&e.tagName)return function(e,t,r){let{id:n,observer:i,elements:a}=function(e){let t;let r={root:e.root||null,margin:e.rootMargin||""},n=s.find(e=>e.root===r.root&&e.margin===r.margin);if(n&&(t=o.get(n)))return t;let i=new Map;return t={id:r,observer:new IntersectionObserver(e=>{e.forEach(e=>{let t=i.get(e.target),r=e.isIntersecting||e.intersectionRatio>0;t&&r&&t(r)})},e),elements:i},s.push(r),o.set(r,t),t}(r);return a.set(e,t),i.observe(e),function(){if(a.delete(e),i.unobserve(e),0===a.size){i.disconnect(),o.delete(n);let e=s.findIndex(e=>e.root===n.root&&e.margin===n.margin);e>-1&&s.splice(e,1)}}}(e,e=>e&&h(e),{root:null==t?void 0:t.current,rootMargin:r})}else if(!u){let e=(0,i.requestIdleCallback)(()=>h(!0));return()=>(0,i.cancelIdleCallback)(e)}},[c,r,t,u,d.current]),[f,u,(0,n.useCallback)(()=>{h(!1)},[])]}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},8081:function(e){!function(){var t={229:function(e){var t,r,n,i=e.exports={};function a(){throw Error("setTimeout has not been defined")}function o(){throw Error("clearTimeout has not been defined")}function s(e){if(t===setTimeout)return setTimeout(e,0);if((t===a||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:a}catch(e){t=a}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(e){r=o}}();var l=[],c=!1,u=-1;function h(){c&&n&&(c=!1,n.length?l=n.concat(l):u=-1,l.length&&d())}function d(){if(!c){var e=s(h);c=!0;for(var t=l.length;t;){for(n=l,l=[];++u<t;)n&&n[u].run();u=-1,t=l.length}n=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function p(){}i.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];l.push(new f(e,t)),1!==l.length||c||s(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=p,i.addListener=p,i.once=p,i.off=p,i.removeListener=p,i.removeAllListeners=p,i.emit=p,i.prependListener=p,i.prependOnceListener=p,i.listeners=function(e){return[]},i.binding=function(e){throw Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw Error("process.chdir is not supported")},i.umask=function(){return 0}}},r={};function n(e){var i=r[e];if(void 0!==i)return i.exports;var a=r[e]={exports:{}},o=!0;try{t[e](a,a.exports,n),o=!1}finally{o&&delete r[e]}return a.exports}n.ab="//";var i=n(229);e.exports=i}()},2901:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"AmpStateContext",{enumerable:!0,get:function(){return n}});let n=r(9920)._(r(2265)).default.createContext({})},687:function(e,t){"use strict";function r(e){let{ampFirst:t=!1,hybrid:r=!1,hasQuery:n=!1}=void 0===e?{}:e;return t||r&&n}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"isInAmpMode",{enumerable:!0,get:function(){return r}})},1943:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"escapeStringRegexp",{enumerable:!0,get:function(){return i}});let r=/[|\\{}()[\]^$+*?.-]/,n=/[|\\{}()[\]^$+*?.-]/g;function i(e){return r.test(e)?e.replace(n,"\\$&"):e}},497:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getImgProps",{enumerable:!0,get:function(){return s}}),r(2301);let n=r(1564),i=r(7103);function a(e){return void 0!==e.default}function o(e){return void 0===e?e:"number"==typeof e?Number.isFinite(e)?e:NaN:"string"==typeof e&&/^[0-9]+$/.test(e)?parseInt(e,10):NaN}function s(e,t){var r;let s,l,c,{src:u,sizes:h,unoptimized:d=!1,priority:f=!1,loading:p,className:m,quality:A,width:g,height:v,fill:y=!1,style:x,overrideSrc:E,onLoad:_,onLoadingComplete:C,placeholder:b="empty",blurDataURL:w,fetchPriority:B,layout:I,objectFit:M,objectPosition:S,lazyBoundary:T,lazyRoot:P,...D}=e,{imgConf:R,showAltText:F,blurComplete:z,defaultLoader:O}=t,Q=R||i.imageConfigDefault;if("allSizes"in Q)s=Q;else{let e=[...Q.deviceSizes,...Q.imageSizes].sort((e,t)=>e-t),t=Q.deviceSizes.sort((e,t)=>e-t);s={...Q,allSizes:e,deviceSizes:t}}if(void 0===O)throw Error("images.loaderFile detected but the file is missing default export.\nRead more: https://nextjs.org/docs/messages/invalid-images-config");let L=D.loader||O;delete D.loader,delete D.srcSet;let k="__next_img_default"in L;if(k){if("custom"===s.loader)throw Error('Image with src "'+u+'" is missing "loader" prop.\nRead more: https://nextjs.org/docs/messages/next-image-missing-loader')}else{let e=L;L=t=>{let{config:r,...n}=t;return e(n)}}if(I){"fill"===I&&(y=!0);let e={intrinsic:{maxWidth:"100%",height:"auto"},responsive:{width:"100%",height:"auto"}}[I];e&&(x={...x,...e});let t={responsive:"100vw",fill:"100vw"}[I];t&&!h&&(h=t)}let U="",N=o(g),G=o(v);if("object"==typeof(r=u)&&(a(r)||void 0!==r.src)){let e=a(u)?u.default:u;if(!e.src)throw Error("An object should only be passed to the image component src parameter if it comes from a static image import. It must include src. Received "+JSON.stringify(e));if(!e.height||!e.width)throw Error("An object should only be passed to the image component src parameter if it comes from a static image import. It must include height and width. Received "+JSON.stringify(e));if(l=e.blurWidth,c=e.blurHeight,w=w||e.blurDataURL,U=e.src,!y){if(N||G){if(N&&!G){let t=N/e.width;G=Math.round(e.height*t)}else if(!N&&G){let t=G/e.height;N=Math.round(e.width*t)}}else N=e.width,G=e.height}}let H=!f&&("lazy"===p||void 0===p);(!(u="string"==typeof u?u:U)||u.startsWith("data:")||u.startsWith("blob:"))&&(d=!0,H=!1),s.unoptimized&&(d=!0),k&&u.endsWith(".svg")&&!s.dangerouslyAllowSVG&&(d=!0),f&&(B="high");let V=o(A),j=Object.assign(y?{position:"absolute",height:"100%",width:"100%",left:0,top:0,right:0,bottom:0,objectFit:M,objectPosition:S}:{},F?{}:{color:"transparent"},x),Y=z||"empty"===b?null:"blur"===b?'url("data:image/svg+xml;charset=utf-8,'+(0,n.getImageBlurSvg)({widthInt:N,heightInt:G,blurWidth:l,blurHeight:c,blurDataURL:w||"",objectFit:j.objectFit})+'")':'url("'+b+'")',J=Y?{backgroundSize:j.objectFit||"cover",backgroundPosition:j.objectPosition||"50% 50%",backgroundRepeat:"no-repeat",backgroundImage:Y}:{},W=function(e){let{config:t,src:r,unoptimized:n,width:i,quality:a,sizes:o,loader:s}=e;if(n)return{src:r,srcSet:void 0,sizes:void 0};let{widths:l,kind:c}=function(e,t,r){let{deviceSizes:n,allSizes:i}=e;if(r){let e=/(^|\s)(1?\d?\d)vw/g,t=[];for(let n;n=e.exec(r);n)t.push(parseInt(n[2]));if(t.length){let e=.01*Math.min(...t);return{widths:i.filter(t=>t>=n[0]*e),kind:"w"}}return{widths:i,kind:"w"}}return"number"!=typeof t?{widths:n,kind:"w"}:{widths:[...new Set([t,2*t].map(e=>i.find(t=>t>=e)||i[i.length-1]))],kind:"x"}}(t,i,o),u=l.length-1;return{sizes:o||"w"!==c?o:"100vw",srcSet:l.map((e,n)=>s({config:t,src:r,quality:a,width:e})+" "+("w"===c?e:n+1)+c).join(", "),src:s({config:t,src:r,quality:a,width:l[u]})}}({config:s,src:u,unoptimized:d,width:N,quality:V,sizes:h,loader:L});return{props:{...D,loading:H?"lazy":p,fetchPriority:B,width:N,height:G,decoding:"async",className:m,style:{...j,...J},sizes:W.sizes,srcSet:W.srcSet,src:E||W.src},meta:{unoptimized:d,priority:f,placeholder:b,fill:y}}}},8321:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{default:function(){return m},defaultHead:function(){return h}});let n=r(9920),i=r(1452),a=r(7437),o=i._(r(2265)),s=n._(r(5960)),l=r(2901),c=r(6590),u=r(687);function h(e){void 0===e&&(e=!1);let t=[(0,a.jsx)("meta",{charSet:"utf-8"})];return e||t.push((0,a.jsx)("meta",{name:"viewport",content:"width=device-width"})),t}function d(e,t){return"string"==typeof t||"number"==typeof t?e:t.type===o.default.Fragment?e.concat(o.default.Children.toArray(t.props.children).reduce((e,t)=>"string"==typeof t||"number"==typeof t?e:e.concat(t),[])):e.concat(t)}r(2301);let f=["name","httpEquiv","charSet","itemProp"];function p(e,t){let{inAmpMode:r}=t;return e.reduce(d,[]).reverse().concat(h(r).reverse()).filter(function(){let e=new Set,t=new Set,r=new Set,n={};return i=>{let a=!0,o=!1;if(i.key&&"number"!=typeof i.key&&i.key.indexOf("$")>0){o=!0;let t=i.key.slice(i.key.indexOf("$")+1);e.has(t)?a=!1:e.add(t)}switch(i.type){case"title":case"base":t.has(i.type)?a=!1:t.add(i.type);break;case"meta":for(let e=0,t=f.length;e<t;e++){let t=f[e];if(i.props.hasOwnProperty(t)){if("charSet"===t)r.has(t)?a=!1:r.add(t);else{let e=i.props[t],r=n[t]||new Set;("name"!==t||!o)&&r.has(e)?a=!1:(r.add(e),n[t]=r)}}}}return a}}()).reverse().map((e,t)=>{let n=e.key||t;if(!r&&"link"===e.type&&e.props.href&&["https://fonts.googleapis.com/css","https://use.typekit.net/"].some(t=>e.props.href.startsWith(t))){let t={...e.props||{}};return t["data-href"]=t.href,t.href=void 0,t["data-optimized-fonts"]=!0,o.default.cloneElement(e,t)}return o.default.cloneElement(e,{key:n})})}let m=function(e){let{children:t}=e,r=(0,o.useContext)(l.AmpStateContext),n=(0,o.useContext)(c.HeadManagerContext);return(0,a.jsx)(s.default,{reduceComponentsToState:p,headManager:n,inAmpMode:(0,u.isInAmpMode)(r),children:t})};("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},1564:function(e,t){"use strict";function r(e){let{widthInt:t,heightInt:r,blurWidth:n,blurHeight:i,blurDataURL:a,objectFit:o}=e,s=n?40*n:t,l=i?40*i:r,c=s&&l?"viewBox='0 0 "+s+" "+l+"'":"";return"%3Csvg xmlns='http://www.w3.org/2000/svg' "+c+"%3E%3Cfilter id='b' color-interpolation-filters='sRGB'%3E%3CfeGaussianBlur stdDeviation='20'/%3E%3CfeColorMatrix values='1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 100 -1' result='s'/%3E%3CfeFlood x='0' y='0' width='100%25' height='100%25'/%3E%3CfeComposite operator='out' in='s'/%3E%3CfeComposite in2='SourceGraphic'/%3E%3CfeGaussianBlur stdDeviation='20'/%3E%3C/filter%3E%3Cimage width='100%25' height='100%25' x='0' y='0' preserveAspectRatio='"+(c?"none":"contain"===o?"xMidYMid":"cover"===o?"xMidYMid slice":"none")+"' style='filter: url(%23b);' href='"+a+"'/%3E%3C/svg%3E"}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getImageBlurSvg",{enumerable:!0,get:function(){return r}})},3938:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ImageConfigContext",{enumerable:!0,get:function(){return a}});let n=r(9920)._(r(2265)),i=r(7103),a=n.default.createContext(i.imageConfigDefault)},7103:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{VALID_LOADERS:function(){return r},imageConfigDefault:function(){return n}});let r=["default","imgix","cloudinary","akamai","custom"],n={deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",loaderFile:"",domains:[],disableStaticImages:!1,minimumCacheTTL:60,formats:["image/webp"],dangerouslyAllowSVG:!1,contentSecurityPolicy:"script-src 'none'; frame-src 'none'; sandbox;",contentDispositionType:"inline",remotePatterns:[],unoptimized:!1}},5601:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{default:function(){return l},getImageProps:function(){return s}});let n=r(9920),i=r(497),a=r(8173),o=n._(r(1241));function s(e){let{props:t}=(0,i.getImgProps)(e,{defaultLoader:o.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,r]of Object.entries(t))void 0===r&&delete t[e];return{props:t}}let l=a.Image},1241:function(e,t){"use strict";function r(e){let{config:t,src:r,width:n,quality:i}=e;return t.path+"?url="+encodeURIComponent(r)+"&w="+n+"&q="+(i||75)}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n}}),r.__next_img_default=!0;let n=r},291:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"RouterContext",{enumerable:!0,get:function(){return n}});let n=r(9920)._(r(2265)).default.createContext(null)},1142:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{formatUrl:function(){return a},formatWithValidation:function(){return s},urlObjectKeys:function(){return o}});let n=r(1452)._(r(8323)),i=/https?|ftp|gopher|file/;function a(e){let{auth:t,hostname:r}=e,a=e.protocol||"",o=e.pathname||"",s=e.hash||"",l=e.query||"",c=!1;t=t?encodeURIComponent(t).replace(/%3A/i,":")+"@":"",e.host?c=t+e.host:r&&(c=t+(~r.indexOf(":")?"["+r+"]":r),e.port&&(c+=":"+e.port)),l&&"object"==typeof l&&(l=String(n.urlQueryToSearchParams(l)));let u=e.search||l&&"?"+l||"";return a&&!a.endsWith(":")&&(a+=":"),e.slashes||(!a||i.test(a))&&!1!==c?(c="//"+(c||""),o&&"/"!==o[0]&&(o="/"+o)):c||(c=""),s&&"#"!==s[0]&&(s="#"+s),u&&"?"!==u[0]&&(u="?"+u),""+a+c+(o=o.replace(/[?#]/g,encodeURIComponent))+(u=u.replace("#","%23"))+s}let o=["auth","hash","host","hostname","href","path","pathname","port","protocol","query","search","slashes"];function s(e){return a(e)}},9195:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{getSortedRoutes:function(){return n.getSortedRoutes},isDynamicRoute:function(){return i.isDynamicRoute}});let n=r(9089),i=r(8083)},20:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"interpolateAs",{enumerable:!0,get:function(){return a}});let n=r(1533),i=r(3169);function a(e,t,r){let a="",o=(0,i.getRouteRegex)(e),s=o.groups,l=(t!==e?(0,n.getRouteMatcher)(o)(t):"")||r;a=e;let c=Object.keys(s);return c.every(e=>{let t=l[e]||"",{repeat:r,optional:n}=s[e],i="["+(r?"...":"")+e+"]";return n&&(i=(t?"":"/")+"["+i+"]"),r&&!Array.isArray(t)&&(t=[t]),(n||e in l)&&(a=a.replace(i,r?t.map(e=>encodeURIComponent(e)).join("/"):encodeURIComponent(t))||"/")})||(a=""),{params:c,result:a}}},8083:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"isDynamicRoute",{enumerable:!0,get:function(){return a}});let n=r(2269),i=/\/\[[^/]+?\](?=\/|$)/;function a(e){return(0,n.isInterceptionRouteAppPath)(e)&&(e=(0,n.extractInterceptionRouteInformation)(e).interceptedRoute),i.test(e)}},8029:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"isLocalURL",{enumerable:!0,get:function(){return a}});let n=r(3461),i=r(9404);function a(e){if(!(0,n.isAbsoluteUrl)(e))return!0;try{let t=(0,n.getLocationOrigin)(),r=new URL(e,t);return r.origin===t&&(0,i.hasBasePath)(r.pathname)}catch(e){return!1}}},5519:function(e,t){"use strict";function r(e,t){let r={};return Object.keys(e).forEach(n=>{t.includes(n)||(r[n]=e[n])}),r}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"omit",{enumerable:!0,get:function(){return r}})},8323:function(e,t){"use strict";function r(e){let t={};return e.forEach((e,r)=>{void 0===t[r]?t[r]=e:Array.isArray(t[r])?t[r].push(e):t[r]=[t[r],e]}),t}function n(e){return"string"!=typeof e&&("number"!=typeof e||isNaN(e))&&"boolean"!=typeof e?"":String(e)}function i(e){let t=new URLSearchParams;return Object.entries(e).forEach(e=>{let[r,i]=e;Array.isArray(i)?i.forEach(e=>t.append(r,n(e))):t.set(r,n(i))}),t}function a(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return r.forEach(t=>{Array.from(t.keys()).forEach(t=>e.delete(t)),t.forEach((t,r)=>e.append(r,t))}),e}Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{assign:function(){return a},searchParamsToUrlQuery:function(){return r},urlQueryToSearchParams:function(){return i}})},1533:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getRouteMatcher",{enumerable:!0,get:function(){return i}});let n=r(3461);function i(e){let{re:t,groups:r}=e;return e=>{let i=t.exec(e);if(!i)return!1;let a=e=>{try{return decodeURIComponent(e)}catch(e){throw new n.DecodeError("failed to decode param")}},o={};return Object.keys(r).forEach(e=>{let t=r[e],n=i[t.pos];void 0!==n&&(o[e]=~n.indexOf("/")?n.split("/").map(e=>a(e)):t.repeat?[a(n)]:a(n))}),o}}},3169:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{getNamedMiddlewareRegex:function(){return d},getNamedRouteRegex:function(){return h},getRouteRegex:function(){return l}});let n=r(2269),i=r(1943),a=r(7741);function o(e){let t=e.startsWith("[")&&e.endsWith("]");t&&(e=e.slice(1,-1));let r=e.startsWith("...");return r&&(e=e.slice(3)),{key:e,repeat:r,optional:t}}function s(e){let t=(0,a.removeTrailingSlash)(e).slice(1).split("/"),r={},s=1;return{parameterizedRoute:t.map(e=>{let t=n.INTERCEPTION_ROUTE_MARKERS.find(t=>e.startsWith(t)),a=e.match(/\[((?:\[.*\])|.+)\]/);if(t&&a){let{key:e,optional:n,repeat:l}=o(a[1]);return r[e]={pos:s++,repeat:l,optional:n},"/"+(0,i.escapeStringRegexp)(t)+"([^/]+?)"}if(!a)return"/"+(0,i.escapeStringRegexp)(e);{let{key:e,repeat:t,optional:n}=o(a[1]);return r[e]={pos:s++,repeat:t,optional:n},t?n?"(?:/(.+?))?":"/(.+?)":"/([^/]+?)"}}).join(""),groups:r}}function l(e){let{parameterizedRoute:t,groups:r}=s(e);return{re:RegExp("^"+t+"(?:/)?$"),groups:r}}function c(e){let{interceptionMarker:t,getSafeRouteKey:r,segment:n,routeKeys:a,keyPrefix:s}=e,{key:l,optional:c,repeat:u}=o(n),h=l.replace(/\W/g,"");s&&(h=""+s+h);let d=!1;(0===h.length||h.length>30)&&(d=!0),isNaN(parseInt(h.slice(0,1)))||(d=!0),d&&(h=r()),s?a[h]=""+s+l:a[h]=l;let f=t?(0,i.escapeStringRegexp)(t):"";return u?c?"(?:/"+f+"(?<"+h+">.+?))?":"/"+f+"(?<"+h+">.+?)":"/"+f+"(?<"+h+">[^/]+?)"}function u(e,t){let r;let o=(0,a.removeTrailingSlash)(e).slice(1).split("/"),s=(r=0,()=>{let e="",t=++r;for(;t>0;)e+=String.fromCharCode(97+(t-1)%26),t=Math.floor((t-1)/26);return e}),l={};return{namedParameterizedRoute:o.map(e=>{let r=n.INTERCEPTION_ROUTE_MARKERS.some(t=>e.startsWith(t)),a=e.match(/\[((?:\[.*\])|.+)\]/);if(r&&a){let[r]=e.split(a[0]);return c({getSafeRouteKey:s,interceptionMarker:r,segment:a[1],routeKeys:l,keyPrefix:t?"nxtI":void 0})}return a?c({getSafeRouteKey:s,segment:a[1],routeKeys:l,keyPrefix:t?"nxtP":void 0}):"/"+(0,i.escapeStringRegexp)(e)}).join(""),routeKeys:l}}function h(e,t){let r=u(e,t);return{...l(e),namedRegex:"^"+r.namedParameterizedRoute+"(?:/)?$",routeKeys:r.routeKeys}}function d(e,t){let{parameterizedRoute:r}=s(e),{catchAll:n=!0}=t;if("/"===r)return{namedRegex:"^/"+(n?".*":"")+"$"};let{namedParameterizedRoute:i}=u(e,!1);return{namedRegex:"^"+i+(n?"(?:(/.*)?)":"")+"$"}}},9089:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getSortedRoutes",{enumerable:!0,get:function(){return n}});class r{insert(e){this._insert(e.split("/").filter(Boolean),[],!1)}smoosh(){return this._smoosh()}_smoosh(e){void 0===e&&(e="/");let t=[...this.children.keys()].sort();null!==this.slugName&&t.splice(t.indexOf("[]"),1),null!==this.restSlugName&&t.splice(t.indexOf("[...]"),1),null!==this.optionalRestSlugName&&t.splice(t.indexOf("[[...]]"),1);let r=t.map(t=>this.children.get(t)._smoosh(""+e+t+"/")).reduce((e,t)=>[...e,...t],[]);if(null!==this.slugName&&r.push(...this.children.get("[]")._smoosh(e+"["+this.slugName+"]/")),!this.placeholder){let t="/"===e?"/":e.slice(0,-1);if(null!=this.optionalRestSlugName)throw Error('You cannot define a route with the same specificity as a optional catch-all route ("'+t+'" and "'+t+"[[..."+this.optionalRestSlugName+']]").');r.unshift(t)}return null!==this.restSlugName&&r.push(...this.children.get("[...]")._smoosh(e+"[..."+this.restSlugName+"]/")),null!==this.optionalRestSlugName&&r.push(...this.children.get("[[...]]")._smoosh(e+"[[..."+this.optionalRestSlugName+"]]/")),r}_insert(e,t,n){if(0===e.length){this.placeholder=!1;return}if(n)throw Error("Catch-all must be the last part of the URL.");let i=e[0];if(i.startsWith("[")&&i.endsWith("]")){let r=i.slice(1,-1),o=!1;if(r.startsWith("[")&&r.endsWith("]")&&(r=r.slice(1,-1),o=!0),r.startsWith("...")&&(r=r.substring(3),n=!0),r.startsWith("[")||r.endsWith("]"))throw Error("Segment names may not start or end with extra brackets ('"+r+"').");if(r.startsWith("."))throw Error("Segment names may not start with erroneous periods ('"+r+"').");function a(e,r){if(null!==e&&e!==r)throw Error("You cannot use different slug names for the same dynamic path ('"+e+"' !== '"+r+"').");t.forEach(e=>{if(e===r)throw Error('You cannot have the same slug name "'+r+'" repeat within a single dynamic path');if(e.replace(/\W/g,"")===i.replace(/\W/g,""))throw Error('You cannot have the slug names "'+e+'" and "'+r+'" differ only by non-word symbols within a single dynamic path')}),t.push(r)}if(n){if(o){if(null!=this.restSlugName)throw Error('You cannot use both an required and optional catch-all route at the same level ("[...'+this.restSlugName+']" and "'+e[0]+'" ).');a(this.optionalRestSlugName,r),this.optionalRestSlugName=r,i="[[...]]"}else{if(null!=this.optionalRestSlugName)throw Error('You cannot use both an optional and required catch-all route at the same level ("[[...'+this.optionalRestSlugName+']]" and "'+e[0]+'").');a(this.restSlugName,r),this.restSlugName=r,i="[...]"}}else{if(o)throw Error('Optional route parameters are not yet supported ("'+e[0]+'").');a(this.slugName,r),this.slugName=r,i="[]"}}this.children.has(i)||this.children.set(i,new r),this.children.get(i)._insert(e.slice(1),t,n)}constructor(){this.placeholder=!0,this.children=new Map,this.slugName=null,this.restSlugName=null,this.optionalRestSlugName=null}}function n(e){let t=new r;return e.forEach(e=>t.insert(e)),t.smoosh()}},5960:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return s}});let n=r(2265),i="undefined"==typeof window,a=i?()=>{}:n.useLayoutEffect,o=i?()=>{}:n.useEffect;function s(e){let{headManager:t,reduceComponentsToState:r}=e;function s(){if(t&&t.mountedInstances){let i=n.Children.toArray(Array.from(t.mountedInstances).filter(Boolean));t.updateHead(r(i,e))}}if(i){var l;null==t||null==(l=t.mountedInstances)||l.add(e.children),s()}return a(()=>{var r;return null==t||null==(r=t.mountedInstances)||r.add(e.children),()=>{var r;null==t||null==(r=t.mountedInstances)||r.delete(e.children)}}),a(()=>(t&&(t._pendingUpdate=s),()=>{t&&(t._pendingUpdate=s)})),o(()=>(t&&t._pendingUpdate&&(t._pendingUpdate(),t._pendingUpdate=null),()=>{t&&t._pendingUpdate&&(t._pendingUpdate(),t._pendingUpdate=null)})),null}},3461:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{DecodeError:function(){return p},MiddlewareNotFoundError:function(){return v},MissingStaticPage:function(){return g},NormalizeError:function(){return m},PageNotFoundError:function(){return A},SP:function(){return d},ST:function(){return f},WEB_VITALS:function(){return r},execOnce:function(){return n},getDisplayName:function(){return l},getLocationOrigin:function(){return o},getURL:function(){return s},isAbsoluteUrl:function(){return a},isResSent:function(){return c},loadGetInitialProps:function(){return h},normalizeRepeatedSlashes:function(){return u},stringifyError:function(){return y}});let r=["CLS","FCP","FID","INP","LCP","TTFB"];function n(e){let t,r=!1;return function(){for(var n=arguments.length,i=Array(n),a=0;a<n;a++)i[a]=arguments[a];return r||(r=!0,t=e(...i)),t}}let i=/^[a-zA-Z][a-zA-Z\d+\-.]*?:/,a=e=>i.test(e);function o(){let{protocol:e,hostname:t,port:r}=window.location;return e+"//"+t+(r?":"+r:"")}function s(){let{href:e}=window.location,t=o();return e.substring(t.length)}function l(e){return"string"==typeof e?e:e.displayName||e.name||"Unknown"}function c(e){return e.finished||e.headersSent}function u(e){let t=e.split("?");return t[0].replace(/\\/g,"/").replace(/\/\/+/g,"/")+(t[1]?"?"+t.slice(1).join("?"):"")}async function h(e,t){let r=t.res||t.ctx&&t.ctx.res;if(!e.getInitialProps)return t.ctx&&t.Component?{pageProps:await h(t.Component,t.ctx)}:{};let n=await e.getInitialProps(t);if(r&&c(r))return n;if(!n)throw Error('"'+l(e)+'.getInitialProps()" should resolve to an object. But found "'+n+'" instead.');return n}let d="undefined"!=typeof performance,f=d&&["mark","measure","getEntriesByName"].every(e=>"function"==typeof performance[e]);class p extends Error{}class m extends Error{}class A extends Error{constructor(e){super(),this.code="ENOENT",this.name="PageNotFoundError",this.message="Cannot find module for page: "+e}}class g extends Error{constructor(e,t){super(),this.message="Failed to load static file for page: "+e+" "+t}}class v extends Error{constructor(){super(),this.code="ENOENT",this.message="Cannot find the middleware module"}}function y(e){return JSON.stringify({message:e.message,stack:e.stack})}},9949:function(e,t,r){"use strict";var n=r(8877);function i(){}function a(){}a.resetWarningCache=i,e.exports=function(){function e(e,t,r,i,a,o){if(o!==n){var s=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:a,resetWarningCache:i};return r.PropTypes=r,r}},1448:function(e,t,r){e.exports=r(9949)()},8877:function(e){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},4008:function(e,t){"use strict";/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */t.ConcurrentRoot=1,t.ContinuousEventPriority=4,t.DefaultEventPriority=16,t.DiscreteEventPriority=1},4185:function(e,t,r){/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */e.exports=function(e){"use strict";var t,n,i,a,o,s={},l=r(2265),c=r(3932),u=Object.assign;function h(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var d=l.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,f=Symbol.for("react.element"),p=Symbol.for("react.portal"),m=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),g=Symbol.for("react.profiler"),v=Symbol.for("react.provider"),y=Symbol.for("react.context"),x=Symbol.for("react.forward_ref"),E=Symbol.for("react.suspense"),_=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),b=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var w=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var B=Symbol.iterator;function I(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=B&&e[B]||e["@@iterator"])?e:null}function M(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case m:return"Fragment";case p:return"Portal";case g:return"Profiler";case A:return"StrictMode";case E:return"Suspense";case _:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case y:return(e.displayName||"Context")+".Consumer";case v:return(e._context.displayName||"Context")+".Provider";case x:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case C:return null!==(t=e.displayName||null)?t:M(e.type)||"Memo";case b:t=e._payload,e=e._init;try{return M(e(t))}catch(e){}}return null}function S(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do 0!=(4098&(t=e).flags)&&(r=t.return),e=t.return;while(e)}return 3===t.tag?r:null}function T(e){if(S(e)!==e)throw Error(h(188))}function P(e){var t=e.alternate;if(!t){if(null===(t=S(e)))throw Error(h(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(null===i)break;var a=i.alternate;if(null===a){if(null!==(n=i.return)){r=n;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===r)return T(i),e;if(a===n)return T(i),t;a=a.sibling}throw Error(h(188))}if(r.return!==n.return)r=i,n=a;else{for(var o=!1,s=i.child;s;){if(s===r){o=!0,r=i,n=a;break}if(s===n){o=!0,n=i,r=a;break}s=s.sibling}if(!o){for(s=a.child;s;){if(s===r){o=!0,r=a,n=i;break}if(s===n){o=!0,n=a,r=i;break}s=s.sibling}if(!o)throw Error(h(189))}}if(r.alternate!==n)throw Error(h(190))}if(3!==r.tag)throw Error(h(188));return r.stateNode.current===r?e:t}function D(e){return null!==(e=P(e))?function e(t){if(5===t.tag||6===t.tag)return t;for(t=t.child;null!==t;){var r=e(t);if(null!==r)return r;t=t.sibling}return null}(e):null}var R,F=Array.isArray,z=e.getPublicInstance,O=e.getRootHostContext,Q=e.getChildHostContext,L=e.prepareForCommit,k=e.resetAfterCommit,U=e.createInstance,N=e.appendInitialChild,G=e.finalizeInitialChildren,H=e.prepareUpdate,V=e.shouldSetTextContent,j=e.createTextInstance,Y=e.scheduleTimeout,J=e.cancelTimeout,W=e.noTimeout,q=e.isPrimaryRenderer,K=e.supportsMutation,X=e.supportsPersistence,Z=e.supportsHydration,$=e.getInstanceFromNode,ee=e.preparePortalMount,et=e.getCurrentEventPriority,er=e.detachDeletedInstance,en=e.supportsMicrotasks,ei=e.scheduleMicrotask,ea=e.supportsTestSelectors,eo=e.findFiberRoot,es=e.getBoundingRect,el=e.getTextContent,ec=e.isHiddenSubtree,eu=e.matchAccessibilityRole,eh=e.setFocusIfFocusable,ed=e.setupIntersectionObserver,ef=e.appendChild,ep=e.appendChildToContainer,em=e.commitTextUpdate,eA=e.commitMount,eg=e.commitUpdate,ev=e.insertBefore,ey=e.insertInContainerBefore,ex=e.removeChild,eE=e.removeChildFromContainer,e_=e.resetTextContent,eC=e.hideInstance,eb=e.hideTextInstance,ew=e.unhideInstance,eB=e.unhideTextInstance,eI=e.clearContainer,eM=e.cloneInstance,eS=e.createContainerChildSet,eT=e.appendChildToContainerChildSet,eP=e.finalizeContainerChildren,eD=e.replaceContainerChildren,eR=e.cloneHiddenInstance,eF=e.cloneHiddenTextInstance,ez=e.canHydrateInstance,eO=e.canHydrateTextInstance,eQ=e.canHydrateSuspenseInstance,eL=e.isSuspenseInstancePending,ek=e.isSuspenseInstanceFallback,eU=e.registerSuspenseInstanceRetry,eN=e.getNextHydratableSibling,eG=e.getFirstHydratableChild,eH=e.getFirstHydratableChildWithinContainer,eV=e.getFirstHydratableChildWithinSuspenseInstance,ej=e.hydrateInstance,eY=e.hydrateTextInstance,eJ=e.hydrateSuspenseInstance,eW=e.getNextHydratableInstanceAfterSuspenseInstance,eq=e.commitHydratedContainer,eK=e.commitHydratedSuspenseInstance,eX=e.clearSuspenseBoundary,eZ=e.clearSuspenseBoundaryFromContainer,e$=e.shouldDeleteUnhydratedTailInstances,e0=e.didNotMatchHydratedContainerTextInstance,e1=e.didNotMatchHydratedTextInstance;function e2(e){if(void 0===R)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);R=t&&t[1]||""}return"\n"+R+e}var e3=!1;function e4(e,t){if(!e||e3)return"";e3=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t){if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(e){var n=e}Reflect.construct(e,[],t)}else{try{t.call()}catch(e){n=e}e.call(t.prototype)}}else{try{throw Error()}catch(e){n=e}e()}}catch(t){if(t&&n&&"string"==typeof t.stack){for(var i=t.stack.split("\n"),a=n.stack.split("\n"),o=i.length-1,s=a.length-1;1<=o&&0<=s&&i[o]!==a[s];)s--;for(;1<=o&&0<=s;o--,s--)if(i[o]!==a[s]){if(1!==o||1!==s)do if(o--,0>--s||i[o]!==a[s]){var l="\n"+i[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=o&&0<=s);break}}}finally{e3=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?e2(e):""}var e5=Object.prototype.hasOwnProperty,e6=[],e8=-1;function e9(e){return{current:e}}function e7(e){0>e8||(e.current=e6[e8],e6[e8]=null,e8--)}function te(e,t){e6[++e8]=e.current,e.current=t}var tt={},tr=e9(tt),tn=e9(!1),ti=tt;function ta(e,t){var r=e.type.contextTypes;if(!r)return tt;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i,a={};for(i in r)a[i]=t[i];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function to(e){return null!=(e=e.childContextTypes)}function ts(){e7(tn),e7(tr)}function tl(e,t,r){if(tr.current!==tt)throw Error(h(168));te(tr,t),te(tn,r)}function tc(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,"function"!=typeof n.getChildContext)return r;for(var i in n=n.getChildContext())if(!(i in t))throw Error(h(108,function(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return M(t);case 8:return t===A?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t}return null}(e)||"Unknown",i));return u({},r,n)}function tu(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||tt,ti=tr.current,te(tr,e),te(tn,tn.current),!0}function th(e,t,r){var n=e.stateNode;if(!n)throw Error(h(169));r?(e=tc(e,t,ti),n.__reactInternalMemoizedMergedChildContext=e,e7(tn),e7(tr),te(tr,e)):e7(tn),te(tn,r)}var td=Math.clz32?Math.clz32:function(e){return 0==(e>>>=0)?32:31-(tf(e)/tp|0)|0},tf=Math.log,tp=Math.LN2,tm=64,tA=4194304;function tg(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function tv(e,t){var r=e.pendingLanes;if(0===r)return 0;var n=0,i=e.suspendedLanes,a=e.pingedLanes,o=268435455&r;if(0!==o){var s=o&~i;0!==s?n=tg(s):0!=(a&=o)&&(n=tg(a))}else 0!=(o=r&~i)?n=tg(o):0!==a&&(n=tg(a));if(0===n)return 0;if(0!==t&&t!==n&&0==(t&i)&&((i=n&-n)>=(a=t&-t)||16===i&&0!=(4194240&a)))return t;if(0!=(4&n)&&(n|=16&r),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=n;0<t;)i=1<<(r=31-td(t)),n|=e[r],t&=~i;return n}function ty(e){return 0!=(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function tx(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function tE(e,t,r){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-td(t)]=r}function t_(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-td(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var tC=0;function tb(e){return 1<(e&=-e)?4<e?0!=(268435455&e)?16:536870912:4:1}var tw=c.unstable_scheduleCallback,tB=c.unstable_cancelCallback,tI=c.unstable_shouldYield,tM=c.unstable_requestPaint,tS=c.unstable_now,tT=c.unstable_ImmediatePriority,tP=c.unstable_UserBlockingPriority,tD=c.unstable_NormalPriority,tR=c.unstable_IdlePriority,tF=null,tz=null,tO="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},tQ=null,tL=!1,tk=!1;function tU(e){null===tQ?tQ=[e]:tQ.push(e)}function tN(){if(!tk&&null!==tQ){tk=!0;var e=0,t=tC;try{var r=tQ;for(tC=1;e<r.length;e++){var n=r[e];do n=n(!0);while(null!==n)}tQ=null,tL=!1}catch(t){throw null!==tQ&&(tQ=tQ.slice(e+1)),tw(tT,tN),t}finally{tC=t,tk=!1}}return null}var tG=d.ReactCurrentBatchConfig;function tH(e,t){if(tO(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!e5.call(t,i)||!tO(e[i],t[i]))return!1}return!0}function tV(e,t){if(e&&e.defaultProps)for(var r in t=u({},t),e=e.defaultProps)void 0===t[r]&&(t[r]=e[r]);return t}var tj=e9(null),tY=null,tJ=null,tW=null;function tq(){tW=tJ=tY=null}function tK(e,t,r){q?(te(tj,t._currentValue),t._currentValue=r):(te(tj,t._currentValue2),t._currentValue2=r)}function tX(e){var t=tj.current;e7(tj),q?e._currentValue=t:e._currentValue2=t}function tZ(e,t,r){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function t$(e,t){tY=e,tW=tJ=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!=(e.lanes&t)&&(n0=!0),e.firstContext=null)}function t0(e){var t=q?e._currentValue:e._currentValue2;if(tW!==e){if(e={context:e,memoizedValue:t,next:null},null===tJ){if(null===tY)throw Error(h(308));tJ=e,tY.dependencies={lanes:0,firstContext:e}}else tJ=tJ.next=e}return t}var t1=null,t2=!1;function t3(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function t4(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function t5(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function t6(e,t){var r=e.updateQueue;null!==r&&(r=r.shared,null!==iK&&0!=(1&e.mode)&&0==(2&iq)?(null===(e=r.interleaved)?(t.next=t,null===t1?t1=[r]:t1.push(r)):(t.next=e.next,e.next=t),r.interleaved=t):(null===(e=r.pending)?t.next=t:(t.next=e.next,e.next=t),r.pending=t))}function t8(e,t,r){if(null!==(t=t.updateQueue)&&(t=t.shared,0!=(4194240&r))){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,t_(e,r)}}function t9(e,t){var r=e.updateQueue,n=e.alternate;if(null!==n&&r===(n=n.updateQueue)){var i=null,a=null;if(null!==(r=r.firstBaseUpdate)){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};null===a?i=a=o:a=a.next=o,r=r.next}while(null!==r);null===a?i=a=t:a=a.next=t}else i=a=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:n.shared,effects:n.effects},e.updateQueue=r;return}null===(e=r.lastBaseUpdate)?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function t7(e,t,r,n){var i=e.updateQueue;t2=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,s=i.shared.pending;if(null!==s){i.shared.pending=null;var l=s,c=l.next;l.next=null,null===o?a=c:o.next=c,o=l;var h=e.alternate;null!==h&&(s=(h=h.updateQueue).lastBaseUpdate)!==o&&(null===s?h.firstBaseUpdate=c:s.next=c,h.lastBaseUpdate=l)}if(null!==a){var d=i.baseState;for(o=0,h=c=l=null,s=a;;){var f=s.lane,p=s.eventTime;if((n&f)===f){null!==h&&(h=h.next={eventTime:p,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var m=e,A=s;switch(f=t,p=r,A.tag){case 1:if("function"==typeof(m=A.payload)){d=m.call(p,d,f);break e}d=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null==(f="function"==typeof(m=A.payload)?m.call(p,d,f):m))break e;d=u({},d,f);break e;case 2:t2=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(f=i.effects)?i.effects=[s]:f.push(s))}else p={eventTime:p,lane:f,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===h?(c=h=p,l=d):h=h.next=p,o|=f;if(null===(s=s.next)){if(null===(s=i.shared.pending))break;s=(f=s).next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}if(null===h&&(l=d),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=h,null!==(t=i.shared.interleaved)){i=t;do o|=i.lane,i=i.next;while(i!==t)}else null===a&&(i.shared.lanes=0);i3|=o,e.lanes=o,e.memoizedState=d}}function re(e,t,r){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(null!==i){if(n.callback=null,n=r,"function"!=typeof i)throw Error(h(191,i));i.call(n)}}}var rt=(new l.Component).refs;function rr(e,t,r,n){r=null==(r=r(n,t=e.memoizedState))?t:u({},t,r),e.memoizedState=r,0===e.lanes&&(e.updateQueue.baseState=r)}var rn={isMounted:function(e){return!!(e=e._reactInternals)&&S(e)===e},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=ah(),i=ad(e),a=t5(n,i);a.payload=t,null!=r&&(a.callback=r),t6(e,a),null!==(t=af(e,i,n))&&t8(t,e,i)},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=ah(),i=ad(e),a=t5(n,i);a.tag=1,a.payload=t,null!=r&&(a.callback=r),t6(e,a),null!==(t=af(e,i,n))&&t8(t,e,i)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=ah(),n=ad(e),i=t5(r,n);i.tag=2,null!=t&&(i.callback=t),t6(e,i),null!==(t=af(e,n,r))&&t8(t,e,n)}};function ri(e,t,r,n,i,a,o){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,a,o):!t.prototype||!t.prototype.isPureReactComponent||!tH(r,n)||!tH(i,a)}function ra(e,t,r){var n=!1,i=tt,a=t.contextType;return"object"==typeof a&&null!==a?a=t0(a):(i=to(t)?ti:tr.current,a=(n=null!=(n=t.contextTypes))?ta(e,i):tt),t=new t(r,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=rn,e.stateNode=t,t._reactInternals=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function ro(e,t,r,n){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(r,n),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&rn.enqueueReplaceState(t,t.state,null)}function rs(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs=rt,t3(e);var a=t.contextType;"object"==typeof a&&null!==a?i.context=t0(a):(a=to(t)?ti:tr.current,i.context=ta(e,a)),i.state=e.memoizedState,"function"==typeof(a=t.getDerivedStateFromProps)&&(rr(e,t,a,r),i.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof i.getSnapshotBeforeUpdate||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||(t=i.state,"function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&rn.enqueueReplaceState(i,i.state,null),t7(e,r,i,n),i.state=e.memoizedState),"function"==typeof i.componentDidMount&&(e.flags|=4194308)}var rl=[],rc=0,ru=null,rh=0,rd=[],rf=0,rp=null,rm=1,rA="";function rg(e,t){rl[rc++]=rh,rl[rc++]=ru,ru=e,rh=t}function rv(e,t,r){rd[rf++]=rm,rd[rf++]=rA,rd[rf++]=rp,rp=e;var n=rm;e=rA;var i=32-td(n)-1;n&=~(1<<i),r+=1;var a=32-td(t)+i;if(30<a){var o=i-i%5;a=(n&(1<<o)-1).toString(32),n>>=o,i-=o,rm=1<<32-td(t)+i|r<<i|n,rA=a+e}else rm=1<<a|r<<i|n,rA=e}function ry(e){null!==e.return&&(rg(e,1),rv(e,1,0))}function rx(e){for(;e===ru;)ru=rl[--rc],rl[rc]=null,rh=rl[--rc],rl[rc]=null;for(;e===rp;)rp=rd[--rf],rd[rf]=null,rA=rd[--rf],rd[rf]=null,rm=rd[--rf],rd[rf]=null}var rE=null,r_=null,rC=!1,rb=!1,rw=null;function rB(e,t){var r=ak(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,null===(t=e.deletions)?(e.deletions=[r],e.flags|=16):t.push(r)}function rI(e,t){switch(e.tag){case 5:return null!==(t=ez(t,e.type,e.pendingProps))&&(e.stateNode=t,rE=e,r_=eG(t),!0);case 6:return null!==(t=eO(t,e.pendingProps))&&(e.stateNode=t,rE=e,r_=null,!0);case 13:if(null!==(t=eQ(t))){var r=null!==rp?{id:rm,overflow:rA}:null;return e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},(r=ak(18,null,null,0)).stateNode=t,r.return=e,e.child=r,rE=e,r_=null,!0}return!1;default:return!1}}function rM(e){return 0!=(1&e.mode)&&0==(128&e.flags)}function rS(e){if(rC){var t=r_;if(t){var r=t;if(!rI(e,t)){if(rM(e))throw Error(h(418));t=eN(r);var n=rE;t&&rI(e,t)?rB(n,r):(e.flags=-4097&e.flags|2,rC=!1,rE=e)}}else{if(rM(e))throw Error(h(418));e.flags=-4097&e.flags|2,rC=!1,rE=e}}}function rT(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;rE=e}function rP(e){if(!Z||e!==rE)return!1;if(!rC)return rT(e),rC=!0,!1;if(3!==e.tag&&(5!==e.tag||e$(e.type)&&!V(e.type,e.memoizedProps))){var t=r_;if(t){if(rM(e)){for(e=r_;e;)e=eN(e);throw Error(h(418))}for(;t;)rB(e,t),t=eN(t)}}if(rT(e),13===e.tag){if(!Z)throw Error(h(316));if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(h(317));r_=eW(e)}else r_=rE?eN(e.stateNode):null;return!0}function rD(){Z&&(r_=rE=null,rb=rC=!1)}function rR(e){null===rw?rw=[e]:rw.push(e)}function rF(e,t,r){if(null!==(e=r.ref)&&"function"!=typeof e&&"object"!=typeof e){if(r._owner){if(r=r._owner){if(1!==r.tag)throw Error(h(309));var n=r.stateNode}if(!n)throw Error(h(147,e));var i=n,a=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===a?t.ref:((t=function(e){var t=i.refs;t===rt&&(t=i.refs={}),null===e?delete t[a]:t[a]=e})._stringRef=a,t)}if("string"!=typeof e)throw Error(h(284));if(!r._owner)throw Error(h(290,e))}return e}function rz(e,t){throw Error(h(31,"[object Object]"===(e=Object.prototype.toString.call(t))?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function rO(e){return(0,e._init)(e._payload)}function rQ(e){function t(t,r){if(e){var n=t.deletions;null===n?(t.deletions=[r],t.flags|=16):n.push(r)}}function r(r,n){if(!e)return null;for(;null!==n;)t(r,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=aN(e,t)).index=0,e.sibling=null,e}function a(t,r,n){return(t.index=n,e)?null!==(n=t.alternate)?(n=n.index)<r?(t.flags|=2,r):n:(t.flags|=2,r):(t.flags|=1048576,r)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function s(e,t,r,n){return null===t||6!==t.tag?(t=aj(r,e.mode,n)).return=e:(t=i(t,r)).return=e,t}function l(e,t,r,n){var a=r.type;return a===m?u(e,t,r.props.children,n,r.key):(null!==t&&(t.elementType===a||"object"==typeof a&&null!==a&&a.$$typeof===b&&rO(a)===t.type)?(n=i(t,r.props)).ref=rF(e,t,r):(n=aG(r.type,r.key,r.props,null,e.mode,n)).ref=rF(e,t,r),n.return=e,n)}function c(e,t,r,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==r.containerInfo||t.stateNode.implementation!==r.implementation?(t=aY(r,e.mode,n)).return=e:(t=i(t,r.children||[])).return=e,t}function u(e,t,r,n,a){return null===t||7!==t.tag?(t=aH(r,e.mode,n,a)).return=e:(t=i(t,r)).return=e,t}function d(e,t,r){if("string"==typeof t&&""!==t||"number"==typeof t)return(t=aj(""+t,e.mode,r)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case f:return(r=aG(t.type,t.key,t.props,null,e.mode,r)).ref=rF(e,null,t),r.return=e,r;case p:return(t=aY(t,e.mode,r)).return=e,t;case b:return d(e,(0,t._init)(t._payload),r)}if(F(t)||I(t))return(t=aH(t,e.mode,r,null)).return=e,t;rz(e,t)}return null}function A(e,t,r,n){var i=null!==t?t.key:null;if("string"==typeof r&&""!==r||"number"==typeof r)return null!==i?null:s(e,t,""+r,n);if("object"==typeof r&&null!==r){switch(r.$$typeof){case f:return r.key===i?l(e,t,r,n):null;case p:return r.key===i?c(e,t,r,n):null;case b:return A(e,t,(i=r._init)(r._payload),n)}if(F(r)||I(r))return null!==i?null:u(e,t,r,n,null);rz(e,r)}return null}function g(e,t,r,n,i){if("string"==typeof n&&""!==n||"number"==typeof n)return s(t,e=e.get(r)||null,""+n,i);if("object"==typeof n&&null!==n){switch(n.$$typeof){case f:return l(t,e=e.get(null===n.key?r:n.key)||null,n,i);case p:return c(t,e=e.get(null===n.key?r:n.key)||null,n,i);case b:return g(e,t,r,(0,n._init)(n._payload),i)}if(F(n)||I(n))return u(t,e=e.get(r)||null,n,i,null);rz(t,n)}return null}return function s(l,c,u,v){if("object"==typeof u&&null!==u&&u.type===m&&null===u.key&&(u=u.props.children),"object"==typeof u&&null!==u){switch(u.$$typeof){case f:e:{for(var y=u.key,x=c;null!==x;){if(x.key===y){if((y=u.type)===m){if(7===x.tag){r(l,x.sibling),(c=i(x,u.props.children)).return=l,l=c;break e}}else if(x.elementType===y||"object"==typeof y&&null!==y&&y.$$typeof===b&&rO(y)===x.type){r(l,x.sibling),(c=i(x,u.props)).ref=rF(l,x,u),c.return=l,l=c;break e}r(l,x);break}t(l,x),x=x.sibling}u.type===m?((c=aH(u.props.children,l.mode,v,u.key)).return=l,l=c):((v=aG(u.type,u.key,u.props,null,l.mode,v)).ref=rF(l,c,u),v.return=l,l=v)}return o(l);case p:e:{for(x=u.key;null!==c;){if(c.key===x){if(4===c.tag&&c.stateNode.containerInfo===u.containerInfo&&c.stateNode.implementation===u.implementation){r(l,c.sibling),(c=i(c,u.children||[])).return=l,l=c;break e}r(l,c);break}t(l,c),c=c.sibling}(c=aY(u,l.mode,v)).return=l,l=c}return o(l);case b:return s(l,c,(x=u._init)(u._payload),v)}if(F(u))return function(i,o,s,l){for(var c=null,u=null,h=o,f=o=0,p=null;null!==h&&f<s.length;f++){h.index>f?(p=h,h=null):p=h.sibling;var m=A(i,h,s[f],l);if(null===m){null===h&&(h=p);break}e&&h&&null===m.alternate&&t(i,h),o=a(m,o,f),null===u?c=m:u.sibling=m,u=m,h=p}if(f===s.length)return r(i,h),rC&&rg(i,f),c;if(null===h){for(;f<s.length;f++)null!==(h=d(i,s[f],l))&&(o=a(h,o,f),null===u?c=h:u.sibling=h,u=h);return rC&&rg(i,f),c}for(h=n(i,h);f<s.length;f++)null!==(p=g(h,i,f,s[f],l))&&(e&&null!==p.alternate&&h.delete(null===p.key?f:p.key),o=a(p,o,f),null===u?c=p:u.sibling=p,u=p);return e&&h.forEach(function(e){return t(i,e)}),rC&&rg(i,f),c}(l,c,u,v);if(I(u))return function(i,o,s,l){var c=I(s);if("function"!=typeof c)throw Error(h(150));if(null==(s=c.call(s)))throw Error(h(151));for(var u=c=null,f=o,p=o=0,m=null,v=s.next();null!==f&&!v.done;p++,v=s.next()){f.index>p?(m=f,f=null):m=f.sibling;var y=A(i,f,v.value,l);if(null===y){null===f&&(f=m);break}e&&f&&null===y.alternate&&t(i,f),o=a(y,o,p),null===u?c=y:u.sibling=y,u=y,f=m}if(v.done)return r(i,f),rC&&rg(i,p),c;if(null===f){for(;!v.done;p++,v=s.next())null!==(v=d(i,v.value,l))&&(o=a(v,o,p),null===u?c=v:u.sibling=v,u=v);return rC&&rg(i,p),c}for(f=n(i,f);!v.done;p++,v=s.next())null!==(v=g(f,i,p,v.value,l))&&(e&&null!==v.alternate&&f.delete(null===v.key?p:v.key),o=a(v,o,p),null===u?c=v:u.sibling=v,u=v);return e&&f.forEach(function(e){return t(i,e)}),rC&&rg(i,p),c}(l,c,u,v);rz(l,u)}return"string"==typeof u&&""!==u||"number"==typeof u?(u=""+u,null!==c&&6===c.tag?(r(l,c.sibling),(c=i(c,u)).return=l):(r(l,c),(c=aj(u,l.mode,v)).return=l),o(l=c)):r(l,c)}}var rL=rQ(!0),rk=rQ(!1),rU={},rN=e9(rU),rG=e9(rU),rH=e9(rU);function rV(e){if(e===rU)throw Error(h(174));return e}function rj(e,t){te(rH,t),te(rG,e),te(rN,rU),e=O(t),e7(rN),te(rN,e)}function rY(){e7(rN),e7(rG),e7(rH)}function rJ(e){var t=rV(rH.current),r=rV(rN.current);t=Q(r,e.type,t),r!==t&&(te(rG,e),te(rN,t))}function rW(e){rG.current===e&&(e7(rN),e7(rG))}var rq=e9(0);function rK(e){for(var t=e;null!==t;){if(13===t.tag){var r=t.memoizedState;if(null!==r&&(null===(r=r.dehydrated)||eL(r)||ek(r)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!=(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var rX=[];function rZ(){for(var e=0;e<rX.length;e++){var t=rX[e];q?t._workInProgressVersionPrimary=null:t._workInProgressVersionSecondary=null}rX.length=0}var r$=d.ReactCurrentDispatcher,r0=d.ReactCurrentBatchConfig,r1=0,r2=null,r3=null,r4=null,r5=!1,r6=!1,r8=0,r9=0;function r7(){throw Error(h(321))}function ne(e,t){if(null===t)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!tO(e[r],t[r]))return!1;return!0}function nt(e,t,r,n,i,a){if(r1=a,r2=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,r$.current=null===e||null===e.memoizedState?nQ:nL,e=r(n,i),r6){a=0;do{if(r6=!1,r8=0,25<=a)throw Error(h(301));a+=1,r4=r3=null,t.updateQueue=null,r$.current=nk,e=r(n,i)}while(r6)}if(r$.current=nO,t=null!==r3&&null!==r3.next,r1=0,r4=r3=r2=null,r5=!1,t)throw Error(h(300));return e}function nr(){var e=0!==r8;return r8=0,e}function nn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===r4?r2.memoizedState=r4=e:r4=r4.next=e,r4}function ni(){if(null===r3){var e=r2.alternate;e=null!==e?e.memoizedState:null}else e=r3.next;var t=null===r4?r2.memoizedState:r4.next;if(null!==t)r4=t,r3=e;else{if(null===e)throw Error(h(310));e={memoizedState:(r3=e).memoizedState,baseState:r3.baseState,baseQueue:r3.baseQueue,queue:r3.queue,next:null},null===r4?r2.memoizedState=r4=e:r4=r4.next=e}return r4}function na(e,t){return"function"==typeof t?t(e):t}function no(e){var t=ni(),r=t.queue;if(null===r)throw Error(h(311));r.lastRenderedReducer=e;var n=r3,i=n.baseQueue,a=r.pending;if(null!==a){if(null!==i){var o=i.next;i.next=a.next,a.next=o}n.baseQueue=i=a,r.pending=null}if(null!==i){a=i.next,n=n.baseState;var s=o=null,l=null,c=a;do{var u=c.lane;if((r1&u)===u)null!==l&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===l?(s=l=d,o=n):l=l.next=d,r2.lanes|=u,i3|=u}c=c.next}while(null!==c&&c!==a);null===l?o=n:l.next=s,tO(n,t.memoizedState)||(n0=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=l,r.lastRenderedState=n}if(null!==(e=r.interleaved)){i=e;do a=i.lane,r2.lanes|=a,i3|=a,i=i.next;while(i!==e)}else null===i&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function ns(e){var t=ni(),r=t.queue;if(null===r)throw Error(h(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,a=t.memoizedState;if(null!==i){r.pending=null;var o=i=i.next;do a=e(a,o.action),o=o.next;while(o!==i);tO(a,t.memoizedState)||(n0=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function nl(){}function nc(e,t){var r=r2,n=ni(),i=t(),a=!tO(n.memoizedState,i);if(a&&(n.memoizedState=i,n0=!0),n=n.queue,nx(nd.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||null!==r4&&1&r4.memoizedState.tag){if(r.flags|=2048,nm(9,nh.bind(null,r,n,i,t),void 0,null),null===iK)throw Error(h(349));0!=(30&r1)||nu(r,t,i)}return i}function nu(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},null===(t=r2.updateQueue)?(t={lastEffect:null,stores:null},r2.updateQueue=t,t.stores=[e]):null===(r=t.stores)?t.stores=[e]:r.push(e)}function nh(e,t,r,n){t.value=r,t.getSnapshot=n,nf(t)&&af(e,1,-1)}function nd(e,t,r){return r(function(){nf(t)&&af(e,1,-1)})}function nf(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!tO(e,r)}catch(e){return!0}}function np(e){var t=nn();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:na,lastRenderedState:e},t.queue=e,e=e.dispatch=nP.bind(null,r2,e),[t.memoizedState,e]}function nm(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},null===(t=r2.updateQueue)?(t={lastEffect:null,stores:null},r2.updateQueue=t,t.lastEffect=e.next=e):null===(r=t.lastEffect)?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e),e}function nA(){return ni().memoizedState}function ng(e,t,r,n){var i=nn();r2.flags|=e,i.memoizedState=nm(1|t,r,void 0,void 0===n?null:n)}function nv(e,t,r,n){var i=ni();n=void 0===n?null:n;var a=void 0;if(null!==r3){var o=r3.memoizedState;if(a=o.destroy,null!==n&&ne(n,o.deps)){i.memoizedState=nm(t,r,a,n);return}}r2.flags|=e,i.memoizedState=nm(1|t,r,a,n)}function ny(e,t){return ng(8390656,8,e,t)}function nx(e,t){return nv(2048,8,e,t)}function nE(e,t){return nv(4,2,e,t)}function n_(e,t){return nv(4,4,e,t)}function nC(e,t){return"function"==typeof t?(t(e=e()),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function nb(e,t,r){return r=null!=r?r.concat([e]):null,nv(4,4,nC.bind(null,t,e),r)}function nw(){}function nB(e,t){var r=ni();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&ne(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function nI(e,t){var r=ni();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&ne(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function nM(e,t){var r=tC;tC=0!==r&&4>r?r:4,e(!0);var n=r0.transition;r0.transition={};try{e(!1),t()}finally{tC=r,r0.transition=n}}function nS(){return ni().memoizedState}function nT(e,t,r){var n=ad(e);r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},nD(e)?nR(t,r):(nF(e,t,r),null!==(e=af(e,n,r=ah()))&&nz(e,t,n))}function nP(e,t,r){var n=ad(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(nD(e))nR(t,i);else{nF(e,t,i);var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var o=t.lastRenderedState,s=a(o,r);if(i.hasEagerState=!0,i.eagerState=s,tO(s,o))return}catch(e){}finally{}null!==(e=af(e,n,r=ah()))&&nz(e,t,n)}}function nD(e){var t=e.alternate;return e===r2||null!==t&&t===r2}function nR(e,t){r6=r5=!0;var r=e.pending;null===r?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function nF(e,t,r){null!==iK&&0!=(1&e.mode)&&0==(2&iq)?(null===(e=t.interleaved)?(r.next=r,null===t1?t1=[t]:t1.push(t)):(r.next=e.next,e.next=r),t.interleaved=r):(null===(e=t.pending)?r.next=r:(r.next=e.next,e.next=r),t.pending=r)}function nz(e,t,r){if(0!=(4194240&r)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,t_(e,r)}}var nO={readContext:t0,useCallback:r7,useContext:r7,useEffect:r7,useImperativeHandle:r7,useInsertionEffect:r7,useLayoutEffect:r7,useMemo:r7,useReducer:r7,useRef:r7,useState:r7,useDebugValue:r7,useDeferredValue:r7,useTransition:r7,useMutableSource:r7,useSyncExternalStore:r7,useId:r7,unstable_isNewReconciler:!1},nQ={readContext:t0,useCallback:function(e,t){return nn().memoizedState=[e,void 0===t?null:t],e},useContext:t0,useEffect:ny,useImperativeHandle:function(e,t,r){return r=null!=r?r.concat([e]):null,ng(4194308,4,nC.bind(null,t,e),r)},useLayoutEffect:function(e,t){return ng(4194308,4,e,t)},useInsertionEffect:function(e,t){return ng(4,2,e,t)},useMemo:function(e,t){var r=nn();return t=void 0===t?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=nn();return t=void 0!==r?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=nT.bind(null,r2,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},nn().memoizedState=e},useState:np,useDebugValue:nw,useDeferredValue:function(e){var t=np(e),r=t[0],n=t[1];return ny(function(){var t=r0.transition;r0.transition={};try{n(e)}finally{r0.transition=t}},[e]),r},useTransition:function(){var e=np(!1),t=e[0];return e=nM.bind(null,e[1]),nn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=r2,i=nn();if(rC){if(void 0===r)throw Error(h(407));r=r()}else{if(r=t(),null===iK)throw Error(h(349));0!=(30&r1)||nu(n,t,r)}i.memoizedState=r;var a={value:r,getSnapshot:t};return i.queue=a,ny(nd.bind(null,n,a,e),[e]),n.flags|=2048,nm(9,nh.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=nn(),t=iK.identifierPrefix;if(rC){var r=rA,n=rm;t=":"+t+"R"+(r=(n&~(1<<32-td(n)-1)).toString(32)+r),0<(r=r8++)&&(t+="H"+r.toString(32)),t+=":"}else t=":"+t+"r"+(r=r9++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},nL={readContext:t0,useCallback:nB,useContext:t0,useEffect:nx,useImperativeHandle:nb,useInsertionEffect:nE,useLayoutEffect:n_,useMemo:nI,useReducer:no,useRef:nA,useState:function(){return no(na)},useDebugValue:nw,useDeferredValue:function(e){var t=no(na),r=t[0],n=t[1];return nx(function(){var t=r0.transition;r0.transition={};try{n(e)}finally{r0.transition=t}},[e]),r},useTransition:function(){return[no(na)[0],ni().memoizedState]},useMutableSource:nl,useSyncExternalStore:nc,useId:nS,unstable_isNewReconciler:!1},nk={readContext:t0,useCallback:nB,useContext:t0,useEffect:nx,useImperativeHandle:nb,useInsertionEffect:nE,useLayoutEffect:n_,useMemo:nI,useReducer:ns,useRef:nA,useState:function(){return ns(na)},useDebugValue:nw,useDeferredValue:function(e){var t=ns(na),r=t[0],n=t[1];return nx(function(){var t=r0.transition;r0.transition={};try{n(e)}finally{r0.transition=t}},[e]),r},useTransition:function(){return[ns(na)[0],ni().memoizedState]},useMutableSource:nl,useSyncExternalStore:nc,useId:nS,unstable_isNewReconciler:!1};function nU(e,t){try{var r="",n=t;do r+=function(e){switch(e.tag){case 5:return e2(e.type);case 16:return e2("Lazy");case 13:return e2("Suspense");case 19:return e2("SuspenseList");case 0:case 2:case 15:return e=e4(e.type,!1);case 11:return e=e4(e.type.render,!1);case 1:return e=e4(e.type,!0);default:return""}}(n),n=n.return;while(n);var i=r}catch(e){i="\nError generating stack: "+e.message+"\n"+e.stack}return{value:e,source:t,stack:i}}function nN(e,t){try{console.error(t.value)}catch(e){setTimeout(function(){throw e})}}var nG="function"==typeof WeakMap?WeakMap:Map;function nH(e,t,r){(r=t5(-1,r)).tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){at||(at=!0,ar=n),nN(e,t)},r}function nV(e,t,r){(r=t5(-1,r)).tag=3;var n=e.type.getDerivedStateFromError;if("function"==typeof n){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){nN(e,t)}}var a=e.stateNode;return null!==a&&"function"==typeof a.componentDidCatch&&(r.callback=function(){nN(e,t),"function"!=typeof n&&(null===an?an=new Set([this]):an.add(this));var r=t.stack;this.componentDidCatch(t.value,{componentStack:null!==r?r:""})}),r}function nj(e,t,r){var n=e.pingCache;if(null===n){n=e.pingCache=new nG;var i=new Set;n.set(t,i)}else void 0===(i=n.get(t))&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=aF.bind(null,e,t,r),t.then(e,e))}function nY(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function nJ(e,t,r,n,i){return 0==(1&e.mode)?e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,1===r.tag&&(null===r.alternate?r.tag=17:((t=t5(-1,1)).tag=2,t6(r,t))),r.lanes|=1):(e.flags|=65536,e.lanes=i),e}function nW(e){e.flags|=4}function nq(e,t){if(null!==e&&e.child===t.child)return!0;if(0!=(16&t.flags))return!1;for(e=t.child;null!==e;){if(0!=(12854&e.flags)||0!=(12854&e.subtreeFlags))return!1;e=e.sibling}return!0}if(K)t=function(e,t){for(var r=t.child;null!==r;){if(5===r.tag||6===r.tag)N(e,r.stateNode);else if(4!==r.tag&&null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}},n=function(){},i=function(e,t,r,n,i){(e=e.memoizedProps)!==n&&(r=H(t.stateNode,r,e,n,i,rV(rN.current)),(t.updateQueue=r)&&nW(t))},a=function(e,t,r,n){r!==n&&nW(t)};else if(X){t=function(e,r,n,i){for(var a=r.child;null!==a;){if(5===a.tag){var o=a.stateNode;n&&i&&(o=eR(o,a.type,a.memoizedProps,a)),N(e,o)}else if(6===a.tag)o=a.stateNode,n&&i&&(o=eF(o,a.memoizedProps,a)),N(e,o);else if(4!==a.tag){if(22===a.tag&&null!==a.memoizedState)null!==(o=a.child)&&(o.return=a),t(e,a,!0,!0);else if(null!==a.child){a.child.return=a,a=a.child;continue}}if(a===r)break;for(;null===a.sibling;){if(null===a.return||a.return===r)return;a=a.return}a.sibling.return=a.return,a=a.sibling}};var nK=function(e,t,r,n){for(var i=t.child;null!==i;){if(5===i.tag){var a=i.stateNode;r&&n&&(a=eR(a,i.type,i.memoizedProps,i)),eT(e,a)}else if(6===i.tag)a=i.stateNode,r&&n&&(a=eF(a,i.memoizedProps,i)),eT(e,a);else if(4!==i.tag){if(22===i.tag&&null!==i.memoizedState)null!==(a=i.child)&&(a.return=i),nK(e,i,!0,!0);else if(null!==i.child){i.child.return=i,i=i.child;continue}}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}};n=function(e,t){var r=t.stateNode;if(!nq(e,t)){var n=eS(e=r.containerInfo);nK(n,t,!1,!1),r.pendingChildren=n,nW(t),eP(e,n)}},i=function(e,r,n,i,a){var o=e.stateNode,s=e.memoizedProps;if((e=nq(e,r))&&s===i)r.stateNode=o;else{var l=r.stateNode,c=rV(rN.current),u=null;s!==i&&(u=H(l,n,s,i,a,c)),e&&null===u?r.stateNode=o:(G(o=eM(o,u,n,s,i,r,e,l),n,i,a,c)&&nW(r),r.stateNode=o,e?nW(r):t(o,r,!1,!1))}},a=function(e,t,r,n){r!==n?(e=rV(rH.current),r=rV(rN.current),t.stateNode=j(n,e,r,t),nW(t)):t.stateNode=e.stateNode}}else n=function(){},i=function(){},a=function(){};function nX(e,t){if(!rC)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;null!==t;)null!==t.alternate&&(r=t),t=t.sibling;null===r?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;null!==r;)null!==r.alternate&&(n=r),r=r.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function nZ(e){var t=null!==e.alternate&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;null!==i;)r|=i.lanes|i.childLanes,n|=14680064&i.subtreeFlags,n|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}var n$=d.ReactCurrentOwner,n0=!1;function n1(e,t,r,n){t.child=null===e?rk(t,null,r,n):rL(t,e.child,r,n)}function n2(e,t,r,n,i){r=r.render;var a=t.ref;return(t$(t,i),n=nt(e,t,r,n,a,i),r=nr(),null===e||n0)?(rC&&r&&ry(t),t.flags|=1,n1(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,ih(e,t,i))}function n3(e,t,r,n,i){if(null===e){var a=r.type;return"function"!=typeof a||aU(a)||void 0!==a.defaultProps||null!==r.compare||void 0!==r.defaultProps?((e=aG(r.type,null,n,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,n4(e,t,a,n,i))}if(a=e.child,0==(e.lanes&i)){var o=a.memoizedProps;if((r=null!==(r=r.compare)?r:tH)(o,n)&&e.ref===t.ref)return ih(e,t,i)}return t.flags|=1,(e=aN(a,n)).ref=t.ref,e.return=t,t.child=e}function n4(e,t,r,n,i){if(null!==e&&tH(e.memoizedProps,n)&&e.ref===t.ref){if(n0=!1,0==(e.lanes&i))return t.lanes=e.lanes,ih(e,t,i);0!=(131072&e.flags)&&(n0=!0)}return n8(e,t,r,n,i)}function n5(e,t,r){var n=t.pendingProps,i=n.children,a=null!==e?e.memoizedState:null;if("hidden"===n.mode){if(0==(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null},te(i0,i$),i$|=r;else{if(0==(1073741824&r))return e=null!==a?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null},t.updateQueue=null,te(i0,i$),i$|=e,null;t.memoizedState={baseLanes:0,cachePool:null},n=null!==a?a.baseLanes:r,te(i0,i$),i$|=n}}else null!==a?(n=a.baseLanes|r,t.memoizedState=null):n=r,te(i0,i$),i$|=n;return n1(e,t,i,r),t.child}function n6(e,t){var r=t.ref;(null===e&&null!==r||null!==e&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function n8(e,t,r,n,i){var a=to(r)?ti:tr.current;return(a=ta(t,a),t$(t,i),r=nt(e,t,r,n,a,i),n=nr(),null===e||n0)?(rC&&n&&ry(t),t.flags|=1,n1(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,ih(e,t,i))}function n9(e,t,r,n,i){if(to(r)){var a=!0;tu(t)}else a=!1;if(t$(t,i),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),ra(t,r,n),rs(t,r,n,i),n=!0;else if(null===e){var o=t.stateNode,s=t.memoizedProps;o.props=s;var l=o.context,c=r.contextType;c="object"==typeof c&&null!==c?t0(c):ta(t,c=to(r)?ti:tr.current);var u=r.getDerivedStateFromProps,h="function"==typeof u||"function"==typeof o.getSnapshotBeforeUpdate;h||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||(s!==n||l!==c)&&ro(t,o,n,c),t2=!1;var d=t.memoizedState;o.state=d,t7(t,n,o,i),l=t.memoizedState,s!==n||d!==l||tn.current||t2?("function"==typeof u&&(rr(t,r,u,n),l=t.memoizedState),(s=t2||ri(t,r,s,n,d,l,c))?(h||"function"!=typeof o.UNSAFE_componentWillMount&&"function"!=typeof o.componentWillMount||("function"==typeof o.componentWillMount&&o.componentWillMount(),"function"==typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"==typeof o.componentDidMount&&(t.flags|=4194308)):("function"==typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),o.props=n,o.state=l,o.context=c,n=s):("function"==typeof o.componentDidMount&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,t4(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:tV(t.type,s),o.props=c,h=t.pendingProps,d=o.context,l="object"==typeof(l=r.contextType)&&null!==l?t0(l):ta(t,l=to(r)?ti:tr.current);var f=r.getDerivedStateFromProps;(u="function"==typeof f||"function"==typeof o.getSnapshotBeforeUpdate)||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||(s!==h||d!==l)&&ro(t,o,n,l),t2=!1,d=t.memoizedState,o.state=d,t7(t,n,o,i);var p=t.memoizedState;s!==h||d!==p||tn.current||t2?("function"==typeof f&&(rr(t,r,f,n),p=t.memoizedState),(c=t2||ri(t,r,c,n,d,p,l)||!1)?(u||"function"!=typeof o.UNSAFE_componentWillUpdate&&"function"!=typeof o.componentWillUpdate||("function"==typeof o.componentWillUpdate&&o.componentWillUpdate(n,p,l),"function"==typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(n,p,l)),"function"==typeof o.componentDidUpdate&&(t.flags|=4),"function"==typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof o.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!=typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=p),o.props=n,o.state=p,o.context=l,n=c):("function"!=typeof o.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!=typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),n=!1)}return n7(e,t,r,n,a,i)}function n7(e,t,r,n,i,a){n6(e,t);var o=0!=(128&t.flags);if(!n&&!o)return i&&th(t,r,!1),ih(e,t,a);n=t.stateNode,n$.current=t;var s=o&&"function"!=typeof r.getDerivedStateFromError?null:n.render();return t.flags|=1,null!==e&&o?(t.child=rL(t,e.child,null,a),t.child=rL(t,null,s,a)):n1(e,t,s,a),t.memoizedState=n.state,i&&th(t,r,!0),t.child}function ie(e){var t=e.stateNode;t.pendingContext?tl(e,t.pendingContext,t.pendingContext!==t.context):t.context&&tl(e,t.context,!1),rj(e,t.containerInfo)}function it(e,t,r,n,i){return rD(),rR(i),t.flags|=256,n1(e,t,r,n),t.child}var ir={dehydrated:null,treeContext:null,retryLane:0};function ii(e){return{baseLanes:e,cachePool:null}}function ia(e,t,r){var n,i,a,o,s,l,c,u,d,f,p,m,A,g,v=t.pendingProps,y=rq.current,x=!1,E=0!=(128&t.flags);if((g=E)||(g=(null===e||null!==e.memoizedState)&&0!=(2&y)),g?(x=!0,t.flags&=-129):(null===e||null!==e.memoizedState)&&(y|=1),te(rq,1&y),null===e)return(rS(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated))?(0==(1&t.mode)?t.lanes=1:ek(e)?t.lanes=8:t.lanes=1073741824,null):(y=v.children,e=v.fallback,x?(v=t.mode,x=t.child,y={mode:"hidden",children:y},0==(1&v)&&null!==x?(x.childLanes=0,x.pendingProps=y):x=aV(y,v,0,null),e=aH(e,v,r,null),x.return=t,e.return=t,x.sibling=e,t.child=x,t.child.memoizedState=ii(r),t.memoizedState=ir,e):io(t,y));if(null!==(y=e.memoizedState)&&null!==(g=y.dehydrated)){if(E)return 256&t.flags?(t.flags&=-257,is(e,t,r,Error(h(422)))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(x=v.fallback,y=t.mode,v=aV({mode:"visible",children:v.children},y,0,null),x=aH(x,y,r,null),x.flags|=2,v.return=t,x.return=t,v.sibling=x,t.child=v,0!=(1&t.mode)&&rL(t,e.child,null,r),t.child.memoizedState=ii(r),t.memoizedState=ir,x);if(0==(1&t.mode))t=is(e,t,r,null);else if(ek(g))t=is(e,t,r,Error(h(419)));else if(v=0!=(r&e.childLanes),n0||v){if(null!==(v=iK)){switch(r&-r){case 4:x=2;break;case 16:x=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:x=32;break;case 536870912:x=268435456;break;default:x=0}0!==(v=0!=(x&(v.suspendedLanes|r))?0:x)&&v!==y.retryLane&&(y.retryLane=v,af(e,v,-1))}aB(),t=is(e,t,r,Error(h(421)))}else eL(g)?(t.flags|=128,t.child=e.child,eU(g,t=aO.bind(null,e)),t=null):(r=y.treeContext,Z&&(r_=eV(g),rE=t,rC=!0,rw=null,rb=!1,null!==r&&(rd[rf++]=rm,rd[rf++]=rA,rd[rf++]=rp,rm=r.id,rA=r.overflow,rp=t)),t=io(t,t.pendingProps.children),t.flags|=4096);return t}return x?(n=e,i=t,a=v.children,o=v.fallback,s=r,l=i.mode,c=(n=n.child).sibling,u={mode:"hidden",children:a},0==(1&l)&&i.child!==n?((a=i.child).childLanes=0,a.pendingProps=u,i.deletions=null):(a=aN(n,u)).subtreeFlags=14680064&n.subtreeFlags,null!==c?o=aN(c,o):(o=aH(o,l,s,null),o.flags|=2),o.return=i,a.return=i,a.sibling=o,i.child=a,v=o,x=t.child,y=e.child.memoizedState,x.memoizedState=null===y?ii(r):{baseLanes:y.baseLanes|r,cachePool:null},x.childLanes=e.childLanes&~r,t.memoizedState=ir,v):(d=e,f=t,p=v.children,m=r,d=(A=d.child).sibling,p=aN(A,{mode:"visible",children:p}),0==(1&f.mode)&&(p.lanes=m),p.return=f,p.sibling=null,null!==d&&(null===(m=f.deletions)?(f.deletions=[d],f.flags|=16):m.push(d)),r=f.child=p,t.memoizedState=null,r)}function io(e,t){return(t=aV({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function is(e,t,r,n){return null!==n&&rR(n),rL(t,e.child,null,r),e=io(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function il(e,t,r){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),tZ(e.return,t,r)}function ic(e,t,r,n,i){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=i)}function iu(e,t,r){var n=t.pendingProps,i=n.revealOrder,a=n.tail;if(n1(e,t,n.children,r),0!=(2&(n=rq.current)))n=1&n|2,t.flags|=128;else{if(null!==e&&0!=(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&il(e,r,t);else if(19===e.tag)il(e,r,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(te(rq,n),0==(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(i=null,r=t.child;null!==r;)null!==(e=r.alternate)&&null===rK(e)&&(i=r),r=r.sibling;null===(r=i)?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),ic(t,!1,i,r,a);break;case"backwards":for(r=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===rK(e)){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}ic(t,!0,r,null,a);break;case"together":ic(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function ih(e,t,r){if(null!==e&&(t.dependencies=e.dependencies),i3|=t.lanes,0==(r&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(h(153));if(null!==t.child){for(r=aN(e=t.child,e.pendingProps),t.child=r,r.return=t;null!==e.sibling;)e=e.sibling,(r=r.sibling=aN(e,e.pendingProps)).return=t;r.sibling=null}return t.child}var id=!1,ip=!1,im="function"==typeof WeakSet?WeakSet:Set,iA=null;function ig(e,t){var r=e.ref;if(null!==r){if("function"==typeof r)try{r(null)}catch(r){aR(e,t,r)}else r.current=null}}function iv(e,t,r){try{r()}catch(r){aR(e,t,r)}}var iy=!1;function ix(e,t,r){var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var i=n=n.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,void 0!==a&&iv(t,r,a)}i=i.next}while(i!==n)}}function iE(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function i_(e){var t=e.ref;if(null!==t){var r=e.stateNode;e=5===e.tag?z(r):r,"function"==typeof t?t(e):t.current=e}}function iC(e,t,r){if(tz&&"function"==typeof tz.onCommitFiberUnmount)try{tz.onCommitFiberUnmount(tF,t)}catch(e){}switch(t.tag){case 0:case 11:case 14:case 15:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var n=e=e.next;do{var i=n,a=i.destroy;i=i.tag,void 0!==a&&(0!=(2&i)?iv(t,r,a):0!=(4&i)&&iv(t,r,a)),n=n.next}while(n!==e)}break;case 1:if(ig(t,r),"function"==typeof(e=t.stateNode).componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(e){aR(t,r,e)}break;case 5:ig(t,r);break;case 4:K?iM(e,t,r):X&&X&&(r=eS(t=t.stateNode.containerInfo),eD(t,r))}}function ib(e,t,r){for(var n=t;;)if(iC(e,n,r),null===n.child||K&&4===n.tag){if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}else n.child.return=n,n=n.child}function iw(e){return 5===e.tag||3===e.tag||4===e.tag}function iB(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||iw(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags||null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function iI(e){if(K){e:{for(var t=e.return;null!==t;){if(iw(t))break e;t=t.return}throw Error(h(160))}var r=t;switch(r.tag){case 5:t=r.stateNode,32&r.flags&&(e_(t),r.flags&=-33),r=iB(e),function e(t,r,n){var i=t.tag;if(5===i||6===i)t=t.stateNode,r?ev(n,t,r):ef(n,t);else if(4!==i&&null!==(t=t.child))for(e(t,r,n),t=t.sibling;null!==t;)e(t,r,n),t=t.sibling}(e,r,t);break;case 3:case 4:t=r.stateNode.containerInfo,r=iB(e),function e(t,r,n){var i=t.tag;if(5===i||6===i)t=t.stateNode,r?ey(n,t,r):ep(n,t);else if(4!==i&&null!==(t=t.child))for(e(t,r,n),t=t.sibling;null!==t;)e(t,r,n),t=t.sibling}(e,r,t);break;default:throw Error(h(161))}}}function iM(e,t,r){for(var n,i,a=t,o=!1;;){if(!o){o=a.return;e:for(;;){if(null===o)throw Error(h(160));switch(n=o.stateNode,o.tag){case 5:i=!1;break e;case 3:case 4:n=n.containerInfo,i=!0;break e}o=o.return}o=!0}if(5===a.tag||6===a.tag)ib(e,a,r),i?eE(n,a.stateNode):ex(n,a.stateNode);else if(18===a.tag)i?eZ(n,a.stateNode):eX(n,a.stateNode);else if(4===a.tag){if(null!==a.child){n=a.stateNode.containerInfo,i=!0,a.child.return=a,a=a.child;continue}}else if(iC(e,a,r),null!==a.child){a.child.return=a,a=a.child;continue}if(a===t)break;for(;null===a.sibling;){if(null===a.return||a.return===t)return;4===(a=a.return).tag&&(o=!1)}a.sibling.return=a.return,a=a.sibling}}function iS(e,t){if(K){switch(t.tag){case 0:case 11:case 14:case 15:ix(3,t,t.return),iE(3,t),ix(5,t,t.return);return;case 1:case 12:case 17:return;case 5:var r=t.stateNode;if(null!=r){var n=t.memoizedProps;e=null!==e?e.memoizedProps:n;var i=t.type,a=t.updateQueue;t.updateQueue=null,null!==a&&eg(r,a,i,e,n,t)}return;case 6:if(null===t.stateNode)throw Error(h(162));r=t.memoizedProps,em(t.stateNode,null!==e?e.memoizedProps:r,r);return;case 3:Z&&null!==e&&e.memoizedState.isDehydrated&&eq(t.stateNode.containerInfo);return;case 13:case 19:iT(t);return}throw Error(h(163))}switch(t.tag){case 0:case 11:case 14:case 15:ix(3,t,t.return),iE(3,t),ix(5,t,t.return);return;case 12:case 22:case 23:return;case 13:case 19:iT(t);return;case 3:Z&&null!==e&&e.memoizedState.isDehydrated&&eq(t.stateNode.containerInfo)}e:if(X){switch(t.tag){case 1:case 5:case 6:break e;case 3:case 4:eD((t=t.stateNode).containerInfo,t.pendingChildren);break e}throw Error(h(163))}}function iT(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var r=e.stateNode;null===r&&(r=e.stateNode=new im),t.forEach(function(t){var n=aQ.bind(null,e,t);r.has(t)||(r.add(t),t.then(n,n))})}}function iP(e){for(;null!==iA;){var t=iA;if(0!=(8772&t.flags)){var r=t.alternate;try{if(0!=(8772&t.flags))switch(t.tag){case 0:case 11:case 15:ip||iE(5,t);break;case 1:var n=t.stateNode;if(4&t.flags&&!ip){if(null===r)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:tV(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}}var a=t.updateQueue;null!==a&&re(t,a,n);break;case 3:var o=t.updateQueue;if(null!==o){if(r=null,null!==t.child)switch(t.child.tag){case 5:r=z(t.child.stateNode);break;case 1:r=t.child.stateNode}re(t,o,r)}break;case 5:var s=t.stateNode;null===r&&4&t.flags&&eA(s,t.type,t.memoizedProps,t);break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:break;case 13:if(Z&&null===t.memoizedState){var l=t.alternate;if(null!==l){var c=l.memoizedState;if(null!==c){var u=c.dehydrated;null!==u&&eK(u)}}}break;default:throw Error(h(163))}ip||512&t.flags&&i_(t)}catch(e){aR(t,t.return,e)}}if(t===e){iA=null;break}if(null!==(r=t.sibling)){r.return=t.return,iA=r;break}iA=t.return}}function iD(e){for(;null!==iA;){var t=iA;if(t===e){iA=null;break}var r=t.sibling;if(null!==r){r.return=t.return,iA=r;break}iA=t.return}}function iR(e){for(;null!==iA;){var t=iA;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{iE(4,t)}catch(e){aR(t,r,e)}break;case 1:var n=t.stateNode;if("function"==typeof n.componentDidMount){var i=t.return;try{n.componentDidMount()}catch(e){aR(t,i,e)}}var a=t.return;try{i_(t)}catch(e){aR(t,a,e)}break;case 5:var o=t.return;try{i_(t)}catch(e){aR(t,o,e)}}}catch(e){aR(t,t.return,e)}if(t===e){iA=null;break}var s=t.sibling;if(null!==s){s.return=t.return,iA=s;break}iA=t.return}}var iF=0,iz=1,iO=2,iQ=3,iL=4;if("function"==typeof Symbol&&Symbol.for){var ik=Symbol.for;iF=ik("selector.component"),iz=ik("selector.has_pseudo_class"),iO=ik("selector.role"),iQ=ik("selector.test_id"),iL=ik("selector.text")}function iU(e){var t=$(e);if(null!=t){if("string"!=typeof t.memoizedProps["data-testname"])throw Error(h(364));return t}if(null===(e=eo(e)))throw Error(h(362));return e.stateNode.current}function iN(e,t){switch(t.$$typeof){case iF:if(e.type===t.value)return!0;break;case iz:e:{t=t.value,e=[e,0];for(var r=0;r<e.length;){var n=e[r++],i=e[r++],a=t[i];if(5!==n.tag||!ec(n)){for(;null!=a&&iN(n,a);)a=t[++i];if(i===t.length){t=!0;break e}for(n=n.child;null!==n;)e.push(n,i),n=n.sibling}}t=!1}return t;case iO:if(5===e.tag&&eu(e.stateNode,t.value))return!0;break;case iL:if((5===e.tag||6===e.tag)&&null!==(e=el(e))&&0<=e.indexOf(t.value))return!0;break;case iQ:if(5===e.tag&&"string"==typeof(e=e.memoizedProps["data-testname"])&&e.toLowerCase()===t.value.toLowerCase())return!0;break;default:throw Error(h(365))}return!1}function iG(e){switch(e.$$typeof){case iF:return"<"+(M(e.value)||"Unknown")+">";case iz:return":has("+(iG(e)||"")+")";case iO:return'[role="'+e.value+'"]';case iL:return'"'+e.value+'"';case iQ:return'[data-testname="'+e.value+'"]';default:throw Error(h(365))}}function iH(e,t){var r=[];e=[e,0];for(var n=0;n<e.length;){var i=e[n++],a=e[n++],o=t[a];if(5!==i.tag||!ec(i)){for(;null!=o&&iN(i,o);)o=t[++a];if(a===t.length)r.push(i);else for(i=i.child;null!==i;)e.push(i,a),i=i.sibling}}return r}function iV(e,t){if(!ea)throw Error(h(363));e=iH(e=iU(e),t),t=[],e=Array.from(e);for(var r=0;r<e.length;){var n=e[r++];if(5===n.tag)ec(n)||t.push(n.stateNode);else for(n=n.child;null!==n;)e.push(n),n=n.sibling}return t}var ij=Math.ceil,iY=d.ReactCurrentDispatcher,iJ=d.ReactCurrentOwner,iW=d.ReactCurrentBatchConfig,iq=0,iK=null,iX=null,iZ=0,i$=0,i0=e9(0),i1=0,i2=null,i3=0,i4=0,i5=0,i6=null,i8=null,i9=0,i7=1/0;function ae(){i7=tS()+500}var at=!1,ar=null,an=null,ai=!1,aa=null,ao=0,as=0,al=null,ac=-1,au=0;function ah(){return 0!=(6&iq)?tS():-1!==ac?ac:ac=tS()}function ad(e){return 0==(1&e.mode)?1:0!=(2&iq)&&0!==iZ?iZ&-iZ:null!==tG.transition?(0===au&&(e=tm,0==(4194240&(tm<<=1))&&(tm=64),au=e),au):0!==(e=tC)?e:et()}function af(e,t,r){if(50<as)throw as=0,al=null,Error(h(185));var n=ap(e,t);return null===n?null:(tE(n,t,r),(0==(2&iq)||n!==iK)&&(n===iK&&(0==(2&iq)&&(i4|=t),4===i1&&ay(n,iZ)),am(n,r),1===t&&0===iq&&0==(1&e.mode)&&(ae(),tL&&tN())),n)}function ap(e,t){e.lanes|=t;var r=e.alternate;for(null!==r&&(r.lanes|=t),r=e,e=e.return;null!==e;)e.childLanes|=t,null!==(r=e.alternate)&&(r.childLanes|=t),r=e,e=e.return;return 3===r.tag?r.stateNode:null}function am(e,t){var r,n=e.callbackNode;!function(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var o=31-td(a),s=1<<o,l=i[o];-1===l?(0==(s&r)||0!=(s&n))&&(i[o]=function(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return -1}}(s,t)):l<=t&&(e.expiredLanes|=s),a&=~s}}(e,t);var i=tv(e,e===iK?iZ:0);if(0===i)null!==n&&tB(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(null!=n&&tB(n),1===t)0===e.tag?(r=ax.bind(null,e),tL=!0,tU(r)):tU(ax.bind(null,e)),en?ei(function(){0===iq&&tN()}):tw(tT,tN),n=null;else{switch(tb(i)){case 1:n=tT;break;case 4:n=tP;break;case 16:default:n=tD;break;case 536870912:n=tR}n=tw(n,aA.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function aA(e,t){if(ac=-1,au=0,0!=(6&iq))throw Error(h(327));var r=e.callbackNode;if(aP()&&e.callbackNode!==r)return null;var n=tv(e,e===iK?iZ:0);if(0===n)return null;if(0!=(30&n)||0!=(n&e.expiredLanes)||t)t=aI(e,n);else{t=n;var i=iq;iq|=2;var a=aw();for((iK!==e||iZ!==t)&&(ae(),aC(e,t));;)try{!function(){for(;null!==iX&&!tI();)aM(iX)}();break}catch(t){ab(e,t)}tq(),iY.current=a,iq=i,null!==iX?t=0:(iK=null,iZ=0,t=i1)}if(0!==t){if(2===t&&0!==(i=ty(e))&&(n=i,t=ag(e,i)),1===t)throw r=i2,aC(e,0),ay(e,n),am(e,tS()),r;if(6===t)ay(e,n);else{if(i=e.current.alternate,0==(30&n)&&!function(e){for(var t=e;;){if(16384&t.flags){var r=t.updateQueue;if(null!==r&&null!==(r=r.stores))for(var n=0;n<r.length;n++){var i=r[n],a=i.getSnapshot;i=i.value;try{if(!tO(a(),i))return!1}catch(e){return!1}}}if(r=t.child,16384&t.subtreeFlags&&null!==r)r.return=t,t=r;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=aI(e,n))&&0!==(a=ty(e))&&(n=a,t=ag(e,a)),1===t))throw r=i2,aC(e,0),ay(e,n),am(e,tS()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(h(345));case 2:case 5:aT(e,i8);break;case 3:if(ay(e,n),(130023424&n)===n&&10<(t=i9+500-tS())){if(0!==tv(e,0))break;if(((i=e.suspendedLanes)&n)!==n){ah(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Y(aT.bind(null,e,i8),t);break}aT(e,i8);break;case 4:if(ay(e,n),(4194240&n)===n)break;for(i=-1,t=e.eventTimes;0<n;){var o=31-td(n);a=1<<o,(o=t[o])>i&&(i=o),n&=~a}if(n=i,10<(n=(120>(n=tS()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*ij(n/1960))-n)){e.timeoutHandle=Y(aT.bind(null,e,i8),n);break}aT(e,i8);break;default:throw Error(h(329))}}}return am(e,tS()),e.callbackNode===r?aA.bind(null,e):null}function ag(e,t){var r=i6;return e.current.memoizedState.isDehydrated&&(aC(e,t).flags|=256),2!==(e=aI(e,t))&&(t=i8,i8=r,null!==t&&av(t)),e}function av(e){null===i8?i8=e:i8.push.apply(i8,e)}function ay(e,t){for(t&=~i5,t&=~i4,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-td(t),n=1<<r;e[r]=-1,t&=~n}}function ax(e){if(0!=(6&iq))throw Error(h(327));aP();var t=tv(e,0);if(0==(1&t))return am(e,tS()),null;var r=aI(e,t);if(0!==e.tag&&2===r){var n=ty(e);0!==n&&(t=n,r=ag(e,n))}if(1===r)throw r=i2,aC(e,0),ay(e,t),am(e,tS()),r;if(6===r)throw Error(h(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,aT(e,i8),am(e,tS()),null}function aE(e){null!==aa&&0===aa.tag&&0==(6&iq)&&aP();var t=iq;iq|=1;var r=iW.transition,n=tC;try{if(iW.transition=null,tC=1,e)return e()}finally{tC=n,iW.transition=r,0==(6&(iq=t))&&tN()}}function a_(){i$=i0.current,e7(i0)}function aC(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==W&&(e.timeoutHandle=W,J(r)),null!==iX)for(r=iX.return;null!==r;){var n=r;switch(rx(n),n.tag){case 1:null!=(n=n.type.childContextTypes)&&ts();break;case 3:rY(),e7(tn),e7(tr),rZ();break;case 5:rW(n);break;case 4:rY();break;case 13:case 19:e7(rq);break;case 10:tX(n.type._context);break;case 22:case 23:a_()}r=r.return}if(iK=e,iX=e=aN(e.current,null),iZ=i$=t,i1=0,i2=null,i5=i4=i3=0,i8=i6=null,null!==t1){for(t=0;t<t1.length;t++)if(null!==(n=(r=t1[t]).interleaved)){r.interleaved=null;var i=n.next,a=r.pending;if(null!==a){var o=a.next;a.next=i,n.next=o}r.pending=n}t1=null}return e}function ab(e,t){for(;;){var r=iX;try{if(tq(),r$.current=nO,r5){for(var n=r2.memoizedState;null!==n;){var i=n.queue;null!==i&&(i.pending=null),n=n.next}r5=!1}if(r1=0,r4=r3=r2=null,r6=!1,r8=0,iJ.current=null,null===r||null===r.return){i1=1,i2=t,iX=null;break}e:{var a=e,o=r.return,s=r,l=t;if(t=iZ,s.flags|=32768,null!==l&&"object"==typeof l&&"function"==typeof l.then){var c=l,u=s,d=u.tag;if(0==(1&u.mode)&&(0===d||11===d||15===d)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=nY(o);if(null!==p){p.flags&=-257,nJ(p,o,s,a,t),1&p.mode&&nj(a,c,t),t=p,l=c;var m=t.updateQueue;if(null===m){var A=new Set;A.add(l),t.updateQueue=A}else m.add(l);break e}if(0==(1&t)){nj(a,c,t),aB();break e}l=Error(h(426))}else if(rC&&1&s.mode){var g=nY(o);if(null!==g){0==(65536&g.flags)&&(g.flags|=256),nJ(g,o,s,a,t),rR(l);break e}}a=l,4!==i1&&(i1=2),null===i6?i6=[a]:i6.push(a),l=nU(l,s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var v=nH(s,l,t);t9(s,v);break e;case 1:a=l;var y=s.type,x=s.stateNode;if(0==(128&s.flags)&&("function"==typeof y.getDerivedStateFromError||null!==x&&"function"==typeof x.componentDidCatch&&(null===an||!an.has(x)))){s.flags|=65536,t&=-t,s.lanes|=t;var E=nV(s,a,t);t9(s,E);break e}}s=s.return}while(null!==s)}aS(r)}catch(e){t=e,iX===r&&null!==r&&(iX=r=r.return);continue}break}}function aw(){var e=iY.current;return iY.current=nO,null===e?nO:e}function aB(){(0===i1||3===i1||2===i1)&&(i1=4),null===iK||0==(268435455&i3)&&0==(268435455&i4)||ay(iK,iZ)}function aI(e,t){var r=iq;iq|=2;var n=aw();for(iK===e&&iZ===t||aC(e,t);;)try{!function(){for(;null!==iX;)aM(iX)}();break}catch(t){ab(e,t)}if(tq(),iq=r,iY.current=n,null!==iX)throw Error(h(261));return iK=null,iZ=0,i1}function aM(e){var t=o(e.alternate,e,i$);e.memoizedProps=e.pendingProps,null===t?aS(e):iX=t,iJ.current=null}function aS(e){var r=e;do{var o=r.alternate;if(e=r.return,0==(32768&r.flags)){if(null!==(o=function(e,r,o){var s=r.pendingProps;switch(rx(r),r.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return nZ(r),null;case 1:case 17:return to(r.type)&&ts(),nZ(r),null;case 3:return s=r.stateNode,rY(),e7(tn),e7(tr),rZ(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(null===e||null===e.child)&&(rP(r)?nW(r):null===e||e.memoizedState.isDehydrated&&0==(256&r.flags)||(r.flags|=1024,null!==rw&&(av(rw),rw=null))),n(e,r),nZ(r),null;case 5:rW(r),o=rV(rH.current);var l=r.type;if(null!==e&&null!=r.stateNode)i(e,r,l,s,o),e.ref!==r.ref&&(r.flags|=512,r.flags|=2097152);else{if(!s){if(null===r.stateNode)throw Error(h(166));return nZ(r),null}if(e=rV(rN.current),rP(r)){if(!Z)throw Error(h(175));e=ej(r.stateNode,r.type,r.memoizedProps,o,e,r,!rb),r.updateQueue=e,null!==e&&nW(r)}else{var c=U(l,s,o,e,r);t(c,r,!1,!1),r.stateNode=c,G(c,l,s,o,e)&&nW(r)}null!==r.ref&&(r.flags|=512,r.flags|=2097152)}return nZ(r),null;case 6:if(e&&null!=r.stateNode)a(e,r,e.memoizedProps,s);else{if("string"!=typeof s&&null===r.stateNode)throw Error(h(166));if(e=rV(rH.current),o=rV(rN.current),rP(r)){if(!Z)throw Error(h(176));if((o=eY(e=r.stateNode,s=r.memoizedProps,r,!rb))&&null!==(l=rE))switch(c=0!=(1&l.mode),l.tag){case 3:e0(l.stateNode.containerInfo,e,s,c);break;case 5:e1(l.type,l.memoizedProps,l.stateNode,e,s,c)}o&&nW(r)}else r.stateNode=j(s,e,o,r)}return nZ(r),null;case 13:if(e7(rq),s=r.memoizedState,rC&&null!==r_&&0!=(1&r.mode)&&0==(128&r.flags)){for(e=r_;e;)e=eN(e);return rD(),r.flags|=98560,r}if(null!==s&&null!==s.dehydrated){if(s=rP(r),null===e){if(!s)throw Error(h(318));if(!Z)throw Error(h(344));if(!(e=null!==(e=r.memoizedState)?e.dehydrated:null))throw Error(h(317));eJ(e,r)}else rD(),0==(128&r.flags)&&(r.memoizedState=null),r.flags|=4;return nZ(r),null}if(null!==rw&&(av(rw),rw=null),0!=(128&r.flags))return r.lanes=o,r;return s=null!==s,o=!1,null===e?rP(r):o=null!==e.memoizedState,s&&!o&&(r.child.flags|=8192,0!=(1&r.mode)&&(null===e||0!=(1&rq.current)?0===i1&&(i1=3):aB())),null!==r.updateQueue&&(r.flags|=4),nZ(r),null;case 4:return rY(),n(e,r),null===e&&ee(r.stateNode.containerInfo),nZ(r),null;case 10:return tX(r.type._context),nZ(r),null;case 19:if(e7(rq),null===(l=r.memoizedState))return nZ(r),null;if(s=0!=(128&r.flags),null===(c=l.rendering)){if(s)nX(l,!1);else{if(0!==i1||null!==e&&0!=(128&e.flags))for(e=r.child;null!==e;){if(null!==(c=rK(e))){for(r.flags|=128,nX(l,!1),null!==(e=c.updateQueue)&&(r.updateQueue=e,r.flags|=4),r.subtreeFlags=0,e=o,s=r.child;null!==s;)o=s,l=e,o.flags&=14680066,null===(c=o.alternate)?(o.childLanes=0,o.lanes=l,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=c.childLanes,o.lanes=c.lanes,o.child=c.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=c.memoizedProps,o.memoizedState=c.memoizedState,o.updateQueue=c.updateQueue,o.type=c.type,l=c.dependencies,o.dependencies=null===l?null:{lanes:l.lanes,firstContext:l.firstContext}),s=s.sibling;return te(rq,1&rq.current|2),r.child}e=e.sibling}null!==l.tail&&tS()>i7&&(r.flags|=128,s=!0,nX(l,!1),r.lanes=4194304)}}else{if(!s){if(null!==(e=rK(c))){if(r.flags|=128,s=!0,null!==(e=e.updateQueue)&&(r.updateQueue=e,r.flags|=4),nX(l,!0),null===l.tail&&"hidden"===l.tailMode&&!c.alternate&&!rC)return nZ(r),null}else 2*tS()-l.renderingStartTime>i7&&1073741824!==o&&(r.flags|=128,s=!0,nX(l,!1),r.lanes=4194304)}l.isBackwards?(c.sibling=r.child,r.child=c):(null!==(e=l.last)?e.sibling=c:r.child=c,l.last=c)}if(null!==l.tail)return r=l.tail,l.rendering=r,l.tail=r.sibling,l.renderingStartTime=tS(),r.sibling=null,e=rq.current,te(rq,s?1&e|2:1&e),r;return nZ(r),null;case 22:case 23:return a_(),s=null!==r.memoizedState,null!==e&&null!==e.memoizedState!==s&&(r.flags|=8192),s&&0!=(1&r.mode)?0!=(1073741824&i$)&&(nZ(r),K&&6&r.subtreeFlags&&(r.flags|=8192)):nZ(r),null;case 24:case 25:return null}throw Error(h(156,r.tag))}(o,r,i$))){iX=o;return}}else{if(null!==(o=function(e,t){switch(rx(t),t.tag){case 1:return to(t.type)&&ts(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return rY(),e7(tn),e7(tr),rZ(),0!=(65536&(e=t.flags))&&0==(128&e)?(t.flags=-65537&e|128,t):null;case 5:return rW(t),null;case 13:if(e7(rq),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(h(340));rD()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return e7(rq),null;case 4:return rY(),null;case 10:return tX(t.type._context),null;case 22:case 23:return a_(),null;default:return null}}(o,r))){o.flags&=32767,iX=o;return}if(null!==e)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{i1=6,iX=null;return}}if(null!==(r=r.sibling)){iX=r;return}iX=r=e}while(null!==r);0===i1&&(i1=5)}function aT(e,t){var r=tC,n=iW.transition;try{iW.transition=null,tC=1,function(e,t,r){do aP();while(null!==aa);if(0!=(6&iq))throw Error(h(327));var n=e.finishedWork,i=e.finishedLanes;if(null!==n){if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(h(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(function(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-td(r),a=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~a}}(e,a),e===iK&&(iX=iK=null,iZ=0),0==(2064&n.subtreeFlags)&&0==(2064&n.flags)||ai||(ai=!0,o=tD,s=function(){return aP(),null},tw(o,s)),a=0!=(15990&n.flags),0!=(15990&n.subtreeFlags)||a){a=iW.transition,iW.transition=null;var o,s,l,c,u=tC;tC=1;var d=iq;iq|=4,iJ.current=null,function(e,t){for(L(e.containerInfo),iA=t;null!==iA;)if(t=(e=iA).child,0!=(1028&e.subtreeFlags)&&null!==t)t.return=e,iA=t;else for(;null!==iA;){e=iA;try{var r=e.alternate;if(0!=(1024&e.flags))switch(e.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==r){var n=r.memoizedProps,i=r.memoizedState,a=e.stateNode,o=a.getSnapshotBeforeUpdate(e.elementType===e.type?n:tV(e.type,n),i);a.__reactInternalSnapshotBeforeUpdate=o}break;case 3:K&&eI(e.stateNode.containerInfo);break;default:throw Error(h(163))}}catch(t){aR(e,e.return,t)}if(null!==(t=e.sibling)){t.return=e.return,iA=t;break}iA=e.return}r=iy,iy=!1}(e,n),function(e,t){for(iA=t;null!==iA;){var r=(t=iA).deletions;if(null!==r)for(var n=0;n<r.length;n++){var i=r[n];try{var a=e;K?iM(a,i,t):ib(a,i,t);var o=i.alternate;null!==o&&(o.return=null),i.return=null}catch(e){aR(i,t,e)}}if(r=t.child,0!=(12854&t.subtreeFlags)&&null!==r)r.return=t,iA=r;else for(;null!==iA;){t=iA;try{var s=t.flags;if(32&s&&K&&e_(t.stateNode),512&s){var l=t.alternate;if(null!==l){var c=l.ref;null!==c&&("function"==typeof c?c(null):c.current=null)}}if(8192&s)switch(t.tag){case 13:if(null!==t.memoizedState){var u=t.alternate;(null===u||null===u.memoizedState)&&(i9=tS())}break;case 22:var h=null!==t.memoizedState,d=t.alternate,f=null!==d&&null!==d.memoizedState;if(r=t,K){e:if(n=r,i=h,a=null,K)for(var p=n;;){if(5===p.tag){if(null===a){a=p;var m=p.stateNode;i?eC(m):ew(p.stateNode,p.memoizedProps)}}else if(6===p.tag){if(null===a){var A=p.stateNode;i?eb(A):eB(A,p.memoizedProps)}}else if((22!==p.tag&&23!==p.tag||null===p.memoizedState||p===n)&&null!==p.child){p.child.return=p,p=p.child;continue}if(p===n)break;for(;null===p.sibling;){if(null===p.return||p.return===n)break e;a===p&&(a=null),p=p.return}a===p&&(a=null),p.sibling.return=p.return,p=p.sibling}}if(h&&!f&&0!=(1&r.mode)){iA=r;for(var g=r.child;null!==g;){for(r=iA=g;null!==iA;){var v=(n=iA).child;switch(n.tag){case 0:case 11:case 14:case 15:ix(4,n,n.return);break;case 1:ig(n,n.return);var y=n.stateNode;if("function"==typeof y.componentWillUnmount){var x=n.return;try{y.props=n.memoizedProps,y.state=n.memoizedState,y.componentWillUnmount()}catch(e){aR(n,x,e)}}break;case 5:ig(n,n.return);break;case 22:if(null!==n.memoizedState){iD(r);continue}}null!==v?(v.return=n,iA=v):iD(r)}g=g.sibling}}}switch(4102&s){case 2:iI(t),t.flags&=-3;break;case 6:iI(t),t.flags&=-3,iS(t.alternate,t);break;case 4096:t.flags&=-4097;break;case 4100:t.flags&=-4097,iS(t.alternate,t);break;case 4:iS(t.alternate,t)}}catch(e){aR(t,t.return,e)}if(null!==(r=t.sibling)){r.return=t.return,iA=r;break}iA=t.return}}}(e,n,i),k(e.containerInfo),e.current=n,l=n,c=e,iA=l,function e(t,r,n){for(var i=0!=(1&t.mode);null!==iA;){var a=iA,o=a.child;if(22===a.tag&&i){var s=null!==a.memoizedState||id;if(!s){var l=a.alternate,c=null!==l&&null!==l.memoizedState||ip;l=id;var u=ip;if(id=s,(ip=c)&&!u)for(iA=a;null!==iA;)c=(s=iA).child,22===s.tag&&null!==s.memoizedState?iR(a):null!==c?(c.return=s,iA=c):iR(a);for(;null!==o;)iA=o,e(o,r,n),o=o.sibling;iA=a,id=l,ip=u}iP(t,r,n)}else 0!=(8772&a.subtreeFlags)&&null!==o?(o.return=a,iA=o):iP(t,r,n)}}(l,c,i),tM(),iq=d,tC=u,iW.transition=a}else e.current=n;if(ai&&(ai=!1,aa=e,ao=i),0===(a=e.pendingLanes)&&(an=null),function(e){if(tz&&"function"==typeof tz.onCommitFiberRoot)try{tz.onCommitFiberRoot(tF,e,void 0,128==(128&e.current.flags))}catch(e){}}(n.stateNode,r),am(e,tS()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)r(t[n]);if(at)throw at=!1,e=ar,ar=null,e;0!=(1&ao)&&0!==e.tag&&aP(),0!=(1&(a=e.pendingLanes))?e===al?as++:(as=0,al=e):as=0,tN()}}(e,t,r)}finally{iW.transition=n,tC=r}return null}function aP(){if(null!==aa){var e=tb(ao),t=iW.transition,r=tC;try{if(iW.transition=null,tC=16>e?16:e,null===aa)var n=!1;else{if(e=aa,aa=null,ao=0,0!=(6&iq))throw Error(h(331));var i=iq;for(iq|=4,iA=e.current;null!==iA;){var a=iA,o=a.child;if(0!=(16&iA.flags)){var s=a.deletions;if(null!==s){for(var l=0;l<s.length;l++){var c=s[l];for(iA=c;null!==iA;){var u=iA;switch(u.tag){case 0:case 11:case 15:ix(8,u,a)}var d=u.child;if(null!==d)d.return=u,iA=d;else for(;null!==iA;){var f=(u=iA).sibling,p=u.return;if(!function e(t){var r=t.alternate;null!==r&&(t.alternate=null,e(r)),t.child=null,t.deletions=null,t.sibling=null,5===t.tag&&null!==(r=t.stateNode)&&er(r),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}(u),u===c){iA=null;break}if(null!==f){f.return=p,iA=f;break}iA=p}}}var m=a.alternate;if(null!==m){var A=m.child;if(null!==A){m.child=null;do{var g=A.sibling;A.sibling=null,A=g}while(null!==A)}}iA=a}}if(0!=(2064&a.subtreeFlags)&&null!==o)o.return=a,iA=o;else for(;null!==iA;){if(a=iA,0!=(2048&a.flags))switch(a.tag){case 0:case 11:case 15:ix(9,a,a.return)}var v=a.sibling;if(null!==v){v.return=a.return,iA=v;break}iA=a.return}}var y=e.current;for(iA=y;null!==iA;){var x=(o=iA).child;if(0!=(2064&o.subtreeFlags)&&null!==x)x.return=o,iA=x;else for(o=y;null!==iA;){if(s=iA,0!=(2048&s.flags))try{switch(s.tag){case 0:case 11:case 15:iE(9,s)}}catch(e){aR(s,s.return,e)}if(s===o){iA=null;break}var E=s.sibling;if(null!==E){E.return=s.return,iA=E;break}iA=s.return}}if(iq=i,tN(),tz&&"function"==typeof tz.onPostCommitFiberRoot)try{tz.onPostCommitFiberRoot(tF,e)}catch(e){}n=!0}return n}finally{tC=r,iW.transition=t}}return!1}function aD(e,t,r){t=nH(e,t=nU(r,t),1),t6(e,t),t=ah(),null!==(e=ap(e,1))&&(tE(e,1,t),am(e,t))}function aR(e,t,r){if(3===e.tag)aD(e,e,r);else for(;null!==t;){if(3===t.tag){aD(t,e,r);break}if(1===t.tag){var n=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof n.componentDidCatch&&(null===an||!an.has(n))){e=nV(t,e=nU(r,e),1),t6(t,e),e=ah(),null!==(t=ap(t,1))&&(tE(t,1,e),am(t,e));break}}t=t.return}}function aF(e,t,r){var n=e.pingCache;null!==n&&n.delete(t),t=ah(),e.pingedLanes|=e.suspendedLanes&r,iK===e&&(iZ&r)===r&&(4===i1||3===i1&&(130023424&iZ)===iZ&&500>tS()-i9?aC(e,0):i5|=r),am(e,t)}function az(e,t){0===t&&(0==(1&e.mode)?t=1:(t=tA,0==(130023424&(tA<<=1))&&(tA=4194304)));var r=ah();null!==(e=ap(e,t))&&(tE(e,t,r),am(e,r))}function aO(e){var t=e.memoizedState,r=0;null!==t&&(r=t.retryLane),az(e,r)}function aQ(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;null!==i&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(h(314))}null!==n&&n.delete(t),az(e,r)}function aL(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ak(e,t,r,n){return new aL(e,t,r,n)}function aU(e){return!(!(e=e.prototype)||!e.isReactComponent)}function aN(e,t){var r=e.alternate;return null===r?((r=ak(e.tag,t,e.key,e.mode)).elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=14680064&e.flags,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function aG(e,t,r,n,i,a){var o=2;if(n=e,"function"==typeof e)aU(e)&&(o=1);else if("string"==typeof e)o=5;else e:switch(e){case m:return aH(r.children,i,a,t);case A:o=8,i|=8;break;case g:return(e=ak(12,r,t,2|i)).elementType=g,e.lanes=a,e;case E:return(e=ak(13,r,t,i)).elementType=E,e.lanes=a,e;case _:return(e=ak(19,r,t,i)).elementType=_,e.lanes=a,e;case w:return aV(r,i,a,t);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case v:o=10;break e;case y:o=9;break e;case x:o=11;break e;case C:o=14;break e;case b:o=16,n=null;break e}throw Error(h(130,null==e?e:typeof e,""))}return(t=ak(o,r,t,i)).elementType=e,t.type=n,t.lanes=a,t}function aH(e,t,r,n){return(e=ak(7,e,n,t)).lanes=r,e}function aV(e,t,r,n){return(e=ak(22,e,n,t)).elementType=w,e.lanes=r,e.stateNode={},e}function aj(e,t,r){return(e=ak(6,e,null,t)).lanes=r,e}function aY(e,t,r){return(t=ak(4,null!==e.children?e.children:[],e.key,t)).lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function aJ(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=W,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=tx(0),this.expirationTimes=tx(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=tx(0),this.identifierPrefix=n,this.onRecoverableError=i,Z&&(this.mutableSourceEagerHydrationData=null)}function aW(e,t,r,n,i,a,o,s,l){return e=new aJ(e,t,r,s,l),1===t?(t=1,!0===a&&(t|=8)):t=0,a=ak(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null},t3(a),e}function aq(e){if(!e)return tt;e=e._reactInternals;e:{if(S(e)!==e||1!==e.tag)throw Error(h(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(to(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(h(171))}if(1===e.tag){var r=e.type;if(to(r))return tc(e,r,t)}return t}function aK(e){var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(h(188));throw Error(h(268,e=Object.keys(e).join(",")))}return null===(e=D(t))?null:e.stateNode}function aX(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var r=e.retryLane;e.retryLane=0!==r&&r<t?r:t}}function aZ(e,t){aX(e,t),(e=e.alternate)&&aX(e,t)}function a$(e){return null===(e=D(e))?null:e.stateNode}function a0(){return null}return o=function(e,t,r){if(null!==e){if(e.memoizedProps!==t.pendingProps||tn.current)n0=!0;else{if(0==(e.lanes&r)&&0==(128&t.flags))return n0=!1,function(e,t,r){switch(t.tag){case 3:ie(t),rD();break;case 5:rJ(t);break;case 1:to(t.type)&&tu(t);break;case 4:rj(t,t.stateNode.containerInfo);break;case 10:tK(t,t.type._context,t.memoizedProps.value);break;case 13:var n=t.memoizedState;if(null!==n){if(null!==n.dehydrated)return te(rq,1&rq.current),t.flags|=128,null;if(0!=(r&t.child.childLanes))return ia(e,t,r);return te(rq,1&rq.current),null!==(e=ih(e,t,r))?e.sibling:null}te(rq,1&rq.current);break;case 19:if(n=0!=(r&t.childLanes),0!=(128&e.flags)){if(n)return iu(e,t,r);t.flags|=128}var i=t.memoizedState;if(null!==i&&(i.rendering=null,i.tail=null,i.lastEffect=null),te(rq,rq.current),!n)return null;break;case 22:case 23:return t.lanes=0,n5(e,t,r)}return ih(e,t,r)}(e,t,r);n0=0!=(131072&e.flags)}}else n0=!1,rC&&0!=(1048576&t.flags)&&rv(t,rh,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps;var i=ta(t,tr.current);t$(t,r),i=nt(null,t,n,e,i,r);var a=nr();return t.flags|=1,"object"==typeof i&&null!==i&&"function"==typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,to(n)?(a=!0,tu(t)):a=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,t3(t),i.updater=rn,t.stateNode=i,i._reactInternals=t,rs(t,n,e,r),t=n7(null,t,n,!0,a,r)):(t.tag=0,rC&&a&&ry(t),n1(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,n=(i=n._init)(n._payload),t.type=n,i=t.tag=function(e){if("function"==typeof e)return aU(e)?1:0;if(null!=e){if((e=e.$$typeof)===x)return 11;if(e===C)return 14}return 2}(n),e=tV(n,e),i){case 0:t=n8(null,t,n,e,r);break e;case 1:t=n9(null,t,n,e,r);break e;case 11:t=n2(null,t,n,e,r);break e;case 14:t=n3(null,t,n,tV(n.type,e),r);break e}throw Error(h(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:tV(n,i),n8(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:tV(n,i),n9(e,t,n,i,r);case 3:e:{if(ie(t),null===e)throw Error(h(387));n=t.pendingProps,i=(a=t.memoizedState).element,t4(e,t),t7(t,n,null,r);var o=t.memoizedState;if(n=o.element,Z&&a.isDehydrated){if(a={element:n,isDehydrated:!1,cache:o.cache,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=it(e,t,n,r,i=Error(h(423)));break e}if(n!==i){t=it(e,t,n,r,i=Error(h(424)));break e}for(Z&&(r_=eH(t.stateNode.containerInfo),rE=t,rC=!0,rw=null,rb=!1),r=rk(t,null,n,r),t.child=r;r;)r.flags=-3&r.flags|4096,r=r.sibling}else{if(rD(),n===i){t=ih(e,t,r);break e}n1(e,t,n,r)}t=t.child}return t;case 5:return rJ(t),null===e&&rS(t),n=t.type,i=t.pendingProps,a=null!==e?e.memoizedProps:null,o=i.children,V(n,i)?o=null:null!==a&&V(n,a)&&(t.flags|=32),n6(e,t),n1(e,t,o,r),t.child;case 6:return null===e&&rS(t),null;case 13:return ia(e,t,r);case 4:return rj(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=rL(t,null,n,r):n1(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:tV(n,i),n2(e,t,n,i,r);case 7:return n1(e,t,t.pendingProps,r),t.child;case 8:case 12:return n1(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,a=t.memoizedProps,tK(t,n,o=i.value),null!==a){if(tO(a.value,o)){if(a.children===i.children&&!tn.current){t=ih(e,t,r);break e}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){var s=a.dependencies;if(null!==s){o=a.child;for(var l=s.firstContext;null!==l;){if(l.context===n){if(1===a.tag){(l=t5(-1,r&-r)).tag=2;var c=a.updateQueue;if(null!==c){var u=(c=c.shared).pending;null===u?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}a.lanes|=r,null!==(l=a.alternate)&&(l.lanes|=r),tZ(a.return,r,t),s.lanes|=r;break}l=l.next}}else if(10===a.tag)o=a.type===t.type?null:a.child;else if(18===a.tag){if(null===(o=a.return))throw Error(h(341));o.lanes|=r,null!==(s=o.alternate)&&(s.lanes|=r),tZ(o,r,t),o=a.sibling}else o=a.child;if(null!==o)o.return=a;else for(o=a;null!==o;){if(o===t){o=null;break}if(null!==(a=o.sibling)){a.return=o.return,o=a;break}o=o.return}a=o}}n1(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,t$(t,r),n=n(i=t0(i)),t.flags|=1,n1(e,t,n,r),t.child;case 14:return i=tV(n=t.type,t.pendingProps),i=tV(n.type,i),n3(e,t,n,i,r);case 15:return n4(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:tV(n,i),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,to(n)?(e=!0,tu(t)):e=!1,t$(t,r),ra(t,n,i),rs(t,n,i,r),n7(null,t,n,!0,e,r);case 19:return iu(e,t,r);case 22:return n5(e,t,r)}throw Error(h(156,t.tag))},s.attemptContinuousHydration=function(e){13===e.tag&&(af(e,134217728,ah()),aZ(e,134217728))},s.attemptHydrationAtCurrentPriority=function(e){if(13===e.tag){var t=ah(),r=ad(e);af(e,r,t),aZ(e,r)}},s.attemptSynchronousHydration=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=tg(t.pendingLanes);0!==r&&(t_(t,1|r),am(t,tS()),0==(6&iq)&&(ae(),tN()))}break;case 13:var n=ah();aE(function(){return af(e,1,n)}),aZ(e,1)}},s.batchedUpdates=function(e,t){var r=iq;iq|=1;try{return e(t)}finally{0===(iq=r)&&(ae(),tL&&tN())}},s.createComponentSelector=function(e){return{$$typeof:iF,value:e}},s.createContainer=function(e,t,r,n,i,a,o){return aW(e,t,!1,null,r,n,i,a,o)},s.createHasPseudoClassSelector=function(e){return{$$typeof:iz,value:e}},s.createHydrationContainer=function(e,t,r,n,i,a,o,s,l){return(e=aW(r,n,!0,e,i,a,o,s,l)).context=aq(null),r=e.current,(a=t5(n=ah(),i=ad(r))).callback=null!=t?t:null,t6(r,a),e.current.lanes=i,tE(e,i,n),am(e,n),e},s.createPortal=function(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:p,key:null==n?null:""+n,children:e,containerInfo:t,implementation:r}},s.createRoleSelector=function(e){return{$$typeof:iO,value:e}},s.createTestNameSelector=function(e){return{$$typeof:iQ,value:e}},s.createTextSelector=function(e){return{$$typeof:iL,value:e}},s.deferredUpdates=function(e){var t=tC,r=iW.transition;try{return iW.transition=null,tC=16,e()}finally{tC=t,iW.transition=r}},s.discreteUpdates=function(e,t,r,n,i){var a=tC,o=iW.transition;try{return iW.transition=null,tC=1,e(t,r,n,i)}finally{tC=a,iW.transition=o,0===iq&&ae()}},s.findAllNodes=iV,s.findBoundingRects=function(e,t){if(!ea)throw Error(h(363));t=iV(e,t),e=[];for(var r=0;r<t.length;r++)e.push(es(t[r]));for(t=e.length-1;0<t;t--){r=e[t];for(var n=r.x,i=n+r.width,a=r.y,o=a+r.height,s=t-1;0<=s;s--)if(t!==s){var l=e[s],c=l.x,u=c+l.width,d=l.y,f=d+l.height;if(n>=c&&a>=d&&i<=u&&o<=f){e.splice(t,1);break}if(n!==c||r.width!==l.width||f<a||d>o){if(!(a!==d||r.height!==l.height||u<n||c>i)){c>n&&(l.width+=c-n,l.x=n),u<i&&(l.width=i-c),e.splice(t,1);break}}else{d>a&&(l.height+=d-a,l.y=a),f<o&&(l.height=o-d),e.splice(t,1);break}}}return e},s.findHostInstance=aK,s.findHostInstanceWithNoPortals=function(e){return null===(e=null!==(e=P(e))?function e(t){if(5===t.tag||6===t.tag)return t;for(t=t.child;null!==t;){if(4!==t.tag){var r=e(t);if(null!==r)return r}t=t.sibling}return null}(e):null)?null:e.stateNode},s.findHostInstanceWithWarning=function(e){return aK(e)},s.flushControlled=function(e){var t=iq;iq|=1;var r=iW.transition,n=tC;try{iW.transition=null,tC=1,e()}finally{tC=n,iW.transition=r,0===(iq=t)&&(ae(),tN())}},s.flushPassiveEffects=aP,s.flushSync=aE,s.focusWithin=function(e,t){if(!ea)throw Error(h(363));for(t=Array.from(t=iH(e=iU(e),t)),e=0;e<t.length;){var r=t[e++];if(!ec(r)){if(5===r.tag&&eh(r.stateNode))return!0;for(r=r.child;null!==r;)t.push(r),r=r.sibling}}return!1},s.getCurrentUpdatePriority=function(){return tC},s.getFindAllNodesFailureDescription=function(e,t){if(!ea)throw Error(h(363));var r=0,n=[];e=[iU(e),0];for(var i=0;i<e.length;){var a=e[i++],o=e[i++],s=t[o];if((5!==a.tag||!ec(a))&&(iN(a,s)&&(n.push(iG(s)),++o>r&&(r=o)),o<t.length))for(a=a.child;null!==a;)e.push(a,o),a=a.sibling}if(r<t.length){for(e=[];r<t.length;r++)e.push(iG(t[r]));return"findAllNodes was able to match part of the selector:\n  "+n.join(" > ")+"\n\nNo matching component was found for:\n  "+e.join(" > ")}return null},s.getPublicRootInstance=function(e){return(e=e.current).child?5===e.child.tag?z(e.child.stateNode):e.child.stateNode:null},s.injectIntoDevTools=function(e){if(e={bundleType:e.bundleType,version:e.version,rendererPackageName:e.rendererPackageName,rendererConfig:e.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:d.ReactCurrentDispatcher,findHostInstanceByFiber:a$,findFiberByHostInstance:e.findFiberByHostInstance||a0,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},"undefined"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)e=!1;else{var t=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(t.isDisabled||!t.supportsFiber)e=!0;else{try{tF=t.inject(e),tz=t}catch(e){}e=!!t.checkDCE}}return e},s.isAlreadyRendering=function(){return!1},s.observeVisibleRects=function(e,t,r,n){if(!ea)throw Error(h(363));var i=ed(e=iV(e,t),r,n).disconnect;return{disconnect:function(){i()}}},s.registerMutableSourceForHydration=function(e,t){var r=t._getVersion;r=r(t._source),null==e.mutableSourceEagerHydrationData?e.mutableSourceEagerHydrationData=[t,r]:e.mutableSourceEagerHydrationData.push(t,r)},s.runWithPriority=function(e,t){var r=tC;try{return tC=e,t()}finally{tC=r}},s.shouldError=function(){return null},s.shouldSuspend=function(){return!1},s.updateContainer=function(e,t,r,n){var i=t.current,a=ah(),o=ad(i);return r=aq(r),null===t.context?t.context=r:t.pendingContext=r,(t=t5(a,o)).payload={element:e},null!==(n=void 0===n?null:n)&&(t.callback=n),t6(i,t),null!==(e=af(i,o,a))&&t8(e,i,o),o},s}},2777:function(e,t,r){"use strict";e.exports=r(4008)},1543:function(e,t,r){"use strict";e.exports=r(4185)},3361:function(e,t){"use strict";/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function r(e,t){var r=e.length;for(e.push(t);0<r;){var n=r-1>>>1,i=e[n];if(0<a(i,t))e[n]=t,e[r]=i,r=n;else break}}function n(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;for(var n=0,i=e.length,o=i>>>1;n<o;){var s=2*(n+1)-1,l=e[s],c=s+1,u=e[c];if(0>a(l,r))c<i&&0>a(u,l)?(e[n]=u,e[c]=r,n=c):(e[n]=l,e[s]=r,n=s);else if(c<i&&0>a(u,r))e[n]=u,e[c]=r,n=c;else break}}return t}function a(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var o,s=performance;t.unstable_now=function(){return s.now()}}else{var l=Date,c=l.now();t.unstable_now=function(){return l.now()-c}}var u=[],h=[],d=1,f=null,p=3,m=!1,A=!1,g=!1,v="function"==typeof setTimeout?setTimeout:null,y="function"==typeof clearTimeout?clearTimeout:null,x="undefined"!=typeof setImmediate?setImmediate:null;function E(e){for(var t=n(h);null!==t;){if(null===t.callback)i(h);else if(t.startTime<=e)i(h),t.sortIndex=t.expirationTime,r(u,t);else break;t=n(h)}}function _(e){if(g=!1,E(e),!A){if(null!==n(u))A=!0,R(C);else{var t=n(h);null!==t&&F(_,t.startTime-e)}}}function C(e,r){A=!1,g&&(g=!1,y(B),B=-1),m=!0;var a=p;try{for(E(r),f=n(u);null!==f&&(!(f.expirationTime>r)||e&&!S());){var o=f.callback;if("function"==typeof o){f.callback=null,p=f.priorityLevel;var s=o(f.expirationTime<=r);r=t.unstable_now(),"function"==typeof s?f.callback=s:f===n(u)&&i(u),E(r)}else i(u);f=n(u)}if(null!==f)var l=!0;else{var c=n(h);null!==c&&F(_,c.startTime-r),l=!1}return l}finally{f=null,p=a,m=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var b=!1,w=null,B=-1,I=5,M=-1;function S(){return!(t.unstable_now()-M<I)}function T(){if(null!==w){var e=t.unstable_now();M=e;var r=!0;try{r=w(!0,e)}finally{r?o():(b=!1,w=null)}}else b=!1}if("function"==typeof x)o=function(){x(T)};else if("undefined"!=typeof MessageChannel){var P=new MessageChannel,D=P.port2;P.port1.onmessage=T,o=function(){D.postMessage(null)}}else o=function(){v(T,0)};function R(e){w=e,b||(b=!0,o())}function F(e,r){B=v(function(){e(t.unstable_now())},r)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){A||m||(A=!0,R(C))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var r=p;p=t;try{return e()}finally{p=r}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=p;p=e;try{return t()}finally{p=r}},t.unstable_scheduleCallback=function(e,i,a){var o=t.unstable_now();switch(a="object"==typeof a&&null!==a&&"number"==typeof(a=a.delay)&&0<a?o+a:o,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return s=a+s,e={id:d++,callback:i,priorityLevel:e,startTime:a,expirationTime:s,sortIndex:-1},a>o?(e.sortIndex=a,r(h,e),null===n(u)&&e===n(h)&&(g?(y(B),B=-1):g=!0,F(_,a-o))):(e.sortIndex=s,r(u,e),A||m||(A=!0,R(C))),e},t.unstable_shouldYield=S,t.unstable_wrapCallback=function(e){var t=p;return function(){var r=p;p=t;try{return e.apply(this,arguments)}finally{p=r}}}},3932:function(e,t,r){"use strict";e.exports=r(3361)},3728:function(e){var t;t=function(){var e=function(){function t(e){return i.appendChild(e.dom),e}function r(e){for(var t=0;t<i.children.length;t++)i.children[t].style.display=t===e?"block":"none";n=e}var n=0,i=document.createElement("div");i.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",i.addEventListener("click",function(e){e.preventDefault(),r(++n%i.children.length)},!1);var a=(performance||Date).now(),o=a,s=0,l=t(new e.Panel("FPS","#0ff","#002")),c=t(new e.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var u=t(new e.Panel("MB","#f08","#201"));return r(0),{REVISION:16,dom:i,addPanel:t,showPanel:r,begin:function(){a=(performance||Date).now()},end:function(){s++;var e=(performance||Date).now();if(c.update(e-a,200),e>o+1e3&&(l.update(1e3*s/(e-o),100),o=e,s=0,u)){var t=performance.memory;u.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}return e},update:function(){a=this.end()},domElement:i,setMode:r}};return e.Panel=function(e,t,r){var n=1/0,i=0,a=Math.round,o=a(window.devicePixelRatio||1),s=80*o,l=48*o,c=3*o,u=2*o,h=3*o,d=15*o,f=74*o,p=30*o,m=document.createElement("canvas");m.width=s,m.height=l,m.style.cssText="width:80px;height:48px";var A=m.getContext("2d");return A.font="bold "+9*o+"px Helvetica,Arial,sans-serif",A.textBaseline="top",A.fillStyle=r,A.fillRect(0,0,s,l),A.fillStyle=t,A.fillText(e,c,u),A.fillRect(h,d,f,p),A.fillStyle=r,A.globalAlpha=.9,A.fillRect(h,d,f,p),{dom:m,update:function(l,g){n=Math.min(n,l),i=Math.max(i,l),A.fillStyle=r,A.globalAlpha=1,A.fillRect(0,0,s,d),A.fillStyle=t,A.fillText(a(l)+" "+e+" ("+a(n)+"-"+a(i)+")",c,u),A.drawImage(m,h+o,d,f-o,p,h,d,f-o,p),A.fillRect(h+f-o,d,o,p),A.fillStyle=r,A.globalAlpha=.9,A.fillRect(h+f-o,d,o,a((1-l/g)*p))}}},e},e.exports=t()},9429:function(e,t,r){"use strict";r.d(t,{MA:function(){return l},Rq:function(){return s},ZH:function(){return c}});let n=e=>"object"==typeof e&&"function"==typeof e.then,i=[];function a(e,t,r=(e,t)=>e===t){if(e===t)return!0;if(!e||!t)return!1;let n=e.length;if(t.length!==n)return!1;for(let i=0;i<n;i++)if(!r(e[i],t[i]))return!1;return!0}function o(e,t=null,r=!1,o={}){for(let n of(null===t&&(t=[e]),i))if(a(t,n.keys,n.equal)){if(r)return;if(Object.prototype.hasOwnProperty.call(n,"error"))throw n.error;if(Object.prototype.hasOwnProperty.call(n,"response"))return o.lifespan&&o.lifespan>0&&(n.timeout&&clearTimeout(n.timeout),n.timeout=setTimeout(n.remove,o.lifespan)),n.response;if(!r)throw n.promise}let s={keys:t,equal:o.equal,remove:()=>{let e=i.indexOf(s);-1!==e&&i.splice(e,1)},promise:(n(e)?e:e(...t)).then(e=>{s.response=e,o.lifespan&&o.lifespan>0&&(s.timeout=setTimeout(s.remove,o.lifespan))}).catch(e=>s.error=e)};if(i.push(s),!r)throw s.promise}let s=(e,t,r)=>o(e,t,!1,r),l=(e,t,r)=>void o(e,t,!0,r),c=e=>{if(void 0===e||0===e.length)i.splice(0,i.length);else{let t=i.find(t=>a(e,t.keys,t.equal));t&&t.remove()}}},7502:function(e,t,r){"use strict";r.d(t,{B$:function(){return function e(t,r){let i=function(e){let t=JSON.stringify(e,f),r=m.get(t);return null==r&&m.set(t,r=++p),r}(r),A=c.get(t);if(A||c.set(t,A=Object.create(null)),A[i])return new A[i];let g=`_onBeforeCompile${i}`,v=function(e,n){t.onBeforeCompile.call(this,e,n);let o=this.customProgramCacheKey()+"|"+e.vertexShader+"|"+e.fragmentShader,c=u[o];if(!c){let t=function(e,{vertexShader:t,fragmentShader:r},n,i){let{vertexDefs:o,vertexMainIntro:s,vertexMainOutro:l,vertexTransform:c,fragmentDefs:u,fragmentMainIntro:h,fragmentMainOutro:f,fragmentColorTransform:p,customRewriter:m,timeUniform:A}=n;if(o=o||"",s=s||"",l=l||"",u=u||"",h=h||"",f=f||"",(c||m)&&(t=a(t)),(p||m)&&(r=a(r=r.replace(/^[ \t]*#include <((?:tonemapping|encodings|fog|premultiplied_alpha|dithering)_fragment)>/gm,"\n//!BEGIN_POST_CHUNK $1\n$&\n//!END_POST_CHUNK\n"))),m){let e=m({vertexShader:t,fragmentShader:r});t=e.vertexShader,r=e.fragmentShader}if(p){let e=[];r=r.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,t=>(e.push(t),"")),f=`${p}
${e.join("\n")}
${f}`}if(A){let e=`
uniform float ${A};
`;o=e+o,u=e+u}return c&&(t=`vec3 troika_position_${i};
vec3 troika_normal_${i};
vec2 troika_uv_${i};
${t}
`,o=`${o}
void troikaVertexTransform${i}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${c}
}
`,s=`
troika_position_${i} = vec3(position);
troika_normal_${i} = vec3(normal);
troika_uv_${i} = vec2(uv);
troikaVertexTransform${i}(troika_position_${i}, troika_normal_${i}, troika_uv_${i});
${s}
`,t=t.replace(/\b(position|normal|uv)\b/g,(e,t,r,n)=>/\battribute\s+vec[23]\s+$/.test(n.substr(0,r))?t:`troika_${t}_${i}`),e.map&&e.map.channel>0||(t=t.replace(/\bMAP_UV\b/g,`troika_uv_${i}`))),{vertexShader:t=d(t,i,o,s,l),fragmentShader:r=d(r,i,u,h,f)}}(this,e,r,i);c=u[o]=t}e.vertexShader=c.vertexShader,e.fragmentShader=c.fragmentShader,s(e.uniforms,this.uniforms),r.timeUniform&&(e.uniforms[r.timeUniform]={get value(){return Date.now()-l}}),this[g]&&this[g](e)},y=function(){return x(r.chained?t:t.clone())},x=function(e){let n=Object.create(e,E);return Object.defineProperty(n,"baseMaterial",{value:t}),Object.defineProperty(n,"id",{value:h++}),n.uuid=function(){let e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,r=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(o[255&e]+o[e>>8&255]+o[e>>16&255]+o[e>>24&255]+"-"+o[255&t]+o[t>>8&255]+"-"+o[t>>16&15|64]+o[t>>24&255]+"-"+o[63&r|128]+o[r>>8&255]+"-"+o[r>>16&255]+o[r>>24&255]+o[255&n]+o[n>>8&255]+o[n>>16&255]+o[n>>24&255]).toUpperCase()}(),n.uniforms=s({},e.uniforms,r.uniforms),n.defines=s({},e.defines,r.defines),n.defines[`TROIKA_DERIVED_MATERIAL_${i}`]="",n.extensions=s({},e.extensions,r.extensions),n._listeners=void 0,n},E={constructor:{value:y},isDerivedMaterial:{value:!0},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return t.customProgramCacheKey()+"|"+i}},onBeforeCompile:{get:()=>v,set(e){this[g]=e}},copy:{writable:!0,configurable:!0,value:function(e){return t.copy.call(this,e),t.isShaderMaterial||t.isDerivedMaterial||(s(this.extensions,e.extensions),s(this.defines,e.defines),s(this.uniforms,n.UniformsUtils.clone(e.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){return x(new t.constructor).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let i=this._depthMaterial;return i||((i=this._depthMaterial=e(t.isDerivedMaterial?t.getDepthMaterial():new n.MeshDepthMaterial({depthPacking:n.RGBADepthPacking}),r)).defines.IS_DEPTH_MATERIAL="",i.uniforms=this.uniforms),i}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let i=this._distanceMaterial;return i||((i=this._distanceMaterial=e(t.isDerivedMaterial?t.getDistanceMaterial():new n.MeshDistanceMaterial,r)).defines.IS_DISTANCE_MATERIAL="",i.uniforms=this.uniforms),i}},dispose:{writable:!0,configurable:!0,value(){let{_depthMaterial:e,_distanceMaterial:r}=this;e&&e.dispose(),r&&r.dispose(),t.dispose.call(this)}}};return A[i]=y,new y}},MW:function(){return i}});var n=r(7776);let i=/\bvoid\s+main\s*\(\s*\)\s*{/g;function a(e){return e.replace(/^[ \t]*#include +<([\w\d./]+)>/gm,function(e,t){let r=n.ShaderChunk[t];return r?a(r):e})}let o=[];for(let e=0;e<256;e++)o[e]=(e<16?"0":"")+e.toString(16);let s=Object.assign||function(){let e=arguments[0];for(let t=1,r=arguments.length;t<r;t++){let r=arguments[t];if(r)for(let t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])}return e},l=Date.now(),c=new WeakMap,u=new Map,h=1e10;function d(e,t,r,n,a){return(n||a||r)&&(e=e.replace(i,`
${r}
void troikaOrigMain${t}() {`)+`
void main() {
  ${n}
  troikaOrigMain${t}();
  ${a}
}`),e}function f(e,t){return"uniforms"===e?void 0:"function"==typeof t?t.toString():t}let p=0,m=new Map;n.DoubleSide},1640:function(e,t,r){"use strict";function n(){var e=Object.create(null);function t(e,t){var r=void 0;self.troikaDefine=function(e){return r=e};var n=URL.createObjectURL(new Blob(["/** "+e.replace(/\*/g,"")+" **/\n\ntroikaDefine(\n"+t+"\n)"],{type:"application/javascript"}));try{importScripts(n)}catch(e){console.error(e)}return URL.revokeObjectURL(n),delete self.troikaDefine,r}self.addEventListener("message",function(r){var n=r.data,i=n.messageId,a=n.action,o=n.data;try{"registerModule"===a&&function r(n,i){var a=n.id,o=n.name,s=n.dependencies;void 0===s&&(s=[]);var l=n.init;void 0===l&&(l=function(){});var c=n.getTransferables;if(void 0===c&&(c=null),!e[a])try{s=s.map(function(t){return t&&t.isWorkerModule&&(r(t,function(e){if(e instanceof Error)throw e}),t=e[t.id].value),t}),l=t("<"+o+">.init",l),c&&(c=t("<"+o+">.getTransferables",c));var u=null;"function"==typeof l?u=l.apply(void 0,s):console.error("worker module init function failed to rehydrate"),e[a]={id:a,value:u,getTransferables:c},i(u)}catch(e){e&&e.noLog||console.error(e),i(e)}}(o,function(e){e instanceof Error?postMessage({messageId:i,success:!1,error:e.message}):postMessage({messageId:i,success:!0,result:{isCallable:"function"==typeof e}})}),"callModule"===a&&function(t,r){var n,i=t.id,a=t.args;e[i]&&"function"==typeof e[i].value||r(Error("Worker module "+i+": not found or its 'init' did not return a function"));try{var o=(n=e[i]).value.apply(n,a);o&&"function"==typeof o.then?o.then(s,function(e){return r(e instanceof Error?e:Error(""+e))}):s(o)}catch(e){r(e)}function s(t){try{var n=e[i].getTransferables&&e[i].getTransferables(t);n&&Array.isArray(n)&&n.length||(n=void 0),r(t,n)}catch(e){console.error(e),r(e)}}}(o,function(e,t){e instanceof Error?postMessage({messageId:i,success:!1,error:e.message}):postMessage({messageId:i,success:!0,result:e},t||void 0)})}catch(e){postMessage({messageId:i,success:!1,error:e.stack})}})}r.d(t,{Ae:function(){return h},Ch:function(){return function e(t){if((!t||"function"!=typeof t.init)&&!s)throw Error("requires `options.init` function");var r,n=t.dependencies,o=t.init,l=t.getTransferables,u=t.workerId;if(!i())return(r=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return r._getInitResult().then(function(t){if("function"==typeof t)return t.apply(void 0,e);throw Error("Worker module function was called but `init` did not return a callable function")})})._getInitResult=function(){var e=t.dependencies,n=t.init,i=Promise.all(e=Array.isArray(e)?e.map(function(e){return e&&e._getInitResult?e._getInitResult():e}):[]).then(function(e){return n.apply(null,e)});return r._getInitResult=function(){return i},i},r;null==u&&(u="#default");var h="workerModule"+ ++a,p=t.name||h,m=null;function A(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(!m){m=f(u,"registerModule",A.workerModuleData);var r=function(){m=null,c[u].delete(r)};(c[u]||(c[u]=new Set)).add(r)}return m.then(function(t){if(t.isCallable)return f(u,"callModule",{id:h,args:e});throw Error("Worker module function was called but `init` did not return a callable function")})}return n=n&&n.map(function(t){return"function"!=typeof t||t.workerModuleData||(s=!0,t=e({workerId:u,name:"<"+p+"> function dependency: "+t.name,init:"function(){return (\n"+d(t)+"\n)}"}),s=!1),t&&t.workerModuleData&&(t=t.workerModuleData),t}),A.workerModuleData={isWorkerModule:!0,id:h,name:p,dependencies:n,init:d(o),getTransferables:l&&d(l)},A}}}),r(357);var i=function(){var e=!1;if("undefined"!=typeof window&&void 0!==window.document)try{new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"}))).terminate(),e=!0}catch(e){console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+e.message+"]")}return i=function(){return e},e},a=0,o=0,s=!1,l=Object.create(null),c=Object.create(null),u=Object.create(null);function h(e){c[e]&&c[e].forEach(function(e){e()}),l[e]&&(l[e].terminate(),delete l[e])}function d(e){var t=e.toString();return!/^function/.test(t)&&/^\w+\s*\(/.test(t)&&(t="function "+t),t}function f(e,t,r){return new Promise(function(i,a){var s=++o;u[s]=function(e){e.success?i(e.result):a(Error("Error in worker "+t+" call: "+e.error))},(function(e){var t=l[e];if(!t){var r=d(n);(t=l[e]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+e.replace(/\*/g,"")+" **/\n\n;("+r+")()"],{type:"application/javascript"})))).onmessage=function(e){var t=e.data,r=t.messageId,n=u[r];if(!n)throw Error("WorkerModule response with empty or unknown messageId");delete u[r],n(t)}}return t})(e).postMessage({messageId:s,action:t,data:r})})}},4492:function(e,t,r){"use strict";/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n=r(2265),i="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},a=n.useState,o=n.useEffect,s=n.useLayoutEffect,l=n.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!i(e,r)}catch(e){return!0}}var u="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var r=t(),n=a({inst:{value:r,getSnapshot:t}}),i=n[0].inst,u=n[1];return s(function(){i.value=r,i.getSnapshot=t,c(i)&&u({inst:i})},[e,r,t]),o(function(){return c(i)&&u({inst:i}),e(function(){c(i)&&u({inst:i})})},[e]),l(r),r};t.useSyncExternalStore=void 0!==n.useSyncExternalStore?n.useSyncExternalStore:u},5107:function(e,t,r){"use strict";/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n=r(2265),i=r(554),a="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},o=i.useSyncExternalStore,s=n.useRef,l=n.useEffect,c=n.useMemo,u=n.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,r,n,i){var h=s(null);if(null===h.current){var d={hasValue:!1,value:null};h.current=d}else d=h.current;var f=o(e,(h=c(function(){function e(e){if(!l){if(l=!0,o=e,e=n(e),void 0!==i&&d.hasValue){var t=d.value;if(i(t,e))return s=t}return s=e}if(t=s,a(o,e))return t;var r=n(e);return void 0!==i&&i(t,r)?t:(o=e,s=r)}var o,s,l=!1,c=void 0===r?null:r;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]},[t,r,n,i]))[0],h[1]);return l(function(){d.hasValue=!0,d.value=f},[f]),u(f),f}},554:function(e,t,r){"use strict";e.exports=r(4492)},5006:function(e,t,r){"use strict";e.exports=r(5107)},5901:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var n=r(2265);let i="undefined"==typeof window||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent)?n.useEffect:n.useLayoutEffect;function a(e){let t="function"==typeof e?function(e){let t;let r=new Set,n=(e,n)=>{let i="function"==typeof e?e(t):e;if(i!==t){let e=t;t=n?i:Object.assign({},t,i),r.forEach(r=>r(t,e))}},i=()=>t,a=(e,n=i,a=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let o=n(t);function s(){let r=n(t);if(!a(o,r)){let t=o;e(o=r,t)}}return r.add(s),()=>r.delete(s)},o={setState:n,getState:i,subscribe:(e,t,n)=>t||n?a(e,t,n):(r.add(e),()=>r.delete(e)),destroy:()=>r.clear()};return t=e(n,i,o),o}(e):e,r=(e=t.getState,r=Object.is)=>{let a;let[,o]=(0,n.useReducer)(e=>e+1,0),s=t.getState(),l=(0,n.useRef)(s),c=(0,n.useRef)(e),u=(0,n.useRef)(r),h=(0,n.useRef)(!1),d=(0,n.useRef)();void 0===d.current&&(d.current=e(s));let f=!1;(l.current!==s||c.current!==e||u.current!==r||h.current)&&(a=e(s),f=!r(d.current,a)),i(()=>{f&&(d.current=a),l.current=s,c.current=e,u.current=r,h.current=!1});let p=(0,n.useRef)(s);i(()=>{let e=()=>{try{let e=t.getState(),r=c.current(e);u.current(d.current,r)||(l.current=e,d.current=r,o())}catch(e){h.current=!0,o()}},r=t.subscribe(e);return t.getState()!==p.current&&e(),r},[]);let m=f?a:d.current;return(0,n.useDebugValue)(m),m};return Object.assign(r,t),r[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");let e=[r,t];return{next(){let t=e.length<=0;return{value:e.shift(),done:t}}}},r}},1962:function(e,t,r){"use strict";var n=r(2265);let i=n.forwardRef(function(e,t){let{title:r,titleId:i,...a}=e;return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":i},a),r?n.createElement("title",{id:i},r):null,n.createElement("path",{fillRule:"evenodd",d:"M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z",clipRule:"evenodd"}))});t.Z=i},3617:function(e,t,r){"use strict";var n=r(2265);let i=n.forwardRef(function(e,t){let{title:r,titleId:i,...a}=e;return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":i},a),r?n.createElement("title",{id:i},r):null,n.createElement("path",{fillRule:"evenodd",d:"M5.47 5.47a.75.75 0 0 1 1.06 0L12 10.94l5.47-5.47a.75.75 0 1 1 1.06 1.06L13.06 12l5.47 5.47a.75.75 0 1 1-1.06 1.06L12 13.06l-5.47 5.47a.75.75 0 0 1-1.06-1.06L10.94 12 5.47 6.53a.75.75 0 0 1 0-1.06Z",clipRule:"evenodd"}))});t.Z=i},4014:function(e,t,r){"use strict";r.r(t),r.d(t,{Any:function(){return tb},BailSignal:function(){return t$},Controller:function(){return ru},FrameValue:function(){return t3},Globals:function(){return d},Interpolation:function(){return rO},Spring:function(){return rR},SpringContext:function(){return rv},SpringRef:function(){return rx},SpringValue:function(){return re},Trail:function(){return rF},Transition:function(){return rz},a:function(){return rV},animated:function(){return rV},config:function(){return tU},createInterpolator:function(){return ey},easings:function(){return eC},inferTo:function(){return tR},interpolate:function(){return rN},to:function(){return rU},update:function(){return rG},useChain:function(){return tk},useInView:function(){return rD},useIsomorphicLayoutEffect:function(){return te},useReducedMotion:function(){return to},useResize:function(){return rT},useScroll:function(){return rS},useSpring:function(){return r_},useSpringRef:function(){return rb},useSpringValue:function(){return rw},useSprings:function(){return rE},useTrail:function(){return rB},useTransition:function(){return rI}});var n,i,a,o,s,l,c=r(5238),u=r(2265),h=Object.defineProperty,d={};((e,t)=>{for(var r in t)h(e,r,{get:t[r],enumerable:!0})})(d,{assign:()=>V,colors:()=>N,createStringInterpolator:()=>i,skipAnimation:()=>G,to:()=>a,willAdvance:()=>H});var f=S(),p=e=>w(e,f),m=S();p.write=e=>w(e,m);var A=S();p.onStart=e=>w(e,A);var g=S();p.onFrame=e=>w(e,g);var v=S();p.onFinish=e=>w(e,v);var y=[];p.setTimeout=(e,t)=>{let r=p.now()+t,n=()=>{let e=y.findIndex(e=>e.cancel==n);~e&&y.splice(e,1),C-=~e?1:0},i={time:r,handler:e,cancel:n};return y.splice(x(r),0,i),C+=1,B(),i};var x=e=>~(~y.findIndex(t=>t.time>e)||~y.length);p.cancel=e=>{A.delete(e),g.delete(e),v.delete(e),f.delete(e),m.delete(e)},p.sync=e=>{b=!0,p.batchedUpdates(e),b=!1},p.throttle=e=>{let t;function r(){try{e(...t)}finally{t=null}}function n(...e){t=e,p.onStart(r)}return n.handler=e,n.cancel=()=>{A.delete(r),t=null},n};var E="undefined"!=typeof window?window.requestAnimationFrame:()=>{};p.use=e=>E=e,p.now="undefined"!=typeof performance?()=>performance.now():Date.now,p.batchedUpdates=e=>e(),p.catch=console.error,p.frameLoop="always",p.advance=()=>{"demand"!==p.frameLoop?console.warn("Cannot call the manual advancement of rafz whilst frameLoop is not set as demand"):M()};var _=-1,C=0,b=!1;function w(e,t){b?(t.delete(e),e(0)):(t.add(e),B())}function B(){_<0&&(_=0,"demand"!==p.frameLoop&&E(I))}function I(){~_&&(E(I),p.batchedUpdates(M))}function M(){let e=_,t=x(_=p.now());if(t&&(T(y.splice(0,t),e=>e.handler()),C-=t),!C){_=-1;return}A.flush(),f.flush(e?Math.min(64,_-e):16.667),g.flush(),m.flush(),v.flush()}function S(){let e=new Set,t=e;return{add(r){C+=t!=e||e.has(r)?0:1,e.add(r)},delete:r=>(C-=t==e&&e.has(r)?1:0,e.delete(r)),flush(r){t.size&&(e=new Set,C-=t.size,T(t,t=>t(r)&&e.add(t)),C+=e.size,t=e)}}}function T(e,t){e.forEach(e=>{try{t(e)}catch(e){p.catch(e)}})}function P(){}var D=(e,t,r)=>Object.defineProperty(e,t,{value:r,writable:!0,configurable:!0}),R={arr:Array.isArray,obj:e=>!!e&&"Object"===e.constructor.name,fun:e=>"function"==typeof e,str:e=>"string"==typeof e,num:e=>"number"==typeof e,und:e=>void 0===e};function F(e,t){if(R.arr(e)){if(!R.arr(t)||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}return e===t}var z=(e,t)=>e.forEach(t);function O(e,t,r){if(R.arr(e)){for(let n=0;n<e.length;n++)t.call(r,e[n],`${n}`);return}for(let n in e)e.hasOwnProperty(n)&&t.call(r,e[n],n)}var Q=e=>R.und(e)?[]:R.arr(e)?e:[e];function L(e,t){if(e.size){let r=Array.from(e);e.clear(),z(r,t)}}var k=(e,...t)=>L(e,e=>e(...t)),U=()=>"undefined"==typeof window||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),N=null,G=!1,H=P,V=e=>{e.to&&(a=e.to),e.now&&(p.now=e.now),void 0!==e.colors&&(N=e.colors),null!=e.skipAnimation&&(G=e.skipAnimation),e.createStringInterpolator&&(i=e.createStringInterpolator),e.requestAnimationFrame&&p.use(e.requestAnimationFrame),e.batchedUpdates&&(p.batchedUpdates=e.batchedUpdates),e.willAdvance&&(H=e.willAdvance),e.frameLoop&&(p.frameLoop=e.frameLoop)},j=new Set,Y=[],J=[],W=0,q={get idle(){return!j.size&&!Y.length},start(e){W>e.priority?(j.add(e),p.onStart(K)):(X(e),p($))},advance:$,sort(e){if(W)p.onFrame(()=>q.sort(e));else{let t=Y.indexOf(e);~t&&(Y.splice(t,1),Z(e))}},clear(){Y=[],j.clear()}};function K(){j.forEach(X),j.clear(),p($)}function X(e){Y.includes(e)||Z(e)}function Z(e){Y.splice(function(e,t){let r=e.findIndex(t);return r<0?e.length:r}(Y,t=>t.priority>e.priority),0,e)}function $(e){let t=J;for(let r=0;r<Y.length;r++){let n=Y[r];W=n.priority,n.idle||(H(n),n.advance(e),n.idle||t.push(n))}return W=0,(J=Y).length=0,(Y=t).length>0}var ee=(e,t,r)=>Math.min(Math.max(r,e),t),et="[-+]?\\d*\\.?\\d+",er=et+"%";function en(...e){return"\\(\\s*("+e.join(")\\s*,\\s*(")+")\\s*\\)"}var ei=RegExp("rgb"+en(et,et,et)),ea=RegExp("rgba"+en(et,et,et,et)),eo=RegExp("hsl"+en(et,er,er)),es=RegExp("hsla"+en(et,er,er,et)),el=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,ec=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,eu=/^#([0-9a-fA-F]{6})$/,eh=/^#([0-9a-fA-F]{8})$/;function ed(e,t,r){return(r<0&&(r+=1),r>1&&(r-=1),r<1/6)?e+(t-e)*6*r:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function ef(e,t,r){let n=r<.5?r*(1+t):r+t-r*t,i=2*r-n;return Math.round(255*ed(i,n,e+1/3))<<24|Math.round(255*ed(i,n,e))<<16|Math.round(255*ed(i,n,e-1/3))<<8}function ep(e){let t=parseInt(e,10);return t<0?0:t>255?255:t}function em(e){return(parseFloat(e)%360+360)%360/360}function eA(e){let t=parseFloat(e);return t<0?0:t>1?255:Math.round(255*t)}function eg(e){let t=parseFloat(e);return t<0?0:t>100?1:t/100}function ev(e){let t;let r="number"==typeof e?e>>>0===e&&e>=0&&e<=4294967295?e:null:(t=eu.exec(e))?parseInt(t[1]+"ff",16)>>>0:N&&void 0!==N[e]?N[e]:(t=ei.exec(e))?(ep(t[1])<<24|ep(t[2])<<16|ep(t[3])<<8|255)>>>0:(t=ea.exec(e))?(ep(t[1])<<24|ep(t[2])<<16|ep(t[3])<<8|eA(t[4]))>>>0:(t=el.exec(e))?parseInt(t[1]+t[1]+t[2]+t[2]+t[3]+t[3]+"ff",16)>>>0:(t=eh.exec(e))?parseInt(t[1],16)>>>0:(t=ec.exec(e))?parseInt(t[1]+t[1]+t[2]+t[2]+t[3]+t[3]+t[4]+t[4],16)>>>0:(t=eo.exec(e))?(255|ef(em(t[1]),eg(t[2]),eg(t[3])))>>>0:(t=es.exec(e))?(ef(em(t[1]),eg(t[2]),eg(t[3]))|eA(t[4]))>>>0:null;if(null===r)return e;let n=(4278190080&(r=r||0))>>>24,i=(16711680&r)>>>16,a=(65280&r)>>>8,o=(255&r)/255;return`rgba(${n}, ${i}, ${a}, ${o})`}var ey=(e,t,r)=>{if(R.fun(e))return e;if(R.arr(e))return ey({range:e,output:t,extrapolate:r});if(R.str(e.output[0]))return i(e);let n=e.output,a=e.range||[0,1],o=e.extrapolateLeft||e.extrapolate||"extend",s=e.extrapolateRight||e.extrapolate||"extend",l=e.easing||(e=>e);return t=>{let r=function(e,t){for(var r=1;r<t.length-1&&!(t[r]>=e);++r);return r-1}(t,a);return function(e,t,r,n,i,a,o,s,l){let c=l?l(e):e;if(c<t){if("identity"===o)return c;"clamp"===o&&(c=t)}if(c>r){if("identity"===s)return c;"clamp"===s&&(c=r)}return n===i?n:t===r?e<=t?n:i:(t===-1/0?c=-c:r===1/0?c-=t:c=(c-t)/(r-t),c=a(c),n===-1/0?c=-c:i===1/0?c+=n:c=c*(i-n)+n,c)}(t,a[r],a[r+1],n[r],n[r+1],l,o,s,e.map)}},ex=2*Math.PI/3,eE=2*Math.PI/4.5,e_=e=>e<.36363636363636365?7.5625*e*e:e<.7272727272727273?7.5625*(e-=.5454545454545454)*e+.75:e<.9090909090909091?7.5625*(e-=.8181818181818182)*e+.9375:7.5625*(e-=.9545454545454546)*e+.984375,eC={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>1-(1-e)*(1-e),easeInOutQuad:e=>e<.5?2*e*e:1-Math.pow(-2*e+2,2)/2,easeInCubic:e=>e*e*e,easeOutCubic:e=>1-Math.pow(1-e,3),easeInOutCubic:e=>e<.5?4*e*e*e:1-Math.pow(-2*e+2,3)/2,easeInQuart:e=>e*e*e*e,easeOutQuart:e=>1-Math.pow(1-e,4),easeInOutQuart:e=>e<.5?8*e*e*e*e:1-Math.pow(-2*e+2,4)/2,easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>1-Math.pow(1-e,5),easeInOutQuint:e=>e<.5?16*e*e*e*e*e:1-Math.pow(-2*e+2,5)/2,easeInSine:e=>1-Math.cos(e*Math.PI/2),easeOutSine:e=>Math.sin(e*Math.PI/2),easeInOutSine:e=>-(Math.cos(Math.PI*e)-1)/2,easeInExpo:e=>0===e?0:Math.pow(2,10*e-10),easeOutExpo:e=>1===e?1:1-Math.pow(2,-10*e),easeInOutExpo:e=>0===e?0:1===e?1:e<.5?Math.pow(2,20*e-10)/2:(2-Math.pow(2,-20*e+10))/2,easeInCirc:e=>1-Math.sqrt(1-Math.pow(e,2)),easeOutCirc:e=>Math.sqrt(1-Math.pow(e-1,2)),easeInOutCirc:e=>e<.5?(1-Math.sqrt(1-Math.pow(2*e,2)))/2:(Math.sqrt(1-Math.pow(-2*e+2,2))+1)/2,easeInBack:e=>2.70158*e*e*e-1.70158*e*e,easeOutBack:e=>1+2.70158*Math.pow(e-1,3)+1.70158*Math.pow(e-1,2),easeInOutBack:e=>e<.5?Math.pow(2*e,2)*(7.189819*e-2.5949095)/2:(Math.pow(2*e-2,2)*(3.5949095*(2*e-2)+2.5949095)+2)/2,easeInElastic:e=>0===e?0:1===e?1:-Math.pow(2,10*e-10)*Math.sin((10*e-10.75)*ex),easeOutElastic:e=>0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin((10*e-.75)*ex)+1,easeInOutElastic:e=>0===e?0:1===e?1:e<.5?-(Math.pow(2,20*e-10)*Math.sin((20*e-11.125)*eE))/2:Math.pow(2,-20*e+10)*Math.sin((20*e-11.125)*eE)/2+1,easeInBounce:e=>1-e_(1-e),easeOutBounce:e_,easeInOutBounce:e=>e<.5?(1-e_(1-2*e))/2:(1+e_(2*e-1))/2,steps:(e,t="end")=>r=>{let n=(r="end"===t?Math.min(r,.999):Math.max(r,.001))*e;return ee(0,1,("end"===t?Math.floor(n):Math.ceil(n))/e)}},eb=Symbol.for("FluidValue.get"),ew=Symbol.for("FluidValue.observers"),eB=e=>!!(e&&e[eb]),eI=e=>e&&e[eb]?e[eb]():e,eM=e=>e[ew]||null;function eS(e,t){let r=e[ew];r&&r.forEach(e=>{e.eventObserved?e.eventObserved(t):e(t)})}var eT=class{constructor(e){if(!e&&!(e=this.get))throw Error("Unknown getter");eP(this,e)}},eP=(e,t)=>eF(e,eb,t);function eD(e,t){if(e[eb]){let r=e[ew];r||eF(e,ew,r=new Set),!r.has(t)&&(r.add(t),e.observerAdded&&e.observerAdded(r.size,t))}return t}function eR(e,t){let r=e[ew];if(r&&r.has(t)){let n=r.size-1;n?r.delete(t):e[ew]=null,e.observerRemoved&&e.observerRemoved(n,t)}}var eF=(e,t,r)=>Object.defineProperty(e,t,{value:r,writable:!0,configurable:!0}),ez=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,eO=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,eQ=RegExp(`(${ez.source})(%|[a-z]+)`,"i"),eL=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,ek=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,eU=e=>{let[t,r]=eN(e);if(!t||U())return e;let n=window.getComputedStyle(document.documentElement).getPropertyValue(t);if(n)return n.trim();if(r&&r.startsWith("--")){let e=window.getComputedStyle(document.documentElement).getPropertyValue(r);if(e)return e}else if(r&&ek.test(r))return eU(r);else if(r)return r;return e},eN=e=>{let t=ek.exec(e);if(!t)return[,];let[,r,n]=t;return[r,n]},eG=(e,t,r,n,i)=>`rgba(${Math.round(t)}, ${Math.round(r)}, ${Math.round(n)}, ${i})`,eH=e=>{o||(o=N?RegExp(`(${Object.keys(N).join("|")})(?!\\w)`,"g"):/^\b$/);let t=e.output.map(e=>eI(e).replace(ek,eU).replace(eO,ev).replace(o,ev)),r=t.map(e=>e.match(ez).map(Number)),n=r[0].map((e,t)=>r.map(e=>{if(!(t in e))throw Error('The arity of each "output" value must be equal');return e[t]})).map(t=>ey({...e,output:t}));return e=>{let r=!eQ.test(t[0])&&t.find(e=>eQ.test(e))?.replace(ez,""),i=0;return t[0].replace(ez,()=>`${n[i++](e)}${r||""}`).replace(eL,eG)}},eV="react-spring: ",ej=e=>{let t=!1;if("function"!=typeof e)throw TypeError(`${eV}once requires a function parameter`);return(...r)=>{t||(e(...r),t=!0)}},eY=ej(console.warn);function eJ(){eY(`${eV}The "interpolate" function is deprecated in v9 (use "to" instead)`)}var eW=ej(console.warn);function eq(e){return R.str(e)&&("#"==e[0]||/\d/.test(e)||!U()&&ek.test(e)||e in(N||{}))}var eK=new WeakMap,eX=e=>e.forEach(({target:e,contentRect:t})=>eK.get(e)?.forEach(e=>e(t))),eZ=new Set,e$=()=>{let e=()=>{eZ.forEach(e=>e({width:window.innerWidth,height:window.innerHeight}))};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},e0=e=>(eZ.add(e),l||(l=e$()),()=>{eZ.delete(e),!eZ.size&&l&&(l(),l=void 0)}),e1=(e,{container:t=document.documentElement}={})=>{if(t===document.documentElement)return e0(e);{let r;return s||"undefined"==typeof ResizeObserver||(s=new ResizeObserver(eX)),(r=eK.get(t))||(r=new Set,eK.set(t,r)),r.add(e),s&&s.observe(t),()=>{let r=eK.get(t);r&&(r.delete(e),!r.size&&s&&s.unobserve(t))}}},e2=(e,t,r)=>t-e==0?1:(r-e)/(t-e),e3={x:{length:"Width",position:"Left"},y:{length:"Height",position:"Top"}},e4=class{constructor(e,t){this.createAxis=()=>({current:0,progress:0,scrollLength:0}),this.updateAxis=e=>{let t=this.info[e],{length:r,position:n}=e3[e];t.current=this.container[`scroll${n}`],t.scrollLength=this.container["scroll"+r]-this.container["client"+r],t.progress=e2(0,t.scrollLength,t.current)},this.update=()=>{this.updateAxis("x"),this.updateAxis("y")},this.sendEvent=()=>{this.callback(this.info)},this.advance=()=>{this.update(),this.sendEvent()},this.callback=e,this.container=t,this.info={time:0,x:this.createAxis(),y:this.createAxis()}}},e5=new WeakMap,e6=new WeakMap,e8=new WeakMap,e9=e=>e===document.documentElement?window:e,e7=(e,{container:t=document.documentElement}={})=>{let r=e8.get(t);r||(r=new Set,e8.set(t,r));let n=new e4(e,t);if(r.add(n),!e5.has(t)){let e=()=>(r?.forEach(e=>e.advance()),!0);e5.set(t,e);let n=e9(t);window.addEventListener("resize",e,{passive:!0}),t!==document.documentElement&&e6.set(t,e1(e,{container:t})),n.addEventListener("scroll",e,{passive:!0})}let i=e5.get(t);return p(i),()=>{p.cancel(i);let e=e8.get(t);if(!e||(e.delete(n),e.size))return;let r=e5.get(t);e5.delete(t),r&&(e9(t).removeEventListener("scroll",r),window.removeEventListener("resize",r),e6.get(t)?.())}},te=U()?u.useEffect:u.useLayoutEffect,tt=()=>{let e=(0,u.useRef)(!1);return te(()=>(e.current=!0,()=>{e.current=!1}),[]),e};function tr(){let e=(0,u.useState)()[1],t=tt();return()=>{t.current&&e(Math.random())}}var tn=e=>(0,u.useEffect)(e,ti),ti=[];function ta(e){let t=(0,u.useRef)();return(0,u.useEffect)(()=>{t.current=e}),t.current}var to=()=>{let[e,t]=(0,u.useState)(null);return te(()=>{let e=window.matchMedia("(prefers-reduced-motion)"),r=e=>{t(e.matches),V({skipAnimation:e.matches})};return r(e),e.addEventListener("change",r),()=>{e.removeEventListener("change",r)}},[]),e},ts=Symbol.for("Animated:node"),tl=e=>!!e&&e[ts]===e,tc=e=>e&&e[ts],tu=(e,t)=>D(e,ts,t),th=e=>e&&e[ts]&&e[ts].getPayload(),td=class{constructor(){tu(this,this)}getPayload(){return this.payload||[]}},tf=class extends td{constructor(e){super(),this._value=e,this.done=!0,this.durationProgress=0,R.num(this._value)&&(this.lastPosition=this._value)}static create(e){return new tf(e)}getPayload(){return[this]}getValue(){return this._value}setValue(e,t){return R.num(e)&&(this.lastPosition=e,t&&(e=Math.round(e/t)*t,this.done&&(this.lastPosition=e))),this._value!==e&&(this._value=e,!0)}reset(){let{done:e}=this;this.done=!1,R.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,e&&(this.lastVelocity=null),this.v0=null)}},tp=class extends tf{constructor(e){super(0),this._string=null,this._toString=ey({output:[e,e]})}static create(e){return new tp(e)}getValue(){let e=this._string;return null==e?this._string=this._toString(this._value):e}setValue(e){if(R.str(e)){if(e==this._string)return!1;this._string=e,this._value=1}else{if(!super.setValue(e))return!1;this._string=null}return!0}reset(e){e&&(this._toString=ey({output:[this.getValue(),e]})),this._value=0,super.reset()}},tm={dependencies:null},tA=class extends td{constructor(e){super(),this.source=e,this.setValue(e)}getValue(e){let t={};return O(this.source,(r,n)=>{tl(r)?t[n]=r.getValue(e):eB(r)?t[n]=eI(r):e||(t[n]=r)}),t}setValue(e){this.source=e,this.payload=this._makePayload(e)}reset(){this.payload&&z(this.payload,e=>e.reset())}_makePayload(e){if(e){let t=new Set;return O(e,this._addToPayload,t),Array.from(t)}}_addToPayload(e){tm.dependencies&&eB(e)&&tm.dependencies.add(e);let t=th(e);t&&z(t,e=>this.add(e))}},tg=class extends tA{constructor(e){super(e)}static create(e){return new tg(e)}getValue(){return this.source.map(e=>e.getValue())}setValue(e){let t=this.getPayload();return e.length==t.length?t.map((t,r)=>t.setValue(e[r])).some(Boolean):(super.setValue(e.map(tv)),!0)}};function tv(e){return(eq(e)?tp:tf).create(e)}function ty(e){let t=tc(e);return t?t.constructor:R.arr(e)?tg:eq(e)?tp:tf}var tx=(e,t)=>{let r=!R.fun(e)||e.prototype&&e.prototype.isReactComponent;return(0,u.forwardRef)((n,i)=>{let a=(0,u.useRef)(null),o=r&&(0,u.useCallback)(e=>{a.current=(i&&(R.fun(i)?i(e):i.current=e),e)},[i]),[s,l]=function(e,t){let r=new Set;return tm.dependencies=r,e.style&&(e={...e,style:t.createAnimatedStyle(e.style)}),e=new tA(e),tm.dependencies=null,[e,r]}(n,t),c=tr(),h=()=>{let e=a.current;(!r||e)&&!1===(!!e&&t.applyAnimatedValues(e,s.getValue(!0)))&&c()},d=new tE(h,l),f=(0,u.useRef)();te(()=>(f.current=d,z(l,e=>eD(e,d)),()=>{f.current&&(z(f.current.deps,e=>eR(e,f.current)),p.cancel(f.current.update))})),(0,u.useEffect)(h,[]),tn(()=>()=>{let e=f.current;z(e.deps,t=>eR(t,e))});let m=t.getComponentProps(s.getValue());return u.createElement(e,{...m,ref:o})})},tE=class{constructor(e,t){this.update=e,this.deps=t}eventObserved(e){"change"==e.type&&p.write(this.update)}},t_=Symbol.for("AnimatedComponent"),tC=e=>R.str(e)?e:e&&R.str(e.displayName)?e.displayName:R.fun(e)&&e.name||null,tb=class{};function tw(e,...t){return R.fun(e)?e(...t):e}var tB=(e,t)=>!0===e||!!(t&&e&&(R.fun(e)?e(t):Q(e).includes(t))),tI=(e,t)=>R.obj(e)?t&&e[t]:e,tM=(e,t)=>!0===e.default?e[t]:e.default?e.default[t]:void 0,tS=e=>e,tT=(e,t=tS)=>{let r=tP;e.default&&!0!==e.default&&(r=Object.keys(e=e.default));let n={};for(let i of r){let r=t(e[i],i);R.und(r)||(n[i]=r)}return n},tP=["config","onProps","onStart","onChange","onPause","onResume","onRest"],tD={config:1,from:1,to:1,ref:1,loop:1,reset:1,pause:1,cancel:1,reverse:1,immediate:1,default:1,delay:1,onProps:1,onStart:1,onChange:1,onPause:1,onResume:1,onRest:1,onResolve:1,items:1,trail:1,sort:1,expires:1,initial:1,enter:1,update:1,leave:1,children:1,onDestroyed:1,keys:1,callId:1,parentId:1};function tR(e){let t=function(e){let t={},r=0;if(O(e,(e,n)=>{!tD[n]&&(t[n]=e,r++)}),r)return t}(e);if(t){let r={to:t};return O(e,(e,n)=>n in t||(r[n]=e)),r}return{...e}}function tF(e){return e=eI(e),R.arr(e)?e.map(tF):eq(e)?d.createStringInterpolator({range:[0,1],output:[e,e]})(1):e}function tz(e){for(let t in e)return!0;return!1}function tO(e){return R.fun(e)||R.arr(e)&&R.obj(e[0])}function tQ(e,t){e.ref?.delete(e),t?.delete(e)}function tL(e,t){t&&e.ref!==t&&(e.ref?.delete(e),t.add(e),e.ref=t)}function tk(e,t,r=1e3){te(()=>{if(t){let n=0;z(e,(e,i)=>{let a=e.current;if(a.length){let o=r*t[i];isNaN(o)?o=n:n=o,z(a,e=>{z(e.queue,e=>{let t=e.delay;e.delay=e=>o+tw(t||0,e)})}),e.start()}})}else{let t=Promise.resolve();z(e,e=>{let r=e.current;if(r.length){let n=r.map(e=>{let t=e.queue;return e.queue=[],t});t=t.then(()=>(z(r,(e,t)=>z(n[t]||[],t=>e.queue.push(t))),Promise.all(e.start())))}})}})}var tU={default:{tension:170,friction:26},gentle:{tension:120,friction:14},wobbly:{tension:180,friction:12},stiff:{tension:210,friction:20},slow:{tension:280,friction:60},molasses:{tension:280,friction:120}},tN={...tU.default,mass:1,damping:1,easing:eC.linear,clamp:!1},tG=class{constructor(){this.velocity=0,Object.assign(this,tN)}};function tH(e,t){if(R.und(t.decay)){let r=!R.und(t.tension)||!R.und(t.friction);!r&&R.und(t.frequency)&&R.und(t.damping)&&R.und(t.mass)||(e.duration=void 0,e.decay=void 0),r&&(e.frequency=void 0)}else e.duration=void 0}var tV=[],tj=class{constructor(){this.changed=!1,this.values=tV,this.toValues=null,this.fromValues=tV,this.config=new tG,this.immediate=!1}};function tY(e,{key:t,props:r,defaultProps:n,state:i,actions:a}){return new Promise((o,s)=>{let l,c;let u=tB(r.cancel??n?.cancel,t);if(u)m();else{R.und(r.pause)||(i.paused=tB(r.pause,t));let e=n?.pause;!0!==e&&(e=i.paused||tB(e,t)),l=tw(r.delay||0,t),e?(i.resumeQueue.add(f),a.pause()):(a.resume(),f())}function h(){i.resumeQueue.add(f),i.timeouts.delete(c),c.cancel(),l=c.time-p.now()}function f(){l>0&&!d.skipAnimation?(i.delayed=!0,c=p.setTimeout(m,l),i.pauseQueue.add(h),i.timeouts.add(c)):m()}function m(){i.delayed&&(i.delayed=!1),i.pauseQueue.delete(h),i.timeouts.delete(c),e<=(i.cancelId||0)&&(u=!0);try{a.start({...r,callId:e,cancel:u},o)}catch(e){s(e)}}})}var tJ=(e,t)=>1==t.length?t[0]:t.some(e=>e.cancelled)?tK(e.get()):t.every(e=>e.noop)?tW(e.get()):tq(e.get(),t.every(e=>e.finished)),tW=e=>({value:e,noop:!0,finished:!0,cancelled:!1}),tq=(e,t,r=!1)=>({value:e,finished:t,cancelled:r}),tK=e=>({value:e,cancelled:!0,finished:!1});function tX(e,t,r,n){let{callId:i,parentId:a,onRest:o}=t,{asyncTo:s,promise:l}=r;return a||e!==s||t.reset?r.promise=(async()=>{let c,u,h;r.asyncId=i,r.asyncTo=e;let f=tT(t,(e,t)=>"onRest"===t?void 0:e),m=new Promise((e,t)=>(c=e,u=t)),A=e=>{let t=i<=(r.cancelId||0)&&tK(n)||i!==r.asyncId&&tq(n,!1);if(t)throw e.result=t,u(e),e},g=(e,t)=>{let a=new t$,o=new t0;return(async()=>{if(d.skipAnimation)throw tZ(r),o.result=tq(n,!1),u(o),o;A(a);let s=R.obj(e)?{...e}:{...t,to:e};s.parentId=i,O(f,(e,t)=>{R.und(s[t])&&(s[t]=e)});let l=await n.start(s);return A(a),r.paused&&await new Promise(e=>{r.resumeQueue.add(e)}),l})()};if(d.skipAnimation)return tZ(r),tq(n,!1);try{let t;t=R.arr(e)?(async e=>{for(let t of e)await g(t)})(e):Promise.resolve(e(g,n.stop.bind(n))),await Promise.all([t.then(c),m]),h=tq(n.get(),!0,!1)}catch(e){if(e instanceof t$)h=e.result;else if(e instanceof t0)h=e.result;else throw e}finally{i==r.asyncId&&(r.asyncId=a,r.asyncTo=a?s:void 0,r.promise=a?l:void 0)}return R.fun(o)&&p.batchedUpdates(()=>{o(h,n,n.item)}),h})():l}function tZ(e,t){L(e.timeouts,e=>e.cancel()),e.pauseQueue.clear(),e.resumeQueue.clear(),e.asyncId=e.asyncTo=e.promise=void 0,t&&(e.cancelId=t)}var t$=class extends Error{constructor(){super("An async animation has been interrupted. You see this error because you forgot to use `await` or `.catch(...)` on its returned promise.")}},t0=class extends Error{constructor(){super("SkipAnimationSignal")}},t1=e=>e instanceof t3,t2=1,t3=class extends eT{constructor(){super(...arguments),this.id=t2++,this._priority=0}get priority(){return this._priority}set priority(e){this._priority!=e&&(this._priority=e,this._onPriorityChange(e))}get(){let e=tc(this);return e&&e.getValue()}to(...e){return d.to(this,e)}interpolate(...e){return eJ(),d.to(this,e)}toJSON(){return this.get()}observerAdded(e){1==e&&this._attach()}observerRemoved(e){0==e&&this._detach()}_attach(){}_detach(){}_onChange(e,t=!1){eS(this,{type:"change",parent:this,value:e,idle:t})}_onPriorityChange(e){this.idle||q.sort(this),eS(this,{type:"priority",parent:this,priority:e})}},t4=Symbol.for("SpringPhase"),t5=e=>(1&e[t4])>0,t6=e=>(2&e[t4])>0,t8=e=>(4&e[t4])>0,t9=(e,t)=>t?e[t4]|=3:e[t4]&=-3,t7=(e,t)=>t?e[t4]|=4:e[t4]&=-5,re=class extends t3{constructor(e,t){if(super(),this.animation=new tj,this.defaultProps={},this._state={paused:!1,delayed:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._pendingCalls=new Set,this._lastCallId=0,this._lastToId=0,this._memoizedDuration=0,!R.und(e)||!R.und(t)){let r=R.obj(e)?{...e}:{...t,from:e};R.und(r.default)&&(r.default=!0),this.start(r)}}get idle(){return!(t6(this)||this._state.asyncTo)||t8(this)}get goal(){return eI(this.animation.to)}get velocity(){let e=tc(this);return e instanceof tf?e.lastVelocity||0:e.getPayload().map(e=>e.lastVelocity||0)}get hasAnimated(){return t5(this)}get isAnimating(){return t6(this)}get isPaused(){return t8(this)}get isDelayed(){return this._state.delayed}advance(e){let t=!0,r=!1,n=this.animation,{toValues:i}=n,{config:a}=n,o=th(n.to);!o&&eB(n.to)&&(i=Q(eI(n.to))),n.values.forEach((s,l)=>{if(s.done)return;let c=s.constructor==tp?1:o?o[l].lastPosition:i[l],u=n.immediate,h=c;if(!u){let t;if(h=s.lastPosition,a.tension<=0){s.done=!0;return}let r=s.elapsedTime+=e,i=n.fromValues[l],o=null!=s.v0?s.v0:s.v0=R.arr(a.velocity)?a.velocity[l]:a.velocity,d=a.precision||(i==c?.005:Math.min(1,.001*Math.abs(c-i)));if(R.und(a.duration)){if(a.decay){let e=!0===a.decay?.998:a.decay,n=Math.exp(-(1-e)*r);h=i+o/(1-e)*(1-n),u=Math.abs(s.lastPosition-h)<=d,t=o*n}else{t=null==s.lastVelocity?o:s.lastVelocity;let r=a.restVelocity||d/10,n=a.clamp?0:a.bounce,l=!R.und(n),f=i==c?s.v0>0:i<c,p=Math.ceil(e/1);for(let e=0;e<p&&!(!(Math.abs(t)>r)&&(u=Math.abs(c-h)<=d));++e){l&&(h==c||h>c==f)&&(t=-t*n,h=c);let e=(-(1e-6*a.tension)*(h-c)+-(.001*a.friction)*t)/a.mass;t+=1*e,h+=1*t}}}else{let n=1;a.duration>0&&(this._memoizedDuration!==a.duration&&(this._memoizedDuration=a.duration,s.durationProgress>0&&(s.elapsedTime=a.duration*s.durationProgress,r=s.elapsedTime+=e)),n=(n=(a.progress||0)+r/this._memoizedDuration)>1?1:n<0?0:n,s.durationProgress=n),t=((h=i+a.easing(n)*(c-i))-s.lastPosition)/e,u=1==n}s.lastVelocity=t,Number.isNaN(h)&&(console.warn("Got NaN while animating:",this),u=!0)}o&&!o[l].done&&(u=!1),u?s.done=!0:t=!1,s.setValue(h,a.round)&&(r=!0)});let s=tc(this),l=s.getValue();if(t){let e=eI(n.to);(l!==e||r)&&!a.decay?(s.setValue(e),this._onChange(e)):r&&a.decay&&this._onChange(l),this._stop()}else r&&this._onChange(l)}set(e){return p.batchedUpdates(()=>{this._stop(),this._focus(e),this._set(e)}),this}pause(){this._update({pause:!0})}resume(){this._update({pause:!1})}finish(){if(t6(this)){let{to:e,config:t}=this.animation;p.batchedUpdates(()=>{this._onStart(),t.decay||this._set(e,!1),this._stop()})}return this}update(e){return(this.queue||(this.queue=[])).push(e),this}start(e,t){let r;return R.und(e)?(r=this.queue||[],this.queue=[]):r=[R.obj(e)?e:{...t,to:e}],Promise.all(r.map(e=>this._update(e))).then(e=>tJ(this,e))}stop(e){let{to:t}=this.animation;return this._focus(this.get()),tZ(this._state,e&&this._lastCallId),p.batchedUpdates(()=>this._stop(t,e)),this}reset(){this._update({reset:!0})}eventObserved(e){"change"==e.type?this._start():"priority"==e.type&&(this.priority=e.priority+1)}_prepareNode(e){let t=this.key||"",{to:r,from:n}=e;(null==(r=R.obj(r)?r[t]:r)||tO(r))&&(r=void 0),null==(n=R.obj(n)?n[t]:n)&&(n=void 0);let i={to:r,from:n};return t5(this)||(e.reverse&&([r,n]=[n,r]),n=eI(n),R.und(n)?tc(this)||this._set(r):this._set(n)),i}_update({...e},t){let{key:r,defaultProps:n}=this;e.default&&Object.assign(n,tT(e,(e,t)=>/^on/.test(t)?tI(e,r):e)),ro(this,e,"onProps"),rs(this,"onProps",e,this);let i=this._prepareNode(e);if(Object.isFrozen(this))throw Error("Cannot animate a `SpringValue` object that is frozen. Did you forget to pass your component to `animated(...)` before animating its props?");let a=this._state;return tY(++this._lastCallId,{key:r,props:e,defaultProps:n,state:a,actions:{pause:()=>{t8(this)||(t7(this,!0),k(a.pauseQueue),rs(this,"onPause",tq(this,rt(this,this.animation.to)),this))},resume:()=>{t8(this)&&(t7(this,!1),t6(this)&&this._resume(),k(a.resumeQueue),rs(this,"onResume",tq(this,rt(this,this.animation.to)),this))},start:this._merge.bind(this,i)}}).then(r=>{if(e.loop&&r.finished&&!(t&&r.noop)){let t=rr(e);if(t)return this._update(t,!0)}return r})}_merge(e,t,r){if(t.cancel)return this.stop(!0),r(tK(this));let n=!R.und(e.to),i=!R.und(e.from);if(n||i){if(!(t.callId>this._lastToId))return r(tK(this));this._lastToId=t.callId}let{key:a,defaultProps:o,animation:s}=this,{to:l,from:c}=s,{to:u=l,from:h=c}=e;i&&!n&&(!t.default||R.und(u))&&(u=h),t.reverse&&([u,h]=[h,u]);let d=!F(h,c);d&&(s.from=h),h=eI(h);let f=!F(u,l);f&&this._focus(u);let m=tO(t.to),{config:A}=s,{decay:g,velocity:v}=A;(n||i)&&(A.velocity=0),t.config&&!m&&function(e,t,r){for(let n in r&&(tH(r={...r},t),t={...r,...t}),tH(e,t),Object.assign(e,t),tN)null==e[n]&&(e[n]=tN[n]);let{frequency:n,damping:i}=e,{mass:a}=e;R.und(n)||(n<.01&&(n=.01),i<0&&(i=0),e.tension=Math.pow(2*Math.PI/n,2)*a,e.friction=4*Math.PI*i*a/n)}(A,tw(t.config,a),t.config!==o.config?tw(o.config,a):void 0);let y=tc(this);if(!y||R.und(u))return r(tq(this,!0));let x=R.und(t.reset)?i&&!t.default:!R.und(h)&&tB(t.reset,a),E=x?h:this.get(),_=tF(u),C=R.num(_)||R.arr(_)||eq(_),b=!m&&(!C||tB(o.immediate||t.immediate,a));if(f){let e=ty(u);if(e!==y.constructor){if(b)y=this._set(_);else throw Error(`Cannot animate between ${y.constructor.name} and ${e.name}, as the "to" prop suggests`)}}let w=y.constructor,B=eB(u),I=!1;if(!B){let e=x||!t5(this)&&d;(f||e)&&(B=!(I=F(tF(E),_))),(F(s.immediate,b)||b)&&F(A.decay,g)&&F(A.velocity,v)||(B=!0)}if(I&&t6(this)&&(s.changed&&!x?B=!0:B||this._stop(l)),!m&&((B||eB(l))&&(s.values=y.getPayload(),s.toValues=eB(u)?null:w==tp?[1]:Q(_)),s.immediate==b||(s.immediate=b,b||x||this._set(l)),B)){let{onRest:e}=s;z(ra,e=>ro(this,t,e));let n=tq(this,rt(this,l));k(this._pendingCalls,n),this._pendingCalls.add(r),s.changed&&p.batchedUpdates(()=>{s.changed=!x,e?.(n,this),x?tw(o.onRest,n):s.onStart?.(n,this)})}x&&this._set(E),m?r(tX(t.to,t,this._state,this)):B?this._start():t6(this)&&!f?this._pendingCalls.add(r):r(tW(E))}_focus(e){let t=this.animation;e!==t.to&&(eM(this)&&this._detach(),t.to=e,eM(this)&&this._attach())}_attach(){let e=0,{to:t}=this.animation;eB(t)&&(eD(t,this),t1(t)&&(e=t.priority+1)),this.priority=e}_detach(){let{to:e}=this.animation;eB(e)&&eR(e,this)}_set(e,t=!0){let r=eI(e);if(!R.und(r)){let e=tc(this);if(!e||!F(r,e.getValue())){let n=ty(r);e&&e.constructor==n?e.setValue(r):tu(this,n.create(r)),e&&p.batchedUpdates(()=>{this._onChange(r,t)})}}return tc(this)}_onStart(){let e=this.animation;e.changed||(e.changed=!0,rs(this,"onStart",tq(this,rt(this,e.to)),this))}_onChange(e,t){t||(this._onStart(),tw(this.animation.onChange,e,this)),tw(this.defaultProps.onChange,e,this),super._onChange(e,t)}_start(){let e=this.animation;tc(this).reset(eI(e.to)),e.immediate||(e.fromValues=e.values.map(e=>e.lastPosition)),t6(this)||(t9(this,!0),t8(this)||this._resume())}_resume(){d.skipAnimation?this.finish():q.start(this)}_stop(e,t){if(t6(this)){t9(this,!1);let r=this.animation;z(r.values,e=>{e.done=!0}),r.toValues&&(r.onChange=r.onPause=r.onResume=void 0),eS(this,{type:"idle",parent:this});let n=t?tK(this.get()):tq(this.get(),rt(this,e??r.to));k(this._pendingCalls,n),r.changed&&(r.changed=!1,rs(this,"onRest",n,this))}}};function rt(e,t){let r=tF(t);return F(tF(e.get()),r)}function rr(e,t=e.loop,r=e.to){let n=tw(t);if(n){let i=!0!==n&&tR(n),a=(i||e).reverse,o=!i||i.reset;return rn({...e,loop:t,default:!1,pause:void 0,to:!a||tO(r)?r:void 0,from:o?e.from:void 0,reset:o,...i})}}function rn(e){let{to:t,from:r}=e=tR(e),n=new Set;return R.obj(t)&&ri(t,n),R.obj(r)&&ri(r,n),e.keys=n.size?Array.from(n):null,e}function ri(e,t){O(e,(e,r)=>null!=e&&t.add(r))}var ra=["onStart","onRest","onChange","onPause","onResume"];function ro(e,t,r){e.animation[r]=t[r]!==tM(t,r)?tI(t[r],e.key):void 0}function rs(e,t,...r){e.animation[t]?.(...r),e.defaultProps[t]?.(...r)}var rl=["onStart","onChange","onRest"],rc=1,ru=class{constructor(e,t){this.id=rc++,this.springs={},this.queue=[],this._lastAsyncId=0,this._active=new Set,this._changed=new Set,this._started=!1,this._state={paused:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._events={onStart:new Map,onChange:new Map,onRest:new Map},this._onFrame=this._onFrame.bind(this),t&&(this._flush=t),e&&this.start({default:!0,...e})}get idle(){return!this._state.asyncTo&&Object.values(this.springs).every(e=>e.idle&&!e.isDelayed&&!e.isPaused)}get item(){return this._item}set item(e){this._item=e}get(){let e={};return this.each((t,r)=>e[r]=t.get()),e}set(e){for(let t in e){let r=e[t];R.und(r)||this.springs[t].set(r)}}update(e){return e&&this.queue.push(rn(e)),this}start(e){let{queue:t}=this;return(e?t=Q(e).map(rn):this.queue=[],this._flush)?this._flush(this,t):(rg(this,t),rh(this,t))}stop(e,t){if(!!e!==e&&(t=e),t){let r=this.springs;z(Q(t),t=>r[t].stop(!!e))}else tZ(this._state,this._lastAsyncId),this.each(t=>t.stop(!!e));return this}pause(e){if(R.und(e))this.start({pause:!0});else{let t=this.springs;z(Q(e),e=>t[e].pause())}return this}resume(e){if(R.und(e))this.start({pause:!1});else{let t=this.springs;z(Q(e),e=>t[e].resume())}return this}each(e){O(this.springs,e)}_onFrame(){let{onStart:e,onChange:t,onRest:r}=this._events,n=this._active.size>0,i=this._changed.size>0;(n&&!this._started||i&&!this._started)&&(this._started=!0,L(e,([e,t])=>{t.value=this.get(),e(t,this,this._item)}));let a=!n&&this._started,o=i||a&&r.size?this.get():null;i&&t.size&&L(t,([e,t])=>{t.value=o,e(t,this,this._item)}),a&&(this._started=!1,L(r,([e,t])=>{t.value=o,e(t,this,this._item)}))}eventObserved(e){if("change"==e.type)this._changed.add(e.parent),e.idle||this._active.add(e.parent);else{if("idle"!=e.type)return;this._active.delete(e.parent)}p.onFrame(this._onFrame)}};function rh(e,t){return Promise.all(t.map(t=>rd(e,t))).then(t=>tJ(e,t))}async function rd(e,t,r){let{keys:n,to:i,from:a,loop:o,onRest:s,onResolve:l}=t,c=R.obj(t.default)&&t.default;o&&(t.loop=!1),!1===i&&(t.to=null),!1===a&&(t.from=null);let u=R.arr(i)||R.fun(i)?i:void 0;u?(t.to=void 0,t.onRest=void 0,c&&(c.onRest=void 0)):z(rl,r=>{let n=t[r];if(R.fun(n)){let i=e._events[r];t[r]=({finished:e,cancelled:t})=>{let r=i.get(n);r?(e||(r.finished=!1),t&&(r.cancelled=!0)):i.set(n,{value:null,finished:e||!1,cancelled:t||!1})},c&&(c[r]=t[r])}});let h=e._state;!h.paused===t.pause?(h.paused=t.pause,k(t.pause?h.pauseQueue:h.resumeQueue)):h.paused&&(t.pause=!0);let d=(n||Object.keys(e.springs)).map(r=>e.springs[r].start(t)),f=!0===t.cancel||!0===tM(t,"cancel");(u||f&&h.asyncId)&&d.push(tY(++e._lastAsyncId,{props:t,state:h,actions:{pause:P,resume:P,start(t,r){f?(tZ(h,e._lastAsyncId),r(tK(e))):(t.onRest=s,r(tX(u,t,h,e)))}}})),h.paused&&await new Promise(e=>{h.resumeQueue.add(e)});let m=tJ(e,await Promise.all(d));if(o&&m.finished&&!(r&&m.noop)){let r=rr(t,o,i);if(r)return rg(e,[r]),rd(e,r,!0)}return l&&p.batchedUpdates(()=>l(m,e,e.item)),m}function rf(e,t){let r={...e.springs};return t&&z(Q(t),e=>{R.und(e.keys)&&(e=rn(e)),R.obj(e.to)||(e={...e,to:void 0}),rA(r,e,e=>rm(e))}),rp(e,r),r}function rp(e,t){O(t,(t,r)=>{e.springs[r]||(e.springs[r]=t,eD(t,e))})}function rm(e,t){let r=new re;return r.key=e,t&&eD(r,t),r}function rA(e,t,r){t.keys&&z(t.keys,n=>{(e[n]||(e[n]=r(n)))._prepareNode(t)})}function rg(e,t){z(t,t=>{rA(e.springs,t,t=>rm(t,e))})}var rv=({children:e,...t})=>{let r=(0,u.useContext)(ry),n=t.pause||!!r.pause,i=t.immediate||!!r.immediate;t=function(e,t){let[r]=(0,u.useState)(()=>({inputs:t,result:e()})),n=(0,u.useRef)(),i=n.current,a=i;return a?t&&a.inputs&&function(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}(t,a.inputs)||(a={inputs:t,result:e()}):a=r,(0,u.useEffect)(()=>{n.current=a,i==r&&(r.inputs=r.result=void 0)},[a]),a.result}(()=>({pause:n,immediate:i}),[n,i]);let{Provider:a}=ry;return u.createElement(a,{value:t},e)},ry=(n={},Object.assign(rv,u.createContext(n)),rv.Provider._context=rv,rv.Consumer._context=rv,rv);rv.Provider=ry.Provider,rv.Consumer=ry.Consumer;var rx=()=>{let e=[],t=function(t){eW(`${eV}Directly calling start instead of using the api object is deprecated in v9 (use ".start" instead), this will be removed in later 0.X.0 versions`);let n=[];return z(e,(e,i)=>{if(R.und(t))n.push(e.start());else{let a=r(t,e,i);a&&n.push(e.start(a))}}),n};t.current=e,t.add=function(t){e.includes(t)||e.push(t)},t.delete=function(t){let r=e.indexOf(t);~r&&e.splice(r,1)},t.pause=function(){return z(e,e=>e.pause(...arguments)),this},t.resume=function(){return z(e,e=>e.resume(...arguments)),this},t.set=function(t){z(e,(e,r)=>{let n=R.fun(t)?t(r,e):t;n&&e.set(n)})},t.start=function(t){let r=[];return z(e,(e,n)=>{if(R.und(t))r.push(e.start());else{let i=this._getProps(t,e,n);i&&r.push(e.start(i))}}),r},t.stop=function(){return z(e,e=>e.stop(...arguments)),this},t.update=function(t){return z(e,(e,r)=>e.update(this._getProps(t,e,r))),this};let r=function(e,t,r){return R.fun(e)?e(r,t):e};return t._getProps=r,t};function rE(e,t,r){let n=R.fun(t)&&t;n&&!r&&(r=[]);let i=(0,u.useMemo)(()=>n||3==arguments.length?rx():void 0,[]),a=(0,u.useRef)(0),o=tr(),s=(0,u.useMemo)(()=>({ctrls:[],queue:[],flush(e,t){let r=rf(e,t);return!(a.current>0)||s.queue.length||Object.keys(r).some(t=>!e.springs[t])?new Promise(n=>{rp(e,r),s.queue.push(()=>{n(rh(e,t))}),o()}):rh(e,t)}}),[]),l=(0,u.useRef)([...s.ctrls]),c=[],h=ta(e)||0;function d(e,r){for(let i=e;i<r;i++){let e=l.current[i]||(l.current[i]=new ru(null,s.flush)),r=n?n(i,e):t[i];r&&(c[i]=function(e){let t=rn(e);return R.und(t.default)&&(t.default=tT(t)),t}(r))}}(0,u.useMemo)(()=>{z(l.current.slice(e,h),e=>{tQ(e,i),e.stop(!0)}),l.current.length=e,d(h,e)},[e]),(0,u.useMemo)(()=>{d(0,Math.min(h,e))},r);let f=l.current.map((e,t)=>rf(e,c[t])),p=(0,u.useContext)(rv),m=ta(p),A=p!==m&&tz(p);te(()=>{a.current++,s.ctrls=l.current;let{queue:e}=s;e.length&&(s.queue=[],z(e,e=>e())),z(l.current,(e,t)=>{i?.add(e),A&&e.start({default:p});let r=c[t];r&&(tL(e,r.ref),e.ref?e.queue.push(r):e.start(r))})}),tn(()=>()=>{z(s.ctrls,e=>e.stop(!0))});let g=f.map(e=>({...e}));return i?[g,i]:g}function r_(e,t){let r=R.fun(e),[[n],i]=rE(1,r?e:[e],r?t||[]:t);return r||2==arguments.length?[n,i]:n}var rC=()=>rx(),rb=()=>(0,u.useState)(rC)[0],rw=(e,t)=>{let r=function(e){let t=(0,u.useRef)(null);return null===t.current&&(t.current=e()),t.current}(()=>new re(e,t));return tn(()=>()=>{r.stop()}),r};function rB(e,t,r){let n;let i=R.fun(t)&&t;i&&!r&&(r=[]);let a=!0,o=rE(e,(e,r)=>{let o=i?i(e,r):t;return n=o.ref,a=a&&o.reverse,o},r||[{}]);if(te(()=>{z(o[1].current,(e,t)=>{let r=o[1].current[t+(a?1:-1)];if(tL(e,n),e.ref){r&&e.update({to:r.springs});return}r?e.start({to:r.springs}):e.start()})},r),i||3==arguments.length){let e=n??o[1];return e._getProps=(t,r,n)=>{let i=R.fun(t)?t(n,r):t;if(i){let t=e.current[n+(i.reverse?1:-1)];return t&&(i.to=t.springs),i}},o}return o[0]}function rI(e,t,r){let n=R.fun(t)&&t,{reset:i,sort:a,trail:o=0,expires:s=!0,exitBeforeEnter:l=!1,onDestroyed:c,ref:h,config:d}=n?n():t,f=(0,u.useMemo)(()=>n||3==arguments.length?rx():void 0,[]),p=Q(e),m=[],A=(0,u.useRef)(null),g=i?null:A.current;te(()=>{A.current=m}),tn(()=>(z(m,e=>{f?.add(e.ctrl),e.ctrl.ref=f}),()=>{z(A.current,e=>{e.expired&&clearTimeout(e.expirationId),tQ(e.ctrl,f),e.ctrl.stop(!0)})}));let v=function(e,{key:t,keys:r=t},n){if(null===r){let t=new Set;return e.map(e=>{let r=n&&n.find(r=>r.item===e&&"leave"!==r.phase&&!t.has(r));return r?(t.add(r),r.key):rM++})}return R.und(r)?e:R.fun(r)?e.map(r):Q(r)}(p,n?n():t,g),y=i&&A.current||[];te(()=>z(y,({ctrl:e,item:t,key:r})=>{tQ(e,f),tw(c,t,r)}));let x=[];if(g&&z(g,(e,t)=>{e.expired?(clearTimeout(e.expirationId),y.push(e)):~(t=x[t]=v.indexOf(e.key))&&(m[t]=e)}),z(p,(e,t)=>{m[t]||(m[t]={key:v[t],item:e,phase:"mount",ctrl:new ru},m[t].ctrl.item=e)}),x.length){let e=-1,{leave:r}=n?n():t;z(x,(t,n)=>{let i=g[n];~t?(e=m.indexOf(i),m[e]={...i,item:p[t]}):r&&m.splice(++e,0,i)})}R.fun(a)&&m.sort((e,t)=>a(e.item,t.item));let E=-o,_=tr(),C=tT(t),b=new Map,w=(0,u.useRef)(new Map),B=(0,u.useRef)(!1);z(m,(e,r)=>{let i,a;let c=e.key,u=e.phase,f=n?n():t,p=tw(f.delay||0,c);if("mount"==u)i=f.enter,a="enter";else{let e=0>v.indexOf(c);if("leave"!=u){if(e)i=f.leave,a="leave";else{if(!(i=f.update))return;a="update"}}else{if(e)return;i=f.enter,a="enter"}}if(i=tw(i,e.item,r),!(i=R.obj(i)?tR(i):{to:i}).config){let t=d||C.config;i.config=tw(t,e.item,r,a)}E+=o;let m={...C,delay:p+E,ref:h,immediate:f.immediate,reset:!1,...i};if("enter"==a&&R.und(m.from)){let i=n?n():t,a=R.und(i.initial)||g?i.from:i.initial;m.from=tw(a,e.item,r)}let{onResolve:y}=m;m.onResolve=e=>{tw(y,e);let t=A.current,r=t.find(e=>e.key===c);if(r){if(e.cancelled&&"update"!=r.phase)return;if(r.ctrl.idle){let e=t.every(e=>e.ctrl.idle);if("leave"==r.phase){let t=tw(s,r.item);if(!1!==t){let n=!0===t?0:t;if(r.expired=!0,!e&&n>0){n<=2147483647&&(r.expirationId=setTimeout(_,n));return}}}e&&t.some(e=>e.expired)&&(w.current.delete(r),l&&(B.current=!0),_())}}};let x=rf(e.ctrl,m);"leave"===a&&l?w.current.set(e,{phase:a,springs:x,payload:m}):b.set(e,{phase:a,springs:x,payload:m})});let I=(0,u.useContext)(rv),M=ta(I),S=I!==M&&tz(I);te(()=>{S&&z(m,e=>{e.ctrl.start({default:I})})},[I]),z(b,(e,t)=>{if(w.current.size){let e=m.findIndex(e=>e.key===t.key);m.splice(e,1)}}),te(()=>{z(w.current.size?w.current:b,({phase:e,payload:t},r)=>{let{ctrl:n}=r;r.phase=e,f?.add(n),S&&"enter"==e&&n.start({default:I}),t&&(tL(n,t.ref),(n.ref||f)&&!B.current?n.update(t):(n.start(t),B.current&&(B.current=!1)))})},i?void 0:r);let T=e=>u.createElement(u.Fragment,null,m.map((t,r)=>{let{springs:n}=b.get(t)||t.ctrl,i=e({...n},t.item,t,r);return i&&i.type?u.createElement(i.type,{...i.props,key:R.str(t.key)||R.num(t.key)?t.key:t.ctrl.id,ref:i.ref}):i}));return f?[T,f]:T}var rM=1,rS=({container:e,...t}={})=>{let[r,n]=r_(()=>({scrollX:0,scrollY:0,scrollXProgress:0,scrollYProgress:0,...t}),[]);return te(()=>{let t=e7(({x:e,y:t})=>{n.start({scrollX:e.current,scrollXProgress:e.progress,scrollY:t.current,scrollYProgress:t.progress})},{container:e?.current||void 0});return()=>{z(Object.values(r),e=>e.stop()),t()}},[]),r},rT=({container:e,...t})=>{let[r,n]=r_(()=>({width:0,height:0,...t}),[]);return te(()=>{let t=e1(({width:e,height:t})=>{n.start({width:e,height:t,immediate:0===r.width.get()||0===r.height.get()})},{container:e?.current||void 0});return()=>{z(Object.values(r),e=>e.stop()),t()}},[]),r},rP={any:0,all:1};function rD(e,t){let[r,n]=(0,u.useState)(!1),i=(0,u.useRef)(),a=R.fun(e)&&e,{to:o={},from:s={},...l}=a?a():{},c=a?t:e,[h,d]=r_(()=>({from:s,...l}),[]);return(te(()=>{let e=i.current,{root:t,once:a,amount:l="any",...u}=c??{};if(!e||a&&r||"undefined"==typeof IntersectionObserver)return;let h=new WeakMap,f=()=>(o&&d.start(o),n(!0),a?void 0:()=>{s&&d.start(s),n(!1)}),p=new IntersectionObserver(e=>{e.forEach(e=>{let t=h.get(e.target);if(!!t!==e.isIntersecting){if(e.isIntersecting){let t=f();R.fun(t)?h.set(e.target,t):p.unobserve(e.target)}else t&&(t(),h.delete(e.target))}})},{root:t&&t.current||void 0,threshold:"number"==typeof l||Array.isArray(l)?l:rP[l],...u});return p.observe(e),()=>p.unobserve(e)},[c]),a)?[i,h]:[i,r]}function rR({children:e,...t}){return e(r_(t))}function rF({items:e,children:t,...r}){let n=rB(e.length,r);return e.map((e,r)=>{let i=t(e,r);return R.fun(i)?i(n[r]):i})}function rz({items:e,children:t,...r}){return rI(e,r)(t)}var rO=class extends t3{constructor(e,t){super(),this.source=e,this.idle=!0,this._active=new Set,this.calc=ey(...t);let r=this._get();tu(this,ty(r).create(r))}advance(e){let t=this._get();F(t,this.get())||(tc(this).setValue(t),this._onChange(t,this.idle)),!this.idle&&rL(this._active)&&rk(this)}_get(){let e=R.arr(this.source)?this.source.map(eI):Q(eI(this.source));return this.calc(...e)}_start(){this.idle&&!rL(this._active)&&(this.idle=!1,z(th(this),e=>{e.done=!1}),d.skipAnimation?(p.batchedUpdates(()=>this.advance()),rk(this)):q.start(this))}_attach(){let e=1;z(Q(this.source),t=>{eB(t)&&eD(t,this),t1(t)&&(t.idle||this._active.add(t),e=Math.max(e,t.priority+1))}),this.priority=e,this._start()}_detach(){z(Q(this.source),e=>{eB(e)&&eR(e,this)}),this._active.clear(),rk(this)}eventObserved(e){"change"==e.type?e.idle?this.advance():(this._active.add(e.parent),this._start()):"idle"==e.type?this._active.delete(e.parent):"priority"==e.type&&(this.priority=Q(this.source).reduce((e,t)=>Math.max(e,(t1(t)?t.priority:0)+1),0))}};function rQ(e){return!1!==e.idle}function rL(e){return!e.size||Array.from(e).every(rQ)}function rk(e){e.idle||(e.idle=!0,z(th(e),e=>{e.done=!0}),eS(e,{type:"idle",parent:e}))}var rU=(e,...t)=>new rO(e,t),rN=(e,...t)=>(eJ(),new rO(e,t));d.assign({createStringInterpolator:eH,to:(e,t)=>new rO(e,t)});var rG=q.advance,rH=["primitive"].concat(Object.keys(r(7776)).filter(e=>/^[A-Z]/.test(e)).map(e=>e[0].toLowerCase()+e.slice(1)));d.assign({createStringInterpolator:eH,colors:{transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},frameLoop:"demand"}),(0,c.n)(()=>{p.advance()});var rV=((e,{applyAnimatedValues:t=()=>!1,createAnimatedStyle:r=e=>new tA(e),getComponentProps:n=e=>e}={})=>{let i={applyAnimatedValues:t,createAnimatedStyle:r,getComponentProps:n},a=e=>{let t=tC(e)||"Anonymous";return(e=R.str(e)?a[e]||(a[e]=tx(e,i)):e[t_]||(e[t_]=tx(e,i))).displayName=`Animated(${t})`,e};return O(e,(t,r)=>{R.arr(e)&&(r=tC(t)),a[r]=a(t)}),{animated:a}})(rH,{applyAnimatedValues:c.j}).animated},5097:function(e,t){"use strict";t.Z=function(){return function(e){var t,r,n,i,a={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},o={},s={};o.L=1,s[1]="L",Object.keys(a).forEach(function(e,t){o[e]=1<<t+1,s[o[e]]=e}),Object.freeze(o);var l=o.LRI|o.RLI|o.FSI,c=o.L|o.R|o.AL,u=o.B|o.S|o.WS|o.ON|o.FSI|o.LRI|o.RLI|o.PDI,h=o.BN|o.RLE|o.LRE|o.RLO|o.LRO|o.PDF,d=o.S|o.WS|o.B|l|o.PDI|h,f=null;function p(e){return!function(){if(!f){f=new Map;var e=function(e){if(a.hasOwnProperty(e)){var t=0;a[e].split(",").forEach(function(r){var n=r.split("+"),i=n[0],a=n[1];i=parseInt(i,36),a=a?parseInt(a,36):0,f.set(t+=i,o[e]);for(var s=0;s<a;s++)f.set(++t,o[e])})}};for(var t in a)e(t)}}(),f.get(e.codePointAt(0))||o.L}var m={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function A(e,t){var r,n=0,i=new Map,a=t&&new Map;return e.split(",").forEach(function e(o){if(-1!==o.indexOf("+"))for(var s=+o;s--;)e(r);else{r=o;var l=o.split(">"),c=l[0],u=l[1];c=String.fromCodePoint(n+=parseInt(c,36)),u=String.fromCodePoint(n+=parseInt(u,36)),i.set(c,u),t&&a.set(u,c)}}),{map:i,reverseMap:a}}function g(){if(!t){var e=A(m.pairs,!0),i=e.map,a=e.reverseMap;t=i,r=a,n=A(m.canonical,!1).map}}function v(e){return g(),t.get(e)||null}function y(e){return g(),r.get(e)||null}function x(e){return g(),n.get(e)||null}var E=o.L,_=o.R,C=o.EN,b=o.ES,w=o.ET,B=o.AN,I=o.CS,M=o.B,S=o.S,T=o.ON,P=o.BN,D=o.NSM,R=o.AL,F=o.LRO,z=o.RLO,O=o.LRE,Q=o.RLE,L=o.PDF,k=o.LRI,U=o.RLI,N=o.FSI,G=o.PDI;function H(e){return!function(){if(!i){var e=A("14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",!0),t=e.map;e.reverseMap.forEach(function(e,r){t.set(r,e)}),i=t}}(),i.get(e)||null}function V(e,t,r,n){var i=e.length;r=Math.max(0,null==r?0:+r),n=Math.min(i-1,null==n?i-1:+n);var a=[];return t.paragraphs.forEach(function(i){var o=Math.max(r,i.start),s=Math.min(n,i.end);if(o<s){for(var l=t.levels.slice(o,s+1),c=s;c>=o&&p(e[c])&d;c--)l[c]=i.level;for(var u=i.level,h=1/0,f=0;f<l.length;f++){var m=l[f];m>u&&(u=m),m<h&&(h=1|m)}for(var A=u;A>=h;A--)for(var g=0;g<l.length;g++)if(l[g]>=A){for(var v=g;g+1<l.length&&l[g+1]>=A;)g++;g>v&&a.push([v+o,g+o])}}}),a}function j(e,t,r,n){for(var i=V(e,t,r,n),a=[],o=0;o<e.length;o++)a[o]=o;return i.forEach(function(e){for(var t=e[0],r=e[1],n=a.slice(t,r+1),i=n.length;i--;)a[r-i]=n[i]}),a}return e.closingToOpeningBracket=y,e.getBidiCharType=p,e.getBidiCharTypeName=function(e){return s[p(e)]},e.getCanonicalBracket=x,e.getEmbeddingLevels=function(e,t){for(var r=new Uint32Array(e.length),n=0;n<e.length;n++)r[n]=p(e[n]);var i=new Map;function a(e,t){var n=r[e];r[e]=t,i.set(n,i.get(n)-1),n&u&&i.set(u,i.get(u)-1),i.set(t,(i.get(t)||0)+1),t&u&&i.set(u,(i.get(u)||0)+1)}for(var o=new Uint8Array(e.length),s=new Map,f=[],m=null,A=0;A<e.length;A++)m||f.push(m={start:A,end:e.length-1,level:"rtl"===t?1:"ltr"===t?0:tT(A,!1)}),r[A]&M&&(m.end=A,m=null);for(var g=Q|O|z|F|l|G|L|M,H=function(e){return e+(1&e?1:2)},V=function(e){return e+(1&e?2:1)},j=0;j<f.length;j++){var Y=[{_level:(m=f[j]).level,_override:0,_isolate:0}],J=void 0,W=0,q=0,K=0;i.clear();for(var X=m.start;X<=m.end;X++){var Z=r[X];if(J=Y[Y.length-1],i.set(Z,(i.get(Z)||0)+1),Z&u&&i.set(u,(i.get(u)||0)+1),Z&g){if(Z&(Q|O)){o[X]=J._level;var $=(Z===Q?V:H)(J._level);!($<=125)||W||q?!W&&q++:Y.push({_level:$,_override:0,_isolate:0})}else if(Z&(z|F)){o[X]=J._level;var ee=(Z===z?V:H)(J._level);!(ee<=125)||W||q?!W&&q++:Y.push({_level:ee,_override:Z&z?_:E,_isolate:0})}else if(Z&l){Z&N&&(Z=1===tT(X+1,!0)?U:k),o[X]=J._level,J._override&&a(X,J._override);var et=(Z===U?V:H)(J._level);et<=125&&0===W&&0===q?(K++,Y.push({_level:et,_override:0,_isolate:1,_isolInitIndex:X})):W++}else if(Z&G){if(W>0)W--;else if(K>0){for(q=0;!Y[Y.length-1]._isolate;)Y.pop();var er=Y[Y.length-1]._isolInitIndex;null!=er&&(s.set(er,X),s.set(X,er)),Y.pop(),K--}J=Y[Y.length-1],o[X]=J._level,J._override&&a(X,J._override)}else Z&L?(0===W&&(q>0?q--:!J._isolate&&Y.length>1&&(Y.pop(),J=Y[Y.length-1])),o[X]=J._level):Z&M&&(o[X]=m.level)}else o[X]=J._level,J._override&&Z!==P&&a(X,J._override)}for(var en=[],ei=null,ea=m.start;ea<=m.end;ea++){var eo=r[ea];if(!(eo&h)){var es=o[ea],el=eo&l,ec=eo===G;ei&&es===ei._level?(ei._end=ea,ei._endsWithIsolInit=el):en.push(ei={_start:ea,_end:ea,_level:es,_startsWithPDI:ec,_endsWithIsolInit:el})}}for(var eu=[],eh=0;eh<en.length;eh++){var ed=en[eh];if(!ed._startsWithPDI||ed._startsWithPDI&&!s.has(ed._start)){for(var ef=[ei=ed],ep=void 0;ei&&ei._endsWithIsolInit&&null!=(ep=s.get(ei._end));)for(var em=eh+1;em<en.length;em++)if(en[em]._start===ep){ef.push(ei=en[em]);break}for(var eA=[],eg=0;eg<ef.length;eg++)for(var ev=ef[eg],ey=ev._start;ey<=ev._end;ey++)eA.push(ey);for(var ex=o[eA[0]],eE=m.level,e_=eA[0]-1;e_>=0;e_--)if(!(r[e_]&h)){eE=o[e_];break}var eC=eA[eA.length-1],eb=o[eC],ew=m.level;if(!(r[eC]&l)){for(var eB=eC+1;eB<=m.end;eB++)if(!(r[eB]&h)){ew=o[eB];break}}eu.push({_seqIndices:eA,_sosType:Math.max(eE,ex)%2?_:E,_eosType:Math.max(ew,eb)%2?_:E})}}for(var eI=0;eI<eu.length;eI++){var eM=eu[eI],eS=eM._seqIndices,eT=eM._sosType,eP=eM._eosType,eD=1&o[eS[0]]?_:E;if(i.get(D))for(var eR=0;eR<eS.length;eR++){var eF=eS[eR];if(r[eF]&D){for(var ez=eT,eO=eR-1;eO>=0;eO--)if(!(r[eS[eO]]&h)){ez=r[eS[eO]];break}a(eF,ez&(l|G)?T:ez)}}if(i.get(C))for(var eQ=0;eQ<eS.length;eQ++){var eL=eS[eQ];if(r[eL]&C)for(var ek=eQ-1;ek>=-1;ek--){var eU=-1===ek?eT:r[eS[ek]];if(eU&c){eU===R&&a(eL,B);break}}}if(i.get(R))for(var eN=0;eN<eS.length;eN++){var eG=eS[eN];r[eG]&R&&a(eG,_)}if(i.get(b)||i.get(I))for(var eH=1;eH<eS.length-1;eH++){var eV=eS[eH];if(r[eV]&(b|I)){for(var ej=0,eY=0,eJ=eH-1;eJ>=0&&(ej=r[eS[eJ]])&h;eJ--);for(var eW=eH+1;eW<eS.length&&(eY=r[eS[eW]])&h;eW++);ej===eY&&(r[eV]===b?ej===C:ej&(C|B))&&a(eV,ej)}}if(i.get(C)){for(var eq=0;eq<eS.length;eq++)if(r[eS[eq]]&C){for(var eK=eq-1;eK>=0&&r[eS[eK]]&(w|h);eK--)a(eS[eK],C);for(eq++;eq<eS.length&&r[eS[eq]]&(w|h|C);eq++)r[eS[eq]]!==C&&a(eS[eq],C)}}if(i.get(w)||i.get(b)||i.get(I))for(var eX=0;eX<eS.length;eX++){var eZ=eS[eX];if(r[eZ]&(w|b|I)){a(eZ,T);for(var e$=eX-1;e$>=0&&r[eS[e$]]&h;e$--)a(eS[e$],T);for(var e0=eX+1;e0<eS.length&&r[eS[e0]]&h;e0++)a(eS[e0],T)}}if(i.get(C))for(var e1=0,e2=eT;e1<eS.length;e1++){var e3=eS[e1],e4=r[e3];e4&C?e2===E&&a(e3,E):e4&c&&(e2=e4)}if(i.get(u)){for(var e5=_|C|B,e6=e5|E,e8=[],e9=[],e7=0;e7<eS.length;e7++)if(r[eS[e7]]&u){var te=e[eS[e7]],tt=void 0;if(null!==v(te)){if(e9.length<63)e9.push({char:te,seqIndex:e7});else break}else if(null!==(tt=y(te)))for(var tr=e9.length-1;tr>=0;tr--){var tn=e9[tr].char;if(tn===tt||tn===y(x(te))||v(x(tn))===te){e8.push([e9[tr].seqIndex,e7]),e9.length=tr;break}}}e8.sort(function(e,t){return e[0]-t[0]});for(var ti=0;ti<e8.length;ti++){for(var ta=e8[ti],to=ta[0],ts=ta[1],tl=!1,tc=0,tu=to+1;tu<ts;tu++){var th=eS[tu];if(r[th]&e6){tl=!0;var td=r[th]&e5?_:E;if(td===eD){tc=td;break}}}if(tl&&!tc){tc=eT;for(var tf=to-1;tf>=0;tf--){var tp=eS[tf];if(r[tp]&e6){var tm=r[tp]&e5?_:E;tc=tm!==eD?tm:eD;break}}}if(tc){if(r[eS[to]]=r[eS[ts]]=tc,tc!==eD){for(var tA=to+1;tA<eS.length;tA++)if(!(r[eS[tA]]&h)){p(e[eS[tA]])&D&&(r[eS[tA]]=tc);break}}if(tc!==eD){for(var tg=ts+1;tg<eS.length;tg++)if(!(r[eS[tg]]&h)){p(e[eS[tg]])&D&&(r[eS[tg]]=tc);break}}}}for(var tv=0;tv<eS.length;tv++)if(r[eS[tv]]&u){for(var ty=tv,tx=tv,tE=eT,t_=tv-1;t_>=0;t_--)if(r[eS[t_]]&h)ty=t_;else{tE=r[eS[t_]]&e5?_:E;break}for(var tC=eP,tb=tv+1;tb<eS.length;tb++)if(r[eS[tb]]&(u|h))tx=tb;else{tC=r[eS[tb]]&e5?_:E;break}for(var tw=ty;tw<=tx;tw++)r[eS[tw]]=tE===tC?tE:eD;tv=tx}}}for(var tB=m.start;tB<=m.end;tB++){var tI=o[tB],tM=r[tB];if(1&tI?tM&(E|C|B)&&o[tB]++:tM&_?o[tB]++:tM&(B|C)&&(o[tB]+=2),tM&h&&(o[tB]=0===tB?m.level:o[tB-1]),tB===m.end||p(e[tB])&(S|M))for(var tS=tB;tS>=0&&p(e[tS])&d;tS--)o[tS]=m.level}}return{levels:o,paragraphs:f};function tT(t,n){for(var i=t;i<e.length;i++){var a=r[i];if(a&(_|R))return 1;if(a&(M|E)||n&&a===G)break;if(a&l){var o=function(t){for(var n=1,i=t+1;i<e.length;i++){var a=r[i];if(a&M)break;if(a&G){if(0==--n)return i}else a&l&&n++}return -1}(i);i=-1===o?e.length:o}}return 0}},e.getMirroredCharacter=H,e.getMirroredCharactersMap=function(e,t,r,n){var i=e.length;r=Math.max(0,null==r?0:+r),n=Math.min(i-1,null==n?i-1:+n);for(var a=new Map,o=r;o<=n;o++)if(1&t[o]){var s=H(e[o]);null!==s&&a.set(o,s)}return a},e.getReorderSegments=V,e.getReorderedIndices=j,e.getReorderedString=function(e,t,r,n){var i=j(e,t,r,n),a=[].concat(e);return i.forEach(function(r,n){a[n]=(1&t.levels[r]?H(e[r]):null)||e[r]}),a.join("")},e.openingToClosingBracket=v,Object.defineProperty(e,"__esModule",{value:!0}),e}({})}},1810:function(e,t,r){"use strict";r.d(t,{w_:function(){return u}});var n=r(2265),i={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},a=n.createContext&&n.createContext(i),o=["attr","size","title"];function s(){return(s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach(function(t){var n,i;n=t,i=r[t],(n=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function u(e){return t=>n.createElement(h,s({attr:c({},e.attr)},t),function e(t){return t&&t.map((t,r)=>n.createElement(t.tag,c({key:r},t.attr),e(t.child)))}(e.child))}function h(e){var t=t=>{var r,{attr:i,size:a,title:l}=e,u=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,o),h=a||t.size||"1em";return t.className&&(r=t.className),e.className&&(r=(r?r+" ":"")+e.className),n.createElement("svg",s({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,i,u,{className:r,style:c(c({color:e.color||t.color},t.style),e.style),height:h,width:h,xmlns:"http://www.w3.org/2000/svg"}),l&&n.createElement("title",null,l),e.children)};return void 0!==a?n.createElement(a.Consumer,null,e=>t(e)):t(i)}},5611:function(e,t,r){"use strict";let n,i,a;r.d(t,{Bi:function(){return k},JA:function(){return tV}});var o=r(3149),s=r(2265),l=r(7437),c=r(7776),u=r(5238),h=r(4014),d=Object.create,f=Object.defineProperty,p=Object.defineProperties,m=Object.getOwnPropertyDescriptor,A=Object.getOwnPropertyDescriptors,g=Object.getOwnPropertyNames,v=Object.getOwnPropertySymbols,y=Object.getPrototypeOf,x=Object.prototype.hasOwnProperty,E=Object.prototype.propertyIsEnumerable,_=(e,t,r)=>t in e?f(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,C=(e,t)=>{for(var r in t||(t={}))x.call(t,r)&&_(e,r,t[r]);if(v)for(var r of v(t))E.call(t,r)&&_(e,r,t[r]);return e},b=(e,t)=>p(e,A(t)),w=(e,t)=>{var r={};for(var n in e)x.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&v)for(var n of v(e))0>t.indexOf(n)&&E.call(e,n)&&(r[n]=e[n]);return r},B=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),I=(e,t)=>{for(var r in t)f(e,r,{get:t[r],enumerable:!0})},M=(e,t,r)=>new Promise((n,i)=>{var a=e=>{try{s(r.next(e))}catch(e){i(e)}},o=e=>{try{s(r.throw(e))}catch(e){i(e)}},s=e=>e.done?n(e.value):Promise.resolve(e.value).then(a,o);s((r=r.apply(e,t)).next())}),S=B((e,t)=>{t.exports=e=>encodeURIComponent(e).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`)}),T=B((e,t)=>{var r="%[a-f0-9]{2}",n=RegExp("("+r+")|([^%]+?)","gi"),i=RegExp("("+r+")+","gi");t.exports=function(e){if("string"!=typeof e)throw TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"��","%FF%FE":"��"},r=i.exec(e);r;){try{t[r[0]]=decodeURIComponent(r[0])}catch(e){var a=function(e){try{return decodeURIComponent(e)}catch(i){for(var t=e.match(n)||[],r=1;r<t.length;r++)t=(e=(function e(t,r){try{return[decodeURIComponent(t.join(""))]}catch(e){}if(1===t.length)return t;r=r||1;var n=t.slice(0,r),i=t.slice(r);return Array.prototype.concat.call([],e(n),e(i))})(t,r).join("")).match(n)||[];return e}}(r[0]);a!==r[0]&&(t[r[0]]=a)}r=i.exec(e)}t["%C2"]="�";for(var o=Object.keys(t),s=0;s<o.length;s++){var l=o[s];e=e.replace(RegExp(l,"g"),t[l])}return e}(e)}}}),P=B((e,t)=>{t.exports=(e,t)=>{if(!("string"==typeof e&&"string"==typeof t))throw TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];let r=e.indexOf(t);return -1===r?[e]:[e.slice(0,r),e.slice(r+t.length)]}}),D=B((e,t)=>{t.exports=function(e,t){for(var r={},n=Object.keys(e),i=Array.isArray(t),a=0;a<n.length;a++){var o=n[a],s=e[o];(i?-1!==t.indexOf(o):t(o,s,e))&&(r[o]=s)}return r}}),R=B(e=>{var t=S(),r=T(),n=P(),i=D(),a=e=>null==e,o=Symbol("encodeFragmentIdentifier");function s(e){if("string"!=typeof e||1!==e.length)throw TypeError("arrayFormatSeparator must be single character string")}function l(e,r){return r.encode?r.strict?t(e):encodeURIComponent(e):e}function c(e,t){return t.decode?r(e):e}function u(e){let t=e.indexOf("#");return -1!==t&&(e=e.slice(0,t)),e}function h(e){let t=(e=u(e)).indexOf("?");return -1===t?"":e.slice(t+1)}function d(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):t.parseBooleans&&null!==e&&("true"===e.toLowerCase()||"false"===e.toLowerCase())&&(e="true"===e.toLowerCase()),e}function f(e,t){s((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);let r=function(e){let t;switch(e.arrayFormat){case"index":return(e,r,n)=>{if(t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),!t){n[e]=r;return}void 0===n[e]&&(n[e]={}),n[e][t[1]]=r};case"bracket":return(e,r,n)=>{if(t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),!t){n[e]=r;return}if(void 0===n[e]){n[e]=[r];return}n[e]=[].concat(n[e],r)};case"colon-list-separator":return(e,r,n)=>{if(t=/(:list)$/.exec(e),e=e.replace(/:list$/,""),!t){n[e]=r;return}if(void 0===n[e]){n[e]=[r];return}n[e]=[].concat(n[e],r)};case"comma":case"separator":return(t,r,n)=>{let i="string"==typeof r&&r.includes(e.arrayFormatSeparator),a="string"==typeof r&&!i&&c(r,e).includes(e.arrayFormatSeparator);r=a?c(r,e):r;let o=i||a?r.split(e.arrayFormatSeparator).map(t=>c(t,e)):null===r?r:c(r,e);n[t]=o};case"bracket-separator":return(t,r,n)=>{let i=/(\[\])$/.test(t);if(t=t.replace(/\[\]$/,""),!i){n[t]=r&&c(r,e);return}let a=null===r?[]:r.split(e.arrayFormatSeparator).map(t=>c(t,e));if(void 0===n[t]){n[t]=a;return}n[t]=[].concat(n[t],a)};default:return(e,t,r)=>{if(void 0===r[e]){r[e]=t;return}r[e]=[].concat(r[e],t)}}}(t),i=Object.create(null);if("string"!=typeof e||!(e=e.trim().replace(/^[?#&]/,"")))return i;for(let a of e.split("&")){if(""===a)continue;let[e,o]=n(t.decode?a.replace(/\+/g," "):a,"=");o=void 0===o?null:["comma","separator","bracket-separator"].includes(t.arrayFormat)?o:c(o,t),r(c(e,t),o,i)}for(let e of Object.keys(i)){let r=i[e];if("object"==typeof r&&null!==r)for(let e of Object.keys(r))r[e]=d(r[e],t);else i[e]=d(r,t)}return!1===t.sort?i:(!0===t.sort?Object.keys(i).sort():Object.keys(i).sort(t.sort)).reduce((e,t)=>{let r=i[t];return r&&"object"==typeof r&&!Array.isArray(r)?e[t]=function e(t){return Array.isArray(t)?t.sort():"object"==typeof t?e(Object.keys(t)).sort((e,t)=>Number(e)-Number(t)).map(e=>t[e]):t}(r):e[t]=r,e},Object.create(null))}e.extract=h,e.parse=f,e.stringify=(e,t)=>{if(!e)return"";s((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);let r=r=>t.skipNull&&a(e[r])||t.skipEmptyString&&""===e[r],n=function(e){switch(e.arrayFormat){case"index":return t=>(r,n)=>{let i=r.length;return void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,[l(t,e),"[",i,"]"].join("")]:[...r,[l(t,e),"[",l(i,e),"]=",l(n,e)].join("")]};case"bracket":return t=>(r,n)=>void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,[l(t,e),"[]"].join("")]:[...r,[l(t,e),"[]=",l(n,e)].join("")];case"colon-list-separator":return t=>(r,n)=>void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,[l(t,e),":list="].join("")]:[...r,[l(t,e),":list=",l(n,e)].join("")];case"comma":case"separator":case"bracket-separator":{let t="bracket-separator"===e.arrayFormat?"[]=":"=";return r=>(n,i)=>void 0===i||e.skipNull&&null===i||e.skipEmptyString&&""===i?n:(i=null===i?"":i,0===n.length?[[l(r,e),t,l(i,e)].join("")]:[[n,l(i,e)].join(e.arrayFormatSeparator)])}default:return t=>(r,n)=>void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,l(t,e)]:[...r,[l(t,e),"=",l(n,e)].join("")]}}(t),i={};for(let t of Object.keys(e))r(t)||(i[t]=e[t]);let o=Object.keys(i);return!1!==t.sort&&o.sort(t.sort),o.map(r=>{let i=e[r];return void 0===i?"":null===i?l(r,t):Array.isArray(i)?0===i.length&&"bracket-separator"===t.arrayFormat?l(r,t)+"[]":i.reduce(n(r),[]).join("&"):l(r,t)+"="+l(i,t)}).filter(e=>e.length>0).join("&")},e.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);let[r,i]=n(e,"#");return Object.assign({url:r.split("?")[0]||"",query:f(h(e),t)},t&&t.parseFragmentIdentifier&&i?{fragmentIdentifier:c(i,t)}:{})},e.stringifyUrl=(t,r)=>{var n;let i,a;r=Object.assign({encode:!0,strict:!0,[o]:!0},r);let s=u(t.url).split("?")[0]||"",c=e.extract(t.url),h=Object.assign(e.parse(c,{sort:!1}),t.query),d=e.stringify(h,r);d&&(d=`?${d}`);let f=(n=t.url,i="",-1!==(a=n.indexOf("#"))&&(i=n.slice(a)),i);return t.fragmentIdentifier&&(f=`#${r[o]?l(t.fragmentIdentifier,r):t.fragmentIdentifier}`),`${s}${d}${f}`},e.pick=(t,r,n)=>{n=Object.assign({parseFragmentIdentifier:!0,[o]:!1},n);let{url:a,query:s,fragmentIdentifier:l}=e.parseUrl(t,n);return e.stringifyUrl({url:a,query:i(s,r),fragmentIdentifier:l},n)},e.exclude=(t,r,n)=>{let i=Array.isArray(r)?e=>!r.includes(e):(e,t)=>!r(e,t);return e.pick(t,i,n)}}),F=(e,t)=>({dpr:e,camera:{fov:t},linear:!0,flat:!0,gl:{preserveDrawingBuffer:!0}}),z={zoom:1,distance:14},O={zoom:5,distance:14},Q="https://ruucm.github.io/shadergradient/shadergradient@1.0.0/hdr/";function L({title:e="",color1:t="#ff7e5f",color2:r="#feb47b"}){return(0,l.jsx)("div",{style:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",background:`linear-gradient(to right, ${t}, ${r})`,color:"white",fontSize:"20px",textAlign:"center",padding:"20px",fontFamily:"Inter",fontWeight:"500"},children:(0,l.jsx)("p",{children:e})})}function k(e){var{children:t,pointerEvents:r="none",pixelDensity:n=1,fov:i=45}=e,a=w(e,["children","pointerEvents","pixelDensity","fov"]);let[c,u]=function(){let[e,t]=(0,s.useState)(-1);return[e,e=>{let r=e.gl.domElement,n=e=>{e.preventDefault(),t(1),console.log("[Context Lost]")},i=e=>{t(0),console.log("[Context Restored]")},a=e=>{t(2),console.log("[Context Error]")};return r.addEventListener("webglcontextlost",n),r.addEventListener("webglcontextrestored",i),r.addEventListener("webglcontextcreationerror",a),()=>{r.removeEventListener("webglcontextlost",n),r.removeEventListener("webglcontextrestored",i),r.removeEventListener("webglcontextcreationerror",a)}}]}();return 1===c?(0,l.jsx)(L,{title:"The graphics context has been lost. Please wait while we try to restore it..."}):(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(o.Canvas,b(C(b(C({id:"gradientCanvas",resize:{offsetSize:!0}},F(n,i)),{style:{pointerEvents:r},onCreated:u}),a),{children:t}),n+i)})}var U=class{constructor(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}},N=new c.OrthographicCamera(-1,1,1,-1,0,1),G=new c.BufferGeometry;G.setAttribute("position",new c.Float32BufferAttribute([-1,3,0,-1,-1,0,3,-1,0],3)),G.setAttribute("uv",new c.Float32BufferAttribute([0,2,0,0,2,0],2));var H=class{constructor(e){this._mesh=new c.Mesh(G,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,N)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}},V=class extends U{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,r){let n,i,a=e.getContext(),o=e.state;o.buffers.color.setMask(!1),o.buffers.depth.setMask(!1),o.buffers.color.setLocked(!0),o.buffers.depth.setLocked(!0),this.inverse?(n=0,i=1):(n=1,i=0),o.buffers.stencil.setTest(!0),o.buffers.stencil.setOp(a.REPLACE,a.REPLACE,a.REPLACE),o.buffers.stencil.setFunc(a.ALWAYS,n,4294967295),o.buffers.stencil.setClear(i),o.buffers.stencil.setLocked(!0),e.setRenderTarget(r),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),o.buffers.color.setLocked(!1),o.buffers.depth.setLocked(!1),o.buffers.stencil.setLocked(!1),o.buffers.stencil.setFunc(a.EQUAL,1,4294967295),o.buffers.stencil.setOp(a.KEEP,a.KEEP,a.KEEP),o.buffers.stencil.setLocked(!0)}},j=class extends U{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}},Y=class extends U{constructor(e,t){super(),this.textureID=void 0!==t?t:"tDiffuse",e instanceof c.ShaderMaterial?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=c.UniformsUtils.clone(e.uniforms),this.material=new c.ShaderMaterial({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new H(this.material)}render(e,t,r){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=r.texture),this.fsQuad.material=this.material,this.renderToScreen?e.setRenderTarget(null):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil)),this.fsQuad.render(e)}},J={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );
			gl_FragColor = opacity * texel;

		}`},W=class{constructor(e,t){if(this.renderer=e,void 0===t){let r={minFilter:c.LinearFilter,magFilter:c.LinearFilter,format:c.RGBAFormat},n=e.getSize(new c.Vector2);this._pixelRatio=e.getPixelRatio(),this._width=n.width,this._height=n.height,(t=new c.WebGLRenderTarget(this._width*this._pixelRatio,this._height*this._pixelRatio,r)).texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],void 0===J&&console.error("THREE.EffectComposer relies on CopyShader"),void 0===Y&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new Y(J),this.clock=new c.Clock}swapBuffers(){let e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){let t=this.passes.indexOf(e);-1!==t&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){void 0===e&&(e=this.clock.getDelta());let t=this.renderer.getRenderTarget(),r=!1;for(let t=0,n=this.passes.length;t<n;t++){let n=this.passes[t];if(!1!==n.enabled){if(n.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(t),n.render(this.renderer,this.writeBuffer,this.readBuffer,e,r),n.needsSwap){if(r){let t=this.renderer.getContext(),r=this.renderer.state.buffers.stencil;r.setFunc(t.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),r.setFunc(t.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==V&&(n instanceof V?r=!0:n instanceof j&&(r=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(void 0===e){let t=this.renderer.getSize(new c.Vector2);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,(e=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;let r=this._width*this._pixelRatio,n=this._height*this._pixelRatio;this.renderTarget1.setSize(r,n),this.renderTarget2.setSize(r,n);for(let e=0;e<this.passes.length;e++)this.passes[e].setSize(r,n)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}};new c.OrthographicCamera(-1,1,1,-1,0,1);var q=new c.BufferGeometry;q.setAttribute("position",new c.Float32BufferAttribute([-1,3,0,-1,-1,0,3,-1,0],3)),q.setAttribute("uv",new c.Float32BufferAttribute([0,2,0,0,2,0],2));var K=class extends U{constructor(e,t,r,n,i){super(),this.scene=e,this.camera=t,this.overrideMaterial=r,this.clearColor=n,this.clearAlpha=void 0!==i?i:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new c.Color}render(e,t,r){let n,i,a=e.autoClear;e.autoClear=!1,void 0!==this.overrideMaterial&&(i=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(e.getClearColor(this._oldClearColor),n=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:r),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(this._oldClearColor,n),void 0!==this.overrideMaterial&&(this.scene.overrideMaterial=i),e.autoClear=a}},X=new Map([[0,null],[1,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x+y,1.0)*opacity+x*(1.0-opacity);}"],[2,"vec3 blend(const in vec3 x,const in vec3 y,const in float opacity){return y*opacity+x*(1.0-opacity);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){float a=min(y.a,opacity);return vec4(blend(x.rgb,y.rgb,a),max(x.a,a));}"],[3,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y)*0.5*opacity+x*(1.0-opacity);}"],[4,"float blend(const in float x,const in float y){return(y==0.0)?y:max(1.0-(1.0-x)/y,0.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[5,"float blend(const in float x,const in float y){return(y==1.0)?y:min(x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[6,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x,y)*opacity+x*(1.0-opacity);}"],[7,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return abs(x-y)*opacity+x*(1.0-opacity);}"],[8,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y-2.0*x*y)*opacity+x*(1.0-opacity);}"],[9,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x,y)*opacity+x*(1.0-opacity);}"],[10,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return x*y*opacity+x*(1.0-opacity);}"],[11,"float blend(const in float x,const in float y){return(y>0.0)?min(x/y,1.0):1.0;}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[12,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-abs(1.0-x-y))*opacity+x*(1.0-opacity);}"],[13,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y*opacity+x*(1.0-opacity);}"],[14,"float blend(const in float x,const in float y){return(x<0.5)?(2.0*x*y):(1.0-2.0*(1.0-x)*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[15,"float blend(const in float x,const in float y){return(y==1.0)?y:min(x*x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[16,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-(1.0-x)*(1.0-y))*opacity+x*(1.0-opacity);}"],[17,"float blend(const in float x,const in float y){return(y<0.5)?(2.0*x*y+x*x*(1.0-2.0*y)):(sqrt(x)*(2.0*y-1.0)+2.0*x*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[18,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x+y-1.0,0.0)*opacity+x*(1.0-opacity);}"]]),Z=class extends c.EventDispatcher{constructor(e,t=1){super(),this.blendFunction=e,this.opacity=new c.Uniform(t)}getBlendFunction(){return this.blendFunction}setBlendFunction(e){this.blendFunction=e,this.dispatchEvent({type:"change"})}getShaderCode(){return X.get(this.blendFunction)}},$={uniforms:{tDiffuse:{value:null},shape:{value:1},radius:{value:2},rotateR:{value:Math.PI/12*1},rotateG:{value:Math.PI/12*2},rotateB:{value:Math.PI/12*3},scatter:{value:1},width:{value:20},height:{value:20},blending:{value:1},blendingMode:{value:1},greyscale:{value:!1},disable:{value:!1}},vertexShader:`

		varying vec2 vUV;
		varying vec3 vPosition;

		void main() {

			vUV = uv;
			vPosition = position;

			gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);

		}`,fragmentShader:`

		#define SQRT2_MINUS_ONE 0.41421356
		#define SQRT2_HALF_MINUS_ONE 0.20710678
		#define PI2 6.28318531
		#define SHAPE_DOT 1
		#define SHAPE_ELLIPSE 2
		#define SHAPE_LINE 3
		#define SHAPE_SQUARE 4
		#define BLENDING_LINEAR 1
		#define BLENDING_MULTIPLY 2
		#define BLENDING_ADD 3
		#define BLENDING_LIGHTER 4
		#define BLENDING_DARKER 5
		uniform sampler2D tDiffuse;
		uniform float radius;
		uniform float rotateR;
		uniform float rotateG;
		uniform float rotateB;
		uniform float scatter;
		uniform float width;
		uniform float height;
		uniform int shape;
		uniform bool disable;
		uniform float blending;
		uniform int blendingMode;
		varying vec2 vUV;
		varying vec3 vPosition;
		uniform bool greyscale;
		const int samples = 8;

		float blend( float a, float b, float t ) {

		// linear blend
			return a * ( 1.0 - t ) + b * t;

		}

		float hypot( float x, float y ) {

		// vector magnitude
			return sqrt( x * x + y * y );

		}

		float rand( vec2 seed ){

		// get pseudo-random number
			return fract( sin( dot( seed.xy, vec2( 12.9898, 78.233 ) ) ) * 43758.5453 );

		}

		float distanceToDotRadius( float channel, vec2 coord, vec2 normal, vec2 p, float angle, float rad_max ) {

		// apply shape-specific transforms
			float dist = hypot( coord.x - p.x, coord.y - p.y );
			float rad = channel;

			if ( shape == SHAPE_DOT ) {

				rad = pow( abs( rad ), 1.125 ) * rad_max;

			} else if ( shape == SHAPE_ELLIPSE ) {

				rad = pow( abs( rad ), 1.125 ) * rad_max;

				if ( dist != 0.0 ) {
					float dot_p = abs( ( p.x - coord.x ) / dist * normal.x + ( p.y - coord.y ) / dist * normal.y );
					dist = ( dist * ( 1.0 - SQRT2_HALF_MINUS_ONE ) ) + dot_p * dist * SQRT2_MINUS_ONE;
				}

			} else if ( shape == SHAPE_LINE ) {

				rad = pow( abs( rad ), 1.5) * rad_max;
				float dot_p = ( p.x - coord.x ) * normal.x + ( p.y - coord.y ) * normal.y;
				dist = hypot( normal.x * dot_p, normal.y * dot_p );

			} else if ( shape == SHAPE_SQUARE ) {

				float theta = atan( p.y - coord.y, p.x - coord.x ) - angle;
				float sin_t = abs( sin( theta ) );
				float cos_t = abs( cos( theta ) );
				rad = pow( abs( rad ), 1.4 );
				rad = rad_max * ( rad + ( ( sin_t > cos_t ) ? rad - sin_t * rad : rad - cos_t * rad ) );

			}

			return rad - dist;

		}

		struct Cell {

		// grid sample positions
			vec2 normal;
			vec2 p1;
			vec2 p2;
			vec2 p3;
			vec2 p4;
			float samp2;
			float samp1;
			float samp3;
			float samp4;

		};

		vec4 getSample( vec2 point ) {

		// multi-sampled point
			vec4 tex = texture2D( tDiffuse, vec2( point.x / width, point.y / height ) );
			float base = rand( vec2( floor( point.x ), floor( point.y ) ) ) * PI2;
			float step = PI2 / float( samples );
			// float dist = radius * 0.66;
			float dist = radius * 0.0;

			for ( int i = 0; i < samples; ++i ) {

				float r = base + step * float( i );
				vec2 coord = point + vec2( cos( r ) * dist, sin( r ) * dist );
				tex += texture2D( tDiffuse, vec2( coord.x / width, coord.y / height ) );

			}

			tex /= float( samples ) + 1.0;
			return tex;

		}

		float getDotColour( Cell c, vec2 p, int channel, float angle, float aa ) {

		// get colour for given point
			float dist_c_1, dist_c_2, dist_c_3, dist_c_4, res;

			if ( channel == 0 ) {

				c.samp1 = getSample( c.p1 ).r;
				c.samp2 = getSample( c.p2 ).r;
				c.samp3 = getSample( c.p3 ).r;
				c.samp4 = getSample( c.p4 ).r;

			} else if (channel == 1) {

				c.samp1 = getSample( c.p1 ).g;
				c.samp2 = getSample( c.p2 ).g;
				c.samp3 = getSample( c.p3 ).g;
				c.samp4 = getSample( c.p4 ).g;

			} else {

				c.samp1 = getSample( c.p1 ).b;
				c.samp3 = getSample( c.p3 ).b;
				c.samp2 = getSample( c.p2 ).b;
				c.samp4 = getSample( c.p4 ).b;

			}

			dist_c_1 = distanceToDotRadius( c.samp1, c.p1, c.normal, p, angle, radius );
			dist_c_2 = distanceToDotRadius( c.samp2, c.p2, c.normal, p, angle, radius );
			dist_c_3 = distanceToDotRadius( c.samp3, c.p3, c.normal, p, angle, radius );
			dist_c_4 = distanceToDotRadius( c.samp4, c.p4, c.normal, p, angle, radius );
			res = ( dist_c_1 > 0.0 ) ? clamp( dist_c_1 / aa, 0.0, 1.0 ) : 0.0;
			// res = 0.0;
			res += ( dist_c_2 > 0.0 ) ? clamp( dist_c_2 / aa, 0.0, 1.0 ) : 0.0;
			res += ( dist_c_3 > 0.0 ) ? clamp( dist_c_3 / aa, 0.0, 1.0 ) : 0.0;
			res += ( dist_c_4 > 0.0 ) ? clamp( dist_c_4 / aa, 0.0, 1.0 ) : 0.0;
			res = clamp( res, 0.0, 1.0 );

			return res;
			// return 2

		}

		Cell getReferenceCell( vec2 p, vec2 origin, float grid_angle, float step ) {

		// get containing cell
			Cell c;

		// calc grid
			vec2 n = vec2( cos( grid_angle ), sin( grid_angle ) );
			float threshold = step * 0.5;
			float dot_normal = n.x * ( p.x - origin.x ) + n.y * ( p.y - origin.y );
			float dot_line = -n.y * ( p.x - origin.x ) + n.x * ( p.y - origin.y );
			vec2 offset = vec2( n.x * dot_normal, n.y * dot_normal );
			float offset_normal = mod( hypot( offset.x, offset.y ), step );
			float normal_dir = ( dot_normal < 0.0 ) ? 1.0 : -1.0;
			float normal_scale = ( ( offset_normal < threshold ) ? -offset_normal : step - offset_normal ) * normal_dir;
			float offset_line = mod( hypot( ( p.x - offset.x ) - origin.x, ( p.y - offset.y ) - origin.y ), step );
			float line_dir = ( dot_line < 0.0 ) ? 1.0 : -1.0;
			float line_scale = ( ( offset_line < threshold ) ? -offset_line : step - offset_line ) * line_dir;

		// get closest corner
			c.normal = n;
			c.p1.x = p.x - n.x * normal_scale + n.y * line_scale;
			c.p1.y = p.y - n.y * normal_scale - n.x * line_scale;

		// scatter
			if ( scatter != 0.0 ) {

				float off_mag = scatter * threshold * 0.5;
				float off_angle = rand( vec2( floor( c.p1.x ), floor( c.p1.y ) ) ) * PI2;
				c.p1.x += cos( off_angle ) * off_mag;
				c.p1.y += sin( off_angle ) * off_mag;

			}

		// find corners
			float normal_step = normal_dir * ( ( offset_normal < threshold ) ? step : -step );
			float line_step = line_dir * ( ( offset_line < threshold ) ? step : -step );
			c.p2.x = c.p1.x - n.x * normal_step;
			c.p2.y = c.p1.y - n.y * normal_step;
			c.p3.x = c.p1.x + n.y * line_step;
			c.p3.y = c.p1.y - n.x * line_step;
			c.p4.x = c.p1.x - n.x * normal_step + n.y * line_step;
			c.p4.y = c.p1.y - n.y * normal_step - n.x * line_step;

			return c;

		}

		float blendColour( float a, float b, float t ) {

		// blend colours
			if ( blendingMode == BLENDING_LINEAR ) {
				return blend( a, b, 1.0 - t );
			} else if ( blendingMode == BLENDING_ADD ) {
				return blend( a, min( 1.0, a + b ), t );
			} else if ( blendingMode == BLENDING_MULTIPLY ) {
				return blend( a, max( 0.0, a * b ), t );
			} else if ( blendingMode == BLENDING_LIGHTER ) {
				return blend( a, max( a, b ), t );
			} else if ( blendingMode == BLENDING_DARKER ) {
				return blend( a, min( a, b ), t );
			} else {
				return blend( a, b, 1.0 - t );
			}

		}

		void main() {

			if ( ! disable ) {

		// setup
				vec2 p = vec2( vUV.x * width, vUV.y * height ) - vec2(vPosition.x, vPosition.y) * 3.0; // - position values to remove black borders.
				vec2 origin = vec2( 0, 0 );
				float aa = ( radius < 2.5 ) ? radius * 0.5 : 1.25;
				// float aa = 0.0;

		// get channel samples
				Cell cell_r = getReferenceCell( p, origin, rotateR, radius );
				Cell cell_g = getReferenceCell( p, origin, rotateG, radius );
				Cell cell_b = getReferenceCell( p, origin, rotateB, radius );
				float r = getDotColour( cell_r, p, 0, rotateR, aa );
				float g = getDotColour( cell_g, p, 1, rotateG, aa );
				float b = getDotColour( cell_b, p, 2, rotateB, aa );

		// blend with original
				vec4 colour = texture2D( tDiffuse, vUV );
				
				// add masking before blendColour
				if (colour.r == 0.0) {
					r = 0.0;
				} else {
					r = blendColour( r, colour.r, blending );
				}

				if (colour.g == 0.0) {
					g = 0.0;
				} else {
					g = blendColour( g, colour.g, blending );
				}

				if (colour.b == 0.0) {
					b = 0.0;
				} else {
					b = blendColour( b, colour.b, blending );
				}
				
				
				

				if ( greyscale ) {
					r = g = b = (r + b + g) / 3.0;
				}

				// add alpha channel to each r, g, b colors
				vec4 vR;
				vec4 vG;
				vec4 vB;
	
				// apply transparent to outside of mesh
				if (r == 0.0 && colour.r == 0.0) {
					vR = vec4( 0, 0, 0, 0 );
				} else {
					vR = vec4( r, 0, 0, 1 );
				}
	
				if (g == 0.0 && colour.g == 0.0) {
					vG = vec4( 0, 0, 0, 0 );
				} else {
					vG = vec4( 0, g, 0, 1 );
				}
	
				if (b == 0.0 && colour.b == 0.0) {
					vB = vec4( 0, 0, 0, 0 );
				} else {
					vB = vec4( 0, 0, b, 1 );
				}

				// gl_FragColor = vec4( r, g, b, 1.0 );
				gl_FragColor = vR + vG + vB;

			} else {

				gl_FragColor = texture2D( tDiffuse, vUV );

			}

		}`},ee=class{constructor(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}},et=new c.OrthographicCamera(-1,1,1,-1,0,1),er=new c.BufferGeometry;er.setAttribute("position",new c.Float32BufferAttribute([-1,3,0,-1,-1,0,3,-1,0],3)),er.setAttribute("uv",new c.Float32BufferAttribute([0,2,0,0,2,0],2));var en=class{constructor(e){this._mesh=new c.Mesh(er,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,et)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}},ei=class extends ee{constructor(e,t,r){super(),void 0===$&&console.error("THREE.HalftonePass requires HalftoneShader"),this.uniforms=c.UniformsUtils.clone($.uniforms),this.material=new c.ShaderMaterial({uniforms:this.uniforms,fragmentShader:$.fragmentShader,vertexShader:$.vertexShader}),this.uniforms.width.value=e,this.uniforms.height.value=t,this.uniforms.disable.value=r.disable,this.uniforms.blending.value=r.blending,this.fsQuad=new en(this.material),this.blendMode=new Z(16),this.extensions=null}render(e,t,r){this.material.uniforms.tDiffuse.value=r.texture,this.renderToScreen?e.setRenderTarget(null):(e.setRenderTarget(t),this.clear&&e.clear()),this.fsQuad.render(e)}setSize(e,t){this.uniforms.width.value=e,this.uniforms.height.value=t}initialize(e,t,r){}addEventListener(){}getAttributes(){return this.attributes}getFragmentShader(){return $.fragmentShader}getVertexShader(){return $.vertexShader}update(e,t,r){}},ea=e=>"function"==typeof e,eo=s.forwardRef((e,t)=>{var r,{envMap:n,resolution:i=256,frames:a=1/0,children:o,makeDefault:h}=e,d=w(e,["envMap","resolution","frames","children","makeDefault"]);let f=(0,u.A)(({set:e})=>e),p=(0,u.A)(({camera:e})=>e),m=(0,u.A)(({size:e})=>e),A=s.useRef(null),g=s.useRef(null),v=function(e,t,r){let{gl:n,size:i,viewport:a}=(0,u.A)(),o="number"==typeof e?e:i.width*a.dpr,l=i.height*a.dpr,h=("number"==typeof e?void 0:e)||{},{samples:d}=h,f=w(h,["samples"]),p=s.useMemo(()=>{let e;return(e=new c.WebGLRenderTarget(o,l,C({minFilter:c.LinearFilter,magFilter:c.LinearFilter,encoding:n.outputEncoding,type:c.HalfFloatType},f))).samples=d,e},[]);return s.useLayoutEffect(()=>{p.setSize(o,l),d&&(p.samples=d)},[d,p,o,l]),s.useEffect(()=>()=>p.dispose(),[]),p}(i);s.useLayoutEffect(()=>{d.manual||A.current.updateProjectionMatrix()},[m,d]),s.useLayoutEffect(()=>{A.current.updateProjectionMatrix()}),s.useLayoutEffect(()=>{if(h)return f(()=>({camera:A.current})),()=>f(()=>({camera:p}))},[A,h,f]);let y=0,x=null,E=ea(o);return(0,u.C)(e=>{E&&(a===1/0||y<a)&&(g.current.visible=!1,e.gl.setRenderTarget(v),x=e.scene.background,n&&(e.scene.background=n),e.gl.render(e.scene,A.current),e.scene.background=x,e.gl.setRenderTarget(null),g.current.visible=!0,y++)}),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("orthographicCamera",b(C({left:-(m.width/2),right:m.width/2,top:m.height/2,bottom:-(m.height/2),ref:(r=[A,t],function(e){r.forEach(function(t){"function"==typeof t?t(e):null!=t&&(t.current=e)})})},d),{children:!E&&o})),(0,l.jsx)("group",{ref:g,children:E&&o(v.texture)})]})}),es=s.createContext({}),el=()=>s.useContext(es),ec=2*Math.PI,eu=new c.Object3D,eh=new c.Matrix4,[ed,ef]=[new c.Quaternion,new c.Quaternion],ep=new c.Vector3,em=new c.Vector3,eA=e=>"minPolarAngle"in e,eg=({alignment:e="bottom-right",margin:t=[80,80],renderPriority:r=0,autoClear:n=!0,onUpdate:i,onTarget:a,children:o})=>{let h=(0,u.A)(({size:e})=>e),d=(0,u.A)(({camera:e})=>e),f=(0,u.A)(({controls:e})=>e),p=(0,u.A)(({gl:e})=>e),m=(0,u.A)(({scene:e})=>e),A=(0,u.A)(({invalidate:e})=>e),g=s.useRef(),v=s.useRef(),y=s.useRef(null),[x]=s.useState(()=>new c.Scene),E=s.useRef(!1),_=s.useRef(0),C=s.useRef(new c.Vector3(0,0,0)),b=s.useRef(new c.Vector3(0,0,0));s.useEffect(()=>{b.current.copy(d.up)},[d]);let w=s.useCallback(e=>{E.current=!0,(f||a)&&(C.current=(null==f?void 0:f.target)||(null==a?void 0:a())),_.current=d.position.distanceTo(ep),ed.copy(d.quaternion),em.copy(e).multiplyScalar(_.current).add(ep),eu.lookAt(em),ef.copy(eu.quaternion),A()},[f,d,a,A]);s.useEffect(()=>(m.background&&(g.current=m.background,m.background=null,x.background=g.current),()=>{g.current&&(m.background=g.current)}),[]),(0,u.C)((e,t)=>{var r;y.current&&v.current&&(E.current&&(.01>ed.angleTo(ef)?(E.current=!1,eA(f)&&d.up.copy(b.current)):(ed.rotateTowards(ef,t*ec),d.position.set(0,0,1).applyQuaternion(ed).multiplyScalar(_.current).add(C.current),d.up.set(0,1,0).applyQuaternion(ed).normalize(),d.quaternion.copy(ed),i?i():f&&f.update(),A())),eh.copy(d.matrix).invert(),null==(r=v.current)||r.quaternion.setFromRotationMatrix(eh),n&&(p.autoClear=!1),p.clearDepth(),p.render(x,y.current))},r);let B=function(e,t){let r=(0,u.A)(e=>e.pointer),[n]=s.useState(()=>{let t=new c.Raycaster;return function(n,i){t.setFromCamera(r,e instanceof c.Camera?e:e.current);let a=this.constructor.prototype.raycast.bind(this);a&&a(t,i)}});return n}(y),I=s.useMemo(()=>({tweenCamera:w,raycast:B}),[w]),[M,S]=t,T=e.endsWith("-center")?0:e.endsWith("-left")?-h.width/2+M:h.width/2-M,P=e.startsWith("center-")?0:e.startsWith("top-")?h.height/2-S:-h.height/2+S;return(0,u.g)((0,l.jsxs)(es.Provider,{value:I,children:[(0,l.jsx)(eo,{ref:y,position:[0,0,200]}),(0,l.jsx)("group",{ref:v,position:[T,P,0],children:o})]}),x)};function ev({scale:e=[.8,.05,.05],color:t,rotation:r}){return(0,l.jsx)("group",{rotation:r,children:(0,l.jsxs)("mesh",{position:[.4,0,0],children:[(0,l.jsx)("boxGeometry",{args:e}),(0,l.jsx)("meshBasicMaterial",{color:t,toneMapped:!1})]})})}function ey(e){var{onClick:t,font:r,disabled:n,arcStyle:i,label:a,labelColor:o,axisHeadScale:h=1}=e,d=w(e,["onClick","font","disabled","arcStyle","label","labelColor","axisHeadScale"]);let f=(0,u.A)(e=>e.gl),p=s.useMemo(()=>{let e=document.createElement("canvas");e.width=64,e.height=64;let t=e.getContext("2d");return t.beginPath(),t.arc(32,32,16,0,2*Math.PI),t.closePath(),t.fillStyle=i,t.fill(),a&&(t.font=r,t.textAlign="center",t.fillStyle=o,t.fillText(a,32,41)),new c.CanvasTexture(e)},[i,a,o,r]),[m,A]=s.useState(!1),g=(a?1:.75)*(m?1.2:1)*h;return(0,l.jsx)("sprite",b(C({scale:g,onPointerOver:n?void 0:e=>{e.stopPropagation(),A(!0)},onPointerOut:n?void 0:t||(e=>{e.stopPropagation(),A(!1)})},d),{children:(0,l.jsx)("spriteMaterial",{map:p,"map-encoding":f.outputEncoding,"map-anisotropy":f.capabilities.getMaxAnisotropy()||1,alphaTest:.3,opacity:a?1:.75,toneMapped:!1})}))}var ex=e=>{var{hideNegativeAxes:t,hideAxisHeads:r,disabled:n,font:i="18px Inter var, Arial, sans-serif",axisColors:a=["#ff2060","#20df80","#2080ff"],axisHeadScale:o=1,axisScale:s,labels:c=["X","Y","Z"],labelColor:u="#000",onClick:h}=e,d=w(e,["hideNegativeAxes","hideAxisHeads","disabled","font","axisColors","axisHeadScale","axisScale","labels","labelColor","onClick"]);let[f,p,m]=a,{tweenCamera:A,raycast:g}=el(),v={font:i,disabled:n,labelColor:u,raycast:g,onClick:h,axisHeadScale:o,onPointerDown:n?void 0:e=>{A(e.object.position),e.stopPropagation()}};return(0,l.jsxs)("group",b(C({scale:40},d),{children:[(0,l.jsx)(ev,{color:f,rotation:[0,0,0],scale:s}),(0,l.jsx)(ev,{color:p,rotation:[0,0,Math.PI/2],scale:s}),(0,l.jsx)(ev,{color:m,rotation:[0,-Math.PI/2,0],scale:s}),!r&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(ey,C({arcStyle:f,position:[1,0,0],label:c[0]},v)),(0,l.jsx)(ey,C({arcStyle:p,position:[0,1,0],label:c[1]},v)),(0,l.jsx)(ey,C({arcStyle:m,position:[0,0,1],label:c[2]},v)),!t&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(ey,C({arcStyle:f,position:[-1,0,0]},v)),(0,l.jsx)(ey,C({arcStyle:p,position:[0,-1,0]},v)),(0,l.jsx)(ey,C({arcStyle:m,position:[0,0,-1]},v))]})]}),(0,l.jsx)("ambientLight",{intensity:.5}),(0,l.jsx)("pointLight",{position:[10,10,10],intensity:.5})]}))};function eE({isFigmaPlugin:e}){return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(eg,{alignment:"bottom-right",margin:e?[25,25]:[65,110],renderPriority:2,children:(0,l.jsx)(ex,{axisColors:["#FF430A","#FF430A","#FF430A"],labelColor:"white",hideNegativeAxes:!0,axisHeadScale:.8})})})}var e_={LEFT:1,RIGHT:2,MIDDLE:4},eC=Object.freeze({NONE:0,ROTATE:1,TRUCK:2,OFFSET:4,DOLLY:8,ZOOM:16,TOUCH_ROTATE:32,TOUCH_TRUCK:64,TOUCH_OFFSET:128,TOUCH_DOLLY:256,TOUCH_ZOOM:512,TOUCH_DOLLY_TRUCK:1024,TOUCH_DOLLY_OFFSET:2048,TOUCH_DOLLY_ROTATE:4096,TOUCH_ZOOM_TRUCK:8192,TOUCH_ZOOM_OFFSET:16384,TOUCH_ZOOM_ROTATE:32768});function eb(e){return e.isPerspectiveCamera}function ew(e){return e.isOrthographicCamera}var eB=2*Math.PI,eI=Math.PI/2;function eM(e,t=1e-5){return Math.abs(e)<t}function eS(e,t,r=1e-5){return eM(e-t,r)}function eT(e,t){return Math.round(e/t)*t}function eP(e){return isFinite(e)?e:e<0?-Number.MAX_VALUE:Number.MAX_VALUE}function eD(e){return Math.abs(e)<Number.MAX_VALUE?e:1/0*e}function eR(e,t){t.set(0,0),e.forEach(e=>{t.x+=e.clientX,t.y+=e.clientY}),t.x/=e.length,t.y/=e.length}function eF(e,t){return!!ew(e)&&(console.warn(`${t} is not supported in OrthographicCamera`),!0)}function ez(e){return e.invert?e.invert():e.inverse(),e}var eO,eQ,eL,ek,eU,eN,eG,eH,eV,ej,eY,eJ,eW,eq,eK,eX,eZ,e$,e0,e1,e2,e3,e4=class{constructor(){this._listeners={}}addEventListener(e,t){let r=this._listeners;void 0===r[e]&&(r[e]=[]),-1===r[e].indexOf(t)&&r[e].push(t)}removeEventListener(e,t){let r=this._listeners[e];if(void 0!==r){let e=r.indexOf(t);-1!==e&&r.splice(e,1)}}removeAllEventListeners(e){if(!e){this._listeners={};return}Array.isArray(this._listeners[e])&&(this._listeners[e].length=0)}dispatchEvent(e){let t=this._listeners[e.type];if(void 0!==t){e.target=this;let r=t.slice(0);for(let t=0,n=r.length;t<n;t++)r[t].call(this,e)}}},e5="undefined"!=typeof window,e6=e5&&/Mac/.test(navigator.platform),e8=!(e5&&"PointerEvent"in window),e9=1/8,e7=class extends e4{constructor(e,t){if(super(),this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.minDistance=0,this.maxDistance=1/0,this.infinityDolly=!1,this.minZoom=.01,this.maxZoom=1/0,this.dampingFactor=.05,this.draggingDampingFactor=.25,this.azimuthRotateSpeed=1,this.polarRotateSpeed=1,this.dollySpeed=1,this.truckSpeed=2,this.dollyToCursor=!1,this.dragToOffset=!1,this.verticalDragToForward=!1,this.boundaryFriction=0,this.restThreshold=.01,this.colliderMeshes=[],this.cancel=()=>{},this._enabled=!0,this._state=eC.NONE,this._viewport=null,this._dollyControlAmount=0,this._hasRested=!0,this._boundaryEnclosesCamera=!1,this._needsUpdate=!0,this._updatedLastTime=!1,this._elementRect=new DOMRect,this._activePointers=[],this._truckInternal=(e,t,r)=>{if(eb(this._camera)){let n=eN.copy(this._camera.position).sub(this._target),i=this._camera.getEffectiveFOV()*eO.MathUtils.DEG2RAD,a=n.length()*Math.tan(.5*i),o=this.truckSpeed*e*a/this._elementRect.height,s=this.truckSpeed*t*a/this._elementRect.height;this.verticalDragToForward?(r?this.setFocalOffset(this._focalOffsetEnd.x+o,this._focalOffsetEnd.y,this._focalOffsetEnd.z,!0):this.truck(o,0,!0),this.forward(-s,!0)):r?this.setFocalOffset(this._focalOffsetEnd.x+o,this._focalOffsetEnd.y+s,this._focalOffsetEnd.z,!0):this.truck(o,s,!0)}else if(ew(this._camera)){let n=this._camera,i=e*(n.right-n.left)/n.zoom/this._elementRect.width,a=t*(n.top-n.bottom)/n.zoom/this._elementRect.height;r?this.setFocalOffset(this._focalOffsetEnd.x+i,this._focalOffsetEnd.y+a,this._focalOffsetEnd.z,!0):this.truck(i,a,!0)}},this._rotateInternal=(e,t)=>{let r=eB*this.azimuthRotateSpeed*e/this._elementRect.height,n=eB*this.polarRotateSpeed*t/this._elementRect.height;this.rotate(r,n,!0)},this._dollyInternal=(e,t,r)=>{let n=Math.pow(.95,-e*this.dollySpeed),i=this._sphericalEnd.radius*n,a=this._sphericalEnd.radius,o=a*(e>=0?-1:1);this.dollyTo(i),this.infinityDolly&&(i<this.minDistance||this.maxDistance===this.minDistance)&&(this._camera.getWorldDirection(eN),this._targetEnd.add(eN.normalize().multiplyScalar(o)),this._target.add(eN.normalize().multiplyScalar(o))),this.dollyToCursor&&(this._dollyControlAmount+=this._sphericalEnd.radius-a,this.infinityDolly&&(i<this.minDistance||this.maxDistance===this.minDistance)&&(this._dollyControlAmount-=o),this._dollyControlCoord.set(t,r))},this._zoomInternal=(e,t,r)=>{let n=Math.pow(.95,e*this.dollySpeed),i=this._zoomEnd;this.zoomTo(this._zoom*n),this.dollyToCursor&&(this._dollyControlAmount+=this._zoomEnd-i,this._dollyControlCoord.set(t,r))},void 0===eO&&console.error("camera-controls: `THREE` is undefined. You must first run `CameraControls.install( { THREE: THREE } )`. Check the docs for further information."),this._camera=e,this._yAxisUpSpace=new eO.Quaternion().setFromUnitVectors(this._camera.up,eL),this._yAxisUpSpaceInverse=ez(this._yAxisUpSpace.clone()),this._state=eC.NONE,this._domElement=t,this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none",this._target=new eO.Vector3,this._targetEnd=this._target.clone(),this._focalOffset=new eO.Vector3,this._focalOffsetEnd=this._focalOffset.clone(),this._spherical=new eO.Spherical().setFromVector3(eN.copy(this._camera.position).applyQuaternion(this._yAxisUpSpace)),this._sphericalEnd=this._spherical.clone(),this._zoom=this._camera.zoom,this._zoomEnd=this._zoom,this._nearPlaneCorners=[new eO.Vector3,new eO.Vector3,new eO.Vector3,new eO.Vector3],this._updateNearPlaneCorners(),this._boundary=new eO.Box3(new eO.Vector3(-1/0,-1/0,-1/0),new eO.Vector3(1/0,1/0,1/0)),this._target0=this._target.clone(),this._position0=this._camera.position.clone(),this._zoom0=this._zoom,this._focalOffset0=this._focalOffset.clone(),this._dollyControlAmount=0,this._dollyControlCoord=new eO.Vector2,this.mouseButtons={left:eC.ROTATE,middle:eC.DOLLY,right:eC.TRUCK,wheel:eb(this._camera)?eC.DOLLY:ew(this._camera)?eC.ZOOM:eC.NONE},this.touches={one:eC.TOUCH_ROTATE,two:eb(this._camera)?eC.TOUCH_DOLLY_TRUCK:ew(this._camera)?eC.TOUCH_ZOOM_TRUCK:eC.NONE,three:eC.TOUCH_TRUCK},this._domElement){let e=new eO.Vector2,t=new eO.Vector2,r=new eO.Vector2,n=e=>{if(!this._enabled)return;let t={pointerId:e.pointerId,clientX:e.clientX,clientY:e.clientY,deltaX:0,deltaY:0};this._activePointers.push(t),this._domElement.ownerDocument.removeEventListener("pointermove",o,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",c),this._domElement.ownerDocument.addEventListener("pointermove",o,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",c),m(e)},i=e=>{if(!this._enabled)return;let t={pointerId:0,clientX:e.clientX,clientY:e.clientY,deltaX:0,deltaY:0};this._activePointers.push(t),this._domElement.ownerDocument.removeEventListener("mousemove",s),this._domElement.ownerDocument.removeEventListener("mouseup",u),this._domElement.ownerDocument.addEventListener("mousemove",s),this._domElement.ownerDocument.addEventListener("mouseup",u),m(e)},a=e=>{this._enabled&&(e.preventDefault(),Array.prototype.forEach.call(e.changedTouches,e=>{let t={pointerId:e.identifier,clientX:e.clientX,clientY:e.clientY,deltaX:0,deltaY:0};this._activePointers.push(t)}),this._domElement.ownerDocument.removeEventListener("touchmove",l,{passive:!1}),this._domElement.ownerDocument.removeEventListener("touchend",h),this._domElement.ownerDocument.addEventListener("touchmove",l,{passive:!1}),this._domElement.ownerDocument.addEventListener("touchend",h),m(e))},o=e=>{e.cancelable&&e.preventDefault();let t=e.pointerId,r=this._findPointerById(t);if(r){if(r.clientX=e.clientX,r.clientY=e.clientY,r.deltaX=e.movementX,r.deltaY=e.movementY,"touch"===e.pointerType)switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else this._state=0,(e.buttons&e_.LEFT)===e_.LEFT&&(this._state=this._state|this.mouseButtons.left),(e.buttons&e_.MIDDLE)===e_.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),(e.buttons&e_.RIGHT)===e_.RIGHT&&(this._state=this._state|this.mouseButtons.right);A()}},s=e=>{let t=this._findPointerById(0);t&&(t.clientX=e.clientX,t.clientY=e.clientY,t.deltaX=e.movementX,t.deltaY=e.movementY,this._state=0,(e.buttons&e_.LEFT)===e_.LEFT&&(this._state=this._state|this.mouseButtons.left),(e.buttons&e_.MIDDLE)===e_.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),(e.buttons&e_.RIGHT)===e_.RIGHT&&(this._state=this._state|this.mouseButtons.right),A())},l=e=>{e.cancelable&&e.preventDefault(),Array.prototype.forEach.call(e.changedTouches,e=>{let t=e.identifier,r=this._findPointerById(t);r&&(r.clientX=e.clientX,r.clientY=e.clientY)}),A()},c=e=>{let t=e.pointerId,r=this._findPointerById(t);if(r&&this._activePointers.splice(this._activePointers.indexOf(r),1),"touch"===e.pointerType)switch(this._activePointers.length){case 0:this._state=eC.NONE;break;case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else this._state=eC.NONE;g()},u=()=>{let e=this._findPointerById(0);e&&this._activePointers.splice(this._activePointers.indexOf(e),1),this._state=eC.NONE,g()},h=e=>{switch(Array.prototype.forEach.call(e.changedTouches,e=>{let t=e.identifier,r=this._findPointerById(t);r&&this._activePointers.splice(this._activePointers.indexOf(r),1)}),this._activePointers.length){case 0:this._state=eC.NONE;break;case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}g()},d=-1,f=e=>{if(!this._enabled||this.mouseButtons.wheel===eC.NONE)return;if(e.preventDefault(),this.dollyToCursor||this.mouseButtons.wheel===eC.ROTATE||this.mouseButtons.wheel===eC.TRUCK){let e=performance.now();d-e<1e3&&this._getClientRect(this._elementRect),d=e}let t=e6?-1:-3,r=1===e.deltaMode?e.deltaY/t:e.deltaY/(10*t),n=this.dollyToCursor?(e.clientX-this._elementRect.x)/this._elementRect.width*2-1:0,i=this.dollyToCursor?-((e.clientY-this._elementRect.y)/this._elementRect.height*2)+1:0;switch(this.mouseButtons.wheel){case eC.ROTATE:this._rotateInternal(e.deltaX,e.deltaY);break;case eC.TRUCK:this._truckInternal(e.deltaX,e.deltaY,!1);break;case eC.OFFSET:this._truckInternal(e.deltaX,e.deltaY,!0);break;case eC.DOLLY:this._dollyInternal(-r,n,i);break;case eC.ZOOM:this._zoomInternal(-r,n,i)}this.dispatchEvent({type:"control"})},p=e=>{this._enabled&&e.preventDefault()},m=n=>{if(this._enabled){if(eR(this._activePointers,eU),this._getClientRect(this._elementRect),e.copy(eU),t.copy(eU),this._activePointers.length>=2){let e=eU.x-this._activePointers[1].clientX,n=eU.y-this._activePointers[1].clientY;r.set(0,Math.sqrt(e*e+n*n));let i=(this._activePointers[0].clientX+this._activePointers[1].clientX)*.5,a=(this._activePointers[0].clientY+this._activePointers[1].clientY)*.5;t.set(i,a)}if("touches"in n||"pointerType"in n&&"touch"===n.pointerType)switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else this._state=0,(n.buttons&e_.LEFT)===e_.LEFT&&(this._state=this._state|this.mouseButtons.left),(n.buttons&e_.MIDDLE)===e_.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),(n.buttons&e_.RIGHT)===e_.RIGHT&&(this._state=this._state|this.mouseButtons.right);this.dispatchEvent({type:"controlstart"})}},A=()=>{if(!this._enabled)return;eR(this._activePointers,eU);let n=this._domElement&&document.pointerLockElement===this._domElement,i=n?-this._activePointers[0].deltaX:t.x-eU.x,a=n?-this._activePointers[0].deltaY:t.y-eU.y;if(t.copy(eU),((this._state&eC.ROTATE)===eC.ROTATE||(this._state&eC.TOUCH_ROTATE)===eC.TOUCH_ROTATE||(this._state&eC.TOUCH_DOLLY_ROTATE)===eC.TOUCH_DOLLY_ROTATE||(this._state&eC.TOUCH_ZOOM_ROTATE)===eC.TOUCH_ZOOM_ROTATE)&&this._rotateInternal(i,a),(this._state&eC.DOLLY)===eC.DOLLY||(this._state&eC.ZOOM)===eC.ZOOM){let t=this.dollyToCursor?(e.x-this._elementRect.x)/this._elementRect.width*2-1:0,r=this.dollyToCursor?-((e.y-this._elementRect.y)/this._elementRect.height*2)+1:0;this._state===eC.DOLLY?this._dollyInternal(a*e9,t,r):this._zoomInternal(a*e9,t,r)}if((this._state&eC.TOUCH_DOLLY)===eC.TOUCH_DOLLY||(this._state&eC.TOUCH_ZOOM)===eC.TOUCH_ZOOM||(this._state&eC.TOUCH_DOLLY_TRUCK)===eC.TOUCH_DOLLY_TRUCK||(this._state&eC.TOUCH_ZOOM_TRUCK)===eC.TOUCH_ZOOM_TRUCK||(this._state&eC.TOUCH_DOLLY_OFFSET)===eC.TOUCH_DOLLY_OFFSET||(this._state&eC.TOUCH_ZOOM_OFFSET)===eC.TOUCH_ZOOM_OFFSET||(this._state&eC.TOUCH_DOLLY_ROTATE)===eC.TOUCH_DOLLY_ROTATE||(this._state&eC.TOUCH_ZOOM_ROTATE)===eC.TOUCH_ZOOM_ROTATE){let e=eU.x-this._activePointers[1].clientX,n=eU.y-this._activePointers[1].clientY,i=Math.sqrt(e*e+n*n),a=r.y-i;r.set(0,i);let o=this.dollyToCursor?(t.x-this._elementRect.x)/this._elementRect.width*2-1:0,s=this.dollyToCursor?-((t.y-this._elementRect.y)/this._elementRect.height*2)+1:0;this._state===eC.TOUCH_DOLLY||this._state===eC.TOUCH_DOLLY_ROTATE||this._state===eC.TOUCH_DOLLY_TRUCK||this._state===eC.TOUCH_DOLLY_OFFSET?this._dollyInternal(a*e9,o,s):this._zoomInternal(a*e9,o,s)}((this._state&eC.TRUCK)===eC.TRUCK||(this._state&eC.TOUCH_TRUCK)===eC.TOUCH_TRUCK||(this._state&eC.TOUCH_DOLLY_TRUCK)===eC.TOUCH_DOLLY_TRUCK||(this._state&eC.TOUCH_ZOOM_TRUCK)===eC.TOUCH_ZOOM_TRUCK)&&this._truckInternal(i,a,!1),((this._state&eC.OFFSET)===eC.OFFSET||(this._state&eC.TOUCH_OFFSET)===eC.TOUCH_OFFSET||(this._state&eC.TOUCH_DOLLY_OFFSET)===eC.TOUCH_DOLLY_OFFSET||(this._state&eC.TOUCH_ZOOM_OFFSET)===eC.TOUCH_ZOOM_OFFSET)&&this._truckInternal(i,a,!0),this.dispatchEvent({type:"control"})},g=()=>{eR(this._activePointers,eU),t.copy(eU),0===this._activePointers.length&&(this._domElement.ownerDocument.removeEventListener("pointermove",o,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",c),this._domElement.ownerDocument.removeEventListener("touchmove",l,{passive:!1}),this._domElement.ownerDocument.removeEventListener("touchend",h),this.dispatchEvent({type:"controlend"}))};this._domElement.addEventListener("pointerdown",n),e8&&this._domElement.addEventListener("mousedown",i),e8&&this._domElement.addEventListener("touchstart",a),this._domElement.addEventListener("pointercancel",c),this._domElement.addEventListener("wheel",f,{passive:!1}),this._domElement.addEventListener("contextmenu",p),this._removeAllEventListeners=()=>{this._domElement.removeEventListener("pointerdown",n),this._domElement.removeEventListener("mousedown",i),this._domElement.removeEventListener("touchstart",a),this._domElement.removeEventListener("pointercancel",c),this._domElement.removeEventListener("wheel",f,{passive:!1}),this._domElement.removeEventListener("contextmenu",p),this._domElement.ownerDocument.removeEventListener("pointermove",o,{passive:!1}),this._domElement.ownerDocument.removeEventListener("mousemove",s),this._domElement.ownerDocument.removeEventListener("touchmove",l,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",c),this._domElement.ownerDocument.removeEventListener("mouseup",u),this._domElement.ownerDocument.removeEventListener("touchend",h)},this.cancel=()=>{this._state!==eC.NONE&&(this._state=eC.NONE,this._activePointers.length=0,g())}}this.update(0)}static install(e){eQ=Object.freeze(new(eO=e.THREE).Vector3(0,0,0)),eL=Object.freeze(new eO.Vector3(0,1,0)),ek=Object.freeze(new eO.Vector3(0,0,1)),eU=new eO.Vector2,eN=new eO.Vector3,eG=new eO.Vector3,eH=new eO.Vector3,eV=new eO.Vector3,ej=new eO.Vector3,eY=new eO.Vector3,eJ=new eO.Vector3,eW=new eO.Vector3,eq=new eO.Spherical,eK=new eO.Spherical,eX=new eO.Box3,eZ=new eO.Box3,e$=new eO.Sphere,e0=new eO.Quaternion,e1=new eO.Quaternion,e2=new eO.Matrix4,e3=new eO.Raycaster}static get ACTION(){return eC}get camera(){return this._camera}set camera(e){this._camera=e,this.updateCameraUp(),this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0}get enabled(){return this._enabled}set enabled(e){this._enabled=e,e?(this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none"):(this.cancel(),this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect="")}get active(){return!this._hasRested}get currentAction(){return this._state}get distance(){return this._spherical.radius}set distance(e){this._spherical.radius===e&&this._sphericalEnd.radius===e||(this._spherical.radius=e,this._sphericalEnd.radius=e,this._needsUpdate=!0)}get azimuthAngle(){return this._spherical.theta}set azimuthAngle(e){this._spherical.theta===e&&this._sphericalEnd.theta===e||(this._spherical.theta=e,this._sphericalEnd.theta=e,this._needsUpdate=!0)}get polarAngle(){return this._spherical.phi}set polarAngle(e){this._spherical.phi===e&&this._sphericalEnd.phi===e||(this._spherical.phi=e,this._sphericalEnd.phi=e,this._needsUpdate=!0)}get boundaryEnclosesCamera(){return this._boundaryEnclosesCamera}set boundaryEnclosesCamera(e){this._boundaryEnclosesCamera=e,this._needsUpdate=!0}addEventListener(e,t){super.addEventListener(e,t)}removeEventListener(e,t){super.removeEventListener(e,t)}rotate(e,t,r=!1){return this.rotateTo(this._sphericalEnd.theta+e,this._sphericalEnd.phi+t,r)}rotateAzimuthTo(e,t=!1){return this.rotateTo(e,this._sphericalEnd.phi,t)}rotatePolarTo(e,t=!1){return this.rotateTo(this._sphericalEnd.theta,e,t)}rotateTo(e,t,r=!1){let n=eO.MathUtils.clamp(e,this.minAzimuthAngle,this.maxAzimuthAngle),i=eO.MathUtils.clamp(t,this.minPolarAngle,this.maxPolarAngle);this._sphericalEnd.theta=n,this._sphericalEnd.phi=i,this._sphericalEnd.makeSafe(),this._needsUpdate=!0,r||(this._spherical.theta=this._sphericalEnd.theta,this._spherical.phi=this._sphericalEnd.phi);let a=!r||eS(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&eS(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold);return this._createOnRestPromise(a)}dolly(e,t=!1){return this.dollyTo(this._sphericalEnd.radius-e,t)}dollyTo(e,t=!1){let r=this._sphericalEnd.radius,n=eO.MathUtils.clamp(e,this.minDistance,this.maxDistance);if(this.colliderMeshes.length>=1){let e=this._collisionTest(),t=eS(e,this._spherical.radius);if(!(r>n)&&t)return Promise.resolve();this._sphericalEnd.radius=Math.min(n,e)}else this._sphericalEnd.radius=n;this._needsUpdate=!0,t||(this._spherical.radius=this._sphericalEnd.radius);let i=!t||eS(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(i)}zoom(e,t=!1){return this.zoomTo(this._zoomEnd+e,t)}zoomTo(e,t=!1){this._zoomEnd=eO.MathUtils.clamp(e,this.minZoom,this.maxZoom),this._needsUpdate=!0,t||(this._zoom=this._zoomEnd);let r=!t||eS(this._zoom,this._zoomEnd,this.restThreshold);return this._createOnRestPromise(r)}pan(e,t,r=!1){return console.warn("`pan` has been renamed to `truck`"),this.truck(e,t,r)}truck(e,t,r=!1){this._camera.updateMatrix(),eV.setFromMatrixColumn(this._camera.matrix,0),ej.setFromMatrixColumn(this._camera.matrix,1),eV.multiplyScalar(e),ej.multiplyScalar(-t);let n=eN.copy(eV).add(ej),i=eG.copy(this._targetEnd).add(n);return this.moveTo(i.x,i.y,i.z,r)}forward(e,t=!1){eN.setFromMatrixColumn(this._camera.matrix,0),eN.crossVectors(this._camera.up,eN),eN.multiplyScalar(e);let r=eG.copy(this._targetEnd).add(eN);return this.moveTo(r.x,r.y,r.z,t)}moveTo(e,t,r,n=!1){let i=eN.set(e,t,r).sub(this._targetEnd);this._encloseToBoundary(this._targetEnd,i,this.boundaryFriction),this._needsUpdate=!0,n||this._target.copy(this._targetEnd);let a=!n||eS(this._target.x,this._targetEnd.x,this.restThreshold)&&eS(this._target.y,this._targetEnd.y,this.restThreshold)&&eS(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(a)}fitToBox(e,t,{cover:r=!1,paddingLeft:n=0,paddingRight:i=0,paddingBottom:a=0,paddingTop:o=0}={}){let s=[],l=e.isBox3?eX.copy(e):eX.setFromObject(e);l.isEmpty()&&(console.warn("camera-controls: fitTo() cannot be used with an empty box. Aborting"),Promise.resolve());let c=eT(this._sphericalEnd.theta,eI),u=eT(this._sphericalEnd.phi,eI);s.push(this.rotateTo(c,u,t));let h=eN.setFromSpherical(this._sphericalEnd).normalize(),d=e0.setFromUnitVectors(h,ek),f=eS(Math.abs(h.y),1);f&&d.multiply(e1.setFromAxisAngle(eL,c)),d.multiply(this._yAxisUpSpaceInverse);let p=eZ.makeEmpty();eG.copy(l.min).applyQuaternion(d),p.expandByPoint(eG),eG.copy(l.min).setX(l.max.x).applyQuaternion(d),p.expandByPoint(eG),eG.copy(l.min).setY(l.max.y).applyQuaternion(d),p.expandByPoint(eG),eG.copy(l.max).setZ(l.min.z).applyQuaternion(d),p.expandByPoint(eG),eG.copy(l.min).setZ(l.max.z).applyQuaternion(d),p.expandByPoint(eG),eG.copy(l.max).setY(l.min.y).applyQuaternion(d),p.expandByPoint(eG),eG.copy(l.max).setX(l.min.x).applyQuaternion(d),p.expandByPoint(eG),eG.copy(l.max).applyQuaternion(d),p.expandByPoint(eG),p.min.x-=n,p.min.y-=a,p.max.x+=i,p.max.y+=o,d.setFromUnitVectors(ek,h),f&&d.premultiply(e1.invert()),d.premultiply(this._yAxisUpSpace);let m=p.getSize(eN),A=p.getCenter(eG).applyQuaternion(d);if(eb(this._camera)){let e=this.getDistanceToFitBox(m.x,m.y,m.z,r);s.push(this.moveTo(A.x,A.y,A.z,t)),s.push(this.dollyTo(e,t)),s.push(this.setFocalOffset(0,0,0,t))}else if(ew(this._camera)){let e=this._camera,n=e.right-e.left,i=e.top-e.bottom,a=r?Math.max(n/m.x,i/m.y):Math.min(n/m.x,i/m.y);s.push(this.moveTo(A.x,A.y,A.z,t)),s.push(this.zoomTo(a,t)),s.push(this.setFocalOffset(0,0,0,t))}return Promise.all(s)}fitToSphere(e,t){var r;let n,i;let a=[],o=e instanceof eO.Sphere?e$.copy(e):(n=(r=e$).center,eX.makeEmpty(),e.traverseVisible(e=>{e.isMesh&&eX.expandByObject(e)}),eX.getCenter(n),i=0,e.traverseVisible(e=>{if(!e.isMesh)return;let t=e.geometry.clone();if(t.applyMatrix4(e.matrixWorld),t.isBufferGeometry){let e=t.attributes.position;for(let t=0,r=e.count;t<r;t++)eN.fromBufferAttribute(e,t),i=Math.max(i,n.distanceToSquared(eN))}else{let e=t.attributes.position,r=new eO.Vector3;for(let t=0,a=e.count;t<a;t++)r.fromBufferAttribute(e,t),i=Math.max(i,n.distanceToSquared(r))}}),r.radius=Math.sqrt(i),r);if(a.push(this.moveTo(o.center.x,o.center.y,o.center.z,t)),eb(this._camera)){let e=this.getDistanceToFitSphere(o.radius);a.push(this.dollyTo(e,t))}else if(ew(this._camera)){let e=this._camera.right-this._camera.left,r=this._camera.top-this._camera.bottom,n=2*o.radius;a.push(this.zoomTo(Math.min(e/n,r/n),t))}return a.push(this.setFocalOffset(0,0,0,t)),Promise.all(a)}setLookAt(e,t,r,n,i,a,o=!1){let s=eG.set(n,i,a),l=eN.set(e,t,r);this._targetEnd.copy(s),this._sphericalEnd.setFromVector3(l.sub(s).applyQuaternion(this._yAxisUpSpace)),this.normalizeRotations(),this._needsUpdate=!0,o||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));let c=!o||eS(this._target.x,this._targetEnd.x,this.restThreshold)&&eS(this._target.y,this._targetEnd.y,this.restThreshold)&&eS(this._target.z,this._targetEnd.z,this.restThreshold)&&eS(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&eS(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&eS(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(c)}lerpLookAt(e,t,r,n,i,a,o,s,l,c,u,h,d,f=!1){let p=eN.set(n,i,a),m=eG.set(e,t,r);eq.setFromVector3(m.sub(p).applyQuaternion(this._yAxisUpSpace));let A=eH.set(c,u,h),g=eG.set(o,s,l);eK.setFromVector3(g.sub(A).applyQuaternion(this._yAxisUpSpace)),this._targetEnd.copy(p.lerp(A,d));let v=eK.theta-eq.theta,y=eK.phi-eq.phi,x=eK.radius-eq.radius;this._sphericalEnd.set(eq.radius+x*d,eq.phi+y*d,eq.theta+v*d),this.normalizeRotations(),this._needsUpdate=!0,f||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));let E=!f||eS(this._target.x,this._targetEnd.x,this.restThreshold)&&eS(this._target.y,this._targetEnd.y,this.restThreshold)&&eS(this._target.z,this._targetEnd.z,this.restThreshold)&&eS(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&eS(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&eS(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(E)}setPosition(e,t,r,n=!1){return this.setLookAt(e,t,r,this._targetEnd.x,this._targetEnd.y,this._targetEnd.z,n)}setTarget(e,t,r,n=!1){let i=this.getPosition(eN);return this.setLookAt(i.x,i.y,i.z,e,t,r,n)}setFocalOffset(e,t,r,n=!1){this._focalOffsetEnd.set(e,t,r),this._needsUpdate=!0,n||this._focalOffset.copy(this._focalOffsetEnd);let i=!n||eS(this._focalOffset.x,this._focalOffsetEnd.x,this.restThreshold)&&eS(this._focalOffset.y,this._focalOffsetEnd.y,this.restThreshold)&&eS(this._focalOffset.z,this._focalOffsetEnd.z,this.restThreshold);return this._createOnRestPromise(i)}setOrbitPoint(e,t,r){this._camera.updateMatrixWorld(),eV.setFromMatrixColumn(this._camera.matrixWorldInverse,0),ej.setFromMatrixColumn(this._camera.matrixWorldInverse,1),eY.setFromMatrixColumn(this._camera.matrixWorldInverse,2);let n=eN.set(e,t,r),i=n.distanceTo(this._camera.position),a=n.sub(this._camera.position);eV.multiplyScalar(a.x),ej.multiplyScalar(a.y),eY.multiplyScalar(a.z),eN.copy(eV).add(ej).add(eY),eN.z=eN.z+i,this.dollyTo(i,!1),this.setFocalOffset(-eN.x,eN.y,-eN.z,!1),this.moveTo(e,t,r,!1)}setBoundary(e){if(!e){this._boundary.min.set(-1/0,-1/0,-1/0),this._boundary.max.set(1/0,1/0,1/0),this._needsUpdate=!0;return}this._boundary.copy(e),this._boundary.clampPoint(this._targetEnd,this._targetEnd),this._needsUpdate=!0}setViewport(e,t,r,n){if(null===e){this._viewport=null;return}this._viewport=this._viewport||new eO.Vector4,"number"==typeof e?this._viewport.set(e,t,r,n):this._viewport.copy(e)}getDistanceToFitBox(e,t,r,n=!1){if(eF(this._camera,"getDistanceToFitBox"))return this._spherical.radius;let i=e/t,a=this._camera.getEffectiveFOV()*eO.MathUtils.DEG2RAD,o=this._camera.aspect;return((n?i>o:i<o)?t:e/o)*.5/Math.tan(.5*a)+.5*r}getDistanceToFitSphere(e){if(eF(this._camera,"getDistanceToFitSphere"))return this._spherical.radius;let t=this._camera.getEffectiveFOV()*eO.MathUtils.DEG2RAD,r=2*Math.atan(Math.tan(.5*t)*this._camera.aspect);return e/Math.sin(.5*(1<this._camera.aspect?t:r))}getTarget(e){return(e&&e.isVector3?e:new eO.Vector3).copy(this._targetEnd)}getPosition(e){return(e&&e.isVector3?e:new eO.Vector3).setFromSpherical(this._sphericalEnd).applyQuaternion(this._yAxisUpSpaceInverse).add(this._targetEnd)}getFocalOffset(e){return(e&&e.isVector3?e:new eO.Vector3).copy(this._focalOffsetEnd)}normalizeRotations(){this._sphericalEnd.theta=this._sphericalEnd.theta%eB,this._sphericalEnd.theta<0&&(this._sphericalEnd.theta+=eB),this._spherical.theta+=eB*Math.round((this._sphericalEnd.theta-this._spherical.theta)/eB)}reset(e=!1){return Promise.all([this.setLookAt(this._position0.x,this._position0.y,this._position0.z,this._target0.x,this._target0.y,this._target0.z,e),this.setFocalOffset(this._focalOffset0.x,this._focalOffset0.y,this._focalOffset0.z,e),this.zoomTo(this._zoom0,e)])}saveState(){this.getTarget(this._target0),this.getPosition(this._position0),this._zoom0=this._zoom,this._focalOffset0.copy(this._focalOffset)}updateCameraUp(){this._yAxisUpSpace.setFromUnitVectors(this._camera.up,eL),ez(this._yAxisUpSpaceInverse.copy(this._yAxisUpSpace))}update(e){let t=Math.min((this._state===eC.NONE?this.dampingFactor:this.draggingDampingFactor)*e*60,1),r=this._sphericalEnd.theta-this._spherical.theta,n=this._sphericalEnd.phi-this._spherical.phi,i=this._sphericalEnd.radius-this._spherical.radius,a=eJ.subVectors(this._targetEnd,this._target),o=eW.subVectors(this._focalOffsetEnd,this._focalOffset);if(eM(r)&&eM(n)&&eM(i)&&eM(a.x)&&eM(a.y)&&eM(a.z)&&eM(o.x)&&eM(o.y)&&eM(o.z)?(this._spherical.copy(this._sphericalEnd),this._target.copy(this._targetEnd),this._focalOffset.copy(this._focalOffsetEnd)):(this._spherical.set(this._spherical.radius+i*t,this._spherical.phi+n*t,this._spherical.theta+r*t),this._target.add(a.multiplyScalar(t)),this._focalOffset.add(o.multiplyScalar(t)),this._needsUpdate=!0),0!==this._dollyControlAmount){if(eb(this._camera)){let e=this._camera,t=eN.setFromSpherical(this._sphericalEnd).applyQuaternion(this._yAxisUpSpaceInverse).normalize().negate(),r=eG.copy(t).cross(e.up).normalize();0===r.lengthSq()&&(r.x=1);let n=eH.crossVectors(r,t),i=this._sphericalEnd.radius*Math.tan(e.getEffectiveFOV()*eO.MathUtils.DEG2RAD*.5),a=(this._sphericalEnd.radius-this._dollyControlAmount-this._sphericalEnd.radius)/this._sphericalEnd.radius,o=eN.copy(this._targetEnd).add(r.multiplyScalar(this._dollyControlCoord.x*i*e.aspect)).add(n.multiplyScalar(this._dollyControlCoord.y*i));this._targetEnd.lerp(o,a)}else if(ew(this._camera)){let e=this._camera,t=e.getWorldDirection(eN.clone()),r=this._targetEnd.x*t.x+this._targetEnd.y*t.y+this._targetEnd.z*t.z,n=eN.set(this._dollyControlCoord.x,this._dollyControlCoord.y,(e.near+e.far)/(e.near-e.far)).unproject(e),i=eG.set(0,0,-1).applyQuaternion(e.quaternion),a=eH.copy(n).add(i.multiplyScalar(-n.dot(e.up))),o=-(this._zoom-this._dollyControlAmount-this._zoomEnd)/this._zoom;this._targetEnd.lerp(a,o);let s=this._targetEnd.x*t.x+this._targetEnd.y*t.y+this._targetEnd.z*t.z,l=t.multiplyScalar(s-r);this._targetEnd.sub(l)}this._target.copy(this._targetEnd),this._boundary.clampPoint(this._targetEnd,this._targetEnd),this._dollyControlAmount=0}let s=this._collisionTest();this._spherical.radius=Math.min(this._spherical.radius,s),this._spherical.makeSafe(),this._camera.position.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(this._target),this._camera.lookAt(this._target),eM(this._focalOffset.x)&&eM(this._focalOffset.y)&&eM(this._focalOffset.z)||(this._camera.updateMatrix(),eV.setFromMatrixColumn(this._camera.matrix,0),ej.setFromMatrixColumn(this._camera.matrix,1),eY.setFromMatrixColumn(this._camera.matrix,2),eV.multiplyScalar(this._focalOffset.x),ej.multiplyScalar(-this._focalOffset.y),eY.multiplyScalar(this._focalOffset.z),eN.copy(eV).add(ej).add(eY),this._camera.position.add(eN)),this._boundaryEnclosesCamera&&this._encloseToBoundary(this._camera.position.copy(this._target),eN.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse),1);let l=this._zoomEnd-this._zoom;this._zoom+=l*t,this._camera.zoom!==this._zoom&&(eM(l)&&(this._zoom=this._zoomEnd),this._camera.zoom=this._zoom,this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0);let c=this._needsUpdate;return c&&!this._updatedLastTime?(this._hasRested=!1,this.dispatchEvent({type:"wake"}),this.dispatchEvent({type:"update"})):c?(this.dispatchEvent({type:"update"}),eM(r,this.restThreshold)&&eM(n,this.restThreshold)&&eM(i,this.restThreshold)&&eM(a.x,this.restThreshold)&&eM(a.y,this.restThreshold)&&eM(a.z,this.restThreshold)&&eM(o.x,this.restThreshold)&&eM(o.y,this.restThreshold)&&eM(o.z,this.restThreshold)&&eM(l,this.restThreshold)&&!this._hasRested&&(this._hasRested=!0,this.dispatchEvent({type:"rest"}))):!c&&this._updatedLastTime&&this.dispatchEvent({type:"sleep"}),this._updatedLastTime=c,this._needsUpdate=!1,c}toJSON(){return JSON.stringify({enabled:this._enabled,minDistance:this.minDistance,maxDistance:eP(this.maxDistance),minZoom:this.minZoom,maxZoom:eP(this.maxZoom),minPolarAngle:this.minPolarAngle,maxPolarAngle:eP(this.maxPolarAngle),minAzimuthAngle:eP(this.minAzimuthAngle),maxAzimuthAngle:eP(this.maxAzimuthAngle),dampingFactor:this.dampingFactor,draggingDampingFactor:this.draggingDampingFactor,dollySpeed:this.dollySpeed,truckSpeed:this.truckSpeed,dollyToCursor:this.dollyToCursor,verticalDragToForward:this.verticalDragToForward,target:this._targetEnd.toArray(),position:eN.setFromSpherical(this._sphericalEnd).add(this._targetEnd).toArray(),zoom:this._zoomEnd,focalOffset:this._focalOffsetEnd.toArray(),target0:this._target0.toArray(),position0:this._position0.toArray(),zoom0:this._zoom0,focalOffset0:this._focalOffset0.toArray()})}fromJSON(e,t=!1){let r=JSON.parse(e),n=eN.fromArray(r.position);this.enabled=r.enabled,this.minDistance=r.minDistance,this.maxDistance=eD(r.maxDistance),this.minZoom=r.minZoom,this.maxZoom=eD(r.maxZoom),this.minPolarAngle=r.minPolarAngle,this.maxPolarAngle=eD(r.maxPolarAngle),this.minAzimuthAngle=eD(r.minAzimuthAngle),this.maxAzimuthAngle=eD(r.maxAzimuthAngle),this.dampingFactor=r.dampingFactor,this.draggingDampingFactor=r.draggingDampingFactor,this.dollySpeed=r.dollySpeed,this.truckSpeed=r.truckSpeed,this.dollyToCursor=r.dollyToCursor,this.verticalDragToForward=r.verticalDragToForward,this._target0.fromArray(r.target0),this._position0.fromArray(r.position0),this._zoom0=r.zoom0,this._focalOffset0.fromArray(r.focalOffset0),this.moveTo(r.target[0],r.target[1],r.target[2],t),eq.setFromVector3(n.sub(this._targetEnd).applyQuaternion(this._yAxisUpSpace)),this.rotateTo(eq.theta,eq.phi,t),this.zoomTo(r.zoom,t),this.setFocalOffset(r.focalOffset[0],r.focalOffset[1],r.focalOffset[2],t),this._needsUpdate=!0}dispose(){this._removeAllEventListeners()}_findPointerById(e){let t=null;return this._activePointers.some(r=>r.pointerId===e&&(t=r,!0)),t}_encloseToBoundary(e,t,r){let n=t.lengthSq();if(0===n)return e;let i=eG.copy(t).add(e),a=this._boundary.clampPoint(i,eH).sub(i),o=a.lengthSq();if(0===o)return e.add(t);if(o===n)return e;if(0===r)return e.add(t).add(a);{let n=1+r*o/t.dot(a);return e.add(eG.copy(t).multiplyScalar(n)).add(a.multiplyScalar(1-r))}}_updateNearPlaneCorners(){if(eb(this._camera)){let e=this._camera,t=e.near,r=Math.tan(e.getEffectiveFOV()*eO.MathUtils.DEG2RAD*.5)*t,n=r*e.aspect;this._nearPlaneCorners[0].set(-n,-r,0),this._nearPlaneCorners[1].set(n,-r,0),this._nearPlaneCorners[2].set(n,r,0),this._nearPlaneCorners[3].set(-n,r,0)}else if(ew(this._camera)){let e=this._camera,t=1/e.zoom,r=e.left*t,n=e.right*t,i=e.top*t,a=e.bottom*t;this._nearPlaneCorners[0].set(r,i,0),this._nearPlaneCorners[1].set(n,i,0),this._nearPlaneCorners[2].set(n,a,0),this._nearPlaneCorners[3].set(r,a,0)}}_collisionTest(){let e=1/0;if(!(this.colliderMeshes.length>=1)||eF(this._camera,"_collisionTest"))return e;let t=eN.setFromSpherical(this._spherical).divideScalar(this._spherical.radius);e2.lookAt(eQ,t,this._camera.up);for(let r=0;r<4;r++){let n=eG.copy(this._nearPlaneCorners[r]);n.applyMatrix4(e2);let i=eH.addVectors(this._target,n);e3.set(i,t),e3.far=this._spherical.radius+1;let a=e3.intersectObjects(this.colliderMeshes);0!==a.length&&a[0].distance<e&&(e=a[0].distance)}return e}_getClientRect(e){let t=this._domElement.getBoundingClientRect();return e.x=t.left,e.y=t.top,this._viewport?(e.x+=this._viewport.x,e.y+=t.height-this._viewport.w-this._viewport.y,e.width=this._viewport.z,e.height=this._viewport.w):(e.width=t.width,e.height=t.height),e}_createOnRestPromise(e){return e?Promise.resolve():(this._hasRested=!1,this.dispatchEvent({type:"transitionstart"}),new Promise(e=>{let t=()=>{this.removeEventListener("rest",t),e()};this.addEventListener("rest",t)}))}_removeAllEventListeners(){}};function te(e){return e/180*Math.PI}function tt(e){return e.map(e=>te(e))}function tr(e){return e.replace("http://localhost:3001/customize","").replace("https://shadergradient.co/customize","").replace("https://www.shadergradient.co/customize","")}function tn(e){var{dampingFactor:t=.05}=e,r=w(e,["dampingFactor"]);e7.install({THREE:c}),(0,u.e)({CameraControls:e7});let n=(0,u.A)(e=>e.camera),i=(0,u.A)(e=>e.gl),a=function({type:e,cAzimuthAngle:t,cPolarAngle:r,cDistance:n,cameraZoom:i,zoomOut:a,enableTransition:o}){let l=(0,s.useRef)(),c=l.current;return(0,u.C)((e,t)=>l.current.update(t)),(0,s.useEffect)(()=>{null==c||c.rotateTo(te(t),te(r),o)},[c,t,r]),(0,s.useEffect)(()=>{a?"sphere"===e?(null==c||c.dollyTo(O.distance,o),null==c||c.zoomTo(O.zoom,o)):(null==c||c.dollyTo(z.distance,o),null==c||c.zoomTo(z.zoom,o)):"sphere"===e?(null==c||c.zoomTo(i,o),null==c||c.dollyTo(14,o)):(null==c||c.dollyTo(n,o),null==c||c.zoomTo(1,o))},[c,a,e,i,n]),l}(r);return(0,l.jsx)("cameraControls",{ref:a,args:[n,i.domElement],enableDamping:!0,dampingFactor:t,zoomSpeed:10,dollySpeed:10,restThreshold:0})}var ti=class extends c.DataTextureLoader{constructor(e){super(e),this.type=c.HalfFloatType}parse(e){let t=function(e,t){switch(e){case 1:throw Error("THREE.RGBELoader: Read Error: "+(t||""));case 2:throw Error("THREE.RGBELoader: Write Error: "+(t||""));case 3:throw Error("THREE.RGBELoader: Bad File Format: "+(t||""));default:throw Error("THREE.RGBELoader: Memory Error: "+(t||""))}},r=`
`,n=function(e,t,n){t=t||1024;let i=e.pos,a=-1,o=0,s="",l=String.fromCharCode.apply(null,new Uint16Array(e.subarray(i,i+128)));for(;0>(a=l.indexOf(r))&&o<t&&i<e.byteLength;)s+=l,o+=l.length,i+=128,l+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(i,i+128)));return -1<a&&(!1!==n&&(e.pos+=o+a+1),s+l.slice(0,a))},i=new Uint8Array(e);i.pos=0;let a=function(e){let r=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,i=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,a=/^\s*FORMAT=(\S+)\s*$/,o=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,s={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0},l,c;for(!(e.pos>=e.byteLength)&&(l=n(e))||t(1,"no header found"),(c=l.match(/^#\?(\S+)/))||t(3,"bad initial token"),s.valid|=1,s.programtype=c[1],s.string+=l+`
`;!1!==(l=n(e));){if(s.string+=l+`
`,"#"===l.charAt(0)){s.comments+=l+`
`;continue}if((c=l.match(r))&&(s.gamma=parseFloat(c[1])),(c=l.match(i))&&(s.exposure=parseFloat(c[1])),(c=l.match(a))&&(s.valid|=2,s.format=c[1]),(c=l.match(o))&&(s.valid|=4,s.height=parseInt(c[1],10),s.width=parseInt(c[2],10)),2&s.valid&&4&s.valid)break}return 2&s.valid||t(3,"missing format specifier"),4&s.valid||t(3,"missing image size specifier"),s}(i),o=a.width,s=a.height,l=function(e,r,n){if(r<8||r>32767||2!==e[0]||2!==e[1]||128&e[2])return new Uint8Array(e);r!==(e[2]<<8|e[3])&&t(3,"wrong scanline width");let i=new Uint8Array(4*r*n);i.length||t(4,"unable to allocate buffer space");let a=0,o=0,s=4*r,l=new Uint8Array(4),c=new Uint8Array(s),u=n;for(;u>0&&o<e.byteLength;){o+4>e.byteLength&&t(1),l[0]=e[o++],l[1]=e[o++],l[2]=e[o++],l[3]=e[o++],(2!=l[0]||2!=l[1]||(l[2]<<8|l[3])!=r)&&t(3,"bad rgbe scanline format");let n=0,h;for(;n<s&&o<e.byteLength;){let r=(h=e[o++])>128;if(r&&(h-=128),(0===h||n+h>s)&&t(3,"bad scanline data"),r){let t=e[o++];for(let e=0;e<h;e++)c[n++]=t}else c.set(e.subarray(o,o+h),n),n+=h,o+=h}for(let e=0;e<r;e++){let t=0;i[a]=c[e+t],t+=r,i[a+1]=c[e+t],t+=r,i[a+2]=c[e+t],t+=r,i[a+3]=c[e+t],a+=4}u--}return i}(i.subarray(i.pos),o,s),u,h,d;switch(this.type){case c.FloatType:let f=new Float32Array(4*(d=l.length/4));for(let e=0;e<d;e++)!function(e,t,r,n){let i=Math.pow(2,e[t+3]-128)/255;r[n+0]=e[t+0]*i,r[n+1]=e[t+1]*i,r[n+2]=e[t+2]*i,r[n+3]=1}(l,4*e,f,4*e);u=f,h=c.FloatType;break;case c.HalfFloatType:let p=new Uint16Array(4*(d=l.length/4));for(let e=0;e<d;e++)!function(e,t,r,n){let i=Math.pow(2,e[t+3]-128)/255;r[n+0]=c.DataUtils.toHalfFloat(Math.min(e[t+0]*i,65504)),r[n+1]=c.DataUtils.toHalfFloat(Math.min(e[t+1]*i,65504)),r[n+2]=c.DataUtils.toHalfFloat(Math.min(e[t+2]*i,65504)),r[n+3]=c.DataUtils.toHalfFloat(1)}(l,4*e,p,4*e);u=p,h=c.HalfFloatType;break;default:throw Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:o,height:s,data:u,header:a.string,gamma:a.gamma,exposure:a.exposure,type:h}}setDataType(e){return this.type=e,this}load(e,t,r,n){return super.load(e,function(e,r){switch(e.type){case c.FloatType:case c.HalfFloatType:"colorSpace"in e?e.colorSpace="srgb-linear":e.encoding=3e3,e.minFilter=c.LinearFilter,e.magFilter=c.LinearFilter,e.generateMipmaps=!1,e.flipY=!0}t&&t(e,r)},r,n)}};function ta(e,{path:t}){return(0,u.F)(ti,e,e=>e.setPath(t))}var to=e=>e.current&&e.current.isScene,ts=e=>to(e)?e.current:e;function tl({background:e=!1,envPreset:t}){let r={city:ta("city.hdr",{path:Q}),dawn:ta("dawn.hdr",{path:Q}),lobby:ta("lobby.hdr",{path:Q})}[t],n=(0,u.A)(e=>e.scene);return s.useLayoutEffect(()=>{if(r){let t=ts(n),i=(t.background,t.environment);return"only"!==e&&(t.environment=r),e&&(t.background=r),()=>{"only"!==e&&(t.environment=i),e&&(t.background="black")}}},[n,r,e]),r.mapping=c.EquirectangularReflectionMapping,null}var tc=0;function tu({lightType:e,brightness:t,envPreset:r}){return(0,l.jsxs)(l.Fragment,{children:["3d"===e&&(0,l.jsx)("ambientLight",{intensity:t||1}),"env"===e&&(0,l.jsx)(s.Suspense,{fallback:(0,l.jsx)(th,{}),children:(0,l.jsx)(tl,{envPreset:r,background:!1,loadingCallback:()=>{}})})]})}function th(){let{progress:e}=function(){let[e,t]=(0,s.useState)({});return c.DefaultLoadingManager.onLoad=()=>{t(e=>b(C({},e),{active:!1}))},c.DefaultLoadingManager.onProgress=(e,r,n)=>{r===n&&(tc=n);let i=(r-tc)/(n-tc)*100||100;t(t=>b(C({},t),{active:!0,item:e,loaded:r,total:n,progress:i}))},e}();return(0,s.useEffect)(()=>{let t=document.getElementById("LoaderRoot");t&&e&&(100===e?(t.innerHTML="Ligths are loaded",setTimeout(()=>{t.innerHTML=""},1e3)):t.innerHTML="Loading lights...")},[e]),(0,l.jsx)("ambientLight",{intensity:.4})}function td(e){let t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}function tf(e=0){return e/255}c.ShaderChunk.uv2_pars_vertex="",c.ShaderChunk.uv2_vertex="",c.ShaderChunk.uv2_pars_fragment="",c.ShaderChunk.encodings_fragment="";var tp={};I(tp,{defaults:()=>tm,positionMix:()=>tw});var tm={};I(tm,{plane:()=>tA,sphere:()=>ty,waterPlane:()=>t_});var tA={};I(tA,{fragment:()=>tg,vertex:()=>tv});var tg=`
#define STANDARD
#ifdef PHYSICAL
#define REFLECTIVITY
#define CLEARCOAT
#define TRANSMISSION
#endif
uniform vec3 diffuse;uniform vec3 emissive;uniform float roughness;uniform float metalness;uniform float opacity;
#ifdef TRANSMISSION
uniform float transmission;
#endif
#ifdef REFLECTIVITY
uniform float reflectivity;
#endif
#ifdef CLEARCOAT
uniform float clearcoat;uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
uniform vec3 sheen;
#endif
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
#ifdef USE_TANGENT
varying vec3 vTangent;varying vec3 vBitangent;
#endif
#endif
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <color_pars_fragment>
#include <common>
#include <dithering_pars_fragment>
#include <emissivemap_pars_fragment>
#include <lightmap_pars_fragment>
#include <map_pars_fragment>
#include <packing>
#include <uv2_pars_fragment>
#include <uv_pars_fragment>
#include <bsdfs>
#include <bumpmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <clipping_planes_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <lights_physical_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <shadowmap_pars_fragment>
varying vec3 vNormal;varying float displacement;varying vec3 vPos;varying float vDistort;uniform float uC1r;uniform float uC1g;uniform float uC1b;uniform float uC2r;uniform float uC2g;uniform float uC2b;uniform float uC3r;uniform float uC3g;uniform float uC3b;varying vec3 color1;varying vec3 color2;varying vec3 color3;float linearToRelativeLuminance2(const in vec3 color){vec3 weights=vec3(0.2126,0.7152,0.0722);return dot(weights,color.rgb);}void main(){vec3 color1=vec3(uC1r,uC1g,uC1b);vec3 color2=vec3(uC2r,uC2g,uC2b);vec3 color3=vec3(uC3r,uC3g,uC3b);float clearcoat=1.0;float clearcoatRoughness=0.5;
#include <clipping_planes_fragment>
vec4 diffuseColor=vec4(mix(mix(color1,color2,smoothstep(-3.0,3.0,vPos.x)),color3,vPos.z),1);ReflectedLight reflectedLight=ReflectedLight(vec3(0.0),vec3(0.0),vec3(0.0),vec3(0.0));vec3 totalEmissiveRadiance=emissive;
#ifdef TRANSMISSION
float totalTransmission=transmission;
#endif
#include <logdepthbuf_fragment>
#include <map_fragment>
#include <color_fragment>
#include <alphamap_fragment>
#include <alphatest_fragment>
#include <roughnessmap_fragment>
#include <metalnessmap_fragment>
#include <normal_fragment_begin>
#include <normal_fragment_maps>
#include <clearcoat_normal_fragment_begin>
#include <clearcoat_normal_fragment_maps>
#include <emissivemap_fragment>
#include <lights_physical_fragment>
#include <lights_fragment_begin>
#include <lights_fragment_maps>
#include <lights_fragment_end>
#include <aomap_fragment>
vec3 outgoingLight=reflectedLight.directDiffuse+reflectedLight.indirectDiffuse+reflectedLight.directSpecular+reflectedLight.indirectSpecular;
#ifdef TRANSMISSION
diffuseColor.a*=mix(saturate(1.-totalTransmission+linearToRelativeLuminance2(reflectedLight.directSpecular+reflectedLight.indirectSpecular)),1.0,metalness);
#endif
#include <tonemapping_fragment>
#include <encodings_fragment>
#include <fog_fragment>
#include <premultiplied_alpha_fragment>
#include <dithering_fragment>
gl_FragColor=vec4(outgoingLight,diffuseColor.a);}`,tv=`vec3 mod289(vec3 x){return x-floor(x*(1.0/289.0))*289.0;}vec4 mod289(vec4 x){return x-floor(x*(1.0/289.0))*289.0;}vec4 permute(vec4 x){return mod289(((x*34.0)+1.0)*x);}vec4 taylorInvSqrt(vec4 r){return 1.79284291400159-0.85373472095314*r;}vec3 fade(vec3 t){return t*t*t*(t*(t*6.0-15.0)+10.0);}float cnoise(vec3 P){vec3 Pi0=floor(P);vec3 Pi1=Pi0+vec3(1.0);Pi0=mod289(Pi0);Pi1=mod289(Pi1);vec3 Pf0=fract(P);vec3 Pf1=Pf0-vec3(1.0);vec4 ix=vec4(Pi0.x,Pi1.x,Pi0.x,Pi1.x);vec4 iy=vec4(Pi0.yy,Pi1.yy);vec4 iz0=Pi0.zzzz;vec4 iz1=Pi1.zzzz;vec4 ixy=permute(permute(ix)+iy);vec4 ixy0=permute(ixy+iz0);vec4 ixy1=permute(ixy+iz1);vec4 gx0=ixy0*(1.0/7.0);vec4 gy0=fract(floor(gx0)*(1.0/7.0))-0.5;gx0=fract(gx0);vec4 gz0=vec4(0.5)-abs(gx0)-abs(gy0);vec4 sz0=step(gz0,vec4(0.0));gx0-=sz0*(step(0.0,gx0)-0.5);gy0-=sz0*(step(0.0,gy0)-0.5);vec4 gx1=ixy1*(1.0/7.0);vec4 gy1=fract(floor(gx1)*(1.0/7.0))-0.5;gx1=fract(gx1);vec4 gz1=vec4(0.5)-abs(gx1)-abs(gy1);vec4 sz1=step(gz1,vec4(0.0));gx1-=sz1*(step(0.0,gx1)-0.5);gy1-=sz1*(step(0.0,gy1)-0.5);vec3 g000=vec3(gx0.x,gy0.x,gz0.x);vec3 g100=vec3(gx0.y,gy0.y,gz0.y);vec3 g010=vec3(gx0.z,gy0.z,gz0.z);vec3 g110=vec3(gx0.w,gy0.w,gz0.w);vec3 g001=vec3(gx1.x,gy1.x,gz1.x);vec3 g101=vec3(gx1.y,gy1.y,gz1.y);vec3 g011=vec3(gx1.z,gy1.z,gz1.z);vec3 g111=vec3(gx1.w,gy1.w,gz1.w);vec4 norm0=taylorInvSqrt(vec4(dot(g000,g000),dot(g010,g010),dot(g100,g100),dot(g110,g110)));g000*=norm0.x;g010*=norm0.y;g100*=norm0.z;g110*=norm0.w;vec4 norm1=taylorInvSqrt(vec4(dot(g001,g001),dot(g011,g011),dot(g101,g101),dot(g111,g111)));g001*=norm1.x;g011*=norm1.y;g101*=norm1.z;g111*=norm1.w;float n000=dot(g000,Pf0);float n100=dot(g100,vec3(Pf1.x,Pf0.yz));float n010=dot(g010,vec3(Pf0.x,Pf1.y,Pf0.z));float n110=dot(g110,vec3(Pf1.xy,Pf0.z));float n001=dot(g001,vec3(Pf0.xy,Pf1.z));float n101=dot(g101,vec3(Pf1.x,Pf0.y,Pf1.z));float n011=dot(g011,vec3(Pf0.x,Pf1.yz));float n111=dot(g111,Pf1);vec3 fade_xyz=fade(Pf0);vec4 n_z=mix(vec4(n000,n100,n010,n110),vec4(n001,n101,n011,n111),fade_xyz.z);vec2 n_yz=mix(n_z.xy,n_z.zw,fade_xyz.y);float n_xyz=mix(n_yz.x,n_yz.y,fade_xyz.x);return 2.2*n_xyz;}mat3 rotation3dY(float angle){float s=sin(angle);float c=cos(angle);return mat3(c,0.0,-s,0.0,1.0,0.0,s,0.0,c);}vec3 rotateY(vec3 v,float angle){return rotation3dY(angle)*v;}varying vec3 vNormal;varying float displacement;varying vec3 vPos;varying float vDistort;varying vec2 vUv;uniform float uTime;uniform float uSpeed;uniform float uLoadingTime;uniform float uNoiseDensity;uniform float uNoiseStrength;
#define STANDARD
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
#ifdef USE_TANGENT
varying vec3 vTangent;varying vec3 vBitangent;
#endif
#endif
#include <clipping_planes_pars_vertex>
#include <color_pars_vertex>
#include <common>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <morphtarget_pars_vertex>
#include <shadowmap_pars_vertex>
#include <skinning_pars_vertex>
#include <uv2_pars_vertex>
#include <uv_pars_vertex>
void main(){
#include <beginnormal_vertex>
#include <color_vertex>
#include <defaultnormal_vertex>
#include <morphnormal_vertex>
#include <skinbase_vertex>
#include <skinnormal_vertex>
#include <uv2_vertex>
#include <uv_vertex>
#ifndef FLAT_SHADED
vNormal=normalize(transformedNormal);
#ifdef USE_TANGENT
vTangent=normalize(transformedTangent);vBitangent=normalize(cross(vNormal,vTangent)*tangent.w);
#endif
#endif
#include <begin_vertex>
#include <clipping_planes_vertex>
#include <displacementmap_vertex>
#include <logdepthbuf_vertex>
#include <morphtarget_vertex>
#include <project_vertex>
#include <skinning_vertex>
vViewPosition=-mvPosition.xyz;
#include <fog_vertex>
#include <shadowmap_vertex>
#include <worldpos_vertex>
vUv=uv;float t=uTime*uSpeed;float distortion=0.75*cnoise(0.43*position*uNoiseDensity+t);vec3 pos=position+normal*distortion*uNoiseStrength*uLoadingTime;vPos=pos;gl_Position=projectionMatrix*modelViewMatrix*vec4(pos,1.);}`,ty={};I(ty,{fragment:()=>tx,vertex:()=>tE});var tx=`
#define STANDARD
#ifdef PHYSICAL
#define REFLECTIVITY
#define CLEARCOAT
#define TRANSMISSION
#endif
uniform vec3 diffuse;uniform vec3 emissive;uniform float roughness;uniform float metalness;uniform float opacity;
#ifdef TRANSMISSION
uniform float transmission;
#endif
#ifdef REFLECTIVITY
uniform float reflectivity;
#endif
#ifdef CLEARCOAT
uniform float clearcoat;uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
uniform vec3 sheen;
#endif
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
#ifdef USE_TANGENT
varying vec3 vTangent;varying vec3 vBitangent;
#endif
#endif
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <color_pars_fragment>
#include <common>
#include <dithering_pars_fragment>
#include <emissivemap_pars_fragment>
#include <lightmap_pars_fragment>
#include <map_pars_fragment>
#include <packing>
#include <uv2_pars_fragment>
#include <uv_pars_fragment>
#include <bsdfs>
#include <bumpmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <clipping_planes_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <lights_physical_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <shadowmap_pars_fragment>
varying vec3 vNormal;varying float displacement;varying vec3 vPos;varying float vDistort;uniform float uC1r;uniform float uC1g;uniform float uC1b;uniform float uC2r;uniform float uC2g;uniform float uC2b;uniform float uC3r;uniform float uC3g;uniform float uC3b;varying vec3 color1;varying vec3 color2;varying vec3 color3;varying float distanceToCenter;float linearToRelativeLuminance2(const in vec3 color){vec3 weights=vec3(0.2126,0.7152,0.0722);return dot(weights,color.rgb);}void main(){vec3 color1=vec3(uC1r,uC1g,uC1b);vec3 color2=vec3(uC2r,uC2g,uC2b);vec3 color3=vec3(uC3r,uC3g,uC3b);float clearcoat=1.0;float clearcoatRoughness=0.5;
#include <clipping_planes_fragment>
float distanceToCenter=distance(vPos,vec3(0,0,0));vec4 diffuseColor=vec4(mix(color3,mix(color2,color1,smoothstep(-1.0,1.0,vPos.y)),distanceToCenter),1);ReflectedLight reflectedLight=ReflectedLight(vec3(0.0),vec3(0.0),vec3(0.0),vec3(0.0));vec3 totalEmissiveRadiance=emissive;
#ifdef TRANSMISSION
float totalTransmission=transmission;
#endif
#include <logdepthbuf_fragment>
#include <map_fragment>
#include <color_fragment>
#include <alphamap_fragment>
#include <alphatest_fragment>
#include <roughnessmap_fragment>
#include <metalnessmap_fragment>
#include <normal_fragment_begin>
#include <normal_fragment_maps>
#include <clearcoat_normal_fragment_begin>
#include <clearcoat_normal_fragment_maps>
#include <emissivemap_fragment>
#include <lights_physical_fragment>
#include <lights_fragment_begin>
#include <lights_fragment_maps>
#include <lights_fragment_end>
#include <aomap_fragment>
vec3 outgoingLight=reflectedLight.directDiffuse+reflectedLight.indirectDiffuse+reflectedLight.directSpecular+reflectedLight.indirectSpecular;
#ifdef TRANSMISSION
diffuseColor.a*=mix(saturate(1.-totalTransmission+linearToRelativeLuminance2(reflectedLight.directSpecular+reflectedLight.indirectSpecular)),1.0,metalness);
#endif
gl_FragColor=vec4(outgoingLight,diffuseColor.a);
#include <tonemapping_fragment>
#include <encodings_fragment>
#include <fog_fragment>
#include <premultiplied_alpha_fragment>
#include <dithering_fragment>
}`,tE=`vec3 mod289(vec3 x){return x-floor(x*(1.0/289.0))*289.0;}vec4 mod289(vec4 x){return x-floor(x*(1.0/289.0))*289.0;}vec4 permute(vec4 x){return mod289(((x*34.0)+1.0)*x);}vec4 taylorInvSqrt(vec4 r){return 1.79284291400159-0.85373472095314*r;}vec3 fade(vec3 t){return t*t*t*(t*(t*6.0-15.0)+10.0);}float pnoise(vec3 P,vec3 rep){vec3 Pi0=mod(floor(P),rep);vec3 Pi1=mod(Pi0+vec3(1.0),rep);Pi0=mod289(Pi0);Pi1=mod289(Pi1);vec3 Pf0=fract(P);vec3 Pf1=Pf0-vec3(1.0);vec4 ix=vec4(Pi0.x,Pi1.x,Pi0.x,Pi1.x);vec4 iy=vec4(Pi0.yy,Pi1.yy);vec4 iz0=Pi0.zzzz;vec4 iz1=Pi1.zzzz;vec4 ixy=permute(permute(ix)+iy);vec4 ixy0=permute(ixy+iz0);vec4 ixy1=permute(ixy+iz1);vec4 gx0=ixy0*(1.0/7.0);vec4 gy0=fract(floor(gx0)*(1.0/7.0))-0.5;gx0=fract(gx0);vec4 gz0=vec4(0.5)-abs(gx0)-abs(gy0);vec4 sz0=step(gz0,vec4(0.0));gx0-=sz0*(step(0.0,gx0)-0.5);gy0-=sz0*(step(0.0,gy0)-0.5);vec4 gx1=ixy1*(1.0/7.0);vec4 gy1=fract(floor(gx1)*(1.0/7.0))-0.5;gx1=fract(gx1);vec4 gz1=vec4(0.5)-abs(gx1)-abs(gy1);vec4 sz1=step(gz1,vec4(0.0));gx1-=sz1*(step(0.0,gx1)-0.5);gy1-=sz1*(step(0.0,gy1)-0.5);vec3 g000=vec3(gx0.x,gy0.x,gz0.x);vec3 g100=vec3(gx0.y,gy0.y,gz0.y);vec3 g010=vec3(gx0.z,gy0.z,gz0.z);vec3 g110=vec3(gx0.w,gy0.w,gz0.w);vec3 g001=vec3(gx1.x,gy1.x,gz1.x);vec3 g101=vec3(gx1.y,gy1.y,gz1.y);vec3 g011=vec3(gx1.z,gy1.z,gz1.z);vec3 g111=vec3(gx1.w,gy1.w,gz1.w);vec4 norm0=taylorInvSqrt(vec4(dot(g000,g000),dot(g010,g010),dot(g100,g100),dot(g110,g110)));g000*=norm0.x;g010*=norm0.y;g100*=norm0.z;g110*=norm0.w;vec4 norm1=taylorInvSqrt(vec4(dot(g001,g001),dot(g011,g011),dot(g101,g101),dot(g111,g111)));g001*=norm1.x;g011*=norm1.y;g101*=norm1.z;g111*=norm1.w;float n000=dot(g000,Pf0);float n100=dot(g100,vec3(Pf1.x,Pf0.yz));float n010=dot(g010,vec3(Pf0.x,Pf1.y,Pf0.z));float n110=dot(g110,vec3(Pf1.xy,Pf0.z));float n001=dot(g001,vec3(Pf0.xy,Pf1.z));float n101=dot(g101,vec3(Pf1.x,Pf0.y,Pf1.z));float n011=dot(g011,vec3(Pf0.x,Pf1.yz));float n111=dot(g111,Pf1);vec3 fade_xyz=fade(Pf0);vec4 n_z=mix(vec4(n000,n100,n010,n110),vec4(n001,n101,n011,n111),fade_xyz.z);vec2 n_yz=mix(n_z.xy,n_z.zw,fade_xyz.y);float n_xyz=mix(n_yz.x,n_yz.y,fade_xyz.x);return 2.2*n_xyz;}varying vec3 vNormal;uniform float uTime;uniform float uSpeed;uniform float uNoiseDensity;uniform float uNoiseStrength;uniform float uFrequency;uniform float uAmplitude;varying vec3 vPos;varying float vDistort;varying vec2 vUv;varying vec3 vViewPosition;
#define STANDARD
#ifndef FLAT_SHADED
#ifdef USE_TANGENT
varying vec3 vTangent;varying vec3 vBitangent;
#endif
#endif
#include <clipping_planes_pars_vertex>
#include <color_pars_vertex>
#include <common>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <morphtarget_pars_vertex>
#include <shadowmap_pars_vertex>
#include <skinning_pars_vertex>
#include <uv2_pars_vertex>
#include <uv_pars_vertex>
mat3 rotation3dY(float angle){float s=sin(angle);float c=cos(angle);return mat3(c,0.0,-s,0.0,1.0,0.0,s,0.0,c);}vec3 rotateY(vec3 v,float angle){return rotation3dY(angle)*v;}void main(){
#include <beginnormal_vertex>
#include <color_vertex>
#include <defaultnormal_vertex>
#include <morphnormal_vertex>
#include <skinbase_vertex>
#include <skinnormal_vertex>
#include <uv2_vertex>
#include <uv_vertex>
#ifndef FLAT_SHADED
vNormal=normalize(transformedNormal);
#ifdef USE_TANGENT
vTangent=normalize(transformedTangent);vBitangent=normalize(cross(vNormal,vTangent)*tangent.w);
#endif
#endif
#include <begin_vertex>
#include <clipping_planes_vertex>
#include <displacementmap_vertex>
#include <logdepthbuf_vertex>
#include <morphtarget_vertex>
#include <project_vertex>
#include <skinning_vertex>
vViewPosition=-mvPosition.xyz;
#include <fog_vertex>
#include <shadowmap_vertex>
#include <worldpos_vertex>
float t=uTime*uSpeed;float distortion=pnoise((normal+t)*uNoiseDensity,vec3(10.0))*uNoiseStrength;vec3 pos=position+(normal*distortion);float angle=sin(uv.y*uFrequency+t)*uAmplitude;pos=rotateY(pos,angle);vPos=pos;vDistort=distortion;vNormal=normal;vUv=uv;gl_Position=projectionMatrix*modelViewMatrix*vec4(pos,1.);}`,t_={};I(t_,{fragment:()=>tC,vertex:()=>tb});var tC=`
#define STANDARD
#ifdef PHYSICAL
#define REFLECTIVITY
#define CLEARCOAT
#define TRANSMISSION
#endif
uniform vec3 diffuse;uniform vec3 emissive;uniform float roughness;uniform float metalness;uniform float opacity;
#ifdef TRANSMISSION
uniform float transmission;
#endif
#ifdef REFLECTIVITY
uniform float reflectivity;
#endif
#ifdef CLEARCOAT
uniform float clearcoat;uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
uniform vec3 sheen;
#endif
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
#ifdef USE_TANGENT
varying vec3 vTangent;varying vec3 vBitangent;
#endif
#endif
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <color_pars_fragment>
#include <common>
#include <dithering_pars_fragment>
#include <emissivemap_pars_fragment>
#include <lightmap_pars_fragment>
#include <map_pars_fragment>
#include <packing>
#include <uv2_pars_fragment>
#include <uv_pars_fragment>
#include <bsdfs>
#include <bumpmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <clipping_planes_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <lights_physical_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <shadowmap_pars_fragment>
varying vec3 vNormal;varying float displacement;varying vec3 vPos;varying float vDistort;uniform float uC1r;uniform float uC1g;uniform float uC1b;uniform float uC2r;uniform float uC2g;uniform float uC2b;uniform float uC3r;uniform float uC3g;uniform float uC3b;varying vec3 color1;varying vec3 color2;varying vec3 color3;float linearToRelativeLuminance2(const in vec3 color){vec3 weights=vec3(0.2126,0.7152,0.0722);return dot(weights,color.rgb);}void main(){vec3 color1=vec3(uC1r,uC1g,uC1b);vec3 color2=vec3(uC2r,uC2g,uC2b);vec3 color3=vec3(uC3r,uC3g,uC3b);float clearcoat=1.0;float clearcoatRoughness=0.5;
#include <clipping_planes_fragment>
vec4 diffuseColor=vec4(mix(mix(color1,color2,smoothstep(-3.0,3.0,vPos.x)),color3,vPos.z),1);ReflectedLight reflectedLight=ReflectedLight(vec3(0.0),vec3(0.0),vec3(0.0),vec3(0.0));vec3 totalEmissiveRadiance=emissive;
#ifdef TRANSMISSION
float totalTransmission=transmission;
#endif
#include <logdepthbuf_fragment>
#include <map_fragment>
#include <color_fragment>
#include <alphamap_fragment>
#include <alphatest_fragment>
#include <roughnessmap_fragment>
#include <metalnessmap_fragment>
#include <normal_fragment_begin>
#include <normal_fragment_maps>
#include <clearcoat_normal_fragment_begin>
#include <clearcoat_normal_fragment_maps>
#include <emissivemap_fragment>
#include <lights_physical_fragment>
#include <lights_fragment_begin>
#include <lights_fragment_maps>
#include <lights_fragment_end>
#include <aomap_fragment>
vec3 outgoingLight=reflectedLight.directDiffuse+reflectedLight.indirectDiffuse+reflectedLight.directSpecular+reflectedLight.indirectSpecular;
#ifdef TRANSMISSION
diffuseColor.a*=mix(saturate(1.-totalTransmission+linearToRelativeLuminance2(reflectedLight.directSpecular+reflectedLight.indirectSpecular)),1.0,metalness);
#endif
#include <tonemapping_fragment>
#include <encodings_fragment>
#include <fog_fragment>
#include <premultiplied_alpha_fragment>
#include <dithering_fragment>
gl_FragColor=vec4(outgoingLight,diffuseColor.a);}`,tb=`vec3 mod289(vec3 x){return x-floor(x*(1.0/289.0))*289.0;}vec4 mod289(vec4 x){return x-floor(x*(1.0/289.0))*289.0;}vec4 permute(vec4 x){return mod289(((x*34.0)+1.0)*x);}vec4 taylorInvSqrt(vec4 r){return 1.79284291400159-0.85373472095314*r;}vec3 fade(vec3 t){return t*t*t*(t*(t*6.0-15.0)+10.0);}float cnoise(vec3 P){vec3 Pi0=floor(P);vec3 Pi1=Pi0+vec3(1.0);Pi0=mod289(Pi0);Pi1=mod289(Pi1);vec3 Pf0=fract(P);vec3 Pf1=Pf0-vec3(1.0);vec4 ix=vec4(Pi0.x,Pi1.x,Pi0.x,Pi1.x);vec4 iy=vec4(Pi0.yy,Pi1.yy);vec4 iz0=Pi0.zzzz;vec4 iz1=Pi1.zzzz;vec4 ixy=permute(permute(ix)+iy);vec4 ixy0=permute(ixy+iz0);vec4 ixy1=permute(ixy+iz1);vec4 gx0=ixy0*(1.0/7.0);vec4 gy0=fract(floor(gx0)*(1.0/7.0))-0.5;gx0=fract(gx0);vec4 gz0=vec4(0.5)-abs(gx0)-abs(gy0);vec4 sz0=step(gz0,vec4(0.0));gx0-=sz0*(step(0.0,gx0)-0.5);gy0-=sz0*(step(0.0,gy0)-0.5);vec4 gx1=ixy1*(1.0/7.0);vec4 gy1=fract(floor(gx1)*(1.0/7.0))-0.5;gx1=fract(gx1);vec4 gz1=vec4(0.5)-abs(gx1)-abs(gy1);vec4 sz1=step(gz1,vec4(0.0));gx1-=sz1*(step(0.0,gx1)-0.5);gy1-=sz1*(step(0.0,gy1)-0.5);vec3 g000=vec3(gx0.x,gy0.x,gz0.x);vec3 g100=vec3(gx0.y,gy0.y,gz0.y);vec3 g010=vec3(gx0.z,gy0.z,gz0.z);vec3 g110=vec3(gx0.w,gy0.w,gz0.w);vec3 g001=vec3(gx1.x,gy1.x,gz1.x);vec3 g101=vec3(gx1.y,gy1.y,gz1.y);vec3 g011=vec3(gx1.z,gy1.z,gz1.z);vec3 g111=vec3(gx1.w,gy1.w,gz1.w);vec4 norm0=taylorInvSqrt(vec4(dot(g000,g000),dot(g010,g010),dot(g100,g100),dot(g110,g110)));g000*=norm0.x;g010*=norm0.y;g100*=norm0.z;g110*=norm0.w;vec4 norm1=taylorInvSqrt(vec4(dot(g001,g001),dot(g011,g011),dot(g101,g101),dot(g111,g111)));g001*=norm1.x;g011*=norm1.y;g101*=norm1.z;g111*=norm1.w;float n000=dot(g000,Pf0);float n100=dot(g100,vec3(Pf1.x,Pf0.yz));float n010=dot(g010,vec3(Pf0.x,Pf1.y,Pf0.z));float n110=dot(g110,vec3(Pf1.xy,Pf0.z));float n001=dot(g001,vec3(Pf0.xy,Pf1.z));float n101=dot(g101,vec3(Pf1.x,Pf0.y,Pf1.z));float n011=dot(g011,vec3(Pf0.x,Pf1.yz));float n111=dot(g111,Pf1);vec3 fade_xyz=fade(Pf0);vec4 n_z=mix(vec4(n000,n100,n010,n110),vec4(n001,n101,n011,n111),fade_xyz.z);vec2 n_yz=mix(n_z.xy,n_z.zw,fade_xyz.y);float n_xyz=mix(n_yz.x,n_yz.y,fade_xyz.x);return 2.2*n_xyz;}mat3 rotation3dY(float angle){float s=sin(angle);float c=cos(angle);return mat3(c,0.0,-s,0.0,1.0,0.0,s,0.0,c);}vec3 rotateY(vec3 v,float angle){return rotation3dY(angle)*v;}varying vec3 vNormal;varying float displacement;varying vec3 vPos;varying float vDistort;uniform float uTime;uniform float uSpeed;uniform float uNoiseDensity;uniform float uNoiseStrength;
#define STANDARD
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
#ifdef USE_TANGENT
varying vec3 vTangent;varying vec3 vBitangent;
#endif
#endif
#include <clipping_planes_pars_vertex>
#include <color_pars_vertex>
#include <common>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <morphtarget_pars_vertex>
#include <shadowmap_pars_vertex>
#include <skinning_pars_vertex>
#include <uv2_pars_vertex>
#include <uv_pars_vertex>
void main(){
#include <beginnormal_vertex>
#include <color_vertex>
#include <defaultnormal_vertex>
#include <morphnormal_vertex>
#include <skinbase_vertex>
#include <skinnormal_vertex>
#include <uv2_vertex>
#include <uv_vertex>
#ifndef FLAT_SHADED
vNormal=normalize(transformedNormal);
#ifdef USE_TANGENT
vTangent=normalize(transformedTangent);vBitangent=normalize(cross(vNormal,vTangent)*tangent.w);
#endif
#endif
#include <begin_vertex>
#include <clipping_planes_vertex>
#include <displacementmap_vertex>
#include <logdepthbuf_vertex>
#include <morphtarget_vertex>
#include <project_vertex>
#include <skinning_vertex>
vViewPosition=-mvPosition.xyz;
#include <fog_vertex>
#include <shadowmap_vertex>
#include <worldpos_vertex>
float t=uTime*uSpeed;float distortion=0.75*cnoise(0.43*position*uNoiseDensity+t);vec3 pos=position+normal*distortion*uNoiseStrength;vPos=pos;gl_Position=projectionMatrix*modelViewMatrix*vec4(pos,1.);}`,tw={};I(tw,{plane:()=>tB,sphere:()=>tS,waterPlane:()=>tD});var tB={};I(tB,{fragment:()=>tI,vertex:()=>tM});var tI="uniform float uC1r;uniform float uC1g;uniform float uC1b;uniform float uC2r;uniform float uC2g;uniform float uC2b;uniform float uC3r;uniform float uC3g;uniform float uC3b;varying vec3 vNormal;varying vec3 vPos;void main(){vec3 color1=vec3(uC1r,uC1g,uC1b);vec3 color2=vec3(uC2r,uC2g,uC2b);vec3 color3=vec3(uC3r,uC3g,uC3b);gl_FragColor=vec4(color1*vPos.x+color2*vPos.y+color3*vPos.z,1.);}",tM=`vec3 mod289(vec3 x){return x-floor(x*(1.0/289.0))*289.0;}vec4 mod289(vec4 x){return x-floor(x*(1.0/289.0))*289.0;}vec4 permute(vec4 x){return mod289(((x*34.0)+1.0)*x);}vec4 taylorInvSqrt(vec4 r){return 1.79284291400159-0.85373472095314*r;}vec3 fade(vec3 t){return t*t*t*(t*(t*6.0-15.0)+10.0);}float cnoise(vec3 P){vec3 Pi0=floor(P);vec3 Pi1=Pi0+vec3(1.0);Pi0=mod289(Pi0);Pi1=mod289(Pi1);vec3 Pf0=fract(P);vec3 Pf1=Pf0-vec3(1.0);vec4 ix=vec4(Pi0.x,Pi1.x,Pi0.x,Pi1.x);vec4 iy=vec4(Pi0.yy,Pi1.yy);vec4 iz0=Pi0.zzzz;vec4 iz1=Pi1.zzzz;vec4 ixy=permute(permute(ix)+iy);vec4 ixy0=permute(ixy+iz0);vec4 ixy1=permute(ixy+iz1);vec4 gx0=ixy0*(1.0/7.0);vec4 gy0=fract(floor(gx0)*(1.0/7.0))-0.5;gx0=fract(gx0);vec4 gz0=vec4(0.5)-abs(gx0)-abs(gy0);vec4 sz0=step(gz0,vec4(0.0));gx0-=sz0*(step(0.0,gx0)-0.5);gy0-=sz0*(step(0.0,gy0)-0.5);vec4 gx1=ixy1*(1.0/7.0);vec4 gy1=fract(floor(gx1)*(1.0/7.0))-0.5;gx1=fract(gx1);vec4 gz1=vec4(0.5)-abs(gx1)-abs(gy1);vec4 sz1=step(gz1,vec4(0.0));gx1-=sz1*(step(0.0,gx1)-0.5);gy1-=sz1*(step(0.0,gy1)-0.5);vec3 g000=vec3(gx0.x,gy0.x,gz0.x);vec3 g100=vec3(gx0.y,gy0.y,gz0.y);vec3 g010=vec3(gx0.z,gy0.z,gz0.z);vec3 g110=vec3(gx0.w,gy0.w,gz0.w);vec3 g001=vec3(gx1.x,gy1.x,gz1.x);vec3 g101=vec3(gx1.y,gy1.y,gz1.y);vec3 g011=vec3(gx1.z,gy1.z,gz1.z);vec3 g111=vec3(gx1.w,gy1.w,gz1.w);vec4 norm0=taylorInvSqrt(vec4(dot(g000,g000),dot(g010,g010),dot(g100,g100),dot(g110,g110)));g000*=norm0.x;g010*=norm0.y;g100*=norm0.z;g110*=norm0.w;vec4 norm1=taylorInvSqrt(vec4(dot(g001,g001),dot(g011,g011),dot(g101,g101),dot(g111,g111)));g001*=norm1.x;g011*=norm1.y;g101*=norm1.z;g111*=norm1.w;float n000=dot(g000,Pf0);float n100=dot(g100,vec3(Pf1.x,Pf0.yz));float n010=dot(g010,vec3(Pf0.x,Pf1.y,Pf0.z));float n110=dot(g110,vec3(Pf1.xy,Pf0.z));float n001=dot(g001,vec3(Pf0.xy,Pf1.z));float n101=dot(g101,vec3(Pf1.x,Pf0.y,Pf1.z));float n011=dot(g011,vec3(Pf0.x,Pf1.yz));float n111=dot(g111,Pf1);vec3 fade_xyz=fade(Pf0);vec4 n_z=mix(vec4(n000,n100,n010,n110),vec4(n001,n101,n011,n111),fade_xyz.z);vec2 n_yz=mix(n_z.xy,n_z.zw,fade_xyz.y);float n_xyz=mix(n_yz.x,n_yz.y,fade_xyz.x);return 2.2*n_xyz;}mat3 rotation3dY(float angle){float s=sin(angle);float c=cos(angle);return mat3(c,0.0,-s,0.0,1.0,0.0,s,0.0,c);}vec3 rotateY(vec3 v,float angle){return rotation3dY(angle)*v;}varying vec3 vNormal;varying float displacement;varying vec3 vPos;varying float vDistort;varying vec2 vUv;uniform float uTime;uniform float uSpeed;uniform float uLoadingTime;uniform float uNoiseDensity;uniform float uNoiseStrength;
#define STANDARD
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
#ifdef USE_TANGENT
varying vec3 vTangent;varying vec3 vBitangent;
#endif
#endif
#include <clipping_planes_pars_vertex>
#include <color_pars_vertex>
#include <common>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <morphtarget_pars_vertex>
#include <shadowmap_pars_vertex>
#include <skinning_pars_vertex>
#include <uv2_pars_vertex>
#include <uv_pars_vertex>
void main(){
#include <beginnormal_vertex>
#include <color_vertex>
#include <defaultnormal_vertex>
#include <morphnormal_vertex>
#include <skinbase_vertex>
#include <skinnormal_vertex>
#include <uv2_vertex>
#include <uv_vertex>
#ifndef FLAT_SHADED
vNormal=normalize(transformedNormal);
#ifdef USE_TANGENT
vTangent=normalize(transformedTangent);vBitangent=normalize(cross(vNormal,vTangent)*tangent.w);
#endif
#endif
#include <begin_vertex>
#include <clipping_planes_vertex>
#include <displacementmap_vertex>
#include <logdepthbuf_vertex>
#include <morphtarget_vertex>
#include <project_vertex>
#include <skinning_vertex>
vViewPosition=-mvPosition.xyz;
#include <fog_vertex>
#include <shadowmap_vertex>
#include <worldpos_vertex>
vUv=uv;float t=uTime*uSpeed;float distortion=0.75*cnoise(0.43*position*uNoiseDensity+t);vec3 pos=position+normal*distortion*uNoiseStrength*uLoadingTime;vPos=pos;gl_Position=projectionMatrix*modelViewMatrix*vec4(pos,1.);}`,tS={};I(tS,{fragment:()=>tT,vertex:()=>tP});var tT=`
#define STANDARD
#ifdef PHYSICAL
#define REFLECTIVITY
#define CLEARCOAT
#define TRANSMISSION
#endif
uniform vec3 diffuse;uniform vec3 emissive;uniform float roughness;uniform float metalness;uniform float opacity;
#ifdef TRANSMISSION
uniform float transmission;
#endif
#ifdef REFLECTIVITY
uniform float reflectivity;
#endif
#ifdef CLEARCOAT
uniform float clearcoat;uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
uniform vec3 sheen;
#endif
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
#ifdef USE_TANGENT
varying vec3 vTangent;varying vec3 vBitangent;
#endif
#endif
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <color_pars_fragment>
#include <common>
#include <dithering_pars_fragment>
#include <emissivemap_pars_fragment>
#include <lightmap_pars_fragment>
#include <map_pars_fragment>
#include <packing>
#include <uv2_pars_fragment>
#include <uv_pars_fragment>
#include <bsdfs>
#include <bumpmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <clipping_planes_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <lights_physical_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <shadowmap_pars_fragment>
varying vec3 vNormal;varying float displacement;varying vec3 vPos;varying float vDistort;uniform float uC1r;uniform float uC1g;uniform float uC1b;uniform float uC2r;uniform float uC2g;uniform float uC2b;uniform float uC3r;uniform float uC3g;uniform float uC3b;varying vec3 color1;varying vec3 color2;varying vec3 color3;varying float distanceToCenter;void main(){vec3 color1=vec3(uC1r,uC1g,uC1b);vec3 color2=vec3(uC2r,uC2g,uC2b);vec3 color3=vec3(uC3r,uC3g,uC3b);float clearcoat=1.0;float clearcoatRoughness=0.5;
#include <clipping_planes_fragment>
float distanceToCenter=distance(vPos,vec3(0,0,0));vec4 diffuseColor=vec4(mix(color3,mix(color2,color1,smoothstep(-1.0,1.0,vPos.y)),distanceToCenter),1);ReflectedLight reflectedLight=ReflectedLight(vec3(0.0),vec3(0.0),vec3(0.0),vec3(0.0));vec3 totalEmissiveRadiance=emissive;
#ifdef TRANSMISSION
float totalTransmission=transmission;
#endif
#include <logdepthbuf_fragment>
#include <map_fragment>
#include <color_fragment>
#include <alphamap_fragment>
#include <alphatest_fragment>
#include <roughnessmap_fragment>
#include <metalnessmap_fragment>
#include <normal_fragment_begin>
#include <normal_fragment_maps>
#include <clearcoat_normal_fragment_begin>
#include <clearcoat_normal_fragment_maps>
#include <emissivemap_fragment>
#include <lights_physical_fragment>
#include <lights_fragment_begin>
#include <lights_fragment_maps>
#include <lights_fragment_end>
#include <aomap_fragment>
vec3 outgoingLight=reflectedLight.directDiffuse+reflectedLight.indirectDiffuse+reflectedLight.directSpecular+reflectedLight.indirectSpecular;
#ifdef TRANSMISSION
diffuseColor.a*=mix(saturate(1.-totalTransmission+linearToRelativeLuminance(reflectedLight.directSpecular+reflectedLight.indirectSpecular)),1.0,metalness);
#endif
gl_FragColor=vec4(outgoingLight,diffuseColor.a);
#include <tonemapping_fragment>
#include <encodings_fragment>
#include <fog_fragment>
#include <premultiplied_alpha_fragment>
#include <dithering_fragment>
}`,tP=`vec3 mod289(vec3 x){return x-floor(x*(1.0/289.0))*289.0;}vec4 mod289(vec4 x){return x-floor(x*(1.0/289.0))*289.0;}vec4 permute(vec4 x){return mod289(((x*34.0)+1.0)*x);}vec4 taylorInvSqrt(vec4 r){return 1.79284291400159-0.85373472095314*r;}vec3 fade(vec3 t){return t*t*t*(t*(t*6.0-15.0)+10.0);}float pnoise(vec3 P,vec3 rep){vec3 Pi0=mod(floor(P),rep);vec3 Pi1=mod(Pi0+vec3(1.0),rep);Pi0=mod289(Pi0);Pi1=mod289(Pi1);vec3 Pf0=fract(P);vec3 Pf1=Pf0-vec3(1.0);vec4 ix=vec4(Pi0.x,Pi1.x,Pi0.x,Pi1.x);vec4 iy=vec4(Pi0.yy,Pi1.yy);vec4 iz0=Pi0.zzzz;vec4 iz1=Pi1.zzzz;vec4 ixy=permute(permute(ix)+iy);vec4 ixy0=permute(ixy+iz0);vec4 ixy1=permute(ixy+iz1);vec4 gx0=ixy0*(1.0/7.0);vec4 gy0=fract(floor(gx0)*(1.0/7.0))-0.5;gx0=fract(gx0);vec4 gz0=vec4(0.5)-abs(gx0)-abs(gy0);vec4 sz0=step(gz0,vec4(0.0));gx0-=sz0*(step(0.0,gx0)-0.5);gy0-=sz0*(step(0.0,gy0)-0.5);vec4 gx1=ixy1*(1.0/7.0);vec4 gy1=fract(floor(gx1)*(1.0/7.0))-0.5;gx1=fract(gx1);vec4 gz1=vec4(0.5)-abs(gx1)-abs(gy1);vec4 sz1=step(gz1,vec4(0.0));gx1-=sz1*(step(0.0,gx1)-0.5);gy1-=sz1*(step(0.0,gy1)-0.5);vec3 g000=vec3(gx0.x,gy0.x,gz0.x);vec3 g100=vec3(gx0.y,gy0.y,gz0.y);vec3 g010=vec3(gx0.z,gy0.z,gz0.z);vec3 g110=vec3(gx0.w,gy0.w,gz0.w);vec3 g001=vec3(gx1.x,gy1.x,gz1.x);vec3 g101=vec3(gx1.y,gy1.y,gz1.y);vec3 g011=vec3(gx1.z,gy1.z,gz1.z);vec3 g111=vec3(gx1.w,gy1.w,gz1.w);vec4 norm0=taylorInvSqrt(vec4(dot(g000,g000),dot(g010,g010),dot(g100,g100),dot(g110,g110)));g000*=norm0.x;g010*=norm0.y;g100*=norm0.z;g110*=norm0.w;vec4 norm1=taylorInvSqrt(vec4(dot(g001,g001),dot(g011,g011),dot(g101,g101),dot(g111,g111)));g001*=norm1.x;g011*=norm1.y;g101*=norm1.z;g111*=norm1.w;float n000=dot(g000,Pf0);float n100=dot(g100,vec3(Pf1.x,Pf0.yz));float n010=dot(g010,vec3(Pf0.x,Pf1.y,Pf0.z));float n110=dot(g110,vec3(Pf1.xy,Pf0.z));float n001=dot(g001,vec3(Pf0.xy,Pf1.z));float n101=dot(g101,vec3(Pf1.x,Pf0.y,Pf1.z));float n011=dot(g011,vec3(Pf0.x,Pf1.yz));float n111=dot(g111,Pf1);vec3 fade_xyz=fade(Pf0);vec4 n_z=mix(vec4(n000,n100,n010,n110),vec4(n001,n101,n011,n111),fade_xyz.z);vec2 n_yz=mix(n_z.xy,n_z.zw,fade_xyz.y);float n_xyz=mix(n_yz.x,n_yz.y,fade_xyz.x);return 2.2*n_xyz;}varying vec3 vNormal;uniform float uTime;uniform float uSpeed;uniform float uNoiseDensity;uniform float uNoiseStrength;uniform float uFrequency;uniform float uAmplitude;varying vec3 vPos;varying float vDistort;varying vec2 vUv;varying vec3 vViewPosition;
#define STANDARD
#ifndef FLAT_SHADED
#ifdef USE_TANGENT
varying vec3 vTangent;varying vec3 vBitangent;
#endif
#endif
#include <clipping_planes_pars_vertex>
#include <color_pars_vertex>
#include <common>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <morphtarget_pars_vertex>
#include <shadowmap_pars_vertex>
#include <skinning_pars_vertex>
#include <uv2_pars_vertex>
#include <uv_pars_vertex>
mat3 rotation3dY(float angle){float s=sin(angle);float c=cos(angle);return mat3(c,0.0,-s,0.0,1.0,0.0,s,0.0,c);}vec3 rotateY(vec3 v,float angle){return rotation3dY(angle)*v;}void main(){
#include <beginnormal_vertex>
#include <color_vertex>
#include <defaultnormal_vertex>
#include <morphnormal_vertex>
#include <skinbase_vertex>
#include <skinnormal_vertex>
#include <uv2_vertex>
#include <uv_vertex>
#ifndef FLAT_SHADED
vNormal=normalize(transformedNormal);
#ifdef USE_TANGENT
vTangent=normalize(transformedTangent);vBitangent=normalize(cross(vNormal,vTangent)*tangent.w);
#endif
#endif
#include <begin_vertex>
#include <clipping_planes_vertex>
#include <displacementmap_vertex>
#include <logdepthbuf_vertex>
#include <morphtarget_vertex>
#include <project_vertex>
#include <skinning_vertex>
vViewPosition=-mvPosition.xyz;
#include <fog_vertex>
#include <shadowmap_vertex>
#include <worldpos_vertex>
float t=uTime*uSpeed;float distortion=pnoise((normal+t)*uNoiseDensity,vec3(10.0))*uNoiseStrength;vec3 pos=position+(normal*distortion);float angle=sin(uv.y*uFrequency+t)*uAmplitude;pos=rotateY(pos,angle);vPos=pos;vDistort=distortion;vNormal=normal;vUv=uv;gl_Position=projectionMatrix*modelViewMatrix*vec4(pos,1.);}`,tD={};I(tD,{fragment:()=>tR,vertex:()=>tF});var tR="uniform float uC1r;uniform float uC1g;uniform float uC1b;uniform float uC2r;uniform float uC2g;uniform float uC2b;uniform float uC3r;uniform float uC3g;uniform float uC3b;varying vec3 vNormal;varying vec3 vPos;void main(){vec3 color1=vec3(uC1r,uC1g,uC1b);vec3 color2=vec3(uC2r,uC2g,uC2b);vec3 color3=vec3(uC3r,uC3g,uC3b);gl_FragColor=vec4(color1*vPos.x+color2*vPos.y+color3*vPos.z,1.);}",tF=`vec3 mod289(vec3 x){return x-floor(x*(1.0/289.0))*289.0;}vec4 mod289(vec4 x){return x-floor(x*(1.0/289.0))*289.0;}vec4 permute(vec4 x){return mod289(((x*34.0)+1.0)*x);}vec4 taylorInvSqrt(vec4 r){return 1.79284291400159-0.85373472095314*r;}vec3 fade(vec3 t){return t*t*t*(t*(t*6.0-15.0)+10.0);}float cnoise(vec3 P){vec3 Pi0=floor(P);vec3 Pi1=Pi0+vec3(1.0);Pi0=mod289(Pi0);Pi1=mod289(Pi1);vec3 Pf0=fract(P);vec3 Pf1=Pf0-vec3(1.0);vec4 ix=vec4(Pi0.x,Pi1.x,Pi0.x,Pi1.x);vec4 iy=vec4(Pi0.yy,Pi1.yy);vec4 iz0=Pi0.zzzz;vec4 iz1=Pi1.zzzz;vec4 ixy=permute(permute(ix)+iy);vec4 ixy0=permute(ixy+iz0);vec4 ixy1=permute(ixy+iz1);vec4 gx0=ixy0*(1.0/7.0);vec4 gy0=fract(floor(gx0)*(1.0/7.0))-0.5;gx0=fract(gx0);vec4 gz0=vec4(0.5)-abs(gx0)-abs(gy0);vec4 sz0=step(gz0,vec4(0.0));gx0-=sz0*(step(0.0,gx0)-0.5);gy0-=sz0*(step(0.0,gy0)-0.5);vec4 gx1=ixy1*(1.0/7.0);vec4 gy1=fract(floor(gx1)*(1.0/7.0))-0.5;gx1=fract(gx1);vec4 gz1=vec4(0.5)-abs(gx1)-abs(gy1);vec4 sz1=step(gz1,vec4(0.0));gx1-=sz1*(step(0.0,gx1)-0.5);gy1-=sz1*(step(0.0,gy1)-0.5);vec3 g000=vec3(gx0.x,gy0.x,gz0.x);vec3 g100=vec3(gx0.y,gy0.y,gz0.y);vec3 g010=vec3(gx0.z,gy0.z,gz0.z);vec3 g110=vec3(gx0.w,gy0.w,gz0.w);vec3 g001=vec3(gx1.x,gy1.x,gz1.x);vec3 g101=vec3(gx1.y,gy1.y,gz1.y);vec3 g011=vec3(gx1.z,gy1.z,gz1.z);vec3 g111=vec3(gx1.w,gy1.w,gz1.w);vec4 norm0=taylorInvSqrt(vec4(dot(g000,g000),dot(g010,g010),dot(g100,g100),dot(g110,g110)));g000*=norm0.x;g010*=norm0.y;g100*=norm0.z;g110*=norm0.w;vec4 norm1=taylorInvSqrt(vec4(dot(g001,g001),dot(g011,g011),dot(g101,g101),dot(g111,g111)));g001*=norm1.x;g011*=norm1.y;g101*=norm1.z;g111*=norm1.w;float n000=dot(g000,Pf0);float n100=dot(g100,vec3(Pf1.x,Pf0.yz));float n010=dot(g010,vec3(Pf0.x,Pf1.y,Pf0.z));float n110=dot(g110,vec3(Pf1.xy,Pf0.z));float n001=dot(g001,vec3(Pf0.xy,Pf1.z));float n101=dot(g101,vec3(Pf1.x,Pf0.y,Pf1.z));float n011=dot(g011,vec3(Pf0.x,Pf1.yz));float n111=dot(g111,Pf1);vec3 fade_xyz=fade(Pf0);vec4 n_z=mix(vec4(n000,n100,n010,n110),vec4(n001,n101,n011,n111),fade_xyz.z);vec2 n_yz=mix(n_z.xy,n_z.zw,fade_xyz.y);float n_xyz=mix(n_yz.x,n_yz.y,fade_xyz.x);return 2.2*n_xyz;}mat3 rotation3dY(float angle){float s=sin(angle);float c=cos(angle);return mat3(c,0.0,-s,0.0,1.0,0.0,s,0.0,c);}vec3 rotateY(vec3 v,float angle){return rotation3dY(angle)*v;}varying vec3 vNormal;varying float displacement;varying vec3 vPos;varying float vDistort;varying vec2 vUv;uniform float uTime;uniform float uSpeed;uniform float uLoadingTime;uniform float uNoiseDensity;uniform float uNoiseStrength;
#define STANDARD
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
#ifdef USE_TANGENT
varying vec3 vTangent;varying vec3 vBitangent;
#endif
#endif
#include <clipping_planes_pars_vertex>
#include <color_pars_vertex>
#include <common>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <morphtarget_pars_vertex>
#include <shadowmap_pars_vertex>
#include <skinning_pars_vertex>
#include <uv2_pars_vertex>
#include <uv_pars_vertex>
void main(){
#include <beginnormal_vertex>
#include <color_vertex>
#include <defaultnormal_vertex>
#include <morphnormal_vertex>
#include <skinbase_vertex>
#include <skinnormal_vertex>
#include <uv2_vertex>
#include <uv_vertex>
#ifndef FLAT_SHADED
vNormal=normalize(transformedNormal);
#ifdef USE_TANGENT
vTangent=normalize(transformedTangent);vBitangent=normalize(cross(vNormal,vTangent)*tangent.w);
#endif
#endif
#include <begin_vertex>
#include <clipping_planes_vertex>
#include <displacementmap_vertex>
#include <logdepthbuf_vertex>
#include <morphtarget_vertex>
#include <project_vertex>
#include <skinning_vertex>
vViewPosition=-mvPosition.xyz;
#include <fog_vertex>
#include <shadowmap_vertex>
#include <worldpos_vertex>
vUv=uv;float t=uTime*uSpeed;float distortion=0.75*cnoise(0.43*position*uNoiseDensity+t);vec3 pos=position+normal*distortion*uNoiseStrength*uLoadingTime;vPos=pos;gl_Position=projectionMatrix*modelViewMatrix*vec4(pos,1.);}`,{to:tz,rotDur:tO,meshDur:tQ,rotDelay:tL,meshDelay:tk}={meshDelay:0,meshDur:0,rotDelay:1.7,rotDur:1,posDelay:1.3,posDur:2.2,logoTransition:3.1,text:2.5,to:1},tU=new c.Clock;Math.easeInOutCubic=function(e,t,r,n){return(e/=n/2)<1?r/2*e*e*e+t:r/2*((e-=2)*e*e+2)+t};var tN=({type:e,animate:t,range:r,rangeStart:n,rangeEnd:i,uTime:a,uSpeed:o,uStrength:d,uDensity:f,uFrequency:p,uAmplitude:m,positionX:A,positionY:g,positionZ:v,rotationX:y,rotationY:x,rotationZ:E,color1:_,color2:b,color3:w,reflection:B,wireframe:I,shader:S,rotSpringOption:T=({rotation:e})=>({to:(t,r)=>M(void 0,null,function*(){yield t({animatedRotation:e})}),from:{rotation:tt([0,0,0])},config:{duration:300}}),posSpringOption:P=({position:e})=>({to:(t,r)=>M(void 0,null,function*(){yield t({animatedPosition:e})}),from:{position:[0,0,0]},config:{duration:300}})})=>{let D=function({type:e,shader:t,color1:r,color2:n,color3:i,uTime:a,uSpeed:o,uDensity:l,uStrength:h,uFrequency:d,uAmplitude:f}){var p,m,A,g,v;let[y,x]=(0,s.useState)(!1),E=null!=e?e:"plane",_=tm[E];t&&"defaults"!==t&&(_=tp[t][E]);let b=(p={colors:[r,n,i],uTime:a,uSpeed:o,uLoadingTime:0,uNoiseDensity:l,uNoiseStrength:h,uFrequency:d,uAmplitude:f,uIntensity:.5},m=_.vertex,A=_.fragment,class extends c.MeshPhysicalMaterial{constructor(){let e=Object.entries(p),t=p.colors,r=td(t[0]),n=td(t[1]),i=td(t[2]),a={uC1r:{value:tf(null==r?void 0:r.r)},uC1g:{value:tf(null==r?void 0:r.g)},uC1b:{value:tf(null==r?void 0:r.b)},uC2r:{value:tf(null==n?void 0:n.r)},uC2g:{value:tf(null==n?void 0:n.g)},uC2b:{value:tf(null==n?void 0:n.b)},uC3r:{value:tf(null==i?void 0:i.r)},uC3g:{value:tf(null==i?void 0:i.g)},uC3b:{value:tf(null==i?void 0:i.b)}},o=e.reduce((e,[t,r])=>{let n=c.UniformsUtils.clone({[t]:{value:r}});return C(C({},e),n)},{});super({metalness:.2,userData:o,side:c.DoubleSide,onBeforeCompile:e=>{e.uniforms=C(C(C({},e.uniforms),o),a),e.vertexShader=m,e.fragmentShader=A}}),e.forEach(([e])=>Object.defineProperty(this,e,{get:()=>this.uniforms[e].value,set:t=>this.uniforms[e].value=t}))}}),w=(g={uTime:a,uSpeed:o,uNoiseDensity:l,uNoiseStrength:h,uFrequency:d,uAmplitude:f,uIntensity:.5},v=_.vertex,class extends c.LineBasicMaterial{constructor(){let e=Object.entries(g),t=e.reduce((e,[t,r])=>{let n=c.UniformsUtils.clone({[t]:{value:r}});return C(C({},e),n)},{});super({color:"#ffffff",linewidth:5,userData:t,onBeforeCompile:e=>{e.uniforms=C(C({},e.uniforms),t),e.vertexShader=v}}),e.forEach(([e])=>Object.defineProperty(this,e,{get:()=>this.uniforms[e].value,set:t=>this.uniforms[e].value=t}))}});return(0,u.e)({ColorShiftMaterial:b}),(0,u.e)({HoveredLineMaterial:w}),(0,s.useEffect)(()=>{x(!0)},[]),y}({type:e,shader:S,color1:_,color2:b,color3:w,uTime:a,uSpeed:o,uDensity:f,uStrength:d,uFrequency:p,uAmplitude:m}),{material:R,linemat:F}=function({animate:e,range:t,rangeStart:r,rangeEnd:n}){let i=(0,s.useRef)(),a=(0,s.useRef)(),o=0;return(0,u.C)((s,l)=>{if(i.current){let s=tU.getElapsedTime();if("enabled"===t&&(s=r+tU.getElapsedTime())>=n&&(s=r,tU.start()),s>tk){let e=i.current.userData.uLoadingTime.value,t=s<tQ+tk?Math.easeInOutCubic(o,e,tz-e,1e3*tQ):tz;i.current.userData.uLoadingTime.value=t,s<tQ+tk&&(o+=20)}"on"===e&&(i.current.userData.uTime.value=s,void 0!==a.current&&(a.current.userData.uTime.value=s))}}),{material:i,linemat:a}}({animate:t,range:r,rangeStart:n,rangeEnd:i}),z=[A,g,v],O=tt([y,x,E]),{animatedPosition:Q}=(0,h.useSpring)(P({position:z})),{animatedRotation:L}=(0,h.useSpring)(T({rotation:O}));return(0,l.jsxs)("group",{children:[(0,l.jsxs)(h.animated.mesh,{position:Q,rotation:L,name:"shadergradient-mesh",children:["plane"===e&&(0,l.jsx)("planeGeometry",{args:[10,10,1,192]}),"sphere"===e&&(0,l.jsx)("icosahedronGeometry",{args:[1,64]}),"waterPlane"===e&&(0,l.jsx)("planeGeometry",{args:[10,10,192,192]}),D&&(0,l.jsx)("colorShiftMaterial",{ref:R,roughness:1-B})]}),(0,l.jsx)("mesh",{children:(0,l.jsxs)("lineSegments",{renderOrder:1,position:z,rotation:O,visible:!1,children:["plane"===e&&(0,l.jsx)("planeGeometry",{args:[10,10,1,36]}),"sphere"===e&&(0,l.jsx)("icosahedronGeometry",{args:[1,12]}),"waterPlane"===e&&(0,l.jsx)("planeGeometry",{args:[10,10,36,36]}),D&&(0,l.jsx)("hoveredLineMaterial",{ref:F})]})})]})},tG=(a=null!=(n=R())?d(y(n)):{},((e,t,r,n)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let i of g(t))x.call(e,i)||i===r||f(e,i,{get:()=>t[i],enumerable:!(n=m(t,i))||n.enumerable});return e})(!i&&n&&n.__esModule?a:f(a,"default",{value:n,enumerable:!0}),n)),tH=tG.parse(tr("?range=enabled&rangeStart=0&rangeEnd=40&frameRate=10&destination=onCanvas&format=gif&animate=on&axesHelper=off&brightness=1.2&cAzimuthAngle=180&cDistance=3.6&cPolarAngle=90&cameraZoom=1&color1=%23ff5005&color2=%23dbba95&color3=%23d0bce1&embedMode=off&envPreset=city&gizmoHelper=hide&grain=on&lightType=3d&pixelDensity=1&fov=45&positionX=-1.4&positionY=0&positionZ=0&reflection=0.1&rotationX=0&rotationY=10&rotationZ=50&shader=defaults&type=plane&uDensity=1.3&uSpeed=0.4&uStrength=4&uTime=0&uFrequency=5.5&wireframe=false"),{parseNumbers:!0,parseBooleans:!0,arrayFormat:"index"});function tV(e){var{control:t="props",dampingFactor:r,rotSpringOption:n,posSpringOption:i,isFigmaPlugin:a=!1,enableTransition:o=!0}=e,c=w(e,["control","dampingFactor","rotSpringOption","posSpringOption","isFigmaPlugin","enableTransition"]);let h=C(C({},tH),c);"query"===t&&(h=tG.parse(tr(c.urlString),{parseNumbers:!0,parseBooleans:!0,arrayFormat:"index"}));let d=h,{lightType:f,envPreset:p,brightness:m,grain:A,grainBlending:g,toggleAxis:v}=d,y=w(d,["lightType","envPreset","brightness","grain","grainBlending","toggleAxis"]);return function(e,t){let{gl:r,scene:n,camera:i,size:a}=(0,u.A)(),o=(0,s.useMemo)(()=>{let o=new W(r);o.addPass(new K(n,i));let s=new ei(a.width,a.height,{shape:1,radius:2,rotateR:Math.PI/12,rotateB:Math.PI/12*2,rotateG:Math.PI/12*3,scatter:1,blending:t,blendingMode:1,greyscale:!1,disable:e});return o.addPass(s),o},[r,n,i,a,e,t]);(0,s.useEffect)(()=>null==o?void 0:o.setSize(a.width,a.height),[o,a]),(0,u.C)((e,t)=>(r.autoClear=!0,void o.render(t)),1)}("off"===A,g||1),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(tu,{lightType:f,brightness:m,envPreset:p}),(0,l.jsx)(tN,b(C({},y),{rotSpringOption:n,posSpringOption:i}),JSON.stringify(y)),v&&(0,l.jsx)(eE,{isFigmaPlugin:a}),(0,l.jsx)(tn,C({dampingFactor:r,enableTransition:o},y))]})}/*! Bundled license information:

camera-controls/dist/camera-controls.module.js:
  (*!
   * camera-controls
   * https://github.com/yomotsu/camera-controls
   * (c) 2017 @yomotsu
   * Released under the MIT License.
   *)
*/},3502:function(e,t,r){"use strict";function n(){return function(e){function t(e,t){for(var r,n,i,a,o,s=/([MLQCZ])([^MLQCZ]*)/g;r=s.exec(e);){var l=r[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(e){return parseFloat(e)});switch(r[1]){case"M":a=n=l[0],o=i=l[1];break;case"L":(l[0]!==a||l[1]!==o)&&t("L",a,o,a=l[0],o=l[1]);break;case"Q":t("Q",a,o,a=l[2],o=l[3],l[0],l[1]);break;case"C":t("C",a,o,a=l[4],o=l[5],l[0],l[1],l[2],l[3]);break;case"Z":(a!==n||o!==i)&&t("L",a,o,n,i)}}}function r(e,r,n){void 0===n&&(n=16);var i={x:0,y:0};t(e,function(e,t,a,o,s,l,c,u,h){switch(e){case"L":r(t,a,o,s);break;case"Q":for(var d=t,f=a,p=1;p<n;p++)!function(e,t,r,n,i,a,o,s){var l=1-o;s.x=l*l*e+2*l*o*r+o*o*i,s.y=l*l*t+2*l*o*n+o*o*a}(t,a,l,c,o,s,p/(n-1),i),r(d,f,i.x,i.y),d=i.x,f=i.y;break;case"C":for(var m=t,A=a,g=1;g<n;g++)!function(e,t,r,n,i,a,o,s,l,c){var u=1-l;c.x=u*u*u*e+3*u*u*l*r+3*u*l*l*i+l*l*l*o,c.y=u*u*u*t+3*u*u*l*n+3*u*l*l*a+l*l*l*s}(t,a,l,c,u,h,o,s,g/(n-1),i),r(m,A,i.x,i.y),m=i.x,A=i.y}})}var n="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",i=new WeakMap,a={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function o(e,t){var r=e.getContext?e.getContext("webgl",a):e,n=i.get(r);if(!n){var o="undefined"!=typeof WebGL2RenderingContext&&r instanceof WebGL2RenderingContext,s={},l={},c={},u=-1,h=[];function d(e){var t=s[e];if(!t&&!(t=s[e]=r.getExtension(e)))throw Error(e+" not supported");return t}function f(e,t){var n=r.createShader(t);return r.shaderSource(n,e),r.compileShader(n),n}function p(){s={},l={},c={},u=-1,h.length=0}r.canvas.addEventListener("webglcontextlost",function(e){p(),e.preventDefault()},!1),i.set(r,n={gl:r,isWebGL2:o,getExtension:d,withProgram:function(e,t,n,i){if(!l[e]){var a={},s={},c=r.createProgram();r.attachShader(c,f(t,r.VERTEX_SHADER)),r.attachShader(c,f(n,r.FRAGMENT_SHADER)),r.linkProgram(c),l[e]={program:c,transaction:function(e){r.useProgram(c),e({setUniform:function(e,t){for(var n=[],i=arguments.length-2;i-- >0;)n[i]=arguments[i+2];var a=s[t]||(s[t]=r.getUniformLocation(c,t));r["uniform"+e].apply(r,[a].concat(n))},setAttribute:function(e,t,n,i,s){var l=a[e];l||(l=a[e]={buf:r.createBuffer(),loc:r.getAttribLocation(c,e),data:null}),r.bindBuffer(r.ARRAY_BUFFER,l.buf),r.vertexAttribPointer(l.loc,t,r.FLOAT,!1,0,0),r.enableVertexAttribArray(l.loc),o?r.vertexAttribDivisor(l.loc,i):d("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(l.loc,i),s!==l.data&&(r.bufferData(r.ARRAY_BUFFER,s,n),l.data=s)}})}}}l[e].transaction(i)},withTexture:function(e,t){u++;try{r.activeTexture(r.TEXTURE0+u);var n=c[e];n||(n=c[e]=r.createTexture(),r.bindTexture(r.TEXTURE_2D,n),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST)),r.bindTexture(r.TEXTURE_2D,n),t(n,u)}finally{u--}},withTextureFramebuffer:function(e,t,n){var i=r.createFramebuffer();h.push(i),r.bindFramebuffer(r.FRAMEBUFFER,i),r.activeTexture(r.TEXTURE0+t),r.bindTexture(r.TEXTURE_2D,e),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e,0);try{n(i)}finally{r.deleteFramebuffer(i),r.bindFramebuffer(r.FRAMEBUFFER,h[--h.length-1]||null)}},handleContextLoss:p})}t(n)}function s(e,t,r,i,a,s,l,c){void 0===l&&(l=15),void 0===c&&(c=null),o(e,function(e){var o=e.gl,u=e.withProgram;(0,e.withTexture)("copy",function(e,h){o.texImage2D(o.TEXTURE_2D,0,o.RGBA,a,s,0,o.RGBA,o.UNSIGNED_BYTE,t),u("copy",n,"precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",function(e){var t=e.setUniform;(0,e.setAttribute)("aUV",2,o.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),t("1i","image",h),o.bindFramebuffer(o.FRAMEBUFFER,c||null),o.disable(o.BLEND),o.colorMask(8&l,4&l,2&l,1&l),o.viewport(r,i,a,s),o.scissor(r,i,a,s),o.drawArrays(o.TRIANGLES,0,3)})})})}var l=Object.freeze({__proto__:null,withWebGLContext:o,renderImageData:s,resizeWebGLCanvasWithoutClearing:function(e,t,r){var n=e.width,i=e.height;o(e,function(a){var o=a.gl,l=new Uint8Array(n*i*4);o.readPixels(0,0,n,i,o.RGBA,o.UNSIGNED_BYTE,l),e.width=t,e.height=r,s(o,l,0,0,n,i)})}});function c(e,t,n,i,a,o){void 0===o&&(o=1);var s=new Uint8Array(e*t),l=i[2]-i[0],c=i[3]-i[1],u=[];r(n,function(e,t,r,n){u.push({x1:e,y1:t,x2:r,y2:n,minX:Math.min(e,r),minY:Math.min(t,n),maxX:Math.max(e,r),maxY:Math.max(t,n)})}),u.sort(function(e,t){return e.maxX-t.maxX});for(var h=0;h<e;h++)for(var d=0;d<t;d++){var f=function(e,t){for(var r=1/0,n=1/0,i=u.length;i--;){var a=u[i];if(a.maxX+n<=e)break;if(e+n>a.minX&&t-n<a.maxY&&t+n>a.minY){var o=function(e,t,r,n,i,a){var o=i-r,s=a-n,l=o*o+s*s,c=l?Math.max(0,Math.min(1,((e-r)*o+(t-n)*s)/l)):0,u=e-(r+c*o),h=t-(n+c*s);return u*u+h*h}(e,t,a.x1,a.y1,a.x2,a.y2);o<r&&(n=Math.sqrt(r=o))}}return function(e,t){for(var r=0,n=u.length;n--;){var i=u[n];if(i.maxX<=e)break;i.y1>t!=i.y2>t&&e<(i.x2-i.x1)*(t-i.y1)/(i.y2-i.y1)+i.x1&&(r+=i.y1<i.y2?1:-1)}return 0!==r}(e,t)&&(n=-n),n}(i[0]+l*(h+.5)/e,i[1]+c*(d+.5)/t),p=Math.pow(1-Math.abs(f)/a,o)/2;f<0&&(p=1-p),p=Math.max(0,Math.min(255,Math.round(255*p))),s[d*e+h]=p}return s}function u(e,t,r,n,i,a,o,s,l,c){void 0===a&&(a=1),void 0===s&&(s=0),void 0===l&&(l=0),void 0===c&&(c=0),h(e,t,r,n,i,a,o,null,s,l,c)}function h(e,t,r,n,i,a,o,l,u,h,d){void 0===a&&(a=1),void 0===u&&(u=0),void 0===h&&(h=0),void 0===d&&(d=0);for(var f=c(e,t,r,n,i,a),p=new Uint8Array(4*f.length),m=0;m<f.length;m++)p[4*m+d]=f[m];s(o,p,u,h,e,t,1<<3-d,l)}var d=Object.freeze({__proto__:null,generate:c,generateIntoCanvas:u,generateIntoFramebuffer:h}),f=new Float32Array([0,0,2,0,0,2]),p=null,m=!1,A={},g=new WeakMap;function v(e){if(!m&&!_(e))throw Error("WebGL generation not supported")}function y(e,t,r,n,i,a,s){if(void 0===a&&(a=1),void 0===s&&(s=null),!s&&!(s=p)){var l="function"==typeof OffscreenCanvas?new OffscreenCanvas(1,1):"undefined"!=typeof document?document.createElement("canvas"):null;if(!l)throw Error("OffscreenCanvas or DOM canvas not supported");s=p=l.getContext("webgl",{depth:!1})}v(s);var c=new Uint8Array(e*t*4);o(s,function(o){var s=o.gl,l=o.withTexture,u=o.withTextureFramebuffer;l("readable",function(o,l){s.texImage2D(s.TEXTURE_2D,0,s.RGBA,e,t,0,s.RGBA,s.UNSIGNED_BYTE,null),u(o,l,function(o){E(e,t,r,n,i,a,s,o,0,0,0),s.readPixels(0,0,e,t,s.RGBA,s.UNSIGNED_BYTE,c)})})});for(var u=new Uint8Array(e*t),h=0,d=0;h<c.length;h+=4)u[d++]=c[h];return u}function x(e,t,r,n,i,a,o,s,l,c){void 0===a&&(a=1),void 0===s&&(s=0),void 0===l&&(l=0),void 0===c&&(c=0),E(e,t,r,n,i,a,o,null,s,l,c)}function E(e,t,i,a,s,l,c,u,h,d,p){void 0===l&&(l=1),void 0===h&&(h=0),void 0===d&&(d=0),void 0===p&&(p=0),v(c);var m=[];r(i,function(e,t,r,n){m.push(e,t,r,n)}),m=new Float32Array(m),o(c,function(r){var i=r.gl,o=r.isWebGL2,c=r.getExtension,A=r.withProgram,g=r.withTexture,v=r.withTextureFramebuffer,y=r.handleContextLoss;if(g("rawDistances",function(r,g){(e!==r._lastWidth||t!==r._lastHeight)&&i.texImage2D(i.TEXTURE_2D,0,i.RGBA,r._lastWidth=e,r._lastHeight=t,0,i.RGBA,i.UNSIGNED_BYTE,null),A("main","precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}","precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",function(n){var u=n.setAttribute,h=n.setUniform,d=!o&&c("ANGLE_instanced_arrays"),p=!o&&c("EXT_blend_minmax");u("aUV",2,i.STATIC_DRAW,0,f),u("aLineSegment",4,i.DYNAMIC_DRAW,1,m),h.apply(void 0,["4f","uGlyphBounds"].concat(a)),h("1f","uMaxDistance",s),h("1f","uExponent",l),v(r,g,function(r){i.enable(i.BLEND),i.colorMask(!0,!0,!0,!0),i.viewport(0,0,e,t),i.scissor(0,0,e,t),i.blendFunc(i.ONE,i.ONE),i.blendEquationSeparate(i.FUNC_ADD,o?i.MAX:p.MAX_EXT),i.clear(i.COLOR_BUFFER_BIT),o?i.drawArraysInstanced(i.TRIANGLES,0,3,m.length/4):d.drawArraysInstancedANGLE(i.TRIANGLES,0,3,m.length/4)})}),A("post",n,"precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",function(r){r.setAttribute("aUV",2,i.STATIC_DRAW,0,f),r.setUniform("1i","tex",g),i.bindFramebuffer(i.FRAMEBUFFER,u),i.disable(i.BLEND),i.colorMask(0===p,1===p,2===p,3===p),i.viewport(h,d,e,t),i.scissor(h,d,e,t),i.drawArrays(i.TRIANGLES,0,3)})}),i.isContextLost())throw y(),Error("webgl context lost")})}function _(e){var t=e&&e!==p?e.canvas||e:A,r=g.get(t);if(void 0===r){m=!0;var n=null;try{var i=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],a=y(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,e);(r=a&&i.length===a.length&&a.every(function(e,t){return e===i[t]}))||(n="bad trial run results",console.info(i,a))}catch(e){r=!1,n=e.message}n&&console.warn("WebGL SDF generation not supported:",n),m=!1,g.set(t,r)}return r}var C=Object.freeze({__proto__:null,generate:y,generateIntoCanvas:x,generateIntoFramebuffer:E,isSupported:_});return e.forEachPathCommand=t,e.generate=function(e,t,r,n,i,a){void 0===i&&(i=Math.max(n[2]-n[0],n[3]-n[1])/2),void 0===a&&(a=1);try{return y.apply(C,arguments)}catch(e){return console.info("WebGL SDF generation failed, falling back to JS",e),c.apply(d,arguments)}},e.generateIntoCanvas=function(e,t,r,n,i,a,o,s,l,c){void 0===i&&(i=Math.max(n[2]-n[0],n[3]-n[1])/2),void 0===a&&(a=1),void 0===s&&(s=0),void 0===l&&(l=0),void 0===c&&(c=0);try{return x.apply(C,arguments)}catch(e){return console.info("WebGL SDF generation failed, falling back to JS",e),u.apply(d,arguments)}},e.javascript=d,e.pathToLineSegments=r,e.webgl=C,e.webglUtils=l,Object.defineProperty(e,"__esModule",{value:!0}),e}({})}r.d(t,{Z:function(){return n}})}}]);